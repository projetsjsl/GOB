import{r as dt,g as ct,a as mt}from"./react-vendor-labSKdyf.js";(function(){const I=document.createElement("link").relList;if(I&&I.supports&&I.supports("modulepreload"))return;for(const M of document.querySelectorAll('link[rel="modulepreload"]'))_(M);new MutationObserver(M=>{for(const P of M)if(P.type==="childList")for(const L of P.addedNodes)L.tagName==="LINK"&&L.rel==="modulepreload"&&_(L)}).observe(document,{childList:!0,subtree:!0});function w(M){const P={};return M.integrity&&(P.integrity=M.integrity),M.referrerPolicy&&(P.referrerPolicy=M.referrerPolicy),M.crossOrigin==="use-credentials"?P.credentials="include":M.crossOrigin==="anonymous"?P.credentials="omit":P.credentials="same-origin",P}function _(M){if(M.ep)return;M.ep=!0;const P=w(M);fetch(M.href,P)}})();var tt={exports:{}},Ue={};var at;function ut(){if(at)return Ue;at=1;var o=dt(),I=Symbol.for("react.element"),w=Symbol.for("react.fragment"),_=Object.prototype.hasOwnProperty,M=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,P={key:!0,ref:!0,__self:!0,__source:!0};function L(J,h,r){var l,g={},S=null,$=null;r!==void 0&&(S=""+r),h.key!==void 0&&(S=""+h.key),h.ref!==void 0&&($=h.ref);for(l in h)_.call(h,l)&&!P.hasOwnProperty(l)&&(g[l]=h[l]);if(J&&J.defaultProps)for(l in h=J.defaultProps,h)g[l]===void 0&&(g[l]=h[l]);return{$$typeof:I,type:J,key:S,ref:$,props:g,_owner:M.current}}return Ue.Fragment=w,Ue.jsx=L,Ue.jsxs=L,Ue}var it;function ht(){return it||(it=1,tt.exports=ut()),tt.exports}var e=ht(),j=dt();const Ke=ct(j);var Qe={},nt;function bt(){if(nt)return Qe;nt=1;var o=mt();return Qe.createRoot=o.createRoot,Qe.hydrateRoot=o.hydrateRoot,Qe}var pt=bt();const yt=ct(pt),ft=({emmaConnected:o,setEmmaConnected:I,showPromptEditor:w,setShowPromptEditor:_,showTemperatureEditor:M,setShowTemperatureEditor:P,showLengthEditor:L,setShowLengthEditor:J})=>{const[h,r]=j.useState(()=>{const s=localStorage.getItem("emma-temperature");return s?parseFloat(s):.3}),[l,g]=j.useState(()=>{const s=localStorage.getItem("emma-max-tokens");return s?parseInt(s):4096}),[S,$]=j.useState(()=>localStorage.getItem("emma-financial-prompt")||`Tu es Emma, CFA¬Æ Level III, analyste financi√®re senior avec 15+ ans exp√©rience gestion portefeuille institutionnel.

MISSION: Fournir analyses financi√®res rigoureuses, factuelles, actionnables de niveau Bloomberg Terminal.

///
DONN√âES DISPONIBLES (via outils dashboard):
- Prix actions temps r√©el (FMP, Polygon, Twelve Data)
- Fondamentaux (ratios P/E, ROE, marges, cash flow)
- Actualit√©s financi√®res (<24h, Finnhub, FMP)
- Indicateurs techniques (RSI, MACD, SMA)
- Calendriers (earnings, √©v√©nements √©conomiques)
- Watchlist utilisateur + tickers √©quipe
///

CAPACIT√âS PRINCIPALES:
1. Analyses compl√®tes CFA¬Æ (valorisation, fondamentaux, technique)
2. Explications concepts financiers (DCF, Graham, Buffett, Lynch)
3. Contexte macro et sectoriel (Fed, taux, inflation)
4. Cadres d√©cisionnels structur√©s (Porter's Five Forces, Moat analysis)

APPROCHE:
- Priorit√© donn√©es R√âELLES via outils (prix, ratios, news)
- Analyses chiffr√©es (minimum 8 ratios financiers)
- Comparaisons sectorielles + historique 3-5 ans
- Sources cit√©es (FMP, Bloomberg, FactSet)

STYLE:
- Professionnel niveau CFA Institute
- Factuel, pr√©cis, sans g√©n√©ralit√©s vagues
- Proactif: proposer analyses compl√©mentaires
- P√©dagogique: expliquer ratios et concepts
- Toujours en fran√ßais

CONTRAINTES:
- Z√âRO mention limitations ("Je n'ai pas acc√®s")
- Commencer par ce que tu PEUX analyser avec donn√©es disponibles
- Longueur: 200-400 mots (questions simples), PROFONDEUR MAXIMALE pour analyses compl√®tes (aucune limite)
- V√©rifier coh√©rence donn√©es avant r√©ponse finale
- Disclaimer obligatoire si recommandations d'investissement`),[k,O]=j.useState(()=>{const s=localStorage.getItem("emma-use-function-calling");return s!==null?s==="true":!0}),[F,q]=j.useState(!1),B=s=>{$(s),localStorage.setItem("emma-financial-prompt",s)},ge=s=>{r(s),localStorage.setItem("emma-temperature",s.toString())},Y=s=>{g(s),localStorage.setItem("emma-max-tokens",s.toString())},ce=s=>{O(s),localStorage.setItem("emma-use-function-calling",s.toString())},R=()=>{B(`Tu es Emma, CFA¬Æ Level III, analyste financi√®re senior avec 15+ ans exp√©rience gestion portefeuille institutionnel.

MISSION: Fournir analyses financi√®res rigoureuses, factuelles, actionnables de niveau Bloomberg Terminal.

///
DONN√âES DISPONIBLES (via outils dashboard):
- Prix actions temps r√©el (FMP, Polygon, Twelve Data)
- Fondamentaux (ratios P/E, ROE, marges, cash flow)
- Actualit√©s financi√®res (<24h, Finnhub, FMP)
- Indicateurs techniques (RSI, MACD, SMA)
- Calendriers (earnings, √©v√©nements √©conomiques)
- Watchlist utilisateur + tickers √©quipe
///

CAPACIT√âS PRINCIPALES:
1. Analyses compl√®tes CFA¬Æ (valorisation, fondamentaux, technique)
2. Explications concepts financiers (DCF, Graham, Buffett, Lynch)
3. Contexte macro et sectoriel (Fed, taux, inflation)
4. Cadres d√©cisionnels structur√©s (Porter's Five Forces, Moat analysis)

APPROCHE:
- Priorit√© donn√©es R√âELLES via outils (prix, ratios, news)
- Analyses chiffr√©es (minimum 8 ratios financiers)
- Comparaisons sectorielles + historique 3-5 ans
- Sources cit√©es (FMP, Bloomberg, FactSet)

STYLE:
- Professionnel niveau CFA Institute
- Factuel, pr√©cis, sans g√©n√©ralit√©s vagues
- Proactif: proposer analyses compl√©mentaires
- P√©dagogique: expliquer ratios et concepts
- Toujours en fran√ßais

CONTRAINTES:
- Z√âRO mention limitations ("Je n'ai pas acc√®s")
- Commencer par ce que tu PEUX analyser avec donn√©es disponibles
- Longueur: 200-400 mots (questions simples), PROFONDEUR MAXIMALE pour analyses compl√®tes (aucune limite)
- V√©rifier coh√©rence donn√©es avant r√©ponse finale
- Disclaimer obligatoire si recommandations d'investissement`)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h2",{className:`text-2xl font-bold transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:"‚öôÔ∏è Admin-JSLAI"})}),e.jsx(EmmaSmsPanel,{}),e.jsxs("div",{className:`rounded-lg p-4 border transition-colors duration-300 ${isDarkMode?"bg-gradient-to-br from-purple-900/20 to-gray-900 border-purple-700":"bg-gradient-to-br from-purple-50 to-gray-50 border-purple-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 cursor-pointer",onClick:()=>q(!F),children:[e.jsxs("h3",{className:`text-lg font-semibold flex items-center gap-2 ${isDarkMode?"text-purple-300":"text-purple-900"}`,children:[e.jsx(Icon,{emoji:"ü§ñ",size:20}),"Emma Configuration (Prompts Optimis√©s)",e.jsx("span",{className:"text-xs opacity-70",children:"(partag√© avec onglet Emma IA‚Ñ¢)"})]}),e.jsx("button",{className:`px-3 py-1 text-xs rounded transition-colors ${isDarkMode?"bg-purple-600 hover:bg-purple-700 text-white":"bg-purple-500 hover:bg-purple-600 text-white"}`,children:F?"‚ñº Masquer":"‚ñ∂ Afficher"})]}),F&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:`p-3 rounded ${isDarkMode?"bg-gray-800":"bg-white"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("label",{className:`font-semibold flex items-center gap-2 ${isDarkMode?"text-purple-300":"text-purple-900"}`,children:[e.jsx(Icon,{emoji:"üìù",size:16}),"Prompt Syst√®me (Optimis√© Hassid)"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:R,className:`px-3 py-1 text-xs rounded transition-colors ${isDarkMode?"bg-green-600 hover:bg-green-700 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:"‚úÖ Restaurer prompt optimis√©"}),e.jsxs("span",{className:`px-3 py-1 text-xs rounded ${isDarkMode?"bg-blue-900 text-blue-200":"bg-blue-100 text-blue-800"}`,children:[S.split(" ").length," mots (-85.6% vs original)"]})]})]}),e.jsx("textarea",{value:S,onChange:s=>B(s.target.value),className:`w-full h-64 p-3 rounded border font-mono text-sm ${isDarkMode?"bg-gray-900 border-gray-700 text-gray-200":"bg-white border-gray-300 text-gray-900"}`,placeholder:"Prompt syst√®me Emma..."}),e.jsx("div",{className:`mt-2 text-xs ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:"üí° Prompt optimis√© selon principes Hassid: layered structure, d√©limiteurs ///, contraintes en fin (recency effect)"})]}),e.jsxs("div",{className:`p-3 rounded ${isDarkMode?"bg-gray-800":"bg-white"}`,children:[e.jsxs("label",{className:`block font-semibold mb-2 flex items-center gap-2 ${isDarkMode?"text-purple-300":"text-purple-900"}`,children:[e.jsx(Icon,{emoji:"üå°Ô∏è",size:16}),"Temp√©rature: ",e.jsx("span",{className:"font-bold text-blue-600",children:h.toFixed(2)}),e.jsxs("span",{className:"text-xs font-normal opacity-70",children:["(",h<=.3?"Pr√©cis/Factuel":h<=.6?"√âquilibr√©":"Cr√©atif",")"]})]}),e.jsx("input",{type:"range",min:"0.1",max:"1.0",step:"0.05",value:h,onChange:s=>ge(parseFloat(s.target.value)),className:"w-full"}),e.jsxs("div",{className:`flex justify-between text-xs mt-1 ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:[e.jsx("span",{children:"0.1 (Pr√©cis)"}),e.jsx("span",{children:"0.5 (√âquilibr√©)"}),e.jsx("span",{children:"1.0 (Cr√©atif)"})]})]}),e.jsxs("div",{className:`p-3 rounded ${isDarkMode?"bg-gray-800":"bg-white"}`,children:[e.jsxs("label",{className:`block font-semibold mb-2 flex items-center gap-2 ${isDarkMode?"text-purple-300":"text-purple-900"}`,children:[e.jsx(Icon,{emoji:"üìè",size:16}),"Longueur Max: ",e.jsxs("span",{className:"font-bold text-blue-600",children:[l," tokens"]}),e.jsxs("span",{className:"text-xs font-normal opacity-70",children:["(~",Math.round(l*.75)," mots)"]})]}),e.jsx("input",{type:"range",min:"1024",max:"16384",step:"512",value:l,onChange:s=>Y(parseInt(s.target.value)),className:"w-full"}),e.jsxs("div",{className:`flex justify-between text-xs mt-1 ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:[e.jsx("span",{children:"1024"}),e.jsx("span",{children:"4096 (d√©faut)"}),e.jsx("span",{children:"8192"}),e.jsx("span",{children:"16384"})]}),e.jsx("div",{className:`mt-2 text-xs ${isDarkMode?"text-yellow-400":"text-yellow-700"}`,children:"‚ö†Ô∏è Note: Analyses compl√®tes SMS = max 2 parties (~3500 chars). Web/Email = profondeur maximale."})]}),e.jsxs("div",{className:`p-3 rounded ${isDarkMode?"bg-gray-800":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:`font-semibold flex items-center gap-2 ${isDarkMode?"text-purple-300":"text-purple-900"}`,children:[e.jsx(Icon,{emoji:"üîß",size:16}),"Function Calling (APIs temps r√©el)"]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:k,onChange:s=>ce(s.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 dark:peer-focus:ring-purple-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-purple-600"}),e.jsx("span",{className:`ml-3 text-sm font-medium ${isDarkMode?"text-gray-300":"text-gray-900"}`,children:k?"Activ√© ‚úÖ":"D√©sactiv√© ‚ùå"})]})]}),e.jsx("div",{className:`mt-2 text-xs ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:k?"‚úÖ Emma utilise les APIs (FMP, Finnhub, etc.) pour donn√©es temps r√©el":"‚ùå Emma se base uniquement sur ses connaissances d'entra√Ænement"})]}),e.jsx("div",{className:`p-3 rounded border-2 ${isDarkMode?"bg-blue-900/20 border-blue-700":"bg-blue-50 border-blue-300"}`,children:e.jsxs("div",{className:`text-sm ${isDarkMode?"text-blue-200":"text-blue-900"}`,children:[e.jsx(Icon,{emoji:"‚ÑπÔ∏è",size:16})," ",e.jsx("strong",{children:"Synchronisation automatique:"}),` Tous les r√©glages sont partag√©s avec l'onglet "Emma IA‚Ñ¢" via localStorage. Les modifications ici s'appliquent imm√©diatement partout.`]})})]})]}),e.jsxs("div",{className:`rounded-lg p-4 border transition-colors duration-300 ${isDarkMode?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("h3",{className:`text-lg font-semibold mb-4 flex items-center gap-2 ${isDarkMode?"text-white":"text-gray-900"}`,children:[e.jsx(Icon,{emoji:"üîç",size:20}),"Debug des Donn√©es"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:`${isDarkMode?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} rounded p-3 border`,children:[e.jsxs("div",{className:"text-blue-600 font-medium mb-2 flex items-center gap-2",children:[e.jsx(Icon,{emoji:"üìä",size:18}),"Stock Data"]}),e.jsxs("div",{className:isDarkMode?"text-gray-200":"text-gray-700",children:["Tickers: ",tickers.length," (",tickers.join(", "),")"]}),e.jsxs("div",{className:isDarkMode?"text-gray-200":"text-gray-700",children:["Donn√©es charg√©es: ",Object.keys(stockData).length]}),e.jsxs("div",{className:isDarkMode?"text-gray-200":"text-gray-700",children:["Derni√®re MAJ: ",lastUpdate?new Date(lastUpdate).toLocaleString("fr-FR"):"Jamais"]})]}),e.jsxs("div",{className:`${isDarkMode?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} rounded p-3 border`,children:[e.jsxs("div",{className:"text-emerald-600 font-medium mb-2 flex items-center gap-2",children:[e.jsx(Icon,{emoji:"üì∞",size:18}),"News Data"]}),e.jsxs("div",{className:isDarkMode?"text-gray-200":"text-gray-700",children:["Articles: ",newsData.length]}),e.jsxs("div",{className:isDarkMode?"text-gray-200":"text-gray-700",children:["Premier article: ",newsData[0]?.title?.substring(0,30)||"Aucun","..."]})]}),e.jsxs("div",{className:`${isDarkMode?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} rounded p-3 border`,children:[e.jsxs("div",{className:"text-violet-600 font-medium mb-2 flex items-center gap-2",children:[e.jsx(Icon,{emoji:"üéØ",size:18}),"Seeking Alpha"]}),e.jsxs("div",{className:isDarkMode?"text-gray-200":"text-gray-700",children:["Stocks: ",seekingAlphaData.stocks?.length||0]}),e.jsxs("div",{className:isDarkMode?"text-gray-200":"text-gray-700",children:["Stock Data: ",Object.keys(seekingAlphaStockData.stocks||{}).length]})]})]})]}),e.jsxs("div",{className:`rounded-lg p-4 border transition-colors duration-300 ${isDarkMode?"bg-gradient-to-br from-blue-900/20 to-gray-900 border-blue-700":"bg-gradient-to-br from-blue-50 to-gray-50 border-blue-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:`text-lg font-semibold flex items-center gap-2 ${isDarkMode?"text-blue-300":"text-blue-900"}`,children:[e.jsx(Icon,{emoji:"üì¶",size:20}),"Gestion du Cache Supabase"]}),e.jsx("button",{onClick:async()=>{setLoadingCacheStatus(!0);try{const s=await fetch(`${API_BASE_URL}/api/supabase-daily-cache?type=status&maxAgeHours=${cacheSettings.maxAgeHours||4}`);if(s.ok){const b=await s.json();setCacheStatus(b.status||{})}}catch(s){console.error("Erreur r√©cup√©ration statut cache:",s)}finally{setLoadingCacheStatus(!1)}},disabled:loadingCacheStatus,className:`px-3 py-1 text-xs rounded transition-colors ${loadingCacheStatus?"bg-gray-500 text-white cursor-not-allowed":isDarkMode?"bg-blue-600 hover:bg-blue-700 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,children:loadingCacheStatus?"‚è≥ Chargement...":"üîÑ Actualiser"})]}),e.jsxs("div",{className:`space-y-4 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:[e.jsxs("div",{className:`p-3 rounded ${isDarkMode?"bg-gray-800":"bg-white"}`,children:[e.jsxs("div",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Icon,{emoji:"‚öôÔ∏è",size:16}),"Param√®tres du Cache"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm mb-2",children:["Dur√©e du cache (heures): ",e.jsxs("span",{className:"font-bold text-blue-600",children:[cacheSettings.maxAgeHours,"h"]})]}),e.jsx("input",{type:"range",min:"1",max:"12",value:cacheSettings.maxAgeHours,onChange:s=>{const b={...cacheSettings,maxAgeHours:parseInt(s.target.value)};setCacheSettings(b),localStorage.setItem("cacheSettings",JSON.stringify(b))},className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"1h"}),e.jsx("span",{children:"6h"}),e.jsx("span",{children:"12h"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"refreshOnNavigation",checked:cacheSettings.refreshOnNavigation,onChange:s=>{const b={...cacheSettings,refreshOnNavigation:s.target.checked};setCacheSettings(b),localStorage.setItem("cacheSettings",JSON.stringify(b))},className:"rounded"}),e.jsx("label",{htmlFor:"refreshOnNavigation",className:"text-sm",children:"Rafra√Æchir les donn√©es tickers lors de la navigation"})]}),cacheSettings.refreshOnNavigation&&e.jsxs("div",{className:"ml-6",children:[e.jsxs("label",{className:"block text-sm mb-2",children:["Intervalle de rafra√Æchissement (minutes): ",e.jsxs("span",{className:"font-bold text-blue-600",children:[cacheSettings.refreshIntervalMinutes," min"]})]}),e.jsx("input",{type:"range",min:"5",max:"30",step:"5",value:cacheSettings.refreshIntervalMinutes,onChange:s=>{const b={...cacheSettings,refreshIntervalMinutes:parseInt(s.target.value)};setCacheSettings(b),localStorage.setItem("cacheSettings",JSON.stringify(b))},className:"w-full"})]})]})]}),e.jsxs("div",{className:`p-3 rounded ${isDarkMode?"bg-gray-800":"bg-white"}`,children:[e.jsxs("div",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Icon,{emoji:"üìä",size:16}),"√âtat du Cache"]}),e.jsx("div",{className:"space-y-2 text-xs",children:Object.keys(cacheStatus).length===0?e.jsx("div",{className:`text-center py-2 ${isDarkMode?"text-gray-400":"text-gray-500"}`,children:`Cliquez sur "Actualiser" pour voir l'√©tat du cache`}):Object.entries(cacheStatus).map(([s,b])=>e.jsxs("div",{className:`p-2 rounded border ${b.expired?isDarkMode?"bg-yellow-900/30 border-yellow-800":"bg-yellow-50 border-yellow-200":isDarkMode?"bg-green-900/30 border-green-800":"bg-green-50 border-green-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-semibold capitalize",children:s.replace("_"," ")}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${b.expired?"bg-yellow-500 text-white":"bg-green-500 text-white"}`,children:b.expired?"‚ö†Ô∏è Expir√©":"‚úÖ Valide"})]}),b.age_hours&&e.jsxs("div",{className:"mt-1 text-gray-600",children:["√Çge: ",parseFloat(b.age_hours).toFixed(1),"h / ",b.max_age_hours||cacheSettings.maxAgeHours,"h max"]})]},s))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:async()=>{if(confirm("Vider tout le cache Supabase ? Les donn√©es seront recharg√©es depuis les APIs."))try{(await fetch(`${API_BASE_URL}/api/supabase-daily-cache`,{method:"DELETE"})).ok&&(alert("Cache vid√© avec succ√®s"),setCacheStatus({}))}catch{alert("Erreur lors du vidage du cache")}},className:`px-4 py-2 rounded text-sm font-semibold transition-colors ${isDarkMode?"bg-red-600 hover:bg-red-700 text-white":"bg-red-500 hover:bg-red-600 text-white"}`,children:"üóëÔ∏è Vider le Cache"}),e.jsx("button",{onClick:()=>{const s={maxAgeHours:4,refreshOnNavigation:!0,refreshIntervalMinutes:10};setCacheSettings(s),localStorage.setItem("cacheSettings",JSON.stringify(s)),alert("Param√®tres r√©initialis√©s aux valeurs par d√©faut")},className:`px-4 py-2 rounded text-sm font-semibold transition-colors ${isDarkMode?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-600 hover:bg-gray-700 text-white"}`,children:"üîÑ R√©initialiser"})]})]})]}),e.jsxs("div",{className:`rounded-lg p-4 border transition-colors duration-300 ${isDarkMode?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:`text-lg font-semibold flex items-center gap-2 ${isDarkMode?"text-white":"text-gray-900"}`,children:[e.jsx(Icon,{emoji:"üìã",size:20}),"Logs Syst√®me"]}),e.jsx("button",{onClick:()=>setSystemLogs([]),className:"px-3 py-1 text-xs bg-red-500 text-white rounded hover:bg-red-600 transition-colors",children:"Effacer logs"})]}),e.jsx("div",{className:`max-h-64 overflow-y-auto rounded p-3 font-mono text-xs ${isDarkMode?"bg-gray-800":"bg-white"}`,children:systemLogs.length===0?e.jsx("div",{className:`text-center py-4 ${isDarkMode?"text-gray-400":"text-gray-500"}`,children:"Aucun log pour le moment"}):systemLogs.map((s,b)=>e.jsxs("div",{className:`py-1 border-b ${isDarkMode?"border-gray-700":"border-gray-200"} ${s.type==="error"?"text-red-500":s.type==="success"?"text-green-500":s.type==="warning"?"text-yellow-500":isDarkMode?"text-gray-300":"text-gray-700"}`,children:[e.jsxs("span",{className:"text-gray-500",children:["[",s.timestamp,"]"]})," ",s.text]},b))})]}),e.jsxs("div",{className:`rounded-lg p-4 border transition-colors duration-300 ${isDarkMode?"bg-gradient-to-br from-purple-900/20 to-gray-900 border-purple-700":"bg-gradient-to-br from-purple-50 to-gray-50 border-purple-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:`text-lg font-semibold flex items-center gap-2 ${isDarkMode?"text-purple-300":"text-purple-900"}`,children:[e.jsx(Icon,{emoji:"üß†",size:20}),"Deep Think"]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded ${isDarkMode?"bg-purple-900/50 text-purple-300":"bg-purple-200 text-purple-900"}`,children:"AI Analysis System"})]}),e.jsxs("div",{className:`space-y-2 text-sm ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:[e.jsxs("div",{className:`p-3 rounded ${isDarkMode?"bg-gray-800":"bg-white"}`,children:[e.jsxs("div",{className:"font-semibold mb-1 flex items-center gap-2",children:[e.jsx(Icon,{emoji:"üéØ",size:16}),"Statut du syst√®me"]}),e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{children:["‚Ä¢ Gemini API: ",typeof window<"u"?"‚úÖ Actif":"‚ö†Ô∏è V√©rification..."]}),e.jsxs("div",{children:["‚Ä¢ Emma Agent: ",systemLogs.filter(s=>s.text.includes("Emma")).length>0?"‚úÖ Op√©rationnel":"‚è∏Ô∏è En attente"]}),e.jsxs("div",{children:["‚Ä¢ Deep Analysis: ",stockData&&Object.keys(stockData).length>0?"‚úÖ Donn√©es disponibles":"‚ö†Ô∏è Pas de donn√©es"]})]})]}),e.jsxs("div",{className:`p-3 rounded ${isDarkMode?"bg-gray-800":"bg-white"}`,children:[e.jsxs("div",{className:"font-semibold mb-1 flex items-center gap-2",children:[e.jsx(Icon,{emoji:"üìä",size:16}),"M√©triques"]}),e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{children:["‚Ä¢ Analyses effectu√©es: ",systemLogs.filter(s=>s.type==="success").length]}),e.jsxs("div",{children:["‚Ä¢ Requ√™tes API: ",systemLogs.length]}),e.jsxs("div",{children:["‚Ä¢ Derni√®re analyse: ",systemLogs[0]?.timestamp||"N/A"]})]})]})]})]}),e.jsxs("div",{className:`rounded-lg p-4 border transition-colors duration-300 ${isDarkMode?"bg-gradient-to-br from-red-900/20 to-gray-900 border-red-700":"bg-gradient-to-br from-red-50 to-gray-50 border-red-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:`text-lg font-semibold flex items-center gap-2 ${isDarkMode?"text-red-300":"text-red-900"}`,children:[e.jsx(Icon,{emoji:"‚ö†Ô∏è",size:20}),"Violations"]}),e.jsxs("span",{className:`px-2 py-1 text-xs rounded ${systemLogs.filter(s=>s.type==="error").length>0?"bg-red-500 text-white":isDarkMode?"bg-green-900/50 text-green-300":"bg-green-200 text-green-900"}`,children:[systemLogs.filter(s=>s.type==="error").length," erreur(s)"]})]}),e.jsx("div",{className:`max-h-48 overflow-y-auto rounded p-3 font-mono text-xs ${isDarkMode?"bg-gray-800":"bg-white"}`,children:systemLogs.filter(s=>s.type==="error").length===0?e.jsx("div",{className:`text-center py-4 ${isDarkMode?"text-green-400":"text-green-600"}`,children:"‚úÖ Aucune violation d√©tect√©e - Syst√®me op√©rationnel"}):e.jsx("div",{className:"space-y-2",children:systemLogs.filter(s=>s.type==="error").map((s,b)=>e.jsx("div",{className:`p-2 rounded border ${isDarkMode?"bg-red-900/30 border-red-800 text-red-200":"bg-red-50 border-red-200 text-red-800"}`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-red-500",children:"‚ö†Ô∏è"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-semibold text-xs",children:["[",s.timestamp,"]"]}),e.jsx("div",{className:"mt-1",children:s.text})]})]})},b))})}),e.jsxs("div",{className:`mt-3 p-2 rounded text-xs ${isDarkMode?"bg-gray-800 text-gray-400":"bg-white text-gray-600"}`,children:["üí° ",e.jsx("strong",{children:"Info:"})," Les violations sont automatiquement track√©es. Consultez les logs syst√®me ci-dessus pour plus de d√©tails."]})]}),e.jsxs("div",{className:`rounded-lg p-4 border transition-colors duration-300 ${isDarkMode?"bg-gradient-to-br from-indigo-900/20 to-gray-900 border-indigo-700":"bg-gradient-to-br from-indigo-50 to-gray-50 border-indigo-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:`text-lg font-semibold flex items-center gap-2 ${isDarkMode?"text-indigo-300":"text-indigo-900"}`,children:[e.jsx(Icon,{emoji:"üé®",size:20}),"Mode d'Affichage des Ic√¥nes"]}),e.jsx("div",{className:`px-3 py-1 rounded text-xs font-medium ${isProfessionalMode?isDarkMode?"bg-blue-900/50 text-blue-300":"bg-blue-200 text-blue-900":isDarkMode?"bg-purple-900/50 text-purple-300":"bg-purple-200 text-purple-900"}`,children:isProfessionalMode?"üíº Professionnel":"üéâ Fun"})]}),e.jsxs("div",{className:`space-y-3 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:[e.jsxs("div",{className:`p-3 rounded ${isDarkMode?"bg-gray-800":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Icon,{emoji:isProfessionalMode?"üíº":"üéâ",size:18}),e.jsx("span",{className:"font-semibold",children:isProfessionalMode?"Mode Professionnel":"Mode Fun"})]}),e.jsx("button",{onClick:()=>{const s=window.ProfessionalModeSystem.toggle();setIsProfessionalMode(s)},className:`px-4 py-2 rounded-lg transition-all duration-300 border-2 font-semibold ${isProfessionalMode?"bg-gradient-to-br from-blue-600 to-blue-700 border-blue-400 text-white hover:from-blue-700 hover:to-blue-800":"bg-gradient-to-br from-purple-600 to-pink-600 border-purple-400 text-white hover:from-purple-700 hover:to-pink-700"}`,children:isProfessionalMode?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"iconoir-briefcase"}),"Mode Professionnel"]}):e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"üéâ"}),"Mode Fun"]})})]}),e.jsx("div",{className:`text-xs mt-2 ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:isProfessionalMode?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mb-1",children:"‚úÖ Ic√¥nes professionnelles Iconoir activ√©es"}),e.jsx("p",{children:"Les emojis sont remplac√©s par des ic√¥nes vectorielles modernes pour une apparence plus professionnelle."})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mb-1",children:"‚úÖ Mode Fun avec emojis activ√©"}),e.jsx("p",{children:"Les ic√¥nes sont affich√©es sous forme d'emojis color√©s pour une exp√©rience plus d√©contract√©e."})]})})]}),e.jsxs("div",{className:`p-2 rounded text-xs ${isDarkMode?"bg-gray-800/50 text-gray-400":"bg-gray-50 text-gray-600"}`,children:["üí° ",e.jsx("strong",{children:"Astuce:"})," Le mode s√©lectionn√© est sauvegard√© automatiquement et s'applique √† tous les onglets du dashboard."]})]})]}),e.jsxs("div",{className:`rounded-lg p-4 border transition-colors duration-300 ${isDarkMode?"bg-gradient-to-br from-emerald-900/20 to-gray-900 border-emerald-700":"bg-gradient-to-br from-emerald-50 to-gray-50 border-emerald-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:`text-lg font-semibold flex items-center gap-2 ${isDarkMode?"text-emerald-300":"text-emerald-900"}`,children:[e.jsx(Icon,{emoji:"ü§ñ",size:20}),"Configuration Emma IA"]}),e.jsx("div",{className:`px-3 py-1 rounded text-xs font-medium ${o?isDarkMode?"bg-green-900/50 text-green-300":"bg-green-200 text-green-900":isDarkMode?"bg-red-900/50 text-red-300":"bg-red-200 text-red-900"}`,children:o?"‚úÖ Gemini Actif":"‚ùå Gemini Inactif"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsx("button",{onClick:()=>_(!w),className:`px-4 py-2 rounded transition-colors ${isDarkMode?"bg-purple-800 hover:bg-purple-700 text-white":"bg-purple-600 hover:bg-purple-700 text-white"}`,children:"üìù Modifier Prompt"}),e.jsx("button",{onClick:()=>P(!M),className:`px-4 py-2 rounded transition-colors ${isDarkMode,"bg-gray-800 hover:bg-gray-700 text-white"}`,children:"üå°Ô∏è Temp√©rature"}),e.jsx("button",{onClick:()=>J(!L),className:`px-4 py-2 rounded transition-colors ${isDarkMode?"bg-green-800 hover:bg-green-700 text-white":"bg-green-600 hover:bg-green-700 text-white"}`,children:"üìè Longueur R√©ponse"})]}),e.jsxs("div",{className:`space-y-4 ${isDarkMode?"bg-gray-800/50":"bg-white"} p-4 rounded-lg border ${isDarkMode?"border-gray-700":"border-gray-200"}`,children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("label",{className:`text-sm font-semibold ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:["üå°Ô∏è Temp√©rature: ",e.jsx("span",{className:"font-bold text-blue-600",children:h.toFixed(1)})]}),e.jsx("span",{className:`text-xs ${isDarkMode?"text-gray-400":"text-gray-500"}`,children:h<=.3?"Pr√©cis":h<=.5?"√âquilibr√©":h<=.7?"Naturel":"Cr√©atif"})]}),e.jsx("input",{type:"range",min:"0.1",max:"1.0",step:"0.1",value:h,onChange:s=>{const b=parseFloat(s.target.value);r(b),localStorage.setItem("emma-temperature",b.toString())},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, #3b82f6 0%, #3b82f6 ${(h-.1)/.9*100}%, #e5e7eb ${(h-.1)/.9*100}%, #e5e7eb 100%)`}}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"0.1"}),e.jsx("span",{children:"0.5"}),e.jsx("span",{children:"1.0"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("label",{className:`text-sm font-semibold ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:["üìè Longueur: ",e.jsx("span",{className:"font-bold text-green-600",children:l})," tokens"]}),e.jsx("span",{className:`text-xs ${isDarkMode?"text-gray-400":"text-gray-500"}`,children:l<=2048?"Concis":l<=4096?"D√©taill√©":"Tr√®s d√©taill√©"})]}),e.jsx("input",{type:"range",min:"512",max:"8192",step:"512",value:l,onChange:s=>{const b=parseInt(s.target.value);g(b),localStorage.setItem("emma-max-tokens",b.toString())},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, #10b981 0%, #10b981 ${(l-512)/7680*100}%, #e5e7eb ${(l-512)/7680*100}%, #e5e7eb 100%)`}}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"512"}),e.jsx("span",{children:"4096"}),e.jsx("span",{children:"8192"})]})]})]}),e.jsxs("div",{className:`mt-3 p-2 rounded text-xs ${isDarkMode?"bg-gray-800 text-gray-400":"bg-white text-gray-600"}`,children:["üí° ",e.jsx("strong",{children:"Info:"})," Ces param√®tres affectent le comportement d'Emma IA dans l'onglet Ask Emma. Modifications appliqu√©es imm√©diatement et sauvegard√©es dans localStorage."]})]}),e.jsxs("div",{className:`rounded-lg p-4 border transition-colors duration-300 ${isDarkMode?"bg-gradient-to-br from-orange-900/20 to-gray-900 border-orange-700":"bg-gradient-to-br from-orange-50 to-gray-50 border-orange-200"}`,children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("h3",{className:`text-lg font-semibold flex items-center gap-2 ${isDarkMode?"text-orange-300":"text-orange-900"}`,children:[e.jsx(Icon,{emoji:"üîê",size:20}),"Configuration Scraping Seeking Alpha"]})}),e.jsxs("div",{className:`space-y-4 ${isDarkMode?"bg-gray-800/50":"bg-white"} p-4 rounded-lg border ${isDarkMode?"border-gray-700":"border-gray-200"}`,children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-semibold mb-2 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"üìß Email:"}),e.jsx("div",{className:`p-3 rounded-lg border ${isDarkMode?"bg-gray-700 border-gray-600 text-gray-200":"bg-gray-50 border-gray-300 text-gray-900"}`,children:"mvilla@videotron.ca"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-semibold mb-2 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"üîë Mot de passe:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`flex-1 p-3 rounded-lg border ${isDarkMode?"bg-gray-700 border-gray-600 text-gray-200":"bg-gray-50 border-gray-300 text-gray-900"}`,children:e.jsx("span",{id:"seeking-alpha-password-display",children:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"})}),e.jsx("button",{onClick:()=>{const s=document.getElementById("seeking-alpha-password-display");s&&(s.textContent==="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"?s.textContent="Mickey69":s.textContent="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢")},className:`px-4 py-3 rounded-lg border transition-colors ${isDarkMode?"bg-orange-700 hover:bg-orange-600 border-orange-600 text-white":"bg-orange-500 hover:bg-orange-600 border-orange-400 text-white"}`,children:"üëÅÔ∏è"})]})]}),e.jsxs("div",{className:`mt-4 p-3 rounded-lg border ${isDarkMode?"bg-blue-900/20 border-blue-700 text-blue-200":"bg-blue-50 border-blue-200 text-blue-800"}`,children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:"üìã Instructions d'utilisation:"}),e.jsxs("ol",{className:"text-xs space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:"Connectez-vous √† Seeking Alpha avec les identifiants ci-dessus"}),e.jsx("li",{children:'Utilisez la section "√âTAPE 1: SCRAPING BATCH" ci-dessous pour lancer le scraping'}),e.jsx("li",{children:"Pour chaque popup ouverte, appuyez sur F12, allez dans la Console, et collez le script g√©n√©r√©"}),e.jsx("li",{children:"Les donn√©es sont automatiquement sauvegard√©es dans Supabase"}),e.jsx("li",{children:'Utilisez "√âTAPE 2: ANALYSE BATCH PERPLEXITY" pour analyser les donn√©es scrap√©es'})]})]})]})]}),e.jsxs("div",{className:`backdrop-blur-sm rounded-lg p-6 border transition-colors duration-300 ${isDarkMode?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("h3",{className:`text-lg font-semibold mb-4 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:[e.jsx(Icon,{emoji:"üìä",size:20,className:"mr-2 inline-block"}),"Gestion des Stocks"]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:refreshAllStocks,disabled:loading,className:"px-4 py-2 bg-emerald-600 text-white rounded hover:bg-emerald-700 disabled:opacity-50 transition-colors",children:loading?"Actualisation...":"Actualiser Stocks"}),e.jsx("button",{onClick:fetchNews,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors",children:"Actualiser News"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:`backdrop-blur-sm rounded-xl p-6 border-2 transition-colors duration-300 ${isDarkMode?"bg-gradient-to-r from-gray-900/40 to-gray-800/40 border-gray-500/50":"bg-gradient-to-r from-gray-800/40 to-gray-700/40 border-gray-400/50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:`text-xl font-bold transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:[e.jsx(Icon,{emoji:"üìä",size:20,className:"mr-2 inline-block"}),"√âTAPE 1: SCRAPING BATCH (25 tickers)"]}),e.jsx("span",{className:`px-4 py-2 rounded-full text-sm font-bold ${scrapingStatus==="idle"?"bg-gray-500 text-white":scrapingStatus==="running"?"bg-gray-700 text-white animate-pulse":scrapingStatus==="completed"?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:scrapingStatus==="idle"?"‚è∏Ô∏è EN ATTENTE":scrapingStatus==="running"?"üîÑ SCRAPING...":scrapingStatus==="completed"?"‚úÖ TERMIN√â":"‚ùå ERREUR"})]}),scrapingStatus==="running"&&e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-4",children:e.jsxs("div",{className:"bg-gradient-to-r from-gray-700 to-gray-600 h-4 rounded-full transition-all duration-300 flex items-center justify-center text-white text-xs font-bold",style:{width:`${scrapingProgress}%`},children:[scrapingProgress,"%"]})})}),e.jsxs("div",{className:`mb-4 p-4 rounded-lg transition-colors duration-300 ${isDarkMode?"bg-black/30":"bg-white/60"}`,children:[e.jsx("p",{className:`text-sm mb-3 font-semibold transition-colors duration-300 ${isDarkMode?"text-yellow-300":"text-yellow-800"}`,children:"‚ö†Ô∏è IMPORTANT: Connectez-vous AVANT de lancer le scraping!"}),e.jsxs("ol",{className:`text-sm space-y-2 transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:[e.jsxs("li",{children:[e.jsx("strong",{children:"1."}),' Cliquez "üîê SE CONNECTER" ‚Üí Login Seeking Alpha']}),e.jsxs("li",{children:[e.jsx("strong",{children:"2."}),` Cliquez "üöÄ LANCER SCRAPING BATCH" ‚Üí Toutes les popups s'ouvrent`]}),e.jsxs("li",{children:[e.jsx("strong",{children:"3."})," Pour CHAQUE popup: F12 ‚Üí Console ‚Üí Collez script ‚Üí Entr√©e"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"4."})," Fermez la popup apr√®s copie"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"5."})," Les donn√©es sont auto-sauvegard√©es dans Supabase"]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{addScrapingLog("üîê Ouverture de la page de connexion Seeking Alpha...","info"),window.open("https://seekingalpha.com/account/login","_blank"),addScrapingLog("‚úÖ Connectez-vous, puis revenez ici","success")},className:"flex-1 px-6 py-4 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-lg hover:from-green-700 hover:to-emerald-700 transition-all font-bold text-lg shadow-lg",children:"üîê SE CONNECTER √Ä SEEKING ALPHA"}),e.jsx("button",{onClick:runSeekingAlphaScraper,disabled:scrapingStatus==="running",className:"flex-1 px-6 py-4 bg-gradient-to-r from-violet-600 to-purple-600 text-white rounded-lg hover:from-violet-700 hover:to-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all font-bold text-lg shadow-lg",children:scrapingStatus==="running"?"‚è≥ SCRAPING EN COURS...":"üöÄ LANCER SCRAPING BATCH"})]})]}),e.jsxs("div",{className:`backdrop-blur-sm rounded-xl p-6 border-2 transition-colors duration-300 ${isDarkMode?"bg-gradient-to-r from-pink-900/40 to-rose-900/40 border-pink-500/50":"bg-gradient-to-r from-pink-50 to-rose-50 border-pink-400/50"}`,children:[e.jsxs("h3",{className:`text-xl font-bold mb-4 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:[e.jsx(Icon,{emoji:"ü§ñ",size:20,className:"mr-2 inline-block"}),"√âTAPE 2: ANALYSE BATCH PERPLEXITY"]}),e.jsxs("div",{className:`mb-4 p-4 rounded-lg transition-colors duration-300 ${isDarkMode?"bg-black/30":"bg-white/60"}`,children:[e.jsx("p",{className:`text-sm mb-3 transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"üìä Cliquez pour analyser TOUTES les donn√©es scrap√©es en une seule fois:"}),e.jsxs("ul",{className:`text-sm space-y-2 transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:[e.jsx("li",{children:"‚úì R√©cup√®re tous les raw scrapes depuis Supabase"}),e.jsx("li",{children:"‚úì Analyse avec Perplexity AI en batch"}),e.jsx("li",{children:"‚úì Formate en JSON structur√©"}),e.jsx("li",{children:"‚úì Sauvegarde dans seeking_alpha_analysis"}),e.jsx("li",{children:"‚úì Affiche les r√©sultats dans le tableau ci-dessous"})]})]}),e.jsxs("button",{onClick:async()=>{addScrapingLog("ü§ñ D√©marrage analyse Perplexity BATCH...","info");try{addScrapingLog("üì• R√©cup√©ration des donn√©es depuis Supabase...","info");const b=await(await fetch("/api/seeking-alpha-scraping?type=raw&limit=100")).json();if(b.success&&b.data&&b.data.length>0){addScrapingLog(`‚úÖ ${b.data.length} raw scrapes trouv√©s`,"success");for(const A of b.data){const se=A.ticker;addScrapingLog(`üîÑ Analyse de ${se} avec Perplexity...`,"info"),await analyzeWithPerplexityAndUpdate(se,{fullText:A.raw_text,url:A.url,content:{}})}addScrapingLog("üéâ Analyse Perplexity termin√©e pour TOUS les tickers!","success"),addScrapingLog("üíæ R√©sultats sauvegard√©s dans Supabase","success")}else addScrapingLog("‚ö†Ô∏è Aucune donn√©e trouv√©e dans Supabase","warning"),addScrapingLog("üí° Effectuez d'abord le scraping (√âtape 1)","info")}catch(s){addScrapingLog(`‚ùå Erreur: ${s.message}`,"error")}},className:"w-full px-6 py-4 bg-gradient-to-r from-pink-600 to-rose-600 text-white rounded-lg hover:from-pink-700 hover:to-rose-700 transition-all font-bold text-lg shadow-lg",children:["ü§ñ ANALYSER TOUT AVEC PERPLEXITY (",tickers.length," tickers)"]})]}),e.jsxs("div",{className:`backdrop-blur-sm rounded-xl p-6 border-2 transition-colors duration-300 ${isDarkMode?"bg-gradient-to-r from-emerald-900/40 to-teal-900/40 border-emerald-500/50":"bg-gradient-to-r from-emerald-50 to-teal-50 border-emerald-400/50"}`,children:[e.jsxs("h3",{className:`text-xl font-bold mb-4 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:[e.jsx(Icon,{emoji:"üìä",size:20,className:"mr-2 inline-block"}),"√âTAPE 3: R√âSULTATS & AFFICHAGE"]}),e.jsx("div",{className:`mb-4 p-4 rounded-lg transition-colors duration-300 ${isDarkMode?"bg-black/30":"bg-white/60"}`,children:e.jsx("p",{className:`text-sm transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:'Toutes les analyses apparaissent dans le tableau ci-dessous. Cliquez sur "RAFRA√éCHIR" pour recharger les derni√®res donn√©es depuis Supabase.'})}),e.jsx("button",{onClick:async()=>{addScrapingLog("üîÑ Rafra√Æchissement des donn√©es depuis Supabase...","info"),await fetchSeekingAlphaData(),await fetchSeekingAlphaStockData(),addScrapingLog("‚úÖ Donn√©es rafra√Æchies!","success")},className:"w-full px-6 py-4 bg-gradient-to-r from-emerald-600 to-teal-600 text-white rounded-lg hover:from-emerald-700 hover:to-teal-700 transition-all font-bold text-lg shadow-lg",children:"üîÑ RAFRA√éCHIR LES DONN√âES DU TABLEAU"})]})]}),scrapingLogs.length>0&&e.jsxs("div",{className:`backdrop-blur-sm rounded-lg p-6 border transition-colors duration-300 ${isDarkMode?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:"üìã Logs de Scraping"}),e.jsx("div",{className:`max-h-64 overflow-y-auto space-y-2 ${isDarkMode?"bg-gray-800":"bg-white"} rounded-lg p-4`,children:scrapingLogs.map((s,b)=>e.jsxs("div",{className:`text-sm p-2 rounded ${s.type==="error"?"bg-red-100 text-red-800":s.type==="success"?"bg-green-100 text-green-800":s.type==="warning"?"bg-yellow-100 text-yellow-800":"bg-gray-700 text-gray-200"}`,children:[e.jsx("span",{className:"font-mono text-xs opacity-70",children:new Date(s.timestamp).toLocaleTimeString()}),e.jsx("span",{className:"ml-2",children:s.message})]},b))})]}),e.jsxs("div",{className:`backdrop-blur-sm rounded-lg p-6 border transition-colors duration-300 ${isDarkMode?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:`text-lg font-semibold transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:"üîó √âtat des Connexions & Diagnostic des APIs"}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:async()=>{await checkApiStatus(),await runHealthCheck()},disabled:healthCheckLoading,className:`px-4 py-2 rounded-lg font-medium transition-colors duration-300 ${healthCheckLoading?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-gray-800 text-white hover:bg-gray-700"}`,children:healthCheckLoading?"V√©rification...":"üîÑ V√©rifier Toutes"})})]}),healthStatus&&e.jsx("div",{className:`p-4 rounded-lg border-2 mb-4 ${healthStatus.overall_status==="healthy"?"bg-green-50 border-green-200":healthStatus.overall_status==="degraded"?"bg-yellow-50 border-yellow-200":"bg-red-50 border-red-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:`font-bold text-lg ${healthStatus.overall_status==="healthy"?"text-green-800":healthStatus.overall_status==="degraded"?"text-yellow-800":"text-red-800"}`,children:[healthStatus.overall_status==="healthy"?"üü¢":healthStatus.overall_status==="degraded"?"üü°":"üî¥","Status Global: ",healthStatus.overall_status.toUpperCase()]}),e.jsxs("p",{className:`text-sm ${healthStatus.overall_status==="healthy"?"text-green-600":healthStatus.overall_status==="degraded"?"text-yellow-600":"text-red-600"}`,children:[healthStatus.healthy_apis,"/",healthStatus.total_apis," APIs op√©rationnelles (",Math.round(healthStatus.healthy_apis/healthStatus.total_apis*100),"%)"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`text-sm font-medium ${healthStatus.overall_status==="healthy"?"text-green-600":healthStatus.overall_status==="degraded"?"text-yellow-600":"text-red-600"}`,children:[healthStatus.response_time_ms,"ms"]}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(healthStatus.timestamp).toLocaleTimeString("fr-FR")})]})]})}),Object.keys(apiStatus).length>0&&e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsx("h4",{className:`text-sm font-semibold mb-2 transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"Connexions d√©taill√©es:"}),Object.entries(apiStatus).map(([s,b])=>e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg transition-colors duration-300 ${isDarkMode?"bg-gray-800":"bg-gray-100"}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:`font-mono capitalize transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:s}),b.error&&e.jsx("div",{className:`text-xs mt-1 transition-colors duration-300 ${isDarkMode?"text-red-400":"text-red-600"}`,children:b.error}),b.source&&e.jsxs("div",{className:`text-xs mt-1 transition-colors duration-300 ${isDarkMode,"text-gray-500"}`,children:["Source: ",b.source]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-3 h-3 rounded-full ${b.status==="success"?"bg-green-500":b.status==="warning"?"bg-yellow-500":b.status==="error"?"bg-red-500":"bg-gray-500"}`}),e.jsxs("span",{className:`text-sm transition-colors duration-300 ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:[b.responseTime,"ms"]})]})]},s))]}),healthStatus&&healthStatus.recommendations&&healthStatus.recommendations.length>0&&e.jsxs("div",{className:`p-4 rounded-lg mt-4 ${isDarkMode?"bg-gray-800":"bg-gray-700"}`,children:[e.jsx("h4",{className:`font-semibold mb-3 ${isDarkMode?"text-white":"text-blue-900"}`,children:"üí° Recommandations"}),e.jsx("div",{className:"space-y-2",children:healthStatus.recommendations.map((s,b)=>e.jsx("div",{className:`p-3 rounded-lg ${s.priority==="critical"?"bg-red-100 border border-red-200":s.priority==="high"?"bg-green-100 border border-green-200":"bg-yellow-100 border border-yellow-200"}`,children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:`font-medium text-sm ${s.priority==="critical"?"text-red-800":s.priority==="high"?"text-green-800":"text-yellow-800"}`,children:[s.priority==="critical"?"üö®":s.priority==="high"?"‚ö†Ô∏è":"üí°",s.message]}),e.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:[e.jsx("strong",{children:"Action:"})," ",s.action]})]})})},b))})]}),Object.keys(apiStatus).length===0&&!healthStatus&&e.jsx("div",{className:`text-center py-8 ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:e.jsx("p",{children:'Cliquez sur "üîÑ V√©rifier Toutes" pour diagnostiquer les connexions'})})]}),e.jsxs("div",{className:`backdrop-blur-sm rounded-lg p-6 border transition-colors duration-300 ${isDarkMode?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("h3",{className:`text-lg font-semibold mb-4 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:[e.jsx(Icon,{emoji:"ü§ñ",size:20,className:"mr-2 inline-block"}),"Monitoring Emma AI"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:`p-4 rounded-lg border transition-colors duration-300 ${isDarkMode?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"text-purple-600 font-medium mb-2 flex items-center gap-2",children:[e.jsx(Icon,{emoji:"üß†",size:18}),"Emma Agent"]}),e.jsxs("div",{className:`text-sm transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:["Status: ",e.jsx("span",{className:"text-green-500",children:"‚úÖ Op√©rationnel"})]}),e.jsx("div",{className:`text-sm transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"Outils: 12 disponibles"})]}),e.jsxs("div",{className:`p-4 rounded-lg border transition-colors duration-300 ${isDarkMode?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:"text-blue-600 font-medium mb-2",children:"üìß Briefings"}),e.jsxs("div",{className:`text-sm transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:["Cron: ",e.jsx("span",{className:"text-green-500",children:"‚úÖ Actif"})]}),e.jsx("div",{className:`text-sm transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"Horaires: 7h20 ‚Ä¢ 11h50 ‚Ä¢ 16h20"})]}),e.jsxs("div",{className:`p-4 rounded-lg border transition-colors duration-300 ${isDarkMode?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:"text-emerald-600 font-medium mb-2",children:"üóÑÔ∏è Supabase"}),e.jsx("div",{className:`text-sm transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"Tables: 4 cr√©√©es"}),e.jsxs("div",{className:`text-sm transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:["Tickers: ",teamTickers.length," team + ",watchlistTickers.length," watchlist"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{fetch("/api/emma-agent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:"Test de connexion Emma Agent",context:{test:!0}})}).then(s=>s.json()).then(s=>{s.success?showMessage("‚úÖ Emma Agent op√©rationnel","success"):showMessage("‚ùå Emma Agent erreur: "+s.error,"error")}).catch(s=>{showMessage("‚ùå Erreur connexion Emma Agent","error")})},className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 transition-colors",children:"üß™ Tester Emma Agent"}),e.jsx("button",{onClick:()=>{fetch("/api/emma-briefing?type=morning").then(s=>s.json()).then(s=>{s.success?showMessage("‚úÖ Emma Briefing op√©rationnel","success"):showMessage("‚ùå Emma Briefing erreur: "+s.error,"error")}).catch(s=>{showMessage("‚ùå Erreur connexion Emma Briefing","error")})},className:"px-4 py-2 bg-gray-800 text-white rounded hover:bg-gray-700 transition-colors",children:"üìß Tester Briefing"})]})]})]}),e.jsxs("div",{className:`backdrop-blur-sm rounded-lg p-6 border transition-colors duration-300 ${isDarkMode?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:"üîß Gestion des Outils Emma"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:`p-4 rounded-lg border transition-colors duration-300 ${isDarkMode?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsxs("h4",{className:`font-medium mb-2 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:[e.jsx(Icon,{emoji:"üìä",size:18,className:"mr-2 inline-block"}),"Outils Financiers"]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("div",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"‚Ä¢ Polygon Stock Price"}),e.jsx("div",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"‚Ä¢ FMP Fundamentals"}),e.jsx("div",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"‚Ä¢ Finnhub News"}),e.jsx("div",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"‚Ä¢ Twelve Data Technical"}),e.jsx("div",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"‚Ä¢ Alpha Vantage Ratios"})]})]}),e.jsxs("div",{className:`p-4 rounded-lg border transition-colors duration-300 ${isDarkMode?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx("h4",{className:`font-medium mb-2 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:"üóÑÔ∏è Outils Supabase"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("div",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"‚Ä¢ Watchlist Manager"}),e.jsx("div",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"‚Ä¢ Team Tickers"}),e.jsx("div",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"‚Ä¢ Economic Calendar"}),e.jsx("div",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"‚Ä¢ Earnings Calendar"}),e.jsx("div",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"‚Ä¢ Analyst Recommendations"})]})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:()=>{fetch("/api/emma-agent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:"Afficher la configuration des outils",context:{action:"show_tools_config"}})}).then(s=>s.json()).then(s=>{s.success?(showMessage("‚úÖ Configuration des outils r√©cup√©r√©e","success"),console.log("Tools Config:",s.tools_config)):showMessage("‚ùå Erreur r√©cup√©ration config","error")}).catch(s=>{showMessage("‚ùå Erreur connexion","error")})},className:"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 transition-colors",children:"‚öôÔ∏è Voir Configuration"})})]})]}),e.jsxs("div",{className:`backdrop-blur-sm rounded-lg p-6 border transition-colors duration-300 ${isDarkMode?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("h3",{className:`text-lg font-semibold mb-4 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:[e.jsx(Icon,{emoji:"‚öôÔ∏è",size:20,className:"mr-2 inline-block"}),"Configuration"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"Token GitHub (pour les mises √† jour)"}),e.jsx("input",{type:"password",value:githubToken,onChange:s=>setGithubToken(s.target.value),placeholder:"Entrez votre token GitHub",className:`w-full px-3 py-2 rounded-lg border transition-colors duration-300 ${isDarkMode?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"}`})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{onClick:()=>setShowSettings(!showSettings),className:"px-4 py-2 bg-gray-800 text-white rounded hover:bg-gray-700 transition-colors",children:[showSettings?"Masquer":"Afficher"," les param√®tres"]})})]})]})]})},jt=()=>{const o=document.documentElement.classList.contains("dark"),I=()=>{sessionStorage.clear(),localStorage.clear(),window.location.href="/login.html"};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:`backdrop-blur-sm rounded-lg p-6 border transition-colors duration-300 ${o?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("h2",{className:`text-2xl font-bold mb-6 transition-colors duration-300 ${o?"text-white":"text-gray-900"}`,children:"‚öôÔ∏è Param√®tres & Actions"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:`p-4 rounded-lg border transition-colors duration-300 ${o?"bg-gray-800 border-gray-600":"bg-white border-gray-300"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-2 transition-colors duration-300 ${o?"text-white":"text-gray-900"}`,children:"Gestion de Session"}),e.jsx("p",{className:`text-sm mb-4 transition-colors duration-300 ${o?"text-gray-400":"text-gray-600"}`,children:"D√©connectez-vous pour revenir √† la page de connexion"}),e.jsxs("button",{onClick:I,className:"bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors duration-200 flex items-center space-x-2",children:[e.jsx("span",{children:"üö™"}),e.jsx("span",{children:"D√©connexion"})]})]}),e.jsxs("div",{className:`p-4 rounded-lg border transition-colors duration-300 ${o?"bg-gray-800 border-gray-600":"bg-white border-gray-300"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-2 transition-colors duration-300 ${o?"text-white":"text-gray-900"}`,children:"Fonctionnalit√©s √† venir"}),e.jsxs("ul",{className:`list-disc list-inside space-y-1 text-sm transition-colors duration-300 ${o?"text-gray-400":"text-gray-600"}`,children:[e.jsx("li",{children:"Gestion des pr√©f√©rences utilisateur"}),e.jsx("li",{children:"Configuration des notifications"}),e.jsx("li",{children:"Th√®me personnalis√©"}),e.jsx("li",{children:"Export/Import de configuration"})]})]})]})]})})},vt=()=>{const[o,I]=j.useState([]),[w,_]=j.useState(""),[M,P]=j.useState({}),[L,J]=j.useState(!1),[h,r]=j.useState(!1),[l,g]=j.useState(!1),[S,$]=j.useState([]),[k,O]=j.useState({minMarketCap:0,maxPE:50,minROE:0,sector:"all"}),F=async()=>{const d=o.map(x=>({symbol:x,name:x}));g(!0);try{const x=[];for(const n of d)try{const[p,T,ee]=await Promise.allSettled([fetch(`/api/marketdata?endpoint=quote&symbol=${n.symbol}&source=auto`),fetch(`/api/fmp?endpoint=profile&symbol=${n.symbol}`),fetch(`/api/fmp?endpoint=ratios&symbol=${n.symbol}`)]),te=p.status==="fulfilled"&&p.value.ok?await p.value.json():null,ne=T.status==="fulfilled"&&T.value.ok?await T.value.json():null,X=ee.status==="fulfilled"&&ee.value.ok?await ee.value.json():null,V={symbol:n.symbol,name:ne?.data?.[0]?.companyName||ne?.companyName||n.symbol,price:te?.c||0,change:te?.dp||0,marketCap:ne?.data?.[0]?.mktCap||ne?.mktCap||0,pe:X?.data?.[0]?.peRatioTTM||X?.peRatioTTM||null,roe:X?.data?.[0]?.returnOnEquityTTM||X?.returnOnEquityTTM||null,debtEquity:X?.data?.[0]?.debtEquityRatioTTM||X?.debtEquityRatioTTM||null,sector:ne?.data?.[0]?.sector||ne?.sector||"Unknown"};V.marketCap>=k.minMarketCap&&(!V.pe||V.pe<=k.maxPE)&&(!V.roe||V.roe*100>=k.minROE)&&(!V.debtEquity||V.debtEquity<=k.maxDebtEquity)&&(k.sector==="all"||V.sector===k.sector)&&x.push(V)}catch(p){console.error(`Erreur pour ${n.symbol}:`,p)}$(x),console.log(`‚úÖ Screener Watchlist: ${x.length} r√©sultats trouv√©s sur ${d.length} titres`)}catch(x){console.error("Erreur screener:",x)}finally{g(!1)}},q=(d,x)=>{if(x==null||x==="N/A")return"text-gray-400";const n=typeof x=="string"?parseFloat(x):x;if(isNaN(n))return"text-gray-400";switch(d){case"PE":return n<0?"text-red-500":n<15?"text-emerald-500":n<25?"text-blue-500":n<35?"text-yellow-500":"text-red-500";case"ROE":return n<0?"text-red-500":n<10?"text-green-500":n<15?"text-yellow-500":n<20?"text-blue-500":"text-emerald-500";case"DE":return n<.3?"text-emerald-500":n<.7?"text-blue-500":n<1.5?"text-yellow-500":n<2.5?"text-green-500":"text-red-500";default:return"text-gray-400"}},B=(d,x="",n="")=>{if(!d&&d!==0)return"N/A";const p=parseFloat(d);return isNaN(p)?"N/A":p>=1e12?`${x}${(p/1e12).toFixed(2)}T${n}`:p>=1e9?`${x}${(p/1e9).toFixed(2)}B${n}`:p>=1e6?`${x}${(p/1e6).toFixed(2)}M${n}`:p>=1e3?`${x}${(p/1e3).toFixed(2)}K${n}`:`${x}${p.toFixed(2)}${n}`},[ge,Y]=j.useState(!1);j.useEffect(()=>{if(ge)return;(async()=>{try{const n=await fetch("/api/supabase-watchlist");if(n.ok){const p=await n.json(),T=Array.isArray(p.tickers)?p.tickers:[];console.log("‚úÖ Watchlist charg√©e depuis Supabase:",T),I(T),localStorage.setItem("dans-watchlist",JSON.stringify(T)),R(T),Y(!0);return}}catch{console.log("‚ö†Ô∏è Supabase non disponible, utilisation du localStorage")}const x=localStorage.getItem("dans-watchlist");if(x){const n=JSON.parse(x);console.log("üì¶ Watchlist charg√©e depuis localStorage:",n),I(n),R(n)}Y(!0)})()},[]);const ce=async(d,x)=>{for(const n of d)try{const p=await fetchStockData(n);p&&!p.message&&(x[n]={...p,timestamp:new Date().toISOString()})}catch(p){console.error(`Erreur pour ${n}:`,p?.message||String(p))}},R=async(d,x=!1)=>{if(d.length===0)return;J(!0);const n={};try{if(d.length>1){console.log(`üöÄ Batch loading ${d.length} tickers...`);const p=d.join(","),T=await fetch(`${API_BASE_URL}/api/marketdata/batch?symbols=${p}&endpoints=quote,fundamentals`);if(T.ok){const ee=await T.json();if(console.log(`‚úÖ Batch loaded: ${ee.metadata?.total_data_points||"N/A"} data points`),console.log(`üí∞ API Calls Saved: ${ee.metadata?.api_calls_saved||"N/A"}`),ee.success&&ee.data){const te=ee.data.quote||{},ne=ee.data.fundamentals||{};d.forEach(X=>{const V=X.toUpperCase(),U=te[V],c=ne[V];(U||c)&&(n[X]={symbol:V,price:U?.c||c?.quote?.price||0,change:U?.d||c?.quote?.change||0,changePercent:U?.dp||c?.quote?.changesPercentage||0,profile:c?.profile||null,ratios:c?.ratios||null,source:U?.source||c?.source||"batch",timestamp:new Date().toISOString()})})}}else console.warn("‚ö†Ô∏è Batch endpoint failed, falling back to individual requests"),await ce(d,n)}else await ce(d,n)}catch(p){console.error("‚ùå Batch loading error:",p),await ce(d,n)}P(x?p=>({...p,...n}):n),J(!1)},s=async()=>{if(!w.trim())return;const d=w.trim().toUpperCase();if(o.includes(d)){showMessage("Ce ticker est d√©j√† dans la watchlist","warning");return}const x=[...o,d];I(x),localStorage.setItem("dans-watchlist",JSON.stringify(x)),_(""),console.log(`‚úÖ ${d} ajout√© √† la watchlist`),P(n=>({...n,[d]:{symbol:d,loading:!0,timestamp:new Date().toISOString()}})),R([d],!0).catch(n=>{console.error("Erreur chargement:",n)}),ae(d,"add").catch(n=>{console.error("Erreur sauvegarde Supabase:",n)})},b=async d=>{const x=o.filter(n=>n!==d);I(x),localStorage.setItem("dans-watchlist",JSON.stringify(x)),P(n=>{const p={...n};return delete p[d],p}),console.log(`‚úÖ ${d} supprim√© de la watchlist`),ae(d,"remove").catch(n=>{console.error("Erreur sauvegarde Supabase:",n)})},A=async()=>{await R(o),console.log("‚úÖ Watchlist actualis√©e silencieusement")};let se=null;const ae=async(d,x)=>{se&&clearTimeout(se),se=setTimeout(async()=>{try{const n=await fetch("/api/supabase-watchlist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:x,ticker:d})});if(!n.ok)throw new Error(`HTTP ${n.status}`);const p=await n.json();console.log(`‚úÖ Supabase: ${p.message}`)}catch(n){console.error("‚ö†Ô∏è Erreur sauvegarde Supabase:",n)}},500)};return j.useEffect(()=>{if(o.length>0){const d=document.getElementById("tradingview-ticker-dan-watchlist");d&&(d.innerHTML="");const x=o.map(T=>T.includes(".TO")||T.includes(".V")?{proName:`TSX:${T.replace(/\.(TO|V)/,"")}`,title:T}:{proName:`NASDAQ:${T}`,title:T}),n=document.createElement("script");n.type="text/javascript",n.src="https://s3.tradingview.com/external-embedding/embed-widget-ticker-tape.js",n.async=!0,n.innerHTML=JSON.stringify({symbols:x.slice(0,20),showSymbolLogo:!0,isTransparent:isDarkMode,displayMode:"adaptive",colorTheme:isDarkMode?"dark":"light",locale:"fr"});const p=document.getElementById("tradingview-ticker-dan-watchlist");p&&p.appendChild(n)}},[o,isDarkMode]),e.jsxs("div",{className:"space-y-6",children:[o.length>0&&e.jsx("div",{className:`rounded-lg overflow-hidden border transition-colors duration-300 ${isDarkMode?"border-gray-700 bg-gray-900":"border-gray-200 bg-white"}`,children:e.jsx("div",{className:"tradingview-widget-container",style:{height:"62px"},children:e.jsx("div",{id:"tradingview-ticker-dan-watchlist",style:{height:"100%"}})})}),h&&e.jsxs("div",{className:`border rounded-lg p-3 transition-colors duration-300 ${isDarkMode?"bg-gray-900 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:"üîç"}),e.jsx("h3",{className:`text-sm font-bold ${isDarkMode?"text-white":"text-gray-900"}`,children:"Screener - Dan's Watchlist"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",o.length," titres)"]})]}),e.jsx("button",{onClick:()=>r(!1),className:`p-1 rounded ${isDarkMode?"hover:bg-gray-800":"hover:bg-gray-100"}`,children:e.jsx("span",{className:"text-gray-500",children:"‚úï"})})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-2 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] text-gray-500 mb-1 block",children:"Market Cap Min (B$)"}),e.jsx("input",{type:"number",value:k.minMarketCap/1e9,onChange:d=>O({...k,minMarketCap:parseFloat(d.target.value||0)*1e9}),className:`w-full px-2 py-1 text-xs rounded border ${isDarkMode?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] text-gray-500 mb-1 block",children:"P/E Max"}),e.jsx("input",{type:"number",value:k.maxPE,onChange:d=>O({...k,maxPE:parseFloat(d.target.value||50)}),className:`w-full px-2 py-1 text-xs rounded border ${isDarkMode?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] text-gray-500 mb-1 block",children:"ROE Min (%)"}),e.jsx("input",{type:"number",value:k.minROE,onChange:d=>O({...k,minROE:parseFloat(d.target.value||0)}),className:`w-full px-2 py-1 text-xs rounded border ${isDarkMode?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] text-gray-500 mb-1 block",children:"D/E Max"}),e.jsx("input",{type:"number",step:"0.1",value:k.maxDebtEquity,onChange:d=>O({...k,maxDebtEquity:parseFloat(d.target.value||2)}),className:`w-full px-2 py-1 text-xs rounded border ${isDarkMode?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] text-gray-500 mb-1 block",children:"Secteur"}),e.jsxs("select",{value:k.sector,onChange:d=>O({...k,sector:d.target.value}),className:`w-full px-2 py-1 text-xs rounded border ${isDarkMode?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"all",children:"Tous"}),e.jsx("option",{value:"Technology",children:"Technologie"}),e.jsx("option",{value:"Consumer Cyclical",children:"Consommation"}),e.jsx("option",{value:"Healthcare",children:"Sant√©"}),e.jsx("option",{value:"Financial",children:"Finance"})]})]})]}),e.jsx("button",{onClick:F,disabled:l||o.length===0,className:`w-full py-2 rounded text-sm font-semibold transition-colors ${l?"bg-gray-400 cursor-not-allowed":"bg-gray-800 hover:bg-gray-700 text-white"}`,children:l?"‚è≥ Analyse en cours...":`üîç Analyser ma Watchlist (${o.length} titres)`}),S.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:[S.length," titre(s) correspondant aux crit√®res"]}),e.jsx("div",{className:`max-h-64 overflow-y-auto border rounded ${isDarkMode?"border-gray-700":"border-gray-300"}`,children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{className:`sticky top-0 ${isDarkMode?"bg-gray-800":"bg-gray-100"}`,children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 text-gray-500",children:"Symbole"}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"Prix"}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"Var %"}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"Cap."}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"P/E"}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"ROE"}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"D/E"})]})}),e.jsx("tbody",{children:S.map(d=>e.jsxs("tr",{className:`border-t ${isDarkMode?"border-gray-700 hover:bg-gray-800":"border-gray-200 hover:bg-gray-50"}`,children:[e.jsxs("td",{className:"p-2",children:[e.jsx("div",{className:`font-bold ${isDarkMode?"text-white":"text-gray-900"}`,children:d.symbol}),e.jsx("div",{className:"text-[9px] text-gray-500",children:d.name})]}),e.jsxs("td",{className:`text-right p-2 font-semibold ${isDarkMode?"text-white":"text-gray-900"}`,children:["$",d.price.toFixed(2)]}),e.jsx("td",{className:`text-right p-2 font-semibold ${d.change>=0?"text-emerald-500":"text-red-500"}`,children:(()=>{const x=d.change;if(!x)return"0.00%";const n=typeof x=="number"?x:typeof x=="object"?x.raw||x.fmt||0:parseFloat(x)||0;return(n>=0?"+":"")+n.toFixed(2)+"%"})()}),e.jsx("td",{className:"text-right p-2 text-gray-400",children:B(d.marketCap)}),e.jsx("td",{className:`text-right p-2 font-semibold ${q("PE",d.pe)}`,children:d.pe?d.pe.toFixed(1):"N/A"}),e.jsx("td",{className:`text-right p-2 font-semibold ${q("ROE",d.roe?d.roe*100:null)}`,children:d.roe?(d.roe*100).toFixed(1)+"%":"N/A"}),e.jsx("td",{className:`text-right p-2 font-semibold ${q("DE",d.debtEquity)}`,children:d.debtEquity?d.debtEquity.toFixed(2):"N/A"})]},d.symbol))})]})})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:`text-2xl font-bold transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:"üëÄ Dan's Watchlist"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>r(!h),className:`px-4 py-2 rounded transition-colors ${h?"bg-gray-800 text-white":isDarkMode?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-900"}`,children:h?"‚úï Fermer Screener":"üîç Ouvrir Screener"}),e.jsx("button",{onClick:A,disabled:L||o.length===0,className:"px-4 py-2 bg-gray-800 text-white rounded hover:bg-gray-700 disabled:opacity-50 transition-colors",children:L?"Actualisation...":"üîÑ Actualiser"}),e.jsxs("button",{onClick:emmaPopulateWatchlist,disabled:L,className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 disabled:opacity-50 flex items-center gap-2",children:[e.jsx("span",{children:"ü§ñ"}),"Emma Populate"]}),e.jsx("div",{className:`text-sm px-4 py-2 rounded ${isDarkMode?"bg-gray-800 text-gray-400":"bg-gray-100 text-gray-600"}`,children:initialLoadComplete?"üöÄ Supabase + Arri√®re-plan silencieux":"‚è≥ Chargement initial..."})]})]}),e.jsxs("div",{className:`backdrop-blur-sm rounded-lg p-6 border transition-colors duration-300 ${isDarkMode?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:"‚ûï Ajouter un Ticker"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:w,onChange:d=>_(d.target.value),placeholder:"Ex: AAPL, TSLA, GOOGL...",className:`flex-1 px-3 py-2 rounded-lg border transition-colors duration-300 ${isDarkMode?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"}`,onKeyPress:d=>d.key==="Enter"&&s()}),e.jsx("button",{onClick:s,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors",children:"‚ûï Ajouter"})]}),e.jsx("p",{className:`text-sm mt-2 transition-colors duration-300 ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:"üí° Ces tickers ne seront visibles que dans cette watchlist personnalis√©e"})]}),o.length>0?e.jsxs("div",{className:`backdrop-blur-sm rounded-lg p-6 border transition-colors duration-300 ${isDarkMode?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("h3",{className:`text-lg font-semibold mb-4 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:["üìä Tickers de la Watchlist (",o.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map(d=>{const x=M[d],n=x?.dp?(x.dp>=0?"+":"")+x.dp.toFixed(2)+"%":"N/A",p=x?.dp>=0?"text-green-400":"text-red-400",T=x?.dp>=0?"bg-green-500":"bg-red-500";return e.jsxs("div",{className:`rounded-lg p-4 border transition-colors duration-300 ${isDarkMode?"bg-gray-800 border-gray-600 hover:border-blue-400/50":"bg-white border-gray-300 hover:border-blue-300"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:getCompanyLogo(d),alt:`${d} logo`,className:"w-8 h-8 rounded",onError:ee=>{ee.target.style.display="none"}}),e.jsx("h4",{className:`font-bold text-lg transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:d})]}),e.jsx("button",{onClick:()=>b(d),className:`p-1 rounded transition-colors duration-300 ${isDarkMode?"text-gray-400 hover:text-red-400 hover:bg-red-900/20":"text-gray-500 hover:text-red-600 hover:bg-red-50"}`,title:"Supprimer de la watchlist",children:"‚úï"})]}),x?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`rounded-lg p-3 mb-3 transition-colors duration-300 ${isDarkMode?"bg-gray-700":"bg-gray-100"}`,children:[e.jsxs("div",{className:`text-2xl font-bold mb-1 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:["$",x.c?.toFixed(2)||"N/A"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 ${T} rounded`}),e.jsx("span",{className:`text-sm font-medium ${p}`,children:n})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:"Volume:"}),e.jsx("span",{className:`transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:x.v?.toLocaleString()||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:"High:"}),e.jsxs("span",{className:`transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:["$",x.h?.toFixed(2)||"N/A"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:"Low:"}),e.jsxs("span",{className:`transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:["$",x.l?.toFixed(2)||"N/A"]})]})]})]}):e.jsxs("div",{className:`text-center py-4 transition-colors duration-300 ${isDarkMode?"text-gray-400":"text-gray-500"}`,children:[e.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-gray-400 border-t-transparent rounded-full mx-auto mb-2"}),e.jsx("span",{className:"text-sm",children:"Chargement..."})]})]},d)})})]}):e.jsxs("div",{className:`backdrop-blur-sm rounded-lg p-8 border transition-colors duration-300 ${isDarkMode?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"} text-center`,children:[e.jsx("div",{className:"text-6xl mb-4",children:"üëÄ"}),e.jsx("h3",{className:`text-xl font-semibold mb-2 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:"Watchlist Vide"}),e.jsx("p",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:"Ajoutez des tickers pour commencer √† suivre vos investissements personnalis√©s"})]})]})},ot=()=>{const[o,I]=j.useState("list"),[w,_]=j.useState(null),M=r=>{const l=r==="bull";return e.jsx("span",{className:`w-9 h-9 rounded-full flex items-center justify-center text-xl font-semibold shadow-inner border ${l?isDarkMode?"bg-lime-900/70 border-lime-500/40 text-lime-300":"bg-lime-100 border-lime-400 text-lime-700":isDarkMode?"bg-rose-900/70 border-rose-500/40 text-rose-200":"bg-rose-100 border-rose-300 text-rose-700"}`,children:l?"üêÇ":"üêª"})},P=r=>{if(!r)return 50;const l=r.toLowerCase();return["bloomberg","reuters","wall street journal","wsj","financial times","ft"].some(k=>l.includes(k))?95:["cnbc","marketwatch","barron","seeking alpha","yahoo finance","morningstar","the economist"].some(k=>l.includes(k))?82:["forbes","benzinga","investor","zacks","motley fool","nasdaq","business insider"].some(k=>l.includes(k))?65:40},L=r=>r>=90?"premium":r>=75?"high":r>=50?"medium":"low",J=r=>!r&&r!==0?"N/A":r>=1e9?(r/1e9).toFixed(2)+"B":r>=1e6?(r/1e6).toFixed(2)+"M":r>=1e3?(r/1e3).toFixed(2)+"K":r.toLocaleString("fr-FR"),h={AAPL:"Apple Inc.",TSLA:"Tesla Inc.",GOOGL:"Alphabet Inc.",GOOG:"Alphabet Inc.",MSFT:"Microsoft Corporation",NVDA:"NVIDIA Corporation",AMZN:"Amazon.com Inc.",META:"Meta Platforms Inc.",NFLX:"Netflix Inc.",AMD:"Advanced Micro Devices Inc.",INTC:"Intel Corporation",CRM:"Salesforce Inc.",ORCL:"Oracle Corporation",CSCO:"Cisco Systems Inc.",ADBE:"Adobe Inc.",PYPL:"PayPal Holdings Inc.",DIS:"The Walt Disney Company",BA:"The Boeing Company",GE:"General Electric Company",JPM:"JPMorgan Chase & Co.",BAC:"Bank of America Corporation",WMT:"Walmart Inc.",HD:"The Home Depot Inc.",PG:"Procter & Gamble Company",JNJ:"Johnson & Johnson",V:"Visa Inc.",MA:"Mastercard Incorporated",UNH:"UnitedHealth Group Inc.",PFE:"Pfizer Inc.",MRK:"Merck & Co. Inc."};return e.jsxs("div",{className:"space-y-6",children:[tickers.length===0&&e.jsxs("div",{className:`p-6 rounded-xl border-2 transition-colors duration-300 ${isDarkMode?"bg-gray-800 border-yellow-500/30":"bg-yellow-50 border-yellow-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"text-2xl",children:"‚è≥"}),e.jsx("h3",{className:`text-lg font-semibold ${isDarkMode?"text-white":"text-gray-900"}`,children:"Chargement des donn√©es..."})]}),e.jsx("p",{className:`text-sm ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:"Les titres et nouvelles sont en cours de chargement. Veuillez patienter quelques instants."}),e.jsx("button",{onClick:async()=>{await loadTickersFromSupabase(),await fetchNews()},className:`mt-4 px-4 py-2 rounded-lg font-semibold transition-all duration-300 ${isDarkMode?"bg-blue-600 hover:bg-blue-700 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,children:"üîÑ Forcer le chargement"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:`text-2xl font-bold transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:"üìä Titres & nouvelles"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:`flex gap-1 p-1 rounded-lg transition-colors duration-300 ${isDarkMode?"bg-gray-800":"bg-gray-200"}`,children:[e.jsx("button",{onClick:()=>I("list"),className:`px-3 py-1 rounded text-sm font-medium transition-all duration-200 ${o==="list"?isDarkMode?"bg-blue-600 text-white":"bg-blue-500 text-white":isDarkMode?"text-gray-400 hover:text-white":"text-gray-600 hover:text-gray-900"}`,children:"üìã Liste"}),e.jsx("button",{onClick:()=>I("cards"),className:`px-3 py-1 rounded text-sm font-medium transition-all duration-200 ${o==="cards"?isDarkMode?"bg-blue-600 text-white":"bg-blue-500 text-white":isDarkMode?"text-gray-400 hover:text-white":"text-gray-600 hover:text-gray-900"}`,children:"üé¥ Cartes"}),e.jsx("button",{onClick:()=>I("table"),className:`px-3 py-1 rounded text-sm font-medium transition-all duration-200 ${o==="table"?isDarkMode?"bg-blue-600 text-white":"bg-blue-500 text-white":isDarkMode?"text-gray-400 hover:text-white":"text-gray-600 hover:text-gray-900"}`,children:"üìä Tableau"})]}),e.jsx("button",{onClick:async()=>{await refreshAllStocks(),await fetchNews(),await fetchLatestNewsForTickers()},disabled:loading,className:`px-4 py-2 rounded-lg font-semibold transition-all duration-300 disabled:opacity-50 ${isDarkMode?"bg-gray-800 hover:bg-gray-700 text-white":"bg-gray-700 hover:bg-gray-600 text-white"}`,children:loading?"‚è≥ Actualisation...":"üîÑ Actualiser"})]})]}),lastUpdate&&e.jsxs("p",{className:"text-gray-400 text-sm",children:["Derni√®re mise √† jour: ",new Date(lastUpdate).toLocaleString("fr-FR")]}),tickers.length>0&&e.jsxs("div",{className:`mt-6 p-6 rounded-xl transition-colors duration-300 ${isDarkMode?"bg-gradient-to-br from-gray-800 to-gray-900 border border-gray-700":"bg-gradient-to-br from-white to-gray-50 border border-gray-200"}`,children:[e.jsxs("h3",{className:`text-xl font-bold mb-4 flex items-center gap-2 ${isDarkMode?"text-white":"text-gray-900"}`,children:[e.jsx(LucideIcon,{name:"Fire",className:"w-6 h-6 text-orange-500"}),"Top Movers du Jour"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:`p-3 sm:p-4 rounded-lg ${isDarkMode?"bg-green-500/10 border border-green-500/30":"bg-green-50 border border-green-200"}`,children:[e.jsxs("h4",{className:`text-base sm:text-sm font-bold mb-3 sm:mb-3 flex items-center gap-3 ${isDarkMode?"text-green-400":"text-green-700"}`,children:[e.jsx(LucideIcon,{name:"TrendingUp",className:"w-5 h-5"}),M("bull"),"Top Gainers"]}),e.jsx("div",{className:"space-y-2.5 sm:space-y-2",children:tickers.map(r=>({ticker:r,change:stockData[r]?.dp||0,price:stockData[r]?.c||0})).filter(r=>r.change>0).sort((r,l)=>l.change-r.change).slice(0,5).map((r,l)=>e.jsx("div",{className:`flex items-start justify-between p-2 sm:p-2 rounded cursor-pointer transition-all hover:scale-[1.02] ${isDarkMode?"hover:bg-green-500/20":"hover:bg-green-100"}`,onClick:()=>{setSelectedStock(r.ticker),setActiveTab("intellistocks")},children:e.jsxs("div",{className:"flex-1 min-w-0 pr-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 ${isDarkMode?"bg-green-500/30 text-green-300":"bg-green-100 text-green-700"}`,children:l+1}),e.jsx("img",{src:getCompanyLogo(r.ticker),alt:r.ticker,className:"w-6 h-6 rounded flex-shrink-0",onError:g=>g.target.style.display="none"}),e.jsx("span",{className:`font-mono font-bold text-sm ${isDarkMode?"text-white":"text-gray-900"} flex-shrink-0`,children:r.ticker}),e.jsxs("div",{className:"text-green-500 font-bold text-sm ml-auto flex-shrink-0",children:["+",r.change.toFixed(2),"% ‚Üë"]}),e.jsxs("div",{className:`text-xs ${isDarkMode?"text-gray-400":"text-gray-600"} flex-shrink-0`,children:["$",r.price.toFixed(2)]})]}),e.jsx("div",{className:`mt-1 ml-8 min-h-[20px] ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:(()=>{const g=extractMoveReason(r.ticker,r.change);return g&&g!==""?e.jsx("div",{className:`text-xs flex items-start gap-2 leading-relaxed ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:tickerMoveReasons[r.ticker]?.source==="Finviz AI"?e.jsxs("span",{className:"inline-flex items-center gap-1.5 flex-wrap",children:[e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-semibold bg-blue-500/20 text-blue-300 border border-blue-500/30 flex-shrink-0",children:"AI"}),e.jsx("span",{className:"leading-relaxed break-words",children:g})]}):e.jsxs("span",{className:"inline-flex items-start gap-1.5",children:[e.jsx("span",{className:"text-blue-400 flex-shrink-0 text-sm",children:"üì∞"}),e.jsx("span",{className:"leading-relaxed break-words",children:g})]})}):e.jsx("div",{className:`text-xs italic ${isDarkMode?"text-gray-600":"text-gray-400"}`,children:"Chargement des explications..."})})()})]})},r.ticker))})]}),e.jsxs("div",{className:`p-4 rounded-lg ${isDarkMode?"bg-red-500/10 border border-red-500/30":"bg-red-50 border border-red-200"}`,children:[e.jsxs("h4",{className:`text-sm font-bold mb-3 flex items-center gap-3 ${isDarkMode?"text-red-400":"text-red-700"}`,children:[e.jsx(LucideIcon,{name:"TrendingDown",className:"w-5 h-5"}),M("bear"),"Top Losers"]}),e.jsx("div",{className:"space-y-2",children:tickers.map(r=>({ticker:r,change:stockData[r]?.dp||0,price:stockData[r]?.c||0})).filter(r=>r.change<0).sort((r,l)=>r.change-l.change).slice(0,5).map((r,l)=>e.jsx("div",{className:`flex items-start justify-between p-2 rounded cursor-pointer transition-all hover:scale-[1.02] ${isDarkMode?"hover:bg-red-500/20":"hover:bg-red-100"}`,onClick:()=>{setSelectedStock(r.ticker),setActiveTab("intellistocks")},children:e.jsxs("div",{className:"flex-1 min-w-0 pr-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 ${isDarkMode?"bg-red-500/30 text-red-300":"bg-red-100 text-red-700"}`,children:l+1}),e.jsx("img",{src:getCompanyLogo(r.ticker),alt:r.ticker,className:"w-6 h-6 rounded flex-shrink-0",onError:g=>g.target.style.display="none"}),e.jsx("span",{className:`font-mono font-bold text-sm ${isDarkMode?"text-white":"text-gray-900"} flex-shrink-0`,children:r.ticker}),e.jsxs("div",{className:"text-red-500 font-bold text-sm ml-auto flex-shrink-0",children:[r.change.toFixed(2),"% ‚Üì"]}),e.jsxs("div",{className:`text-xs ${isDarkMode?"text-gray-400":"text-gray-600"} flex-shrink-0`,children:["$",r.price.toFixed(2)]})]}),e.jsx("div",{className:`mt-1 ml-8 min-h-[20px] ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:(()=>{const g=extractMoveReason(r.ticker,r.change);return g&&g!==""?e.jsx("div",{className:`text-xs flex items-start gap-2 leading-relaxed ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:tickerMoveReasons[r.ticker]?.source==="Finviz AI"?e.jsxs("span",{className:"inline-flex items-center gap-1.5 flex-wrap",children:[e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-semibold bg-blue-500/20 text-blue-300 border border-blue-500/30 flex-shrink-0",children:"AI"}),e.jsx("span",{className:"leading-relaxed break-words",children:g})]}):e.jsxs("span",{className:"inline-flex items-start gap-1.5",children:[e.jsx("span",{className:"text-blue-400 flex-shrink-0 text-sm",children:"üì∞"}),e.jsx("span",{className:"leading-relaxed break-words",children:g})]})}):e.jsx("div",{className:`text-xs italic ${isDarkMode?"text-gray-600":"text-gray-400"}`,children:"Chargement des explications..."})})()})]})},r.ticker))})]})]})]}),tickers.length>0&&Object.keys(stockData).length>0&&e.jsxs("div",{className:`mt-6 p-6 rounded-xl transition-colors duration-300 ${isDarkMode?"bg-gradient-to-br from-gray-800 to-gray-900 border border-gray-700":"bg-gradient-to-br from-white to-gray-50 border border-gray-200"}`,children:[e.jsxs("h3",{className:`text-xl font-bold mb-4 flex items-center gap-2 ${isDarkMode?"text-white":"text-gray-900"}`,children:[e.jsx(LucideIcon,{name:"Target",className:"w-6 h-6 text-indigo-500"}),"Analyses & Opinions d'Analystes"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:tickers.map(r=>{const g=stockData[r]?.recommendation?.[0];if(!g)return null;const S=(g.buy||0)+(g.hold||0)+(g.sell||0)+(g.strongBuy||0)+(g.strongSell||0);if(S===0)return null;const $=(g.strongBuy||0)*2+(g.buy||0),k=(g.strongSell||0)*2+(g.sell||0),O=g.hold||0;let F="Hold",q="yellow";return $>k&&$>O?(F="Buy",q="green"):k>$&&k>O&&(F="Sell",q="red"),{ticker:r,totalAnalysts:S,consensus:F,consensusColor:q,buyScore:$,sellScore:k,holdScore:O,recommendation:g}}).filter(r=>r!==null).sort((r,l)=>l.totalAnalysts-r.totalAnalysts).slice(0,6).map(r=>e.jsxs("div",{className:`p-4 rounded-lg cursor-pointer transition-all hover:scale-[1.02] ${isDarkMode?"bg-gray-700/50 hover:bg-gray-700/70 border border-gray-600":"bg-white hover:bg-gray-50 border border-gray-200"}`,onClick:()=>{setSelectedStock(r.ticker),setActiveTab("intellistocks")},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:getCompanyLogo(r.ticker),alt:r.ticker,className:"w-8 h-8 rounded",onError:l=>l.target.style.display="none"}),e.jsx("span",{className:`font-mono font-bold text-lg ${isDarkMode?"text-white":"text-gray-900"}`,children:r.ticker})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-bold ${r.consensusColor==="green"?"bg-green-500/20 text-green-500 border border-green-500/30":r.consensusColor==="red"?"bg-red-500/20 text-red-500 border border-red-500/30":"bg-yellow-500/20 text-yellow-500 border border-yellow-500/30"}`,children:r.consensus==="Buy"?"ACHAT":r.consensus==="Sell"?"VENTE":"CONSERVER"})]}),e.jsxs("div",{className:`text-sm mb-2 ${isDarkMode?"text-gray-300":"text-gray-600"}`,children:[r.totalAnalysts," analyste",r.totalAnalysts>1?"s":""]}),e.jsxs("div",{className:"space-y-1.5",children:[r.recommendation.strongBuy>0&&e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:isDarkMode?"text-gray-400":"text-gray-600",children:"Strong Buy"}),e.jsx("span",{className:"font-bold text-green-500",children:r.recommendation.strongBuy})]}),r.recommendation.buy>0&&e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:isDarkMode?"text-gray-400":"text-gray-600",children:"Buy"}),e.jsx("span",{className:"font-bold text-green-400",children:r.recommendation.buy})]}),r.recommendation.hold>0&&e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:isDarkMode?"text-gray-400":"text-gray-600",children:"Hold"}),e.jsx("span",{className:"font-bold text-yellow-500",children:r.recommendation.hold})]}),r.recommendation.sell>0&&e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:isDarkMode?"text-gray-400":"text-gray-600",children:"Sell"}),e.jsx("span",{className:"font-bold text-red-400",children:r.recommendation.sell})]}),r.recommendation.strongSell>0&&e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:isDarkMode?"text-gray-400":"text-gray-600",children:"Strong Sell"}),e.jsx("span",{className:"font-bold text-red-500",children:r.recommendation.strongSell})]})]}),e.jsx("div",{className:`mt-3 pt-3 border-t ${isDarkMode?"border-gray-600":"border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(LucideIcon,{name:"ArrowUpRight",className:"w-3 h-3 text-gray-400"}),e.jsx("span",{className:`text-xs ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:"Cliquer pour analyse compl√®te"})]})})]},r.ticker))}),tickers.filter(r=>{const g=stockData[r]?.recommendation?.[0];return g&&(g.buy||0)+(g.hold||0)+(g.sell||0)+(g.strongBuy||0)+(g.strongSell||0)>0}).length===0&&e.jsxs("div",{className:`text-center py-8 ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:[e.jsx(LucideIcon,{name:"AlertCircle",className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Aucune recommandation d'analyste disponible pour le moment"}),e.jsx("p",{className:"text-sm mt-2",children:"Les donn√©es seront charg√©es lors de la prochaine actualisation"})]})]}),o==="list"&&e.jsx("div",{className:"mt-8",children:e.jsxs("div",{className:`backdrop-blur-sm rounded-2xl p-8 border-2 shadow-2xl transition-colors duration-300 ${isDarkMode?"bg-gradient-to-br from-gray-800/90 to-gray-900/90 border-blue-500/30 shadow-blue-500/10":"bg-gradient-to-br from-white/95 to-gray-50/95 border-blue-400/40 shadow-blue-400/10"}`,children:[e.jsx("h2",{className:`text-2xl font-bold mb-6 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:"üìä Titres - Vue Liste"}),tickers.length===0?e.jsxs("div",{className:`text-center py-12 ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:[e.jsx("p",{className:"text-lg font-semibold mb-2",children:"Aucun titre disponible"}),e.jsx("p",{className:"text-sm",children:"Les donn√©es sont en cours de chargement..."})]}):Object.keys(stockData).length===0?e.jsxs("div",{className:`text-center py-12 ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:[e.jsx("p",{className:"text-lg font-semibold mb-2",children:"Chargement des donn√©es de march√©..."}),e.jsx("p",{className:"text-sm",children:"Veuillez patienter quelques instants"})]}):e.jsx("div",{className:"space-y-3",children:tickers.map(r=>{const l=stockData[r]||{},g=l.c||l.price||0;l.d||l.change;const S=l.dp||l.changePercent||0,$=S>=0;return e.jsxs("div",{className:`flex items-center justify-between p-4 rounded-xl cursor-pointer transition-all hover:scale-[1.01] ${isDarkMode?"bg-gray-700/50 hover:bg-gray-700/70 border border-gray-600":"bg-white hover:bg-gray-50 border border-gray-200"}`,onClick:()=>{setSelectedStock(r),setActiveTab("intellistocks")},children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("img",{src:getCompanyLogo(r),alt:r,className:"w-12 h-12 rounded-lg",onError:k=>k.target.style.display="none"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`font-mono font-bold text-lg ${isDarkMode?"text-white":"text-gray-900"}`,children:r}),e.jsx("div",{className:`text-sm ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:h[r]||r}),e.jsx("div",{className:`mt-2 min-h-[20px] ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:extractMoveReason(r,S)?e.jsx("div",{className:`text-xs flex items-start gap-2 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:tickerMoveReasons[r]?.source==="Finviz AI"?e.jsxs("span",{className:"inline-flex items-center gap-1.5 flex-wrap",children:[e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-semibold bg-blue-500/20 text-blue-300 border border-blue-500/30 flex-shrink-0",children:"AI"}),e.jsx("span",{className:"leading-relaxed",children:extractMoveReason(r,S)})]}):e.jsxs("span",{className:"inline-flex items-start gap-1.5",children:[e.jsx("span",{className:"text-blue-400 flex-shrink-0",children:"üì∞"}),e.jsx("span",{className:"leading-relaxed",children:extractMoveReason(r,S)})]})}):tickerLatestNews[r]?e.jsxs("div",{className:`text-xs ${isDarkMode,"text-gray-500"}`,children:["üì∞ ",e.jsx("span",{className:"italic",children:tickerLatestNews[r].title.length>70?tickerLatestNews[r].title.substring(0,70)+"...":tickerLatestNews[r].title})]}):e.jsx("div",{className:`text-xs italic ${isDarkMode?"text-gray-600":"text-gray-400"}`,children:"Chargement des explications..."})})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`font-bold text-xl ${isDarkMode?"text-white":"text-gray-900"}`,children:["$",g.toFixed(2)]}),e.jsxs("div",{className:`font-semibold ${$?"text-green-500":"text-red-500"}`,children:[$?"+":"",S.toFixed(2),"%"]})]})]},r)})})]})}),o==="cards"&&e.jsx("div",{className:"mt-8",children:e.jsxs("div",{className:`backdrop-blur-sm rounded-2xl p-8 border-2 shadow-2xl transition-colors duration-300 ${isDarkMode?"bg-gradient-to-br from-gray-800/90 to-gray-900/90 border-blue-500/30 shadow-blue-500/10":"bg-gradient-to-br from-white/95 to-gray-50/95 border-blue-400/40 shadow-blue-400/10"}`,children:[e.jsx("h2",{className:`text-2xl font-bold mb-6 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:"üé¥ Titres - Vue Cartes"}),tickers.length===0?e.jsxs("div",{className:`text-center py-12 ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:[e.jsx("p",{className:"text-lg font-semibold mb-2",children:"Aucun titre disponible"}),e.jsx("p",{className:"text-sm",children:"Les donn√©es sont en cours de chargement..."})]}):Object.keys(stockData).length===0?e.jsxs("div",{className:`text-center py-12 ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:[e.jsx("p",{className:"text-lg font-semibold mb-2",children:"Chargement des donn√©es de march√©..."}),e.jsx("p",{className:"text-sm",children:"Veuillez patienter quelques instants"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:tickers.map(r=>{const l=stockData[r]||{},g=l.c||l.price||0,S=l.d||l.change||0,$=l.dp||l.changePercent||0,k=l.h||0,O=l.l||0,F=l.v||0,q=$>=0;return e.jsxs("div",{className:`p-6 rounded-xl cursor-pointer transition-all hover:scale-[1.02] ${isDarkMode?"bg-gradient-to-br from-gray-700/50 to-gray-800/50 hover:from-gray-700/70 hover:to-gray-800/70 border border-gray-600":"bg-gradient-to-br from-white to-gray-50 hover:from-gray-50 hover:to-gray-100 border border-gray-200 shadow-lg"}`,onClick:()=>{setSelectedStock(r),setActiveTab("intellistocks")},children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:getCompanyLogo(r),alt:r,className:"w-14 h-14 rounded-xl",onError:B=>B.target.style.display="none"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`font-mono font-bold text-xl ${isDarkMode?"text-white":"text-gray-900"}`,children:r}),e.jsx("div",{className:`text-xs ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:h[r]||r}),e.jsx("div",{className:`mt-2 min-h-[24px] ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:extractMoveReason(r,$)?e.jsx("div",{className:`text-xs flex items-start gap-2 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:tickerMoveReasons[r]?.source==="Finviz AI"?e.jsxs("span",{className:"inline-flex items-center gap-1.5 flex-wrap",children:[e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-semibold bg-blue-500/20 text-blue-300 border border-blue-500/30 flex-shrink-0",children:"AI"}),e.jsx("span",{className:"leading-relaxed",children:extractMoveReason(r,$)})]}):e.jsxs("span",{className:"inline-flex items-start gap-1.5",children:[e.jsx("span",{className:"text-blue-400 flex-shrink-0",children:"üì∞"}),e.jsx("span",{className:"leading-relaxed",children:extractMoveReason(r,$)})]})}):tickerLatestNews[r]?e.jsxs("div",{className:`text-xs ${isDarkMode,"text-gray-500"}`,children:["üì∞ ",e.jsx("span",{className:"italic",children:tickerLatestNews[r].title.length>60?tickerLatestNews[r].title.substring(0,60)+"...":tickerLatestNews[r].title})]}):e.jsx("div",{className:`text-xs italic ${isDarkMode?"text-gray-600":"text-gray-400"}`,children:"Chargement des explications..."})})]})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-bold ${q?"bg-green-500/20 text-green-500 border border-green-500/30":"bg-red-500/20 text-red-500 border border-red-500/30"}`,children:q?"‚ñ≤":"‚ñº"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:`text-3xl font-bold mb-1 ${isDarkMode?"text-white":"text-gray-900"}`,children:["$",g.toFixed(2)]}),e.jsxs("div",{className:`text-lg font-semibold ${q?"text-green-500":"text-red-500"}`,children:[q?"+":"",S.toFixed(2)," (",q?"+":"",$.toFixed(2),"%)"]})]}),e.jsxs("div",{className:`grid grid-cols-2 gap-2 pt-4 border-t ${isDarkMode?"border-gray-600":"border-gray-200"}`,children:[e.jsxs("div",{children:[e.jsx("div",{className:`text-xs ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:"Haut"}),e.jsxs("div",{className:`font-bold ${isDarkMode?"text-white":"text-gray-900"}`,children:["$",k.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("div",{className:`text-xs ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:"Bas"}),e.jsxs("div",{className:`font-bold ${isDarkMode?"text-white":"text-gray-900"}`,children:["$",O.toFixed(2)]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:`text-xs ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:"Volume"}),e.jsx("div",{className:`font-bold ${isDarkMode?"text-white":"text-gray-900"}`,children:J(F)})]})]})]},r)})})]})}),o==="table"&&e.jsx("div",{className:"mt-8",children:e.jsxs("div",{className:`backdrop-blur-sm rounded-2xl p-8 border-2 shadow-2xl transition-colors duration-300 ${isDarkMode?"bg-gradient-to-br from-gray-800/90 to-gray-900/90 border-blue-500/30 shadow-blue-500/10":"bg-gradient-to-br from-white/95 to-gray-50/95 border-blue-400/40 shadow-blue-400/10"}`,children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:`text-2xl font-bold mb-3 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:"üìä Donn√©es Financi√®res & Actualit√©s"}),e.jsxs("div",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-300 ${isDarkMode?"bg-gray-600/20 text-gray-300 border border-gray-500/30":"bg-gray-700/80 text-gray-200 border border-gray-600/50"}`,children:[e.jsx("span",{className:"mr-2",children:"üîó"}),"Source: Finnhub API"]}),e.jsx("p",{className:`text-sm mt-3 transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-600"}`,children:"Donn√©es en temps r√©el avec 3 actualit√©s par titre"})]}),e.jsx("div",{className:"overflow-x-auto max-h-[70vh] overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-200 dark:scrollbar-thumb-gray-600 dark:scrollbar-track-gray-800 relative text-sm",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:`border-b-2 transition-colors duration-300 ${isDarkMode?"border-blue-500/50 bg-gray-900":"border-blue-400/50 bg-gray-100"}`,children:[e.jsx("th",{className:`text-left py-2 px-3 font-bold transition-colors duration-300 ${isDarkMode?"text-blue-300":"text-blue-700"}`,children:"üìà Ticker"}),e.jsx("th",{className:`text-left py-2 px-3 font-bold transition-colors duration-300 ${isDarkMode?"text-blue-300":"text-blue-700"}`,children:"üí∞ Prix"}),e.jsx("th",{className:`text-left py-2 px-3 font-bold transition-colors duration-300 ${isDarkMode?"text-blue-300":"text-blue-700"}`,children:"üìä Change"}),e.jsx("th",{className:`text-left py-2 px-3 font-bold transition-colors duration-300 ${isDarkMode?"text-blue-300":"text-blue-700"}`,children:"üìà P/E"}),e.jsx("th",{className:`text-left py-2 px-3 font-bold transition-colors duration-300 ${isDarkMode?"text-blue-300":"text-blue-700"}`,children:"üíé Dividende"}),e.jsx("th",{className:`text-left py-2 px-3 font-bold transition-colors duration-300 ${isDarkMode?"text-blue-300":"text-blue-700"}`,children:"üè¢ Secteur"}),e.jsx("th",{className:`text-left py-2 px-3 font-bold transition-colors duration-300 ${isDarkMode?"text-blue-300":"text-blue-700"}`,children:"‚≠ê Rating"}),e.jsx("th",{className:`text-left py-2 px-3 font-bold transition-colors duration-300 ${isDarkMode?"text-blue-300":"text-blue-700"}`,children:"üòä Sentiment"}),e.jsx("th",{className:`text-left py-2 px-3 font-bold transition-colors duration-300 ${isDarkMode?"text-blue-300":"text-blue-700"}`,children:"‚ö° Actions"})]})}),e.jsx("tbody",{children:tickers.map(r=>{const l=stockData[r],g=l?.c?`$${l.c.toFixed(2)}`:"N/A",S=l?.d?`${l.d>0?"+":""}${l.d.toFixed(2)}`:"N/A",$=l?.dp?`${l.dp>0?"+":""}${l.dp.toFixed(2)}%`:"N/A",k=l?.d>0?"text-green-400":l?.d<0?"text-red-400":"text-gray-400",O=l?.profile,F=l?.fundamentals,q=F?.peRatio?Number.isFinite(F.peRatio)?F.peRatio.toFixed(2):F.peRatio:O?.pe?O.pe.toFixed(2):"N/A",B=F?.dividendYield?`${(Number(F.dividendYield)*100).toFixed(2)}%`:O?.dividend?`${(O.dividend*100).toFixed(2)}%`:"N/A",ge=F?.sector||O?.industry||"N/A",Y=l?.recommendation,ce=Y?.length>0?Y[0].buy+Y[0].strongBuy>Y[0].sell+Y[0].strongSell?"Achat":Y[0].sell+Y[0].strongSell>Y[0].buy+Y[0].strongBuy?"Vente":"Neutre":"N/A",R=sortNewsByCredibility(newsData.filter(A=>(A.title+" "+A.description).toLowerCase().includes(r.toLowerCase()))).slice(0,2),s=(A,se)=>{const ae=(A+" "+se).toLowerCase(),d=["hausse","croissance","gain","profit","positif","am√©lioration","succ√®s","fort","solide"],x=["baisse","chute","perte","n√©gatif","d√©clin","faible","probl√®me","risque","inqui√©tude"],n=d.filter(T=>ae.includes(T)).length,p=x.filter(T=>ae.includes(T)).length;return n>p?{sentiment:"Positif",color:"text-green-400"}:p>n?{sentiment:"N√©gatif",color:"text-red-400"}:{sentiment:"Neutre",color:"text-gray-400"}},b=R.length>0?s(R[0].title,R[0].description):{sentiment:"N/A"};return e.jsxs(Ke.Fragment,{children:[e.jsxs("tr",{className:`border-b-2 transition-all duration-300 hover:scale-[1.02] ${isDarkMode?"border-gray-600/50 hover:bg-gradient-to-r hover:from-gray-800/80 hover:to-gray-700/80 hover:shadow-lg hover:shadow-blue-500/10":"border-gray-300/50 hover:bg-gradient-to-r hover:from-gray-50/80 hover:to-white/80 hover:shadow-lg hover:shadow-blue-400/10"}`,children:[e.jsx("td",{className:"py-4 px-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:getCompanyLogo(r),alt:`${r} logo`,className:"w-8 h-8 rounded-lg shadow-md",onError:A=>{A.target.style.display="none"}}),e.jsx("span",{className:`font-mono font-bold text-xl transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:r})]})}),e.jsx("td",{className:`py-2 px-3 font-bold transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:g}),e.jsxs("td",{className:`py-2 px-3 font-semibold transition-colors duration-300 ${k}`,children:[S," (",$,")"]}),e.jsx("td",{className:`py-2 px-3 font-medium transition-colors duration-300 ${isDarkMode?"text-gray-200":"text-gray-700"}`,children:q}),e.jsx("td",{className:`py-2 px-3 font-medium transition-colors duration-300 ${isDarkMode?"text-green-300":"text-green-600"}`,children:B}),e.jsx("td",{className:`py-2 px-3 text-sm transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-600"}`,children:cleanText(ge)}),e.jsx("td",{className:"py-4 px-3",children:e.jsx("span",{className:`px-4 py-2 rounded-full text-sm font-bold transition-colors duration-300 ${ce==="Achat"?"bg-green-500 text-white":ce==="Vente"?"bg-red-500 text-white":"bg-yellow-500 text-black"}`,children:ce})}),e.jsx("td",{className:"py-4 px-3",children:e.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-full transition-colors duration-300 ${b.sentiment==="Positif"?"bg-green-100 text-green-800":b.sentiment==="N√©gatif"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:[e.jsx("span",{className:"text-lg",children:b.sentiment==="Positif"?"üòä":b.sentiment==="N√©gatif"?"üòü":"üòê"}),e.jsx("span",{className:"font-semibold",children:b.sentiment})]})}),e.jsx("td",{className:"py-4 px-3",children:e.jsx("button",{onClick:()=>{setSelectedStock(r),setActiveTab("intellistocks")},className:`px-4 py-2 text-xs font-semibold rounded-lg transition-all duration-300 hover:scale-[1.02] shadow ${isDarkMode?"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 text-white shadow-blue-500/25":"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-400 hover:to-blue-500 text-white shadow-blue-400/25"}`,children:"üìä Voir dans JLab"})})]}),finvizNews[r]&&e.jsx("tr",{className:`border-b-2 transition-all duration-300 ${isDarkMode?"border-purple-500/30 bg-gradient-to-r from-purple-900/20 to-indigo-900/20 hover:from-purple-900/30 hover:to-indigo-900/30":"border-purple-400/30 bg-gradient-to-r from-purple-50/60 to-indigo-50/60 hover:from-purple-100/80 hover:to-indigo-100/80"}`,children:e.jsx("td",{colSpan:"9",className:"py-4 px-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-full ${isDarkMode?"bg-purple-500/20":"bg-purple-100"}`,children:e.jsx(LucideIcon,{name:"Sparkles",className:"w-5 h-5 text-purple-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`text-xs font-bold px-2 py-0.5 rounded ${isDarkMode?"bg-purple-500/30 text-purple-300":"bg-purple-200 text-purple-700"}`,children:"üî• CE QUI BOUGE"}),e.jsx("span",{className:`text-xs ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:finvizNews[r].date})]}),e.jsx("p",{className:`text-sm font-medium leading-relaxed ${isDarkMode?"text-gray-200":"text-gray-800"}`,children:finvizNews[r].headline}),finvizNews[r].link&&e.jsxs("a",{href:finvizNews[r].link,target:"_blank",rel:"noopener noreferrer",onClick:A=>A.stopPropagation(),className:`text-xs mt-2 inline-flex items-center gap-1 hover:underline ${isDarkMode?"text-purple-400":"text-purple-600"}`,children:[e.jsx(LucideIcon,{name:"ExternalLink",className:"w-3 h-3"}),"Lire l'article complet"]})]})]})})}),R.map((A,se)=>e.jsx("tr",{className:`border-b-2 transition-all duration-300 hover:scale-[1.01] ${isDarkMode?"border-gray-600/30 bg-gradient-to-r from-gray-800/40 to-gray-700/40 hover:from-gray-700/60 hover:to-gray-600/60":"border-gray-300/30 bg-gradient-to-r from-gray-50/60 to-white/60 hover:from-gray-100/80 hover:to-gray-50/80"}`,children:e.jsx("td",{colSpan:"9",className:"py-6 px-4",children:e.jsx("div",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-200":"text-gray-700"}`,children:e.jsxs("div",{className:"flex items-start gap-4",children:[(()=>{const ae=getNewsIcon(A.title,A.description,A.sentiment);return e.jsx("div",{className:`p-3 rounded-full transition-colors duration-300 ${isDarkMode?"bg-gray-600/20":"bg-gray-200/60"}`,children:e.jsx(LucideIcon,{name:ae.icon,className:`w-6 h-6 ${ae.color}`})})})(),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:`font-bold text-lg mb-3 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:A.url?e.jsx("a",{href:A.url,target:"_blank",rel:"noopener noreferrer",className:`hover:underline transition-colors duration-300 ${isDarkMode?"text-blue-300 hover:text-blue-200":"text-blue-600 hover:text-blue-700"}`,children:cleanText(A.title)}):cleanText(A.title)}),e.jsx("p",{className:`text-base mb-4 leading-relaxed transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-600"}`,children:cleanText(A.description)}),e.jsxs("div",{className:`flex items-center gap-4 text-sm transition-colors duration-300 ${isDarkMode?"text-gray-400":"text-gray-500"}`,children:[e.jsx("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full transition-colors duration-300 ${isDarkMode?"bg-gray-800":"bg-gray-200"}`,children:e.jsx("span",{className:"font-semibold",children:A.source?.name||"Source inconnue"})}),e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full transition-colors duration-300 ${isDarkMode?"bg-gray-800":"bg-gray-200"}`,children:[e.jsx("span",{children:"üïí"}),e.jsx("span",{children:A.publishedAt?new Date(A.publishedAt).toLocaleString("fr-FR"):"Date inconnue"})]}),A.url&&e.jsx("a",{href:A.url,target:"_blank",rel:"noopener noreferrer",className:`px-4 py-2 rounded-full font-semibold transition-all duration-300 hover:scale-105 ${isDarkMode?"bg-gray-800 hover:bg-gray-700 text-white shadow-lg shadow-gray-500/25":"bg-gray-700 hover:bg-gray-600 text-white shadow-lg shadow-gray-400/25"}`,children:"üìñ Lire l'article"})]})]})]})})})},`${r}-news-${se}`))]},r)})})]})}),e.jsxs("div",{className:`text-center mt-8 p-6 rounded-xl transition-colors duration-300 ${isDarkMode?"bg-gradient-to-r from-blue-900/30 to-purple-900/30 border border-blue-500/20":"bg-gradient-to-r from-blue-100/80 to-purple-100/80 border border-blue-300/30"}`,children:[e.jsx("div",{className:`text-lg font-semibold mb-2 transition-colors duration-300 ${isDarkMode?"text-blue-300":"text-blue-700"}`,children:"üìú Section Principale - Donn√©es Financi√®res"}),e.jsx("div",{className:`text-sm transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-600"}`,children:"Faites d√©filer pour voir toutes les donn√©es ‚Ä¢ Source: Finnhub API ‚Ä¢ 3 actualit√©s par titre"}),e.jsx("div",{className:`text-xs mt-2 transition-colors duration-300 ${isDarkMode?"text-gray-400":"text-gray-500"}`,children:"Donn√©es mises √† jour automatiquement toutes les 5 minutes"})]})]})}),tickers.length===0&&e.jsx("div",{className:"bg-yellow-900/20 backdrop-blur-sm rounded-lg p-6 border border-yellow-300/20",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-yellow-400 text-2xl",children:"‚ö†Ô∏è"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-yellow-200 font-semibold",children:"Aucun ticker configur√©"}),e.jsx("p",{className:"text-yellow-300/80 text-sm mt-1",children:"Ajoutez des tickers dans l'onglet Seeking Alpha pour voir les donn√©es ici."})]})]})}),newsData.length>0&&e.jsx("div",{className:"mt-12",children:e.jsxs("div",{className:`backdrop-blur-sm rounded-2xl p-8 border-2 shadow-2xl transition-colors duration-300 ${isDarkMode?"bg-gradient-to-br from-gray-800/90 to-gray-900/90 border-purple-500/30 shadow-purple-500/10":"bg-gradient-to-br from-white/95 to-gray-50/95 border-purple-400/40 shadow-purple-400/10"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:`text-2xl font-bold transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:"üì∞ Actualit√©s du March√©"}),e.jsxs("div",{className:`px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-300 ${isDarkMode?"bg-purple-500/20 text-purple-300 border border-purple-500/30":"bg-purple-100 text-purple-700 border border-purple-300"}`,children:[newsData.length," articles"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:newsData.slice(0,12).map((r,l)=>{const g=P(r.source?.name||""),S=L(g);return e.jsxs("div",{role:"button",tabIndex:0,onClick:()=>{r.url&&window.open(r.url,"_blank","noopener,noreferrer")},onKeyDown:$=>{($.key==="Enter"||$.key===" ")&&r.url&&($.preventDefault(),window.open(r.url,"_blank","noopener,noreferrer"))},className:`p-6 rounded-xl cursor-pointer transition-all hover:scale-[1.02] focus:outline-none focus:ring-2 focus:ring-emerald-500 ${isDarkMode?"bg-gradient-to-br from-gray-700/50 to-gray-800/50 hover:from-gray-700/70 hover:to-gray-800/70 border border-gray-600":"bg-gradient-to-br from-white to-gray-50 hover:from-gray-50 hover:to-gray-100 border border-gray-200 shadow-lg"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-bold ${S==="premium"?"bg-yellow-500/20 text-yellow-500 border border-yellow-500/30":S==="high"?"bg-green-500/20 text-green-500 border border-green-500/30":S==="medium"?"bg-blue-500/20 text-blue-500 border border-blue-500/30":S==="low"?"bg-gray-500/20 text-gray-500 border border-gray-500/30":"bg-red-500/20 text-red-500 border border-red-500/30"}`,children:r.source?.name||"Source inconnue"}),e.jsx("div",{className:`text-xs ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:new Date(r.publishedAt).toLocaleDateString("fr-FR",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),e.jsx("h3",{className:`font-bold text-lg mb-3 line-clamp-2 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:r.title}),r.description&&e.jsx("p",{className:`text-sm mb-4 line-clamp-3 transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-600"}`,children:r.description}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs("a",{href:r.url,target:"_blank",rel:"noopener noreferrer",onClick:$=>$.stopPropagation(),className:`flex-1 px-3 py-2 rounded-lg text-center text-sm font-semibold transition-all ${isDarkMode?"bg-blue-600 hover:bg-blue-500 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,children:[e.jsx(IconoirIcon,{name:"ExternalLink",className:"w-4 h-4 inline mr-1"}),"Lire"]}),e.jsxs("button",{onClick:$=>{$.stopPropagation(),summarizeWithEmma(r.url,r.title)},className:`flex-1 px-3 py-2 rounded-lg text-center text-sm font-semibold transition-all ${isDarkMode?"bg-purple-600 hover:bg-purple-500 text-white":"bg-purple-500 hover:bg-purple-600 text-white"}`,children:[e.jsx(IconoirIcon,{name:"Brain",className:"w-4 h-4 inline mr-1"}),"Emma"]})]})]},l)})}),newsData.length>12&&e.jsx("div",{className:"text-center mt-6",children:e.jsxs("button",{onClick:()=>setActiveTab("markets-economy"),className:`px-6 py-3 rounded-lg font-semibold transition-all ${isDarkMode?"bg-purple-600 hover:bg-purple-500 text-white":"bg-purple-500 hover:bg-purple-600 text-white"}`,children:["Voir toutes les actualit√©s (",newsData.length,") ‚Üí"]})})]})})]})},Nt=()=>{const[o,I]=j.useState(new Date),[w,_]=j.useState("AAPL"),[M,P]=j.useState("1D"),[L,J]=j.useState(!1),[h,r]=j.useState(null),[l,g]=j.useState(!0),[S,$]=j.useState(!1),[k,O]=j.useState(null),[F,q]=j.useState(!1),[B,ge]=j.useState([]),[Y,ce]=j.useState(!1),[R,s]=j.useState(()=>{const t=localStorage.getItem("jslaiConfig");return t?JSON.parse(t):{valuation:20,profitability:20,growth:15,financialHealth:20,momentum:10,moat:10,sectorPosition:5}});j.useEffect(()=>{localStorage.setItem("jslaiConfig",JSON.stringify(R))},[R]);const b=t=>{const i={AAPL:183.45,TSLA:251.23,GOOGL:143.12,MSFT:384.89,NVDA:485.32,AMZN:178.91}[t]||180,a={AAPL:"Apple Inc.",TSLA:"Tesla Inc.",GOOGL:"Alphabet Inc.",MSFT:"Microsoft Corp.",NVDA:"NVIDIA Corp.",AMZN:"Amazon.com Inc."};return{quote:{symbol:t,name:a[t]||"Company Inc.",price:i,change:parseFloat((Math.random()*6-2).toFixed(2)),changesPercentage:parseFloat((Math.random()*4-1).toFixed(2)),volume:Math.floor(Math.random()*5e7+3e7),marketCap:Math.floor(Math.random()*2e12+1e12),avgVolume:Math.floor(Math.random()*6e7+4e7)},intraday:Array.from({length:20},(v,f)=>({date:`${9+Math.floor(f/4)}:${f%4*15}`,open:i+(Math.random()*4-2),high:i+(Math.random()*5-1),low:i+(Math.random()*3-3),close:i+(Math.random()*4-2),volume:Math.floor(Math.random()*5e6+2e6)})),metrics:{peRatioTTM:parseFloat((Math.random()*40+15).toFixed(1)),pegRatioTTM:parseFloat((Math.random()*2+.5).toFixed(2)),priceToSalesRatioTTM:parseFloat((Math.random()*8+2).toFixed(2)),dividendYieldTTM:parseFloat((Math.random()*.03).toFixed(4))},ratios:{debtEquityRatio:parseFloat((Math.random()*2+.3).toFixed(2)),returnOnEquityTTM:parseFloat((Math.random()*.4+.1).toFixed(3)),returnOnAssetsTTM:parseFloat((Math.random()*.2+.05).toFixed(3)),netProfitMarginTTM:parseFloat((Math.random()*.3+.1).toFixed(3))},profile:{companyName:a[t]||"Company Inc.",price:i,beta:parseFloat((Math.random()*.6+.8).toFixed(2)),sector:"Technology",industry:"Consumer Electronics"},news:[{title:`${t} annonce r√©sultats trimestriels record`,publishedDate:new Date(Date.now()-2*36e5).toISOString(),site:"Reuters"},{title:"Nouveau partenariat strat√©gique annonc√©",publishedDate:new Date(Date.now()-5*36e5).toISOString(),site:"Bloomberg"},{title:"Analystes rel√®vent objectif de prix",publishedDate:new Date(Date.now()-8*36e5).toISOString(),site:"CNBC"}],sentiment:{overall:Math.floor(Math.random()*30+60),news:Math.floor(Math.random()*30+65),social:Math.floor(Math.random()*30+60),institutional:Math.floor(Math.random()*30+55),retail:Math.floor(Math.random()*30+70),summary:"Sentiment globalement positif avec optimisme mod√©r√©"},insights:{catalysts:["R√©sultats trimestriels sup√©rieurs aux attentes","Innovation produit majeure annonc√©e","Expansion internationale r√©ussie"],risks:["Concurrence accrue dans le secteur","Incertitudes macro√©conomiques","Volatilit√© des march√©s"],consensus:"bullish",reasoning:"Les fondamentaux solides et la croissance continue justifient un sentiment positif"}}},A=async(t,i="1D")=>{try{console.log(`üîç R√©cup√©ration des donn√©es r√©elles pour ${t}...`);let a,v;switch(i){case"1D":a="15min",v=20;break;case"1W":a="1hour",v=24;break;case"1M":a="1day",v=30;break;case"3M":a="1day",v=90;break;case"6M":a="1day",v=180;break;case"1A":a="1day",v=365;break;case"5A":a="1week",v=260;break;case"MAX":a="1month",v=120;break;case"YTD":a="1day";const G=new Date,ue=new Date(G.getFullYear(),0,1),pe=Math.ceil((G-ue)/(1e3*60*60*24));v=Math.min(pe,365);break;default:a="1day",v=30}const[f,De,Ee,je,be,oe,Be]=await Promise.allSettled([fetchHybridData(t,"quote"),fetchHybridData(t,"profile"),fetchHybridData(t,"ratios"),fetchHybridData(t,"news"),fetchHybridData(t,"prices"),fetchHybridData(t,"analyst"),fetchHybridData(t,"earnings")]),W=f.status==="fulfilled"&&f.value.success?f.value.data:null,H=De.status==="fulfilled"&&De.value.success?De.value.data:null,D=Ee.status==="fulfilled"&&Ee.value.success?Ee.value.data:null,Ge=je.status==="fulfilled"&&je.value.success?je.value.data:null,me=be.status==="fulfilled"&&be.value.success?be.value.data:null,ve=oe.status==="fulfilled"&&oe.value.success?oe.value.data:null,Ne=Be.status==="fulfilled"&&Be.value.success?Be.value.data:null,We={quote:f.status==="fulfilled"?f.value.fallback||!1:!0,profile:De.status==="fulfilled"?De.value.fallback||!1:!0,ratios:Ee.status==="fulfilled"?Ee.value.fallback||!1:!0,news:je.status==="fulfilled"?je.value.fallback||!1:!0,intraday:be.status==="fulfilled"?be.value.fallback||!1:!0,analyst:oe.status==="fulfilled"?oe.value.fallback||!1:!0,earnings:Be.status==="fulfilled"?Be.value.fallback||!1:!0};console.log("‚úÖ Donn√©es r√©cup√©r√©es:",{hasQuote:!!W,hasProfile:!!H,hasRatios:!!D,hasNews:!!Ge,hasIntraday:!!me,hasAnalyst:!!ve,hasEarnings:!!Ne,fallbackIndicators:We});const Je=Object.keys(We).length,rt=Object.values(We).filter(Boolean).length,et=Je-rt,_e=Math.round(et/Je*100);console.log(`üìä Qualit√© des donn√©es: ${_e}% (${et}/${Je} sections en production)`);const Re=[];W||Re.push("Quote manquant"),H||Re.push("Profile manquant"),D||Re.push("Ratios manquant"),Ge||Re.push("News manquant"),Re.length>0&&console.warn("‚ö†Ô∏è Donn√©es manquantes:",Re),console.log("‚úÖ Donn√©es hybrides r√©cup√©r√©es:",{hasQuote:!!W,hasProfile:!!H,hasRatios:!!D,hasNews:!!Ge,hasIntraday:!!me,hasAnalyst:!!ve,hasEarnings:!!Ne,quoteSource:W?.source||"unknown",profileSource:H?.source||"unknown",ratiosSource:D?.source||"unknown",quoteConfidence:W?.metadata?.confidence||0,profileConfidence:H?.metadata?.confidence||0,ratiosConfidence:D?.metadata?.confidence||0,quoteFreshness:W?.metadata?.freshness||"unknown",profileFreshness:H?.metadata?.freshness||"unknown",ratiosFreshness:D?.metadata?.freshness||"unknown"});const $e=(()=>{let G=0,ue={};const pe=D?.data?.[0]?.peRatioTTM||D?.peRatioTTM||null;let z=50;pe&&(pe<10?z=100:pe<15?z=85:pe<20?z=70:pe<25?z=55:pe<30?z=40:z=25),ue.valuation=z,G+=z*R.valuation/100;const Q=D?.data?.[0]?.returnOnEquityTTM||D?.returnOnEquityTTM||null;let K=50;if(Q){const ie=Q*100;ie>25?K=100:ie>20?K=85:ie>15?K=70:ie>10?K=55:ie>5?K=40:K=25}ue.profitability=K,G+=K*R.profitability/100;const re=D?.data?.[0]?.grossProfitMarginTTM||D?.grossProfitMarginTTM||null,le=D?.data?.[0]?.netProfitMarginTTM||D?.netProfitMarginTTM||null;let Z=60;if(re&&le){const ie=(re+le)/2;ie>.3?Z=100:ie>.2?Z=85:ie>.15?Z=70:ie>.1?Z=55:ie>.05?Z=40:Z=25}ue.growth=Z,G+=Z*R.growth/100;const E=D?.data?.[0]?.debtEquityRatioTTM||D?.debtEquityRatioTTM||null,N=D?.data?.[0]?.currentRatio||D?.currentRatio||null;let Ie=50,Ae=50;E!==null&&(E<.3?Ae=100:E<.5?Ae=85:E<1?Ae=70:E<1.5?Ae=55:E<2?Ae=40:Ae=25);let ke=50;N!==null&&(N>3?ke=100:N>2?ke=85:N>1.5?ke=70:N>1?ke=55:N>.5?ke=40:ke=25),Ie=Math.round(Ae*.6+ke*.4),ue.financialHealth=Ie,G+=Ie*R.financialHealth/100;const we=W?.dp||0;let he=50;we>10?he=100:we>5?he=85:we>2?he=70:we>0?he=60:we>-2?he=45:we>-5?he=30:he=15,ue.momentum=he,G+=he*R.momentum/100;const Xe=D?.data?.[0]?.operatingProfitMarginTTM||D?.operatingProfitMarginTTM||null;let Me=60;if(re&&Xe){const ie=(re+Xe)/2;ie>.4?Me=100:ie>.3?Me=85:ie>.2?Me=70:ie>.15?Me=60:ie>.1?Me=45:Me=30}ue.moat=Me,G+=Me*R.moat/100;const ye=H?.data?.[0]?.beta||H?.beta||null;let xe=60;ye!==null&&(ye<.5?xe=100:ye<.8?xe=85:ye<1?xe=75:ye<1.2?xe=60:ye<1.5?xe=45:xe=30),ue.sectorPosition=xe,G+=xe*R.sectorPosition/100;const de=Math.round(G);return{total:de,breakdown:ue,interpretation:de>=85?"Excellent":de>=75?"Tr√®s Bon":de>=65?"Bon":de>=50?"Moyen":de>=35?"Faible":"Mauvais",recommendation:de>=75?"Achat Fort":de>=65?"Achat":de>=50?"Conserver":de>=35?"Surveiller":"√âviter"}})();console.log("ü§ñ Calcul du sentiment et insights √† partir des donn√©es r√©elles...");const Pe=W?.dp||0,Ye=(D?.data?.[0]?.returnOnEquityTTM||D?.returnOnEquityTTM||0)*100,Se=D?.data?.[0]?.peRatioTTM||D?.peRatioTTM||0;let ze=50;Ye>20?ze+=20:Ye>15&&(ze+=10),Se>0&&Se<15?ze+=15:Se>0&&Se<25&&(ze+=5);let Fe=60;Pe>5?Fe=85:Pe>2?Fe=75:Pe>0?Fe=65:Pe>-2?Fe=55:Pe>-5?Fe=45:Fe=30;const Ve=Math.round(ze*.6+Fe*.4),Le=[];Ye>20&&Le.push(`ROE excellent √† ${Ye.toFixed(1)}%`),Pe>2&&Le.push(`Forte dynamique haussi√®re (+${Pe.toFixed(2)}%)`),Se>0&&Se<15&&Le.push(`Valorisation attractive (P/E: ${Se.toFixed(1)})`),Le.length===0&&Le.push("Fondamentaux stables");const Oe=[],st=D?.data?.[0]?.debtEquityRatioTTM||D?.debtEquityRatioTTM||0;st>2&&Oe.push(`Endettement √©lev√© (D/E: ${st.toFixed(2)})`),Pe<-5&&Oe.push("Momentum baissier significatif"),Se>40&&Oe.push(`Valorisation √©lev√©e (P/E: ${Se.toFixed(1)})`),Oe.length===0&&Oe.push("Volatilit√© de march√© normale");let qe="neutral";Ve>=70?qe="bullish":Ve<=45&&(qe="bearish");let He="HOLD",Ce=Ve;$e.total>=75?(He="STRONG_BUY",Ce=Math.min(90,Ce+10)):$e.total>=65?(He="BUY",Ce=Math.min(85,Ce+5)):$e.total<=35?(He="SELL",Ce=Math.min(85,Ce)):$e.total<=25&&(He="STRONG_SELL",Ce=Math.min(90,Ce));const fe={sentiment:{overall:Ve,news:Fe,summary:`Sentiment ${qe==="bullish"?"positif":qe==="bearish"?"n√©gatif":"neutre"} bas√© sur les fondamentaux et le momentum`},insights:{catalysts:Le,risks:Oe,consensus:qe,reasoning:`Score JSLAI‚Ñ¢ de ${$e.total}/100 (${$e.interpretation}). ${$e.recommendation}.`},analyst:{recommendation:He,confidence:Ce,keyPoints:[`Score JSLAI‚Ñ¢: ${$e.total}/100`,`Sentiment: ${Ve}/100`,`Tendance: ${qe}`]}};return console.log("‚úÖ Sentiment et insights calcul√©s √† partir des donn√©es r√©elles (sans Perplexity)"),{jslaiScore:$e,quote:{symbol:t,name:H?.data?.[0]?.companyName||H?.companyName||`${t} Inc.`,price:W?.c||0,change:W?.d||0,changesPercentage:W?.dp||0,volume:W?.volume||0,marketCap:H?.data?.[0]?.mktCap||H?.mktCap||0,avgVolume:W?.avgVolume||0},intraday:(()=>{if(me&&Array.isArray(me)&&me.length>0)return console.log(`üìä Donn√©es historiques r√©elles r√©cup√©r√©es: ${me.length} points`),me.map((z,Q)=>({date:z.date||new Date(z.timestamp||Date.now()-Q*6e4).toLocaleString("fr-FR"),open:z.open||0,high:z.high||0,low:z.low||0,close:z.close||0,volume:z.volume||0}));if(me?.historical&&Array.isArray(me.historical)&&me.historical.length>0){console.log(`üìä Donn√©es FMP historiques r√©cup√©r√©es: ${me.historical.length} points`);let z=me.historical;if(i==="YTD"){const Q=new Date().getFullYear();z=me.historical.filter(K=>new Date(K.date).getFullYear()===Q),console.log(`üìä Donn√©es YTD filtr√©es: ${z.length} points`)}return z.map((Q,K)=>({date:Q.date||new Date(Q.timestamp||Date.now()-K*6e4).toLocaleString("fr-FR"),open:Q.open||0,high:Q.high||0,low:Q.low||0,close:Q.close||0,volume:Q.volume||0}))}const G=W?.c||0,ue=W?.d||0,pe=W?.dp||0;if(G>0){const z=[],Q=G-ue,K=i;let re,le,Z;switch(K){case"1D":re=20,le=3,Z=E=>{const N=new Date;return N.setHours(9,E*le,0,0),N.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})};break;case"1W":re=7,le=1,Z=E=>{const N=new Date;return N.setDate(N.getDate()-(6-E)),N.toLocaleDateString("fr-FR",{weekday:"short"})};break;case"1M":re=30,le=1,Z=E=>{const N=new Date;return N.setDate(N.getDate()-(29-E)),N.toLocaleDateString("fr-FR",{day:"2-digit"})};break;case"3M":re=12,le=7,Z=E=>{const N=new Date;return N.setDate(N.getDate()-(11-E)*7),N.toLocaleDateString("fr-FR",{month:"short"})};break;case"6M":re=24,le=7,Z=E=>{const N=new Date;return N.setDate(N.getDate()-(23-E)*7),N.toLocaleDateString("fr-FR",{month:"short"})};break;case"1A":re=12,le=30,Z=E=>{const N=new Date;return N.setMonth(N.getMonth()-(11-E)),N.toLocaleDateString("fr-FR",{month:"short"})};break;case"5A":re=20,le=90,Z=E=>{const N=new Date;return N.setMonth(N.getMonth()-(19-E)*3),N.toLocaleDateString("fr-FR",{year:"2-digit",month:"short"})};break;case"MAX":re=30,le=120,Z=E=>{const N=new Date;return N.setMonth(N.getMonth()-(29-E)*4),N.toLocaleDateString("fr-FR",{year:"2-digit",month:"short"})};break;case"YTD":re=12,le=30,Z=E=>{const N=new Date;return N.setMonth(E),N.toLocaleDateString("fr-FR",{month:"short"})};break;default:re=20,le=3,Z=E=>{const N=new Date;return N.setHours(9,E*le,0,0),N.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})}}for(let E=0;E<re;E++){const N=E/(re-1);let Ie;if(K==="YTD"){const ye=Q*(1-pe/100*.8),xe=E/(re-1);Ie=ye+xe*(G-ye)}else if(K==="5A"||K==="MAX"){const ye=K==="5A"?5:10,xe=1-pe/100*(ye*.2),de=G*xe;Ie=de+N*(G-de)}else{const ye=pe>0?1:-1,xe=Math.random()*.02-.01,de=N*ue+xe*Q;Ie=Math.max(.01,Q+de)}const Ae=Math.random()*.015-.0075,ke=Ie*(1+Ae),we=E===0?K==="YTD"?Q*.9:Q:z[E-1]?.close||ke,he=Math.max(.01,ke),Xe=Math.max(we,he)*(1+Math.random()*.01),Me=Math.min(we,he)*(1-Math.random()*.01);z.push({date:Z(E),open:we,high:Xe,low:Me,close:he,volume:Math.floor(Math.random()*2e6)+5e5})}return console.log(`üìä Donn√©es ${K} g√©n√©r√©es pour ${t}: ${z.length} points`),z}return[]})(),metrics:{peRatioTTM:D?.valuation?.peRatio||null,pegRatioTTM:D?.valuation?.pegRatio||null,priceToSalesRatioTTM:D?.valuation?.psRatio||null,dividendYieldTTM:D?.debt?.dividendYield||null},ratios:{debtEquityRatio:D?.debt?.debtEquityRatio||null,returnOnEquityTTM:D?.profitability?.returnOnEquity||null,returnOnAssetsTTM:D?.profitability?.returnOnAssets||null,netProfitMarginTTM:D?.profitability?.netProfitMargin||null,currentRatio:D?.liquidity?.currentRatio||null,quickRatio:D?.liquidity?.quickRatio||null,grossProfitMargin:D?.profitability?.grossProfitMargin||null,operatingProfitMargin:D?.profitability?.operatingIncomeMargin||null},profile:{companyName:H?.data?.[0]?.companyName||H?.companyName||`${t} Inc.`,price:W?.c||0,beta:H?.data?.[0]?.beta||H?.beta||null,sector:H?.data?.[0]?.sector||H?.sector||"Unknown",industry:H?.data?.[0]?.industry||H?.industry||"Unknown"},news:Ge?.news?.slice(0,5)?.map(G=>({title:G.title,source:G.source?.name||"Marketaux",time:G.publishedAt,url:G.url||"#",sentiment:G.sentiment||"neutral"}))||[],sentiment:{overall:fe?.sentiment?.overall||60,news:fe?.sentiment?.news||65,social:60,institutional:55,retail:70,summary:fe?.sentiment?.summary||"Analyse en cours"},analystRecommendations:ve?{consensus:ve.consensus?.rating||"N/A",targetPrice:ve.consensus?.targetPrice||null,upside:ve.consensus?.upside||null,analystCount:ve.consensus?.analystCount||0,breakdown:ve.breakdown||{},confidence:ve.validation?.confidence||0,sources:ve.validation?.sources||[]}:null,earningsCalendar:Ne?{nextEarningsDate:Ne.consensus?.nextEarningsDate||null,estimatedEPS:Ne.consensus?.estimatedEPS||null,estimatedRevenue:Ne.consensus?.estimatedRevenue||null,upcoming:Ne.upcoming||[],historical:Ne.historical?.slice(0,4)||[],statistics:Ne.statistics||null,confidence:Ne.validation?.confidence||0}:null,dataValidation:{quote:{confidence:W?.metadata?.confidence||0,status:W?.metadata?.freshness||"unknown",source:W?.source||"unknown",lastUpdated:W?.metadata?.lastUpdated||null},profile:{confidence:H?.metadata?.confidence||0,status:H?.metadata?.freshness||"unknown",source:H?.source||"unknown",lastUpdated:H?.metadata?.lastUpdated||null},ratios:{confidence:D?.metadata?.confidence||0,quality:D?.metadata?.dataQuality||"Unknown",source:D?.source||"unknown",lastUpdated:D?.metadata?.lastUpdated||null}},insights:{catalysts:fe?.insights?.catalysts||["Analyse en cours des catalyseurs de march√©","Surveillance des annonces d'entreprise","Suivi des tendances du secteur"],risks:fe?.insights?.risks||["Volatilit√© du march√©","Conditions macro√©conomiques","Concurrence sectorielle"],consensus:fe?.insights?.consensus||"neutral",reasoning:fe?.insights?.reasoning||"Analyse bas√©e sur les donn√©es de march√© actuelles"},aiAnalyst:fe?.analyst?{recommendation:fe.analyst.recommendation,confidence:fe.analyst.confidence,keyPoints:fe.analyst.keyPoints}:null,fallbackIndicators:We,dataQuality:{total_sections:Je,fallback_sections:rt,production_sections:et,quality_percentage:_e,status:_e>=80?"EXCELLENT":_e>=60?"GOOD":_e>=40?"FAIR":"POOR"}}}catch(a){return console.error(`Error fetching real data for ${t}:`,a),null}};j.useEffect(()=>{(async()=>{try{g(!0),console.log(`üìä Chargement des donn√©es pour ${w}...`);const i=await A(w,M);if(i&&i.quote&&i.quote.price>0)r(i),$(!0),O(new Date),console.log("‚úÖ Donn√©es charg√©es avec succ√®s"),(!i.intraday||i.intraday.length===0)&&ge(a=>a.find(v=>v.code==="intraday_missing")?a:[...a,{code:"intraday_missing",severity:"low",message:"Donn√©es intraday non disponibles - utilisation des donn√©es quote uniquement."}]);else throw new Error("Donn√©es invalides re√ßues de l'API")}catch(i){console.error("‚ùå Erreur lors du chargement:",i?.message||String(i)),$(!1);const a=b(w);r(a),ge(v=>v.find(f=>f.code==="data_fetch_error")?v:[...v,{code:"data_fetch_error",severity:"high",message:"√âchec de r√©cup√©ration API. V√©rifiez votre connexion et les cl√©s API."}]),q(!0)}finally{g(!1)}})()},[w]),j.useEffect(()=>{const t=document.getElementById("tradingview-mini-chart-jlab");if(t){t.innerHTML="";const i=document.createElement("script");i.type="text/javascript",i.src="https://s3.tradingview.com/external-embedding/embed-widget-mini-symbol-overview.js",i.async=!0,i.innerHTML=JSON.stringify({symbol:`NASDAQ:${w}`,width:"100%",height:"100%",locale:"fr",dateRange:"1D",colorTheme:isDarkMode?"dark":"light",isTransparent:!1,autosize:!0,largeChartUrl:""}),t.appendChild(i),console.log(`üìä TradingView Mini Chart recharg√© pour ${w}`)}},[w,isDarkMode]),j.useEffect(()=>{const t=[];try{const i=typeof window.Recharts<"u"||typeof Recharts<"u"||typeof window<"u"&&window.Recharts,a=typeof Chart<"u"||typeof window<"u"&&window.Chart;!i&&!a?t.push({code:"charts_missing",severity:"high",message:"Aucune biblioth√®que de graphiques disponible ‚Äî graphiques d√©sactiv√©s."}):!i&&a&&t.push({code:"recharts_missing",severity:"medium",message:"Recharts non disponible ‚Äî utilisation de Chart.js comme alternative."})}catch{t.push({code:"charts_missing",severity:"high",message:"Erreur de d√©tection des biblioth√®ques de graphiques."})}try{typeof window.LucideIcon<"u"&&typeof window.LucideIcon=="function"||t.push({code:"icons_missing",severity:"low",message:"Composant d'ic√¥nes personnalis√© non disponible (fallback activ√©)."})}catch{t.push({code:"icons_missing",severity:"low",message:"Composant d'ic√¥nes personnalis√© non disponible (fallback activ√©)."})}ge(t),t.length>0&&q(!0)},[]);const se=[{symbol:"AAPL",name:"Apple Inc."},{symbol:"TSLA",name:"Tesla Inc."},{symbol:"GOOGL",name:"Alphabet Inc."},{symbol:"MSFT",name:"Microsoft Corp."},{symbol:"NVDA",name:"NVIDIA Corp."},{symbol:"AMZN",name:"Amazon.com Inc."},{symbol:"META",name:"Meta Platforms Inc."},{symbol:"NFLX",name:"Netflix Inc."},{symbol:"AMD",name:"Advanced Micro Devices"},{symbol:"INTC",name:"Intel Corporation"}],ae=(t,i)=>{if(i==null||i==="N/A")return"text-gray-400";const a=typeof i=="string"?parseFloat(i):i;if(isNaN(a))return"text-gray-400";switch(t){case"PE":return a<0?"text-red-500":a<15?"text-emerald-500":a<25?"text-blue-500":a<35?"text-yellow-500":"text-red-500";case"PEG":return a<0?"text-red-500":a<1?"text-emerald-500":a<1.5?"text-blue-500":a<2?"text-yellow-500":"text-green-500";case"PS":return a<1?"text-emerald-500":a<3?"text-blue-500":a<5?"text-yellow-500":"text-green-500";case"ROE":return a<0?"text-red-500":a<10?"text-green-500":a<15?"text-yellow-500":a<20?"text-blue-500":"text-emerald-500";case"ROA":return a<0?"text-red-500":a<5?"text-green-500":a<10?"text-blue-500":a<15?"text-emerald-500":"text-emerald-400";case"DE":return a<.3?"text-emerald-500":a<.7?"text-blue-500":a<1.5?"text-yellow-500":a<2.5?"text-green-500":"text-red-500";case"Margin":return a<0?"text-red-500":a<5?"text-green-500":a<10?"text-yellow-500":a<20?"text-blue-500":"text-emerald-500";case"Beta":return a<0?"text-purple-500":a<.8?"text-emerald-500":a<1?"text-blue-500":a<1.3?"text-yellow-500":a<1.7?"text-green-500":"text-red-500";case"Div":return a<1?"text-gray-400":a<2?"text-blue-400":a<4?"text-blue-500":a<6?"text-emerald-500":a<8?"text-yellow-500":"text-green-500";case"CurrentRatio":return a<1?"text-red-500":a<1.5?"text-green-500":a<2.5?"text-emerald-500":a<3.5?"text-blue-500":"text-yellow-500";case"QuickRatio":return a<.5?"text-red-500":a<1?"text-green-500":a<1.5?"text-blue-500":"text-emerald-500";case"EPS":return a<0?"text-red-500":a<1?"text-green-500":a<3?"text-blue-500":"text-emerald-500";default:return"text-gray-400"}},d=async t=>{setLoadingScreener(!0);try{const i=[];for(const a of t)try{const[v,f,De]=await Promise.allSettled([fetch(`/api/marketdata?endpoint=quote&symbol=${a.symbol}&source=auto`),fetch(`/api/fmp?endpoint=profile&symbol=${a.symbol}`),fetch(`/api/fmp?endpoint=ratios&symbol=${a.symbol}`)]),Ee=v.status==="fulfilled"&&v.value.ok?await v.value.json():null,je=f.status==="fulfilled"&&f.value.ok?await f.value.json():null,be=De.status==="fulfilled"&&De.value.ok?await De.value.json():null,oe={symbol:a.symbol,name:a.name,price:Ee?.c||0,change:Ee?.dp||0,marketCap:je?.data?.[0]?.mktCap||je?.mktCap||0,pe:be?.data?.[0]?.peRatioTTM||be?.peRatioTTM||null,roe:be?.data?.[0]?.returnOnEquityTTM||be?.returnOnEquityTTM||null,debtEquity:be?.data?.[0]?.debtEquityRatioTTM||be?.debtEquityRatioTTM||null,sector:je?.data?.[0]?.sector||je?.sector||"Unknown"};oe.marketCap>=screenerFilters.minMarketCap&&(!oe.pe||oe.pe<=screenerFilters.maxPE)&&(!oe.roe||oe.roe*100>=screenerFilters.minROE)&&(!oe.debtEquity||oe.debtEquity<=screenerFilters.maxDebtEquity)&&(screenerFilters.sector==="all"||oe.sector===screenerFilters.sector)&&i.push(oe)}catch(v){console.error(`Erreur pour ${a.symbol}:`,v)}setScreenerResults(i),console.log(`‚úÖ Screener: ${i.length} r√©sultats trouv√©s sur ${t.length} titres`)}catch(i){console.error("Erreur screener:",i)}finally{setLoadingScreener(!1)}},x=se.find(t=>t.symbol===w),n=h?.quote||{},p=h?.metrics||{},T=h?.ratios||{},ee=h?.profile||{},te=h?.intraday||[],ne=h?.news||[],X=h?.sentiment||{},V=h?.insights||{},U=h?.historicalRatios||[],c=h?.movingAverages||{},Te=(t,i="",a="")=>{if(!t&&t!==0)return"N/A";const v=parseFloat(t);return isNaN(v)?"N/A":v>=1e12?`${i}${(v/1e12).toFixed(2)}T${a}`:v>=1e9?`${i}${(v/1e9).toFixed(2)}B${a}`:v>=1e6?`${i}${(v/1e6).toFixed(2)}M${a}`:v>=1e3?`${i}${(v/1e3).toFixed(2)}K${a}`:`${i}${v.toFixed(2)}${a}`},u=t=>{const i=new Date(t),a=Math.floor((Date.now()-i.getTime())/36e5);return a<1?"maintenant":a<24?`${a}h`:`${Math.floor(a/24)}j`},m={RSI:{value:67.8,signal:"Achat"},MACD:{value:2.34,signal:"Bullish"},SMA_50:{value:(n.price||0)*.98,signal:"Au-dessus"},SMA_200:{value:(n.price||0)*.94,signal:"Au-dessus"}},C={buyVolume:68.4,sellVolume:31.6};if(p.peRatioTTM,(T.netProfitMarginTTM||.25)*100,l)return e.jsx("div",{className:`min-h-screen p-2 flex items-center justify-center transition-colors duration-300 ${isDarkMode?"bg-neutral-950 text-gray-100":"bg-gray-50 text-gray-900"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-500 mx-auto mb-4"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Chargement des donn√©es‚Ä¶"})]})});const y=window.LucideIcon;return e.jsxs("div",{className:`min-h-screen p-2 transition-colors duration-300 ${isDarkMode?"bg-neutral-950 text-gray-100":"bg-gray-50 text-gray-900"}`,children:[Y&&e.jsxs("div",{className:`mb-2 border rounded-lg p-3 transition-colors duration-300 ${isDarkMode?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{name:"Filter",className:"w-4 h-4 text-blue-500"}),e.jsx("h3",{className:`text-sm font-bold ${isDarkMode?"text-white":"text-gray-900"}`,children:"üîç Screener de Titres"})]}),e.jsx("button",{onClick:()=>ce(!1),className:`p-1 rounded ${isDarkMode?"hover:bg-neutral-800":"hover:bg-gray-100"}`,children:e.jsx(y,{name:"X",className:"w-4 h-4 text-gray-500"})})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-2 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] text-gray-500 mb-1 block",children:"Market Cap Min (B$)"}),e.jsx("input",{type:"number",value:screenerFilters.minMarketCap/1e9,onChange:t=>setScreenerFilters({...screenerFilters,minMarketCap:parseFloat(t.target.value||0)*1e9}),className:`w-full px-2 py-1 text-xs rounded border ${isDarkMode?"bg-neutral-800 border-neutral-700 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] text-gray-500 mb-1 block",children:"P/E Max"}),e.jsx("input",{type:"number",value:screenerFilters.maxPE,onChange:t=>setScreenerFilters({...screenerFilters,maxPE:parseFloat(t.target.value||50)}),className:`w-full px-2 py-1 text-xs rounded border ${isDarkMode?"bg-neutral-800 border-neutral-700 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] text-gray-500 mb-1 block",children:"ROE Min (%)"}),e.jsx("input",{type:"number",value:screenerFilters.minROE,onChange:t=>setScreenerFilters({...screenerFilters,minROE:parseFloat(t.target.value||0)}),className:`w-full px-2 py-1 text-xs rounded border ${isDarkMode?"bg-neutral-800 border-neutral-700 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] text-gray-500 mb-1 block",children:"D/E Max"}),e.jsx("input",{type:"number",step:"0.1",value:screenerFilters.maxDebtEquity,onChange:t=>setScreenerFilters({...screenerFilters,maxDebtEquity:parseFloat(t.target.value||2)}),className:`w-full px-2 py-1 text-xs rounded border ${isDarkMode?"bg-neutral-800 border-neutral-700 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] text-gray-500 mb-1 block",children:"Secteur"}),e.jsxs("select",{value:screenerFilters.sector,onChange:t=>setScreenerFilters({...screenerFilters,sector:t.target.value}),className:`w-full px-2 py-1 text-xs rounded border ${isDarkMode?"bg-neutral-800 border-neutral-700 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"all",children:"Tous"}),e.jsx("option",{value:"Technology",children:"Technologie"}),e.jsx("option",{value:"Consumer Cyclical",children:"Consommation"}),e.jsx("option",{value:"Healthcare",children:"Sant√©"}),e.jsx("option",{value:"Financial",children:"Finance"})]})]})]}),e.jsx("button",{onClick:()=>d(se),disabled:loadingScreener,className:`w-full py-2 rounded text-sm font-semibold transition-colors ${loadingScreener?"bg-gray-400 cursor-not-allowed":"bg-gray-800 hover:bg-gray-700 text-white"}`,children:loadingScreener?"‚è≥ Analyse en cours...":"üîç Lancer le Screener"}),screenerResults.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:[screenerResults.length," titre(s) trouv√©(s)"]}),e.jsx("div",{className:`max-h-64 overflow-y-auto border rounded ${isDarkMode?"border-neutral-700":"border-gray-300"}`,children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{className:`sticky top-0 ${isDarkMode?"bg-neutral-800":"bg-gray-100"}`,children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 text-gray-500",children:"Symbole"}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"Prix"}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"Var %"}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"Cap."}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"P/E"}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"ROE"}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"D/E"}),e.jsx("th",{className:"text-center p-2 text-gray-500",children:"Action"})]})}),e.jsx("tbody",{children:screenerResults.map(t=>e.jsxs("tr",{className:`border-t ${isDarkMode?"border-neutral-700 hover:bg-neutral-800":"border-gray-200 hover:bg-gray-50"}`,children:[e.jsxs("td",{className:"p-2",children:[e.jsx("div",{className:`font-bold ${isDarkMode?"text-white":"text-gray-900"}`,children:t.symbol}),e.jsx("div",{className:"text-[9px] text-gray-500",children:t.name})]}),e.jsxs("td",{className:`text-right p-2 font-semibold ${isDarkMode?"text-white":"text-gray-900"}`,children:["$",t.price.toFixed(2)]}),e.jsx("td",{className:`text-right p-2 font-semibold ${t.change>=0?"text-emerald-500":"text-red-500"}`,children:(()=>{const i=t.change;if(!i)return"0.00%";const a=typeof i=="number"?i:typeof i=="object"?i.raw||i.fmt||0:parseFloat(i)||0;return(a>=0?"+":"")+a.toFixed(2)+"%"})()}),e.jsx("td",{className:"text-right p-2 text-gray-400",children:Te(t.marketCap)}),e.jsx("td",{className:`text-right p-2 font-semibold ${ae("PE",t.pe)}`,children:t.pe?t.pe.toFixed(1):"N/A"}),e.jsx("td",{className:`text-right p-2 font-semibold ${ae("ROE",t.roe?t.roe*100:null)}`,children:t.roe?(t.roe*100).toFixed(1)+"%":"N/A"}),e.jsx("td",{className:`text-right p-2 font-semibold ${ae("DE",t.debtEquity)}`,children:t.debtEquity?t.debtEquity.toFixed(2):"N/A"}),e.jsx("td",{className:"text-center p-2",children:e.jsx("button",{onClick:()=>{_(t.symbol),ce(!1)},className:"px-2 py-1 bg-gray-800 text-white rounded text-[9px] hover:bg-gray-700 transition-colors",children:"Voir"})})]},t.symbol))})]})})]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`p-1.5 border rounded-lg transition-colors duration-300 ${isDarkMode?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:e.jsx(y,{name:"Activity",className:"w-4 h-4 text-gray-400"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:`text-base font-bold flex items-center gap-2 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:["Expert Trading Analytics",S?e.jsx(y,{name:"Wifi",className:"w-3 h-3 text-green-500"}):e.jsx(y,{name:"WifiOff",className:"w-3 h-3 text-red-500"}),h?.jslaiScore&&e.jsxs("div",{className:`px-4 py-1.5 rounded text-sm font-bold border-2 ${h.jslaiScore.total>=75?"bg-emerald-900/30 text-emerald-400 border-emerald-600 glow-pulse":h.jslaiScore.total>=65?"bg-gray-900/30 text-gray-400 border-gray-600":h.jslaiScore.total>=50?"bg-yellow-900/30 text-yellow-400 border-yellow-600":"bg-red-900/30 text-red-400 border-red-600 glow-pulse-red"}`,children:["üéØ JSLAI‚Ñ¢ ",h.jslaiScore.total,"/100"]}),e.jsxs("button",{onClick:()=>{const t=`Analyse approfondie de ${w}: fondamentaux, techniques, actualit√©s et recommandation d'investissement`;setEmmaPrefillMessage(t),setTimeout(()=>handleTabChange("ask-emma"),50)},className:`flex items-center gap-2 px-4 py-1.5 rounded text-sm font-semibold border-2 transition-all hover:scale-105 ${isDarkMode?"bg-purple-900/30 hover:bg-purple-800/40 text-purple-400 border-purple-600":"bg-purple-100 hover:bg-purple-200 text-purple-700 border-purple-400"}`,title:`Demander une analyse d√©taill√©e de ${w} √† Emma IA`,children:[e.jsx("img",{src:"EMMA-JSLAI-GOB-dark.jpg",alt:"Emma",className:"w-4 h-4 rounded-full"}),"Analyse d'Emma IA"]})]}),e.jsxs("p",{className:"text-[8px] text-gray-600",children:[h?.dataQuality?e.jsxs(e.Fragment,{children:["üìä Qualit√©: ",h.dataQuality.quality_percentage,"% (",h.dataQuality.production_sections,"/",h.dataQuality.total_sections," r√©elles)",h.dataQuality.status==="EXCELLENT"&&" ‚úÖ",h.dataQuality.status==="GOOD"&&" üü¢",h.dataQuality.status==="FAIR"&&" üü°",h.dataQuality.status==="POOR"&&" üî¥"]}):"Mode D√©mo Hybride ‚Ä¢ FMP + Perplexity AI",h?.jslaiScore&&e.jsxs("span",{className:"ml-2",children:["‚Ä¢ ",h.jslaiScore.interpretation," (",h.jslaiScore.recommendation,")"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:async()=>{try{g(!0),console.log("üîÑ Actualisation des donn√©es...");const t=await A(w,M);if(t&&t.quote&&t.quote.price>0)r(t),$(!0),O(new Date),console.log("‚úÖ Donn√©es actualis√©es avec succ√®s");else throw new Error("Donn√©es invalides re√ßues de l'API")}catch(t){console.error("‚ùå Erreur lors de l'actualisation:",t),$(!1)}finally{g(!1)}},className:`p-1.5 border rounded-md transition-all ${isDarkMode?"bg-neutral-900 hover:bg-neutral-800 border-neutral-800":"bg-white hover:bg-gray-100 border-gray-300"}`,children:e.jsx(y,{name:"RefreshCw",className:"w-3 h-3 text-gray-400"})}),e.jsxs("button",{onClick:emmaPopulateJLab,disabled:l,className:`px-3 py-1.5 border rounded-lg transition-all flex items-center gap-2 ${isDarkMode?"bg-purple-900 hover:bg-purple-800 border-purple-800 text-purple-200":"bg-purple-600 hover:bg-purple-700 border-purple-600 text-white"} disabled:opacity-50`,children:[e.jsx("span",{children:"ü§ñ"}),e.jsx("span",{className:"text-xs font-semibold",children:"Emma Populate"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>J(!L),className:`flex items-center gap-2 px-3 py-1.5 border rounded-lg transition-all ${isDarkMode?"bg-neutral-900 hover:bg-neutral-800 border-neutral-800":"bg-white hover:bg-gray-100 border-gray-300"}`,children:[e.jsxs("div",{children:[e.jsx("div",{className:`text-xs font-bold transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:w}),e.jsx("div",{className:"text-[8px] text-gray-600",children:ee.companyName||x?.name})]}),e.jsx(y,{name:"ChevronDown",className:`w-3 h-3 text-gray-400 transition-transform ${L?"rotate-180":""}`})]}),L&&e.jsx("div",{className:`absolute top-full mt-1 right-0 w-48 border rounded-lg shadow-2xl overflow-hidden z-50 transition-colors duration-300 ${isDarkMode?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:se.map(t=>e.jsx("button",{onClick:()=>{_(t.symbol),J(!1)},className:`w-full p-2 flex items-center justify-between transition-all text-xs ${w===t.symbol?isDarkMode?"bg-neutral-800":"bg-gray-100":isDarkMode?"hover:bg-neutral-800":"hover:bg-gray-50"}`,children:e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:`font-bold transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:t.symbol}),e.jsx("div",{className:"text-[8px] text-gray-600",children:t.name})]})},t.symbol))})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs font-mono font-bold text-gray-300",children:o.toLocaleTimeString("fr-FR")}),e.jsx("div",{className:"text-[8px] text-gray-600",children:o.toLocaleDateString("fr-FR",{day:"numeric",month:"short"})})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>ce(!Y),className:`p-1.5 border rounded-md transition-all ${Y?"bg-gray-800 border-gray-800":isDarkMode?"bg-neutral-900 hover:bg-neutral-800 border-neutral-800":"bg-white hover:bg-gray-100 border-gray-300"}`,title:"Ouvrir le screener de titres",children:e.jsx(y,{name:"Filter",className:`w-3 h-3 ${Y?"text-white":"text-gray-500"}`})}),e.jsx("button",{className:`p-1.5 border rounded-md transition-all ${isDarkMode?"bg-neutral-900 hover:bg-neutral-800 border-neutral-800":"bg-white hover:bg-gray-100 border-gray-300"}`,children:e.jsx(y,{name:"Bell",className:"w-3 h-3 text-gray-500"})}),e.jsx("button",{className:`p-1.5 border rounded-md transition-all ${isDarkMode?"bg-neutral-900 hover:bg-neutral-800 border-neutral-800":"bg-white hover:bg-gray-100 border-gray-300"}`,children:e.jsx(y,{name:"Search",className:"w-3 h-3 text-gray-500"})}),e.jsx("button",{className:`p-1.5 border rounded-md transition-all ${isDarkMode?"bg-neutral-900 hover:bg-neutral-800 border-neutral-800":"bg-white hover:bg-gray-100 border-gray-300"}`,children:e.jsx(y,{name:"Settings",className:"w-3 h-3 text-gray-500"})}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>q(!F),className:`p-1.5 border rounded-md transition-all ${isDarkMode?"bg-neutral-900 hover:bg-neutral-800 border-neutral-800":"bg-white hover:bg-gray-100 border-gray-300"}`,title:B.length?"Diagnostics: probl√®mes d√©tect√©s":"Aide IntelliStocks",children:e.jsxs("div",{className:"relative",children:[e.jsx(y,{name:B.length?"AlertTriangle":"HelpCircle",className:`w-3 h-3 ${B.length?"text-yellow-500":"text-gray-500"}`}),B.length>0&&e.jsx("span",{className:"absolute -top-0.5 -right-0.5 w-2 h-2 bg-red-500 rounded-full"})]})}),F&&e.jsxs("div",{className:`absolute right-0 mt-2 w-80 border rounded-xl shadow-2xl z-50 ${isDarkMode?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("div",{className:`p-3 border-b flex items-center justify-between gap-2 ${isDarkMode?"border-neutral-800":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{name:"LifeBuoy",className:"w-4 h-4 text-blue-500"}),e.jsxs("div",{children:[e.jsx("div",{className:`text-xs font-bold ${isDarkMode?"text-white":"text-gray-900"}`,children:"Aide & diagnostics IntelliStocks"}),e.jsx("div",{className:"text-[10px] text-gray-500",children:"Mode D√©mo Hybride ‚Ä¢ FMP + Perplexity"})]})]}),e.jsx("button",{onClick:()=>q(!1),className:`p-1 rounded ${isDarkMode?"hover:bg-neutral-800":"hover:bg-gray-100"}`,children:e.jsx(y,{name:"X",className:"w-3 h-3 text-gray-500"})})]}),e.jsxs("div",{className:"p-3 space-y-2 text-[11px]",children:[B.length>0?e.jsxs("div",{children:[e.jsx("div",{className:`mb-1 font-semibold ${isDarkMode?"text-white":"text-gray-900"}`,children:"Probl√®mes d√©tect√©s"}),e.jsx("ul",{className:"space-y-1",children:B.map((t,i)=>e.jsx("li",{className:`p-2 rounded border ${t.severity==="high"?isDarkMode?"bg-red-900/30 border-red-800 text-red-200":"bg-red-50 border-red-200 text-red-800":t.severity==="medium"?isDarkMode?"bg-yellow-900/30 border-yellow-800 text-yellow-200":"bg-yellow-50 border-yellow-200 text-yellow-800":isDarkMode?"bg-gray-900/30 border-gray-800 text-gray-200":"bg-gray-50 border-gray-200 text-gray-800"}`,children:t.message},i))})]}):e.jsx("div",{className:`p-2 rounded border ${isDarkMode?"bg-emerald-900/20 border-emerald-800 text-emerald-200":"bg-emerald-50 border-emerald-200 text-emerald-800"}`,children:"Aucun probl√®me d√©tect√©."}),e.jsx("div",{className:`pt-1 border-t ${isDarkMode?"border-neutral-800":"border-gray-200"}`}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:`font-semibold ${isDarkMode?"text-white":"text-gray-900"}`,children:"Conseils rapides"}),e.jsxs("ul",{className:"list-disc pl-4 space-y-1 text-gray-500",children:[e.jsx("li",{children:"Les graphiques utilisent Chart.js pour afficher les donn√©es en temps r√©el."}),e.jsx("li",{children:"Les donn√©es proviennent de FMP et Marketaux via les APIs configur√©es."}),e.jsx("li",{children:"Actualisez avec le bouton rafra√Æchir pour recharger les derni√®res donn√©es du march√©."}),e.jsx("li",{children:"Les graphiques s'adaptent au th√®me sombre/clair automatiquement."})]}),e.jsx("div",{className:`mt-2 pt-2 border-t ${isDarkMode?"border-neutral-800":"border-gray-200"}`}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:`font-semibold ${isDarkMode?"text-white":"text-gray-900"}`,children:"Code couleur des m√©triques"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1 text-[10px]",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),e.jsx("span",{children:"Excellent / Sous-√©valu√©"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-700"}),e.jsx("span",{children:"Bon / Juste valoris√©"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500"}),e.jsx("span",{children:"Moyen / Attention"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),e.jsx("span",{children:"Faible / Risque"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"}),e.jsx("span",{children:"Mauvais / Danger"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400"}),e.jsx("span",{children:"Non disponible"})]})]})]}),e.jsx("div",{className:`mt-2 pt-2 border-t ${isDarkMode?"border-neutral-800":"border-gray-200"}`}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:`font-semibold text-[10px] ${isDarkMode?"text-white":"text-gray-900"}`,children:"Standards utilis√©s"}),e.jsxs("ul",{className:"space-y-0.5 text-[9px] text-gray-500",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"P/E:"})," <15 excellent, 15-25 bon, >25 √©lev√©"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"PEG:"})," <1 sous-√©valu√© (Peter Lynch), >2 sur√©valu√©"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"ROE:"})," >20% excellent (Warren Buffett), >15% bon"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"D/E:"})," <0.7 sain, >2 risqu√©"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Marge:"})," >20% excellente, 10-20% bonne"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Beta:"})," <1 d√©fensif, >1.5 volatil"]})]})]})]})]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-2",children:[e.jsxs("div",{className:"col-span-8 space-y-2",children:[e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 hover-lift shine-effect ${isDarkMode?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-sm font-bold mb-0.5 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:w}),e.jsxs("p",{className:"text-[8px] text-gray-600",children:[ee.companyName||x?.name," ‚Ä¢ ",ee.sector||"NASDAQ"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`text-lg font-bold transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:["$",parseFloat(n.price||0).toFixed(2)]}),e.jsxs("div",{className:`flex items-center gap-1 justify-end text-xs ${parseFloat(n.changesPercentage||0)>=0?"text-emerald-500":"text-red-500"}`,children:[parseFloat(n.changesPercentage||0)>=0?e.jsx(y,{name:"ArrowUpRight",className:"w-3 h-3"}):e.jsx(y,{name:"ArrowDownRight",className:"w-3 h-3"}),e.jsxs("span",{className:"font-semibold",children:[parseFloat(n.changesPercentage||0)>=0?"+":"",parseFloat(n.changesPercentage||0).toFixed(2),"%"]})]})]})]}),e.jsx("div",{style:{width:"100%",height:140},children:typeof Chart<"u"&&te&&te.length>0?e.jsx("canvas",{ref:t=>{if(t){t.chart&&(t.chart.destroy(),t.chart=null);const i=t.getContext("2d");t.chart=new Chart(i,{type:"line",data:{labels:te.map(a=>a.date),datasets:[{label:"Prix",data:te.map(a=>a.close),borderColor:parseFloat(n.changesPercentage||0)>=0?"rgb(34, 197, 94)":"rgb(239, 68, 68)",backgroundColor:parseFloat(n.changesPercentage||0)>=0?"rgba(34, 197, 94, 0.1)":"rgba(239, 68, 68, 0.1)",tension:.4,fill:!0,borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{mode:"index",intersect:!1,backgroundColor:isDarkMode?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.8)",titleColor:isDarkMode?"#fff":"#000",bodyColor:isDarkMode?"#fff":"#000",borderColor:isDarkMode?"#444":"#ddd",borderWidth:1}},scales:{x:{display:M!=="1D",grid:{display:!1},ticks:{color:isDarkMode?"#888":"#666",font:{size:8},maxTicksLimit:6}},y:{display:!0,position:"right",grid:{color:isDarkMode?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},ticks:{color:isDarkMode?"#888":"#666",font:{size:10},callback:function(a){return"$"+a.toFixed(2)}}}}}})}},width:"100%",height:"140"},`chart-${w}-${M}`):e.jsx("div",{className:"text-center text-gray-500 text-xs py-8",children:"üìà Chargement des donn√©es du graphique..."})}),e.jsx("div",{className:"flex gap-1 mt-1.5",children:["1D","1W","1M","3M","6M","1A","5A","MAX","YTD"].map(t=>e.jsx("button",{onClick:async()=>{P(t);try{g(!0),console.log(`üìä Changement de timeframe vers ${t}...`);const i=await A(w,t);i&&i.quote&&i.quote.price>0&&(r(i),$(!0),O(new Date),console.log(`‚úÖ Donn√©es ${t} charg√©es avec succ√®s`))}catch(i){console.error("‚ùå Erreur lors du changement de timeframe:",i)}finally{g(!1)}},className:`px-2 py-0.5 rounded text-[9px] font-semibold transition-all ${M===t?isDarkMode?"bg-neutral-700 text-white border border-neutral-600":"bg-gray-300 text-gray-900 border border-gray-400":isDarkMode?"bg-neutral-800 hover:bg-neutral-700 border border-neutral-800 text-gray-500":"bg-gray-100 hover:bg-gray-200 border border-gray-200 text-gray-600"}`,children:t},t))})]}),e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${isDarkMode?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("h3",{className:"text-[10px] font-bold mb-1.5 flex items-center gap-1 text-gray-400",children:[e.jsx(y,{name:"BarChart3",className:"w-3 h-3 text-gray-500"}),"Volume & Flux d'Ordres"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{style:{width:"100%",height:80},children:typeof Chart<"u"&&te.length>0?e.jsx("canvas",{ref:t=>{if(t&&!t.chart){const i=t.getContext("2d");t.chart=new Chart(i,{type:"bar",data:{labels:te.map(a=>a.date),datasets:[{label:"Volume",data:te.map(a=>a.volume),backgroundColor:te.map((a,v)=>v===0||a.close>=te[v-1].close?"rgba(34, 197, 94, 0.6)":"rgba(239, 68, 68, 0.6)"),borderColor:te.map((a,v)=>v===0||a.close>=te[v-1].close?"rgb(34, 197, 94)":"rgb(239, 68, 68)"),borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:isDarkMode?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.8)",titleColor:isDarkMode?"#fff":"#000",bodyColor:isDarkMode?"#fff":"#000"}},scales:{x:{display:!1},y:{display:!0,position:"right",grid:{color:isDarkMode?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},ticks:{color:isDarkMode?"#888":"#666",font:{size:9}}}}}})}},width:"100%",height:"80"}):e.jsx("div",{className:"text-center text-gray-500 text-xs py-4",children:"üìä Chargement du volume..."})}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:`flex items-center justify-between p-1.5 border rounded text-[9px] transition-colors duration-300 ${isDarkMode?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("span",{className:"text-gray-500",children:"Acheteurs"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:`w-16 h-1.5 rounded-full overflow-hidden ${isDarkMode?"bg-neutral-700":"bg-gray-200"}`,children:e.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${C.buyVolume}%`}})}),e.jsxs("span",{className:"text-emerald-500 font-bold",children:[C.buyVolume,"%"]})]})]}),e.jsxs("div",{className:`flex items-center justify-between p-1.5 border rounded text-[9px] transition-colors duration-300 ${isDarkMode?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("span",{className:"text-gray-500",children:"Vendeurs"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:`w-16 h-1.5 rounded-full overflow-hidden ${isDarkMode?"bg-neutral-700":"bg-gray-200"}`,children:e.jsx("div",{className:"h-full bg-red-500",style:{width:`${C.sellVolume}%`}})}),e.jsxs("span",{className:"text-red-500 font-bold",children:[C.sellVolume,"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsxs("div",{className:`p-1.5 border rounded text-center transition-colors duration-300 ${isDarkMode?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:"text-[8px] text-gray-600",children:"Volume"}),e.jsx("div",{className:`text-xs font-bold transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:Te(n.volume)})]}),e.jsxs("div",{className:`p-1.5 border rounded text-center transition-colors duration-300 ${isDarkMode?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:"text-[8px] text-gray-600",children:"Cap"}),e.jsx("div",{className:`text-xs font-bold transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:Te(n.marketCap)})]})]})]})]})]}),e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 hover-lift shine-effect ${isDarkMode?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("h3",{className:"text-[10px] font-bold mb-2 flex items-center gap-1 text-gray-400",children:[e.jsx(y,{name:"LineChart",className:"w-3 h-3 text-gray-500"}),"TradingView Mini Chart"]}),e.jsx("div",{style:{height:"250px"},children:e.jsx("div",{id:"tradingview-mini-chart-jlab",className:"tradingview-widget-container",style:{height:"100%",width:"100%"},ref:t=>{if(t&&!t.hasChildNodes()){const i=document.createElement("script");i.type="text/javascript",i.src="https://s3.tradingview.com/external-embedding/embed-widget-mini-symbol-overview.js",i.async=!0,i.innerHTML=JSON.stringify({symbol:`NASDAQ:${w}`,width:"100%",height:"100%",locale:"fr",dateRange:"1D",colorTheme:isDarkMode?"dark":"light",isTransparent:!1,autosize:!0,largeChartUrl:""}),t.appendChild(i)}}})})]}),e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${isDarkMode?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("h3",{className:"text-[10px] font-bold mb-1.5 flex items-center gap-1 text-gray-400",children:[e.jsx(y,{name:"TrendingUp",className:"w-3 h-3 text-gray-500"}),"Moyennes Mobiles & Croisements"]}),e.jsxs("div",{className:`mb-2 p-2 border rounded text-center ${c.interpretation?.trend?.includes("Haussier fort")?isDarkMode?"bg-emerald-900/30 border-emerald-800":"bg-emerald-50 border-emerald-200":c.interpretation?.trend?.includes("Haussier")?isDarkMode?"bg-gray-900/30 border-gray-800":"bg-gray-800 border-gray-700":c.interpretation?.trend?.includes("Baissier fort")?isDarkMode?"bg-red-900/30 border-red-800":"bg-red-50 border-red-200":c.interpretation?.trend?.includes("Baissier")?isDarkMode?"bg-green-900/30 border-green-800":"bg-green-50 border-green-200":isDarkMode?"bg-gray-900/30 border-gray-800":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:"text-[8px] text-gray-500 mb-0.5",children:"Tendance Globale"}),e.jsxs("div",{className:`text-xs font-bold ${c.interpretation?.trend?.includes("Haussier")?"text-emerald-500":c.interpretation?.trend?.includes("Baissier")?"text-red-500":"text-gray-400"}`,children:[c.interpretation?.trend==="Haussier fort"&&"üìà ",c.interpretation?.trend==="Baissier fort"&&"üìâ ",c.interpretation?.trend||"Calcul en cours..."]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:`p-1.5 border rounded transition-colors duration-300 ${isDarkMode?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("div",{className:"text-[9px] font-semibold text-gray-400",children:"SMA 20 jours"}),e.jsxs("div",{className:"text-[9px] text-gray-500",children:["$",c.sma20?.value?.toFixed(2)||"N/A"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:`text-[8px] font-semibold ${c.sma20?.diff>0?"text-emerald-500":"text-red-500"}`,children:[c.interpretation?.sma20,c.sma20?.diff>0?" ‚Üë":" ‚Üì"]}),e.jsxs("div",{className:`text-xs font-bold ${Math.abs(c.sma20?.diff||0)>5?c.sma20?.diff>0?"text-emerald-500":"text-red-500":"text-blue-500"}`,children:[c.sma20?.diff>0?"+":"",c.sma20?.diff?.toFixed(2)||0,"%"]})]}),e.jsx("div",{className:"text-[7px] text-gray-500 mt-1 italic",children:Math.abs(c.sma20?.diff||0)<2?"üí° Proche de la moyenne - Zone de consolidation":c.sma20?.diff>5?"üöÄ Fort au-dessus - Momentum haussier":c.sma20?.diff<-5?"‚ö†Ô∏è Fort en-dessous - Pression baissi√®re":c.sma20?.diff>0?"‚úÖ Au-dessus - Signal positif":"‚ö†Ô∏è En-dessous - Signal n√©gatif"})]}),e.jsxs("div",{className:`p-1.5 border rounded transition-colors duration-300 ${isDarkMode?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("div",{className:"text-[9px] font-semibold text-gray-400",children:"SMA 50 jours"}),e.jsxs("div",{className:"text-[9px] text-gray-500",children:["$",c.sma50?.value?.toFixed(2)||"N/A"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:`text-[8px] font-semibold ${c.sma50?.diff>0?"text-emerald-500":"text-red-500"}`,children:[c.interpretation?.sma50,c.sma50?.diff>0?" ‚Üë":" ‚Üì"]}),e.jsxs("div",{className:`text-xs font-bold ${Math.abs(c.sma50?.diff||0)>5?c.sma50?.diff>0?"text-emerald-500":"text-red-500":"text-blue-500"}`,children:[c.sma50?.diff>0?"+":"",c.sma50?.diff?.toFixed(2)||0,"%"]})]}),e.jsx("div",{className:"text-[7px] text-gray-500 mt-1 italic",children:c.sma50?.diff>0&&c.sma20?.diff>0?"üìä Tendance moyen terme positive":c.sma50?.diff<0&&c.sma20?.diff<0?"üìâ Tendance moyen terme n√©gative":c.sma50?.diff>0?"‚ö° Support potentiel - Test en cours":"‚ö†Ô∏è R√©sistance - Vigilance recommand√©e"})]}),e.jsxs("div",{className:`p-1.5 border rounded transition-colors duration-300 ${isDarkMode?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("div",{className:"text-[9px] font-semibold text-gray-400",children:"SMA 200 jours"}),e.jsxs("div",{className:"text-[9px] text-gray-500",children:["$",c.sma200?.value?.toFixed(2)||"N/A"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:`text-[8px] font-semibold ${c.sma200?.diff>0?"text-emerald-500":"text-red-500"}`,children:[c.interpretation?.sma200,c.sma200?.diff>0?" ‚Üë":" ‚Üì"]}),e.jsxs("div",{className:`text-xs font-bold ${Math.abs(c.sma200?.diff||0)>10?c.sma200?.diff>0?"text-emerald-500":"text-red-500":"text-blue-500"}`,children:[c.sma200?.diff>0?"+":"",c.sma200?.diff?.toFixed(2)||0,"%"]})]}),e.jsx("div",{className:"text-[7px] text-gray-500 mt-1 italic",children:c.sma200?.diff>10?"üéØ Bull Market confirm√© - Tendance long terme haussi√®re":c.sma200?.diff>0?"‚úÖ Au-dessus SMA200 - March√© haussier":c.sma200?.diff<-10?"üêª Bear Market - Tendance long terme baissi√®re":"‚ö†Ô∏è En-dessous SMA200 - March√© baissier"})]})]}),c.sma20&&c.sma50&&e.jsxs("div",{className:`mt-2 p-2 border rounded text-[8px] ${c.sma20.value>c.sma50.value&&c.sma50.value>c.sma200.value?isDarkMode?"bg-emerald-900/20 border-emerald-800 text-emerald-300":"bg-emerald-50 border-emerald-200 text-emerald-700":c.sma20.value<c.sma50.value&&c.sma50.value<c.sma200.value?isDarkMode?"bg-red-900/20 border-red-800 text-red-300":"bg-red-50 border-red-200 text-red-700":isDarkMode?"bg-yellow-900/20 border-yellow-800 text-yellow-300":"bg-yellow-50 border-yellow-200 text-yellow-700"}`,children:[e.jsxs("div",{className:"font-semibold mb-1 flex items-center gap-2",children:[e.jsx(Icon,{emoji:"üìä",size:16}),"Analyse des Croisements"]}),c.sma20.value>c.sma50.value&&c.sma50.value>c.sma200.value?e.jsx("div",{children:"‚úÖ Configuration id√©ale : SMA20 > SMA50 > SMA200. Tendance haussi√®re confirm√©e sur tous les horizons temporels."}):c.sma20.value<c.sma50.value&&c.sma50.value<c.sma200.value?e.jsx("div",{children:"‚ö†Ô∏è Configuration baissi√®re : SMA20 < SMA50 < SMA200. Pression vendeuse sur tous les horizons. Prudence recommand√©e."}):c.sma20.value>c.sma50.value?e.jsx("div",{children:"‚ö° Croisement r√©cent possible : SMA20 au-dessus de SMA50. Signal de retournement haussier √† confirmer."}):e.jsx("div",{children:"üìâ Moyennes d√©salign√©es : Configuration mixte. Attendre confirmation de tendance avant prise de position."})]})]}),e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${isDarkMode?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("h3",{className:"text-[10px] font-bold mb-1.5 flex items-center gap-1 text-gray-400",children:[e.jsx(y,{name:"Activity",className:"w-3 h-3 text-gray-500"}),"Indicateurs Techniques"]}),e.jsx("div",{className:"grid grid-cols-2 gap-1.5",children:Object.entries(m).map(([t,i])=>{const a=i.signal==="Achat"||i.signal==="Bullish"||i.signal==="Au-dessus"?"text-emerald-500":i.signal==="Neutre"?"text-blue-500":"text-red-500";return e.jsxs("div",{className:`flex items-center justify-between p-1.5 border rounded transition-colors duration-300 ${isDarkMode?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-[9px] text-gray-400",children:t.replace("_"," ")}),e.jsx("div",{className:`text-[8px] font-semibold ${a}`,children:i.signal})]}),e.jsx("div",{className:`text-sm font-bold ${a}`,children:typeof i.value=="number"?i.value.toFixed(2):i.value})]},t)})})]}),e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${isDarkMode?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("h3",{className:"text-[10px] font-bold mb-1.5 flex items-center gap-1 text-gray-400",children:[e.jsx(y,{name:"DollarSign",className:"w-3 h-3 text-gray-500"}),"Analyse Fondamentale"]}),e.jsx("div",{className:"grid grid-cols-3 gap-1.5",children:[{label:"P/E",value:p.peRatioTTM,suffix:"x",metric:"PE"},{label:"PEG",value:p.pegRatioTTM,suffix:"",metric:"PEG"},{label:"P/S",value:p.priceToSalesRatioTTM,suffix:"x",metric:"PS"},{label:"ROE",value:T.returnOnEquityTTM?T.returnOnEquityTTM*100:null,suffix:"%",metric:"ROE",isPercent:!0},{label:"ROA",value:T.returnOnAssetsTTM?T.returnOnAssetsTTM*100:null,suffix:"%",metric:"ROA",isPercent:!0},{label:"D/E",value:T.debtEquityRatio,suffix:"x",metric:"DE"},{label:"Marge",value:T.netProfitMarginTTM?T.netProfitMarginTTM*100:null,suffix:"%",metric:"Margin",isPercent:!0},{label:"Beta",value:ee.beta,suffix:"",metric:"Beta"},{label:"Div",value:p.dividendYieldTTM?p.dividendYieldTTM*100:null,suffix:"%",metric:"Div",isPercent:!0}].map(t=>e.jsxs("div",{className:`p-1.5 border rounded text-center transition-colors duration-300 ${isDarkMode?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:"text-[8px] text-gray-600 mb-0.5",children:t.label}),e.jsx("div",{className:`text-xs font-bold transition-colors duration-300 ${ae(t.metric,t.value)}`,children:t.value!=null?typeof t.value=="number"?t.value.toFixed(t.isPercent?1:2)+t.suffix:t.value:"N/A"})]},t.label))})]}),e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${isDarkMode?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("h3",{className:"text-[10px] font-bold mb-2 flex items-center gap-1 text-gray-400",children:[e.jsx(y,{name:"TrendingUp",className:"w-3 h-3 text-gray-500"}),"Ratios Historiques (Tendances)"]}),U.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:`border rounded p-1.5 ${isDarkMode?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:"text-[9px] font-semibold text-gray-400 mb-1",children:"P/E Ratio (Price to Earnings)"}),e.jsx("div",{style:{width:"100%",height:60},children:e.jsx("canvas",{ref:t=>{if(t&&!t.chart&&U.length>0){const i=t.getContext("2d"),a=U.map(f=>f.peRatioTTM).filter(f=>f!=null).reverse(),v=U.map(f=>new Date(f.date).toLocaleDateString("fr-FR",{month:"short",year:"2-digit"})).reverse();t.chart=new Chart(i,{type:"line",data:{labels:v,datasets:[{label:"P/E",data:a,borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.3,fill:!0,borderWidth:2,pointRadius:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:isDarkMode?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.8)",titleColor:isDarkMode?"#fff":"#000",bodyColor:isDarkMode?"#fff":"#000",borderColor:isDarkMode?"#444":"#ddd",borderWidth:1}},scales:{x:{display:!0,grid:{display:!1},ticks:{color:isDarkMode?"#888":"#666",font:{size:8}}},y:{display:!0,position:"right",grid:{color:isDarkMode?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},ticks:{color:isDarkMode?"#888":"#666",font:{size:8}}}}}})}},width:"100%",height:"60"})})]}),e.jsxs("div",{className:`border rounded p-1.5 ${isDarkMode?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:"text-[9px] font-semibold text-gray-400 mb-1",children:"ROE (Return on Equity)"}),e.jsx("div",{style:{width:"100%",height:60},children:e.jsx("canvas",{ref:t=>{if(t&&!t.chart&&U.length>0){const i=t.getContext("2d"),a=U.map(f=>f.returnOnEquityTTM?f.returnOnEquityTTM*100:null).filter(f=>f!=null).reverse(),v=U.map(f=>new Date(f.date).toLocaleDateString("fr-FR",{month:"short",year:"2-digit"})).reverse();t.chart=new Chart(i,{type:"line",data:{labels:v,datasets:[{label:"ROE %",data:a,borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.3,fill:!0,borderWidth:2,pointRadius:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:isDarkMode?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.8)",titleColor:isDarkMode?"#fff":"#000",bodyColor:isDarkMode?"#fff":"#000",borderColor:isDarkMode?"#444":"#ddd",borderWidth:1,callbacks:{label:f=>`ROE: ${f.parsed.y.toFixed(2)}%`}}},scales:{x:{display:!0,grid:{display:!1},ticks:{color:isDarkMode?"#888":"#666",font:{size:8}}},y:{display:!0,position:"right",grid:{color:isDarkMode?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},ticks:{color:isDarkMode?"#888":"#666",font:{size:8},callback:f=>f.toFixed(1)+"%"}}}}})}},width:"100%",height:"60"})})]}),e.jsxs("div",{className:`border rounded p-1.5 ${isDarkMode?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:"text-[9px] font-semibold text-gray-400 mb-1",children:"D/E Ratio (Debt to Equity)"}),e.jsx("div",{style:{width:"100%",height:60},children:e.jsx("canvas",{ref:t=>{if(t&&!t.chart&&U.length>0){const i=t.getContext("2d"),a=U.map(f=>f.debtEquityRatioTTM).filter(f=>f!=null).reverse(),v=U.map(f=>new Date(f.date).toLocaleDateString("fr-FR",{month:"short",year:"2-digit"})).reverse();t.chart=new Chart(i,{type:"bar",data:{labels:v,datasets:[{label:"D/E",data:a,backgroundColor:a.map(f=>f>1?"rgba(239, 68, 68, 0.6)":"rgba(34, 197, 94, 0.6)"),borderColor:a.map(f=>f>1?"rgb(239, 68, 68)":"rgb(34, 197, 94)"),borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:isDarkMode?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.8)",titleColor:isDarkMode?"#fff":"#000",bodyColor:isDarkMode?"#fff":"#000",borderColor:isDarkMode?"#444":"#ddd",borderWidth:1}},scales:{x:{display:!0,grid:{display:!1},ticks:{color:isDarkMode?"#888":"#666",font:{size:8}}},y:{display:!0,position:"right",grid:{color:isDarkMode?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},ticks:{color:isDarkMode?"#888":"#666",font:{size:8}}}}}})}},width:"100%",height:"60"})})]}),e.jsxs("div",{className:`border rounded p-1.5 ${isDarkMode?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:"text-[9px] font-semibold text-gray-400 mb-1",children:"Marge Nette (Net Profit Margin)"}),e.jsx("div",{style:{width:"100%",height:60},children:e.jsx("canvas",{ref:t=>{if(t&&!t.chart&&U.length>0){const i=t.getContext("2d"),a=U.map(f=>f.netProfitMarginTTM?f.netProfitMarginTTM*100:null).filter(f=>f!=null).reverse(),v=U.map(f=>new Date(f.date).toLocaleDateString("fr-FR",{month:"short",year:"2-digit"})).reverse();t.chart=new Chart(i,{type:"line",data:{labels:v,datasets:[{label:"Marge %",data:a,borderColor:"rgb(168, 85, 247)",backgroundColor:"rgba(168, 85, 247, 0.1)",tension:.3,fill:!0,borderWidth:2,pointRadius:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:isDarkMode?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.8)",titleColor:isDarkMode?"#fff":"#000",bodyColor:isDarkMode?"#fff":"#000",borderColor:isDarkMode?"#444":"#ddd",borderWidth:1,callbacks:{label:f=>`Marge: ${f.parsed.y.toFixed(2)}%`}}},scales:{x:{display:!0,grid:{display:!1},ticks:{color:isDarkMode?"#888":"#666",font:{size:8}}},y:{display:!0,position:"right",grid:{color:isDarkMode?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},ticks:{color:isDarkMode?"#888":"#666",font:{size:8},callback:f=>f.toFixed(1)+"%"}}}}})}},width:"100%",height:"60"})})]})]}):e.jsxs("div",{className:"text-center text-gray-500 text-xs py-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(Icon,{emoji:"üìä",size:24})}),e.jsx("div",{children:"Chargement des ratios historiques..."})]})]}),V.catalysts&&e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${isDarkMode?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("h3",{className:"text-[10px] font-bold mb-1.5 flex items-center gap-1 text-gray-400",children:[e.jsx(y,{name:"Brain",className:"w-3 h-3 text-gray-500"}),"Insights IA (Perplexity)"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[9px] text-gray-500 mb-1 font-semibold",children:"üöÄ Catalyseurs"}),V.catalysts.map((t,i)=>e.jsxs("div",{className:"text-[8px] text-emerald-400 mb-0.5",children:["‚Ä¢ ",t]},i))]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[9px] text-gray-500 mb-1 font-semibold",children:"‚ö†Ô∏è Risques"}),V.risks.map((t,i)=>e.jsxs("div",{className:"text-[8px] text-green-400 mb-0.5",children:["‚Ä¢ ",t]},i))]}),e.jsxs("div",{className:`p-1.5 border rounded transition-colors duration-300 ${isDarkMode?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{className:"text-[9px] text-gray-500 mb-0.5",children:["Consensus :",e.jsx("span",{className:`ml-1 font-bold ${V.consensus==="bullish"?"text-emerald-500":V.consensus==="bearish"?"text-red-500":"text-gray-400"}`,children:V.consensus==="bullish"?"üìà Bullish":V.consensus==="bearish"?"üìâ Bearish":"‚ûñ Neutre"})]}),e.jsx("div",{className:"text-[8px] text-gray-400",children:V.reasoning})]})]})]}),e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${isDarkMode?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("h3",{className:"text-[10px] font-bold mb-1.5 flex items-center gap-1 text-gray-400",children:[e.jsx(y,{name:"TrendingUp",className:"w-3 h-3 text-gray-500"}),"Comparaison Pairs"]}),e.jsx("div",{style:{width:"100%",height:120},children:e.jsx("div",{className:"text-center text-gray-500 text-xs py-8",children:"üìä Graphique Radar (Recharts n√©cessite une configuration avanc√©e)"})})]})]}),e.jsxs("div",{className:"col-span-4 space-y-2",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${isDarkMode?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsx("div",{className:"text-[8px] text-gray-600 mb-0.5",children:"Capitalisation"}),e.jsx("div",{className:`text-base font-bold transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:Te(n.marketCap)}),e.jsxs("div",{className:"text-[8px] text-gray-500",children:["P/E: ",p.peRatioTTM?.toFixed(1)||"N/A"]})]}),e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${isDarkMode?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsx("div",{className:"text-[8px] text-gray-600 mb-0.5",children:"Sentiment IA"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("div",{className:"text-base font-bold text-emerald-500",children:[X.overall||0,"%"]}),e.jsx("div",{className:`flex-1 h-1.5 rounded-full overflow-hidden ${isDarkMode?"bg-neutral-700":"bg-gray-200"}`,children:e.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${X.overall||0}%`}})})]}),e.jsx("div",{className:"text-[8px] text-emerald-500 mt-0.5",children:(X.overall||0)>70?"Tr√®s Bullish":(X.overall||0)>50?"Bullish":"Neutre"})]}),e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${isDarkMode?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsx("div",{className:"text-[8px] text-gray-600 mb-0.5",children:"Prix Actuel"}),e.jsxs("div",{className:`text-base font-bold transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:["$",parseFloat(n.price||0).toFixed(2)]}),e.jsxs("div",{className:"text-[8px] text-emerald-500 mt-0.5",children:["Volume: ",Te(n.volume)]})]})]}),X.overall&&e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${isDarkMode?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("h3",{className:"text-[9px] font-bold mb-1.5 flex items-center gap-1 text-gray-400",children:[e.jsx(y,{name:"Brain",className:"w-3 h-3 text-gray-500"}),"Sentiment IA"]}),e.jsx("div",{style:{width:"100%",height:90},children:e.jsx("div",{className:"text-center text-gray-500 text-xs py-6",children:"üìä Graphique Sentiment"})}),X.summary&&e.jsx("div",{className:`mt-1.5 p-1.5 border rounded transition-colors duration-300 ${isDarkMode?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:e.jsx("div",{className:"text-[8px] text-gray-400",children:X.summary})})]}),e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${isDarkMode?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("h3",{className:"text-[9px] font-bold mb-1.5 flex items-center gap-1 text-gray-400",children:[e.jsx(y,{name:"Newspaper",className:"w-3 h-3 text-gray-500"}),"News Temps R√©el"]}),e.jsx("div",{className:"space-y-1 max-h-40 overflow-y-auto",children:ne.map((t,i)=>e.jsxs("div",{className:`p-1.5 border rounded transition-all cursor-pointer ${isDarkMode?"bg-neutral-800 border-neutral-700 hover:bg-neutral-750":"bg-gray-50 border-gray-200 hover:bg-gray-100"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-0.5",children:[e.jsx("div",{className:"text-[7px] px-1 py-0.5 rounded bg-emerald-900 text-emerald-500",children:"üìà"}),e.jsx("span",{className:"text-[7px] text-gray-600",children:u(t.publishedDate)})]}),e.jsx("div",{className:`font-semibold text-[8px] mb-0.5 transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:t.title}),e.jsx("div",{className:"text-[7px] text-gray-500",children:t.site})]},i))})]})]})]}),e.jsx("div",{className:`mt-2 p-1.5 border rounded-lg transition-colors duration-300 ${isDarkMode?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{name:"AlertCircle",className:"w-3 h-3 text-gray-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-[9px] text-gray-400",children:"‚úÖ Dashboard Hybride Fonctionnel"}),e.jsx("div",{className:"text-[7px] text-gray-600",children:"Mode D√©mo ‚Ä¢ FMP (donn√©es pr√©cises) + Perplexity (intelligence IA)"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-[8px] text-gray-500 font-bold",children:"Hybride Optimal"}),e.jsx("div",{className:"text-[7px] text-gray-600",children:"Pr√©cision + IA"})]})]})})]})]})},kt=()=>{const[o,I]=j.useState("economic"),[w,_]=j.useState([{date:"Mon Oct 16",events:[{time:"12:55 PM",currency:"USD",impact:2,event:"Fed Paulson Speech",actual:"N/A",forecast:"N/A",previous:"N/A"},{time:"08:30 AM",currency:"USD",impact:3,event:"NY Empire State Manufacturing Index",actual:"10.70",forecast:"-1.00",previous:"-8.70"}]}]),[M,P]=j.useState(!1),[L,J]=j.useState(null),[h,r]=j.useState(!1),[l,g]=j.useState(""),[S,$]=j.useState("all"),[k,O]=j.useState("all"),[F,q]=j.useState("all"),[B,ge]=j.useState("all"),[Y,ce]=j.useState("week"),[R,s]=j.useState(!0),b=["AAPL","MSFT","GOOGL","GOOG","AMZN","NVDA","META","TSLA","BRK.B","UNH","JNJ","V","XOM","WMT","JPM","MA","PG","CVX","HD","ABBV","MRK","PEP","COST","AVGO","ADBE","TMO","CSCO","ACN","DHR","NFLX","VZ","ABT","NKE","CMCSA","WFC","PM","TXN","LIN","NEE","DIS","HON","QCOM","UPS","IBM","RTX","AMGN","T","SPGI","INTU","DE","AMAT","LOW","SBUX","GS","CAT","AXP","BKNG","ADP","SYK","TJX","GE","ISRG","VRTX","ZTS","MU","FI","C","MDT","GILD","REGN","BLK","ETN","SHW","KLAC","WM","APH","LRCX","ADI","CDNS","SNPS"],[A,se]=j.useState([]),[ae,d]=j.useState([]),x=()=>[{date:"Mon Oct 16",events:[{time:"12:55 PM",currency:"USD",impact:2,event:"Fed Paulson Speech",actual:"N/A",forecast:"N/A",previous:"N/A"},{time:"08:30 AM",currency:"USD",impact:3,event:"NY Empire State Manufacturing Index",actual:"10.70",forecast:"-1.00",previous:"-8.70"}]}];console.log("üìÖ EconomicCalendarTab charg√©"),console.log("üìä Donn√©es init:",w),console.log("üîß √âtat du composant:",{activeSubTab:o,loading:M,error:L}),Ke.useEffect(()=>{(async()=>{try{const C=await(await fetch("/api/tickers-config")).json();C.success&&(se(C.team_tickers||[]),console.log(`‚úÖ Team tickers loaded: ${C.team_tickers?.length||0}`))}catch(m){console.error("‚ùå Error loading team tickers:",m)}try{const C=await(await fetch("/api/supabase-watchlist")).json();C.tickers&&Array.isArray(C.tickers)&&(d(C.tickers),console.log(`‚úÖ Watchlist tickers loaded: ${C.tickers.length}`))}catch(m){console.error("‚ùå Error loading watchlist tickers:",m);const C=localStorage.getItem("dans-watchlist");if(C){const y=JSON.parse(C);d(y),console.log(`üì¶ Watchlist loaded from localStorage: ${y.length}`)}}})()},[]),Ke.useEffect(()=>{n(),q("all"),ge("all"),s(o==="earnings")},[o]);const n=async()=>{console.log("üîÑ fetchCalendarData appel√© pour:",o),P(!0),J(null);try{if(o==="earnings"){const m=await(await fetch("/api/calendar-earnings")).json();m.success&&m.data?(_(m.data),console.log(`‚úÖ ${m.data.length} earnings calendar days loaded from ${m.source}`),m.fallback_tried&&console.log("‚ö†Ô∏è Fallback sources tried:",m.fallback_tried)):(J("Aucune donn√©e d'earnings disponible"),_(x()))}else if(o==="economic"){const m=await(await fetch("/api/calendar-economic")).json();m.success&&m.data?(_(m.data),console.log(`‚úÖ ${m.data.length} economic calendar days loaded from ${m.source}`),m.fallback_tried&&console.log("‚ö†Ô∏è Fallback sources tried:",m.fallback_tried)):(J("Aucune donn√©e √©conomique disponible"),_(x()))}else if(o==="dividends"){const m=await(await fetch("/api/calendar-dividends")).json();m.success&&m.data?(_(m.data),console.log(`‚úÖ ${m.data.length} dividend events loaded from ${m.source}`),m.fallback_tried&&console.log("‚ö†Ô∏è Fallback sources tried:",m.fallback_tried)):(J("Aucune donn√©e de dividendes disponible"),_(x()))}else _(x())}catch(u){console.error("‚ùå Erreur fetchCalendarData:",u),J(`Impossible de charger les donn√©es: ${u.message}`),_(x())}finally{P(!1)}},p=async()=>{console.log("üîÑ Actualisation du calendrier..."),r(!0),await n(),setTimeout(()=>r(!1),1e3)},T=u=>{const m=[],C=["bg-yellow-500","bg-green-500","bg-red-500"];for(let y=0;y<3;y++)m.push(e.jsx("div",{className:`w-3 h-5 rounded-sm ${y<u?C[y]:"bg-gray-600"} ${y<u?"opacity-100":"opacity-30"}`},y));return m},ee=(u,m)=>{if(u==="N/A"||m==="N/A")return"text-gray-400";const C=parseFloat(u),y=parseFloat(m);return C>y?"text-green-400":C<y?"text-red-400":"text-gray-400"},te=u=>({USD:"üá∫üá∏",EUR:"üá™üá∫",GBP:"üá¨üáß",JPY:"üáØüáµ",CAD:"üá®üá¶",AUD:"üá¶üá∫",CHF:"üá®üá≠",CNY:"üá®üá≥",NZD:"üá≥üáø"})[u]||"üåç",ne=u=>{const m=u.match(/^([A-Z]{1,5})\s/);return m?m[1]:null},X=u=>{const m=ne(u.event);return m&&A.includes(m)?1:u.currency==="CAD"||m&&m.endsWith(".TO")?2:u.currency==="USD"&&(!m||!m.endsWith(".TO"))?3:4},V=u=>[...u].sort((m,C)=>{const y=X(m),t=X(C);if(y!==t)return y-t;const i=m.time||"",a=C.time||"";return i.localeCompare(a)}),U=(Array.isArray(w)?w:[]).map(u=>{const m=(Array.isArray(u.events)?u.events:[]).filter(y=>{if(l&&!y.event.toLowerCase().includes(l.toLowerCase())||S!=="all"&&y.impact!==parseInt(S)||k!=="all"&&y.currency!==k)return!1;if(F!=="all"&&(o==="earnings"||o==="dividends")){const t=ne(y.event);if(!t||t!==F)return!1}if(B!=="all"&&(o==="earnings"||o==="dividends")){const t=ne(y.event);if(!t)return!1;const i=A.includes(t),a=ae.includes(t);if(B==="team"&&!i||B==="watchlist"&&!a||B==="both"&&!(i||a))return!1}if(R&&o==="earnings"){const t=ne(y.event);if(!t||!b.includes(t))return!1}return!0}),C=V(m);return{...u,events:C}}).filter(u=>u.events.length>0),c=[...new Set((Array.isArray(w)?w:[]).flatMap(u=>(Array.isArray(u.events)?u.events:[]).map(m=>m.currency||"USD")))].sort(),Te=o==="earnings"||o==="dividends"?[...new Set((Array.isArray(w)?w:[]).flatMap(u=>(Array.isArray(u.events)?u.events:[]).map(m=>ne(m.event)).filter(m=>m!==null)))].sort():[];return e.jsx("div",{className:`${isDarkMode?"bg-gray-900 text-gray-200":"bg-white text-gray-900"} p-6`,children:e.jsxs("div",{className:"max-w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-2xl",children:"üìÖ"}),e.jsx("h2",{className:"text-2xl font-bold",children:"Calendrier financier"})]}),e.jsxs("button",{onClick:p,disabled:M||h,className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors text-sm ${M||h?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-gray-800 hover:bg-gray-700 text-white"}`,children:[e.jsx("div",{className:`w-4 h-4 ${M||h?"animate-spin":""}`,children:"üîÑ"}),"Actualiser"]})]}),e.jsxs("div",{className:`${isDarkMode?"bg-gray-800":"bg-gray-100"} rounded-lg p-4 mb-4`,children:[e.jsxs("div",{className:`grid grid-cols-1 gap-3 ${o==="earnings"||o==="dividends"?"md:grid-cols-6":"md:grid-cols-4"}`,children:[e.jsx("div",{className:"col-span-1 md:col-span-2",children:e.jsx("input",{type:"text",placeholder:"üîç Rechercher un √©v√©nement...",value:l,onChange:u=>g(u.target.value),className:`w-full px-3 py-2 rounded-md text-sm ${isDarkMode?"bg-gray-700 text-white border-gray-600":"bg-white text-gray-900 border-gray-300"} border focus:outline-none focus:ring-2 focus:ring-blue-500`})}),(o==="earnings"||o==="dividends")&&e.jsx("div",{children:e.jsxs("select",{value:B,onChange:u=>{ge(u.target.value),u.target.value!=="all"&&q("all")},className:`w-full px-3 py-2 rounded-md text-sm ${isDarkMode?"bg-gray-700 text-white border-gray-600":"bg-white text-gray-900 border-gray-300"} border focus:outline-none focus:ring-2 focus:ring-blue-500`,children:[e.jsx("option",{value:"all",children:"Tous les titres"}),e.jsxs("option",{value:"team",children:["üë• √âquipe (",A.length,")"]}),e.jsxs("option",{value:"watchlist",children:["‚≠ê Liste de suivi (",ae.length,")"]}),e.jsxs("option",{value:"both",children:["üéØ √âquipe + Liste (",A.length+ae.length,")"]})]})}),(o==="earnings"||o==="dividends")&&e.jsx("div",{children:e.jsxs("select",{value:F,onChange:u=>q(u.target.value),disabled:B!=="all",className:`w-full px-3 py-2 rounded-md text-sm ${isDarkMode?"bg-gray-700 text-white border-gray-600":"bg-white text-gray-900 border-gray-300"} border focus:outline-none focus:ring-2 focus:ring-blue-500 ${B!=="all"?"opacity-50 cursor-not-allowed":""}`,children:[e.jsxs("option",{value:"all",children:["S√©lectionner un ticker (",Te.length,")"]}),Te.map(u=>e.jsx("option",{value:u,children:u},u))]})}),e.jsx("div",{children:e.jsxs("select",{value:S,onChange:u=>$(u.target.value),className:`w-full px-3 py-2 rounded-md text-sm ${isDarkMode?"bg-gray-700 text-white border-gray-600":"bg-white text-gray-900 border-gray-300"} border focus:outline-none focus:ring-2 focus:ring-blue-500`,children:[e.jsx("option",{value:"all",children:"Tous les impacts"}),e.jsx("option",{value:"3",children:"üî¥ Impact √©lev√©"}),e.jsx("option",{value:"2",children:"üü† Impact moyen"}),e.jsx("option",{value:"1",children:"üü° Impact faible"})]})}),e.jsx("div",{children:e.jsxs("select",{value:k,onChange:u=>O(u.target.value),className:`w-full px-3 py-2 rounded-md text-sm ${isDarkMode?"bg-gray-700 text-white border-gray-600":"bg-white text-gray-900 border-gray-300"} border focus:outline-none focus:ring-2 focus:ring-blue-500`,children:[e.jsx("option",{value:"all",children:"Toutes les devises"}),c.map(u=>e.jsxs("option",{value:u,children:[te(u)," ",u]},u))]})}),o==="earnings"&&e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm cursor-pointer transition-colors ${isDarkMode?R?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600":R?"bg-blue-500 text-white":"bg-white text-gray-700 hover:bg-gray-50"} border ${isDarkMode?"border-gray-600":"border-gray-300"}`,children:[e.jsx("input",{type:"checkbox",checked:R,onChange:u=>s(u.target.checked),className:"w-4 h-4 cursor-pointer"}),e.jsx("span",{className:"font-medium",children:"Grandes capitalisations seulement"})]})})]}),(l||S!=="all"||k!=="all"||F!=="all"||B!=="all"||o==="earnings"&&R)&&e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"Filtres actifs :"}),o==="earnings"&&R&&e.jsx("span",{className:`text-xs px-2 py-1 rounded ${isDarkMode?"bg-blue-900 text-blue-200":"bg-blue-100 text-blue-800"}`,children:"üìä Grandes capitalisations"}),l&&e.jsxs("span",{className:`text-xs px-2 py-1 rounded ${isDarkMode?"bg-gray-900 text-gray-200":"bg-gray-700 text-gray-200"}`,children:['Recherche¬†: "',l,'"']}),B!=="all"&&e.jsx("span",{className:`text-xs px-2 py-1 rounded ${isDarkMode?"bg-cyan-900 text-cyan-200":"bg-cyan-100 text-cyan-800"}`,children:B==="team"?"üë• Tickers √©quipe":B==="watchlist"?"‚≠ê Tickers liste de suivi":"üéØ √âquipe + Liste de suivi"}),F!=="all"&&e.jsxs("span",{className:`text-xs px-2 py-1 rounded ${isDarkMode?"bg-purple-900 text-purple-200":"bg-purple-100 text-purple-800"}`,children:["Ticker¬†: ",F]}),S!=="all"&&e.jsxs("span",{className:`text-xs px-2 py-1 rounded ${isDarkMode?"bg-green-900 text-green-200":"bg-green-100 text-green-800"}`,children:["Impact¬†: ",S==="3"?"√âlev√©":S==="2"?"Moyen":"Faible"]}),k!=="all"&&e.jsxs("span",{className:`text-xs px-2 py-1 rounded ${isDarkMode?"bg-green-900 text-green-200":"bg-green-100 text-green-800"}`,children:["Devise¬†: ",k]}),e.jsx("button",{onClick:()=>{g(""),$("all"),O("all"),q("all"),ge("all"),s(o==="earnings")},className:"text-xs text-red-400 hover:text-red-300 underline",children:"R√©initialiser"})]})]}),L&&e.jsxs("div",{className:"bg-red-900/50 border border-red-500 text-red-200 px-4 py-3 rounded-lg mb-4 text-sm",children:["‚ö†Ô∏è ",L]}),e.jsxs("div",{className:"flex gap-0 mb-4 border-b border-gray-700",children:[e.jsx("button",{onClick:()=>I("economic"),className:`px-4 py-2 font-medium transition-colors text-sm ${o==="economic"?"bg-gray-800 text-white":`${isDarkMode?"bg-gray-800 text-gray-400 hover:bg-gray-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`}`,children:"√âconomique"}),e.jsx("button",{onClick:()=>I("earnings"),className:`px-4 py-2 font-medium transition-colors text-sm ${o==="earnings"?"bg-gray-800 text-white":`${isDarkMode?"bg-gray-800 text-gray-400 hover:bg-gray-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`}`,children:"Earnings"}),e.jsx("button",{onClick:()=>I("dividends"),className:`px-4 py-2 font-medium transition-colors text-sm ${o==="dividends"?"bg-gray-800 text-white":`${isDarkMode?"bg-gray-800 text-gray-400 hover:bg-gray-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`}`,children:"Dividendes"})]}),M?e.jsxs("div",{className:`${isDarkMode?"bg-gray-800":"bg-gray-100"} rounded-lg p-8 text-center`,children:[e.jsx("div",{className:"w-8 h-8 text-blue-500 animate-spin mx-auto mb-3",children:"üîÑ"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Loading data..."})]}):U.length===0?e.jsxs("div",{className:`${isDarkMode?"bg-gray-800":"bg-gray-100"} rounded-lg p-8 text-center`,children:[e.jsx("p",{className:"text-gray-400 text-sm",children:w.length===0?"No data available":"No events match your filters"}),w.length>0&&e.jsx("button",{onClick:()=>{g(""),$("all"),O("all")},className:"mt-3 text-blue-400 hover:text-blue-300 underline text-sm",children:"Clear filters"})]}):e.jsx("div",{className:`${isDarkMode?"bg-gray-800":"bg-gray-100"} rounded-lg overflow-hidden shadow-lg`,children:U.map((u,m)=>e.jsxs("div",{className:"border-b border-gray-700 last:border-b-0",children:[e.jsx("div",{className:`${isDarkMode?"bg-gray-750":"bg-gray-200"} px-4 py-2 font-semibold text-sm`,children:u.date}),m===0&&e.jsxs("div",{className:`grid grid-cols-[80px_1fr_80px_60px_90px_90px_90px] gap-3 px-4 py-3 ${isDarkMode?"bg-gray-900":"bg-gray-300"} text-xs font-bold ${isDarkMode?"text-gray-300":"text-gray-700"} border-b-2 ${isDarkMode?"border-gray-600":"border-gray-400"}`,children:[e.jsx("div",{children:"TIME"}),e.jsx("div",{children:"EVENT"}),e.jsx("div",{children:"IMPACT"}),e.jsx("div",{children:"FOR"}),e.jsx("div",{className:"text-center",children:"ACTUAL"}),e.jsx("div",{className:"text-center",children:"FORECAST"}),e.jsx("div",{className:"text-center",children:"PREVIOUS"})]}),u.events.map((C,y)=>e.jsxs("div",{className:`grid grid-cols-[80px_1fr_80px_60px_90px_90px_90px] gap-3 px-4 py-3 ${isDarkMode?"hover:bg-gray-750":"hover:bg-gray-200"} transition-colors border-b ${isDarkMode?"border-gray-700":"border-gray-300"} last:border-b-0 items-center text-sm`,children:[e.jsx("div",{className:`${isDarkMode?"text-gray-400":"text-gray-600"} font-mono text-xs`,children:C.time}),e.jsxs("div",{className:"font-medium flex items-center gap-2",title:C.event,children:[e.jsx("span",{className:"text-lg",children:te(C.currency)}),e.jsx("span",{className:`${isDarkMode?"text-gray-200":"text-gray-800"} truncate`,children:C.event})]}),e.jsx("div",{className:"flex gap-1",children:T(C.impact)}),e.jsx("div",{className:`${isDarkMode?"text-gray-400":"text-gray-600"} font-semibold text-xs`,children:C.currency}),e.jsx("div",{className:`text-center font-bold ${ee(C.actual,C.forecast)}`,children:C.actual}),e.jsx("div",{className:`text-center ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:C.forecast}),e.jsx("div",{className:`text-center ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:C.previous})]},y))]},m))}),e.jsx("div",{className:`mt-4 ${isDarkMode?"bg-gray-800":"bg-gray-100"} rounded-lg p-4`,children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-xs",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:`${isDarkMode?"text-gray-400":"text-gray-600"}`,children:["Showing ",U.reduce((u,m)=>u+m.events.length,0)," events"]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold ${isDarkMode ? 'text-gray-300' : 'text-gray-700'}",children:"Impact:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-sm"}),e.jsx("span",{className:`${isDarkMode?"text-gray-400":"text-gray-600"}`,children:"High"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-sm"}),e.jsx("span",{className:`${isDarkMode?"text-gray-400":"text-gray-600"}`,children:"Medium"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-sm"}),e.jsx("span",{className:`${isDarkMode?"text-gray-400":"text-gray-600"}`,children:"Low"})]})]}),e.jsx("div",{className:`ml-auto ${isDarkMode,"text-gray-500"} text-xs italic`,children:"Data powered by FMP API"})]})})]})})},wt=()=>{const[o,I]=j.useState("stocks-news"),[w,_]=j.useState(!0),M={isDarkMode:w},P=()=>{switch(o){case"stocks-news":return e.jsx(ot,{...M});case"admin-jslai":return e.jsx(ft,{...M});case"plus":return e.jsx(jt,{...M});case"watchlist":return e.jsx(vt,{...M});case"intellistocks":return e.jsx(Nt,{...M});case"economic-calendar":return e.jsx(kt,{...M});default:return e.jsx(ot,{...M})}};return e.jsxs("div",{className:"min-h-screen bg-gray-900 text-white",children:[e.jsx("header",{className:"bg-gray-800 border-b border-gray-700 sticky top-0 z-50",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsx("h1",{className:"text-2xl font-bold",children:"GOB Financial Dashboard"})})}),e.jsx("nav",{className:"bg-gray-800 border-b border-gray-700 sticky top-16 z-40",children:e.jsx("div",{className:"container mx-auto px-4 py-2 flex space-x-2 overflow-x-auto",children:["stocks-news","intellistocks","economic-calendar","plus"].map(L=>e.jsx("button",{onClick:()=>I(L),className:"px-4 py-2 rounded-lg "+(o===L?"bg-green-500 text-white":"bg-gray-700 text-gray-300"),children:L},L))})}),e.jsx("main",{className:"container mx-auto px-4 py-6",children:P()})]})},lt={Activity:"activity",Wifi:"wifi",WifiOff:"wifi-off",RefreshCw:"refresh-double",Refresh:"refresh",ChevronDown:"nav-arrow-down",Bell:"bell",Search:"search",Settings:"settings",AlertTriangle:"warning-triangle",AlertCircle:"info-circle",HelpCircle:"help-circle",LifeBuoy:"lifebelt",X:"xmark",Close:"xmark",Plus:"plus",Minus:"minus",BarChart3:"stat-up",Brain:"brain",TrendingUp:"trending-up",TrendingDown:"trending-down",GraphUp:"graph-up",ChartLine:"chart-line",DollarSign:"dollar",Newspaper:"newspaper",Page:"page",FileText:"page",Briefcase:"briefcase",ArrowUpRight:"arrow-tr",ArrowDownRight:"arrow-br",ArrowUp:"arrow-up",ArrowDown:"arrow-down",Fire:"sparks",Target:"target",Shield:"shield",Sparkles:"sparks",ExternalLink:"open-new-window",Users:"group",User:"user",Calendar:"calendar",Clock:"clock",Image:"media-image",Video:"media-video",Star:"star",StarFilled:"star-solid",Rocket:"rocket",Database:"database",Code:"code",Mail:"mail",Phone:"phone",Globe:"globe",Building:"building",ChatBubble:"chat-bubble"},Mt={"üì°":"antenna-signal","‚öôÔ∏è":"settings","üìÖ":"calendar","üåÖ":"sun-light","‚òÄÔ∏è":"sun-light","üåÜ":"building","üìä":"stat-up","üìà":"trending-up","üìâ":"trending-down","ü§ñ":"brain","üí¨":"chat-bubble","üîç":"search","üìù":"page","üéØ":"target","üíº":"briefcase","üåê":"globe","üí∞":"dollar","üè¢":"building","üìß":"mail","üîî":"bell","‚è∞":"clock","‚úÖ":"check-circle","‚ùå":"xmark-circle","‚ö†Ô∏è":"warning-triangle","üöÄ":"rocket","üî•":"sparks","üí°":"light-bulb","üß†":"brain","üì∞":"newspaper","üíµ":"dollar","üì≤":"smartphone-device","üé®":"palette","üîí":"lock","üîì":"lock-unlock","üë§":"user","üë•":"group","‚≠ê":"star","üèÜ":"trophy","üìå":"pin","üîó":"link","üñºÔ∏è":"media-image","üì∏":"camera","üé¨":"movie","üéµ":"music-note","üìÅ":"folder","üìÑ":"page","üíª":"laptop","‚å®Ô∏è":"keyboard","üñ±Ô∏è":"mouse-button-right","üñ•Ô∏è":"pc-monitor","üì±":"smartphone-device","üîã":"battery-charging","üîå":"plug","üõ†Ô∏è":"tools","üéì":"graduation-cap","üìö":"book-stack","üìñ":"book","‚úèÔ∏è":"edit-pencil","üñäÔ∏è":"pen","üìé":"attachment","üìç":"pin-alt","üß≠":"compass","üó∫Ô∏è":"map","üè†":"home","üè™":"shop","üè¨":"city","üè≠":"industry","‚ö°":"flash","üåü":"star-solid","üíé":"gem-stone","üéÅ":"gift","üõí":"cart","üí≥":"credit-card","üéâ":"party","üéä":"gift","üîê":"lock","üéÆ":"gamepad","üé≤":"dice"},Ze=({name:o,className:I="w-4 h-4"})=>{const w=lt[o]||lt.Activity;return e.jsx("i",{className:`iconoir-${w} ${I}`,style:{fontSize:"inherit"}})},xt={isEnabled:function(){const o=localStorage.getItem("gobapps-professional-mode");return o==="true"||o===null},toggle:function(){const o=!this.isEnabled();return localStorage.setItem("gobapps-professional-mode",o.toString()),window.dispatchEvent(new CustomEvent("professional-mode-changed",{detail:{enabled:o}})),o},emojiToIcon:Mt,renderIcon:function(o,I=24,w=""){if(!this.isEnabled())return`<span class="inline-block">${o}</span>`;const _=this.emojiToIcon[o];return _?`<i class="iconoir-${_} ${w}" style="font-size: ${I}px;"></i>`:`<span class="inline-block">${o}</span>`}};typeof window<"u"&&(window.IconoirIcon=Ze,window.LucideIcon=Ze,window.ProfessionalModeSystem=xt);const Dt=()=>(j.useEffect(()=>{if(window.__GOB_DASHBOARD_MOUNTED){console.warn("‚ö†Ô∏è Dashboard d√©j√† mont√©");return}window.__GOB_DASHBOARD_MOUNTED=!0,window.IconoirIcon=Ze,window.LucideIcon=Ze,window.ProfessionalModeSystem=xt,console.log("‚úÖ GOB Dashboard mont√© (Vite + React + TypeScript)")},[]),e.jsx(wt,{}));console.log("üöÄ Vite + React + TypeScript charg√©");console.log("üìö V√©rification des biblioth√®ques CDN:");console.log("  Chart.js:",typeof Chart<"u"?"‚úÖ":"‚ùå");console.log("  Recharts:",typeof window.Recharts<"u"?"‚úÖ":"‚ùå");console.log("  LightweightCharts:",typeof window.LightweightCharts<"u"?"‚úÖ":"‚ùå");const gt=document.getElementById("root");if(!gt)throw new Error("Root element not found");yt.createRoot(gt).render(e.jsx(Ke.StrictMode,{children:e.jsx(Dt,{})}));
//# sourceMappingURL=index-D865dimS.js.map
