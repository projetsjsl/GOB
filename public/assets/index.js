import{r as xt,g as gt,a as ht}from"./react-vendor.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))F(h);new MutationObserver(h=>{for(const M of h)if(M.type==="childList")for(const L of M.addedNodes)L.tagName==="LINK"&&L.rel==="modulepreload"&&F(L)}).observe(document,{childList:!0,subtree:!0});function b(h){const M={};return h.integrity&&(M.integrity=h.integrity),h.referrerPolicy&&(M.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?M.credentials="include":h.crossOrigin==="anonymous"?M.credentials="omit":M.credentials="same-origin",M}function F(h){if(h.ep)return;h.ep=!0;const M=b(h);fetch(h.href,M)}})();var st={exports:{}},We={};var it;function bt(){if(it)return We;it=1;var D=xt(),t=Symbol.for("react.element"),b=Symbol.for("react.fragment"),F=Object.prototype.hasOwnProperty,h=D.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,M={key:!0,ref:!0,__self:!0,__source:!0};function L(G,E,I){var u,T={},z=null,P=null;I!==void 0&&(z=""+I),E.key!==void 0&&(z=""+E.key),E.ref!==void 0&&(P=E.ref);for(u in E)F.call(E,u)&&!M.hasOwnProperty(u)&&(T[u]=E[u]);if(G&&G.defaultProps)for(u in E=G.defaultProps,E)T[u]===void 0&&(T[u]=E[u]);return{$$typeof:t,type:G,key:z,ref:P,props:T,_owner:h.current}}return We.Fragment=b,We.jsx=L,We.jsxs=L,We}var lt;function pt(){return lt||(lt=1,st.exports=bt()),st.exports}var e=pt(),p=xt();const et=gt(p);var Ze={},ot;function yt(){if(ot)return Ze;ot=1;var D=ht();return Ze.createRoot=D.createRoot,Ze.hydrateRoot=D.hydrateRoot,Ze}var ft=yt();const jt=gt(ft),vt=D=>{const{emmaConnected:t,setEmmaConnected:b,showPromptEditor:F,setShowPromptEditor:h,showTemperatureEditor:M,setShowTemperatureEditor:L,showLengthEditor:G,setShowLengthEditor:E}=D,[I,u]=p.useState(()=>{const r=localStorage.getItem("emma-temperature");return r?parseFloat(r):.3}),[T,z]=p.useState(()=>{const r=localStorage.getItem("emma-max-tokens");return r?parseInt(r):4096}),[P,H]=p.useState(()=>localStorage.getItem("emma-financial-prompt")||`Tu es Emma, CFA¬Æ Level III, analyste financi√®re senior avec 15+ ans exp√©rience gestion portefeuille institutionnel.

MISSION: Fournir analyses financi√®res rigoureuses, factuelles, actionnables de niveau Bloomberg Terminal.

///
DONN√âES DISPONIBLES (via outils dashboard):
- Prix actions temps r√©el (FMP, Polygon, Twelve Data)
- Fondamentaux (ratios P/E, ROE, marges, cash flow)
- Actualit√©s financi√®res (<24h, Finnhub, FMP)
- Indicateurs techniques (RSI, MACD, SMA)
- Calendriers (earnings, √©v√©nements √©conomiques)
- Watchlist utilisateur + tickers √©quipe
///

CAPACIT√âS PRINCIPALES:
1. Analyses compl√®tes CFA¬Æ (valorisation, fondamentaux, technique)
2. Explications concepts financiers (DCF, Graham, Buffett, Lynch)
3. Contexte macro et sectoriel (Fed, taux, inflation)
4. Cadres d√©cisionnels structur√©s (Porter's Five Forces, Moat analysis)

APPROCHE:
- Priorit√© donn√©es R√âELLES via outils (prix, ratios, news)
- Analyses chiffr√©es (minimum 8 ratios financiers)
- Comparaisons sectorielles + historique 3-5 ans
- Sources cit√©es (FMP, Bloomberg, FactSet)

STYLE:
- Professionnel niveau CFA Institute
- Factuel, pr√©cis, sans g√©n√©ralit√©s vagues
- Proactif: proposer analyses compl√©mentaires
- P√©dagogique: expliquer ratios et concepts
- Toujours en fran√ßais

CONTRAINTES:
- Z√âRO mention limitations ("Je n'ai pas acc√®s")
- Commencer par ce que tu PEUX analyser avec donn√©es disponibles
- Longueur: 200-400 mots (questions simples), PROFONDEUR MAXIMALE pour analyses compl√®tes (aucune limite)
- V√©rifier coh√©rence donn√©es avant r√©ponse finale
- Disclaimer obligatoire si recommandations d'investissement`),[O,Q]=p.useState(()=>{const r=localStorage.getItem("emma-use-function-calling");return r!==null?r==="true":!0}),[ne,re]=p.useState(!1),K=r=>{H(r),localStorage.setItem("emma-financial-prompt",r)},R=r=>{u(r),localStorage.setItem("emma-temperature",r.toString())},J=r=>{z(r),localStorage.setItem("emma-max-tokens",r.toString())},de=r=>{Q(r),localStorage.setItem("emma-use-function-calling",r.toString())},V=()=>{K(`Tu es Emma, CFA¬Æ Level III, analyste financi√®re senior avec 15+ ans exp√©rience gestion portefeuille institutionnel.

MISSION: Fournir analyses financi√®res rigoureuses, factuelles, actionnables de niveau Bloomberg Terminal.

///
DONN√âES DISPONIBLES (via outils dashboard):
- Prix actions temps r√©el (FMP, Polygon, Twelve Data)
- Fondamentaux (ratios P/E, ROE, marges, cash flow)
- Actualit√©s financi√®res (<24h, Finnhub, FMP)
- Indicateurs techniques (RSI, MACD, SMA)
- Calendriers (earnings, √©v√©nements √©conomiques)
- Watchlist utilisateur + tickers √©quipe
///

CAPACIT√âS PRINCIPALES:
1. Analyses compl√®tes CFA¬Æ (valorisation, fondamentaux, technique)
2. Explications concepts financiers (DCF, Graham, Buffett, Lynch)
3. Contexte macro et sectoriel (Fed, taux, inflation)
4. Cadres d√©cisionnels structur√©s (Porter's Five Forces, Moat analysis)

APPROCHE:
- Priorit√© donn√©es R√âELLES via outils (prix, ratios, news)
- Analyses chiffr√©es (minimum 8 ratios financiers)
- Comparaisons sectorielles + historique 3-5 ans
- Sources cit√©es (FMP, Bloomberg, FactSet)

STYLE:
- Professionnel niveau CFA Institute
- Factuel, pr√©cis, sans g√©n√©ralit√©s vagues
- Proactif: proposer analyses compl√©mentaires
- P√©dagogique: expliquer ratios et concepts
- Toujours en fran√ßais

CONTRAINTES:
- Z√âRO mention limitations ("Je n'ai pas acc√®s")
- Commencer par ce que tu PEUX analyser avec donn√©es disponibles
- Longueur: 200-400 mots (questions simples), PROFONDEUR MAXIMALE pour analyses compl√®tes (aucune limite)
- V√©rifier coh√©rence donn√©es avant r√©ponse finale
- Disclaimer obligatoire si recommandations d'investissement`)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h2",{className:`text-2xl font-bold transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:"‚öôÔ∏è Admin-JSLAI"})}),e.jsx(EmmaSmsPanel,{}),e.jsxs("div",{className:`rounded-lg p-4 border transition-colors duration-300 ${isDarkMode?"bg-gradient-to-br from-purple-900/20 to-gray-900 border-purple-700":"bg-gradient-to-br from-purple-50 to-gray-50 border-purple-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 cursor-pointer",onClick:()=>re(!ne),children:[e.jsxs("h3",{className:`text-lg font-semibold flex items-center gap-2 ${isDarkMode?"text-purple-300":"text-purple-900"}`,children:[e.jsx(Icon,{emoji:"ü§ñ",size:20}),"Emma Configuration (Prompts Optimis√©s)",e.jsx("span",{className:"text-xs opacity-70",children:"(partag√© avec onglet Emma IA‚Ñ¢)"})]}),e.jsx("button",{className:`px-3 py-1 text-xs rounded transition-colors ${isDarkMode?"bg-purple-600 hover:bg-purple-700 text-white":"bg-purple-500 hover:bg-purple-600 text-white"}`,children:ne?"‚ñº Masquer":"‚ñ∂ Afficher"})]}),ne&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:`p-3 rounded ${isDarkMode?"bg-gray-800":"bg-white"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("label",{className:`font-semibold flex items-center gap-2 ${isDarkMode?"text-purple-300":"text-purple-900"}`,children:[e.jsx(Icon,{emoji:"üìù",size:16}),"Prompt Syst√®me (Optimis√© Hassid)"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:V,className:`px-3 py-1 text-xs rounded transition-colors ${isDarkMode?"bg-green-600 hover:bg-green-700 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:"‚úÖ Restaurer prompt optimis√©"}),e.jsxs("span",{className:`px-3 py-1 text-xs rounded ${isDarkMode?"bg-blue-900 text-blue-200":"bg-blue-100 text-blue-800"}`,children:[P.split(" ").length," mots (-85.6% vs original)"]})]})]}),e.jsx("textarea",{value:P,onChange:r=>K(r.target.value),className:`w-full h-64 p-3 rounded border font-mono text-sm ${isDarkMode?"bg-gray-900 border-gray-700 text-gray-200":"bg-white border-gray-300 text-gray-900"}`,placeholder:"Prompt syst√®me Emma..."}),e.jsx("div",{className:`mt-2 text-xs ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:"üí° Prompt optimis√© selon principes Hassid: layered structure, d√©limiteurs ///, contraintes en fin (recency effect)"})]}),e.jsxs("div",{className:`p-3 rounded ${isDarkMode?"bg-gray-800":"bg-white"}`,children:[e.jsxs("label",{className:`block font-semibold mb-2 flex items-center gap-2 ${isDarkMode?"text-purple-300":"text-purple-900"}`,children:[e.jsx(Icon,{emoji:"üå°Ô∏è",size:16}),"Temp√©rature: ",e.jsx("span",{className:"font-bold text-blue-600",children:I.toFixed(2)}),e.jsxs("span",{className:"text-xs font-normal opacity-70",children:["(",I<=.3?"Pr√©cis/Factuel":I<=.6?"√âquilibr√©":"Cr√©atif",")"]})]}),e.jsx("input",{type:"range",min:"0.1",max:"1.0",step:"0.05",value:I,onChange:r=>R(parseFloat(r.target.value)),className:"w-full"}),e.jsxs("div",{className:`flex justify-between text-xs mt-1 ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:[e.jsx("span",{children:"0.1 (Pr√©cis)"}),e.jsx("span",{children:"0.5 (√âquilibr√©)"}),e.jsx("span",{children:"1.0 (Cr√©atif)"})]})]}),e.jsxs("div",{className:`p-3 rounded ${isDarkMode?"bg-gray-800":"bg-white"}`,children:[e.jsxs("label",{className:`block font-semibold mb-2 flex items-center gap-2 ${isDarkMode?"text-purple-300":"text-purple-900"}`,children:[e.jsx(Icon,{emoji:"üìè",size:16}),"Longueur Max: ",e.jsxs("span",{className:"font-bold text-blue-600",children:[T," tokens"]}),e.jsxs("span",{className:"text-xs font-normal opacity-70",children:["(~",Math.round(T*.75)," mots)"]})]}),e.jsx("input",{type:"range",min:"1024",max:"16384",step:"512",value:T,onChange:r=>J(parseInt(r.target.value)),className:"w-full"}),e.jsxs("div",{className:`flex justify-between text-xs mt-1 ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:[e.jsx("span",{children:"1024"}),e.jsx("span",{children:"4096 (d√©faut)"}),e.jsx("span",{children:"8192"}),e.jsx("span",{children:"16384"})]}),e.jsx("div",{className:`mt-2 text-xs ${isDarkMode?"text-yellow-400":"text-yellow-700"}`,children:"‚ö†Ô∏è Note: Analyses compl√®tes SMS = max 2 parties (~3500 chars). Web/Email = profondeur maximale."})]}),e.jsxs("div",{className:`p-3 rounded ${isDarkMode?"bg-gray-800":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:`font-semibold flex items-center gap-2 ${isDarkMode?"text-purple-300":"text-purple-900"}`,children:[e.jsx(Icon,{emoji:"üîß",size:16}),"Function Calling (APIs temps r√©el)"]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:O,onChange:r=>de(r.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 dark:peer-focus:ring-purple-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-purple-600"}),e.jsx("span",{className:`ml-3 text-sm font-medium ${isDarkMode?"text-gray-300":"text-gray-900"}`,children:O?"Activ√© ‚úÖ":"D√©sactiv√© ‚ùå"})]})]}),e.jsx("div",{className:`mt-2 text-xs ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:O?"‚úÖ Emma utilise les APIs (FMP, Finnhub, etc.) pour donn√©es temps r√©el":"‚ùå Emma se base uniquement sur ses connaissances d'entra√Ænement"})]}),e.jsx("div",{className:`p-3 rounded border-2 ${isDarkMode?"bg-blue-900/20 border-blue-700":"bg-blue-50 border-blue-300"}`,children:e.jsxs("div",{className:`text-sm ${isDarkMode?"text-blue-200":"text-blue-900"}`,children:[e.jsx(Icon,{emoji:"‚ÑπÔ∏è",size:16})," ",e.jsx("strong",{children:"Synchronisation automatique:"}),` Tous les r√©glages sont partag√©s avec l'onglet "Emma IA‚Ñ¢" via localStorage. Les modifications ici s'appliquent imm√©diatement partout.`]})})]})]}),e.jsxs("div",{className:`rounded-lg p-4 border transition-colors duration-300 ${isDarkMode?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("h3",{className:`text-lg font-semibold mb-4 flex items-center gap-2 ${isDarkMode?"text-white":"text-gray-900"}`,children:[e.jsx(Icon,{emoji:"üîç",size:20}),"Debug des Donn√©es"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:`${isDarkMode?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} rounded p-3 border`,children:[e.jsxs("div",{className:"text-blue-600 font-medium mb-2 flex items-center gap-2",children:[e.jsx(Icon,{emoji:"üìä",size:18}),"Stock Data"]}),e.jsxs("div",{className:isDarkMode?"text-gray-200":"text-gray-700",children:["Tickers: ",tickers.length," (",tickers.join(", "),")"]}),e.jsxs("div",{className:isDarkMode?"text-gray-200":"text-gray-700",children:["Donn√©es charg√©es: ",Object.keys(stockData).length]}),e.jsxs("div",{className:isDarkMode?"text-gray-200":"text-gray-700",children:["Derni√®re MAJ: ",lastUpdate?new Date(lastUpdate).toLocaleString("fr-FR"):"Jamais"]})]}),e.jsxs("div",{className:`${isDarkMode?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} rounded p-3 border`,children:[e.jsxs("div",{className:"text-emerald-600 font-medium mb-2 flex items-center gap-2",children:[e.jsx(Icon,{emoji:"üì∞",size:18}),"News Data"]}),e.jsxs("div",{className:isDarkMode?"text-gray-200":"text-gray-700",children:["Articles: ",newsData.length]}),e.jsxs("div",{className:isDarkMode?"text-gray-200":"text-gray-700",children:["Premier article: ",newsData[0]?.title?.substring(0,30)||"Aucun","..."]})]}),e.jsxs("div",{className:`${isDarkMode?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} rounded p-3 border`,children:[e.jsxs("div",{className:"text-violet-600 font-medium mb-2 flex items-center gap-2",children:[e.jsx(Icon,{emoji:"üéØ",size:18}),"Seeking Alpha"]}),e.jsxs("div",{className:isDarkMode?"text-gray-200":"text-gray-700",children:["Stocks: ",seekingAlphaData.stocks?.length||0]}),e.jsxs("div",{className:isDarkMode?"text-gray-200":"text-gray-700",children:["Stock Data: ",Object.keys(seekingAlphaStockData.stocks||{}).length]})]})]})]}),e.jsxs("div",{className:`rounded-lg p-4 border transition-colors duration-300 ${isDarkMode?"bg-gradient-to-br from-blue-900/20 to-gray-900 border-blue-700":"bg-gradient-to-br from-blue-50 to-gray-50 border-blue-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:`text-lg font-semibold flex items-center gap-2 ${isDarkMode?"text-blue-300":"text-blue-900"}`,children:[e.jsx(Icon,{emoji:"üì¶",size:20}),"Gestion du Cache Supabase"]}),e.jsx("button",{onClick:async()=>{setLoadingCacheStatus(!0);try{const r=await fetch(`${API_BASE_URL}/api/supabase-daily-cache?type=status&maxAgeHours=${cacheSettings.maxAgeHours||4}`);if(r.ok){const l=await r.json();setCacheStatus(l.status||{})}}catch(r){console.error("Erreur r√©cup√©ration statut cache:",r)}finally{setLoadingCacheStatus(!1)}},disabled:loadingCacheStatus,className:`px-3 py-1 text-xs rounded transition-colors ${loadingCacheStatus?"bg-gray-500 text-white cursor-not-allowed":isDarkMode?"bg-blue-600 hover:bg-blue-700 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,children:loadingCacheStatus?"‚è≥ Chargement...":"üîÑ Actualiser"})]}),e.jsxs("div",{className:`space-y-4 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:[e.jsxs("div",{className:`p-3 rounded ${isDarkMode?"bg-gray-800":"bg-white"}`,children:[e.jsxs("div",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Icon,{emoji:"‚öôÔ∏è",size:16}),"Param√®tres du Cache"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm mb-2",children:["Dur√©e du cache (heures): ",e.jsxs("span",{className:"font-bold text-blue-600",children:[cacheSettings.maxAgeHours,"h"]})]}),e.jsx("input",{type:"range",min:"1",max:"12",value:cacheSettings.maxAgeHours,onChange:r=>{const l={...cacheSettings,maxAgeHours:parseInt(r.target.value)};setCacheSettings(l),localStorage.setItem("cacheSettings",JSON.stringify(l))},className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"1h"}),e.jsx("span",{children:"6h"}),e.jsx("span",{children:"12h"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"refreshOnNavigation",checked:cacheSettings.refreshOnNavigation,onChange:r=>{const l={...cacheSettings,refreshOnNavigation:r.target.checked};setCacheSettings(l),localStorage.setItem("cacheSettings",JSON.stringify(l))},className:"rounded"}),e.jsx("label",{htmlFor:"refreshOnNavigation",className:"text-sm",children:"Rafra√Æchir les donn√©es tickers lors de la navigation"})]}),cacheSettings.refreshOnNavigation&&e.jsxs("div",{className:"ml-6",children:[e.jsxs("label",{className:"block text-sm mb-2",children:["Intervalle de rafra√Æchissement (minutes): ",e.jsxs("span",{className:"font-bold text-blue-600",children:[cacheSettings.refreshIntervalMinutes," min"]})]}),e.jsx("input",{type:"range",min:"5",max:"30",step:"5",value:cacheSettings.refreshIntervalMinutes,onChange:r=>{const l={...cacheSettings,refreshIntervalMinutes:parseInt(r.target.value)};setCacheSettings(l),localStorage.setItem("cacheSettings",JSON.stringify(l))},className:"w-full"})]})]})]}),e.jsxs("div",{className:`p-3 rounded ${isDarkMode?"bg-gray-800":"bg-white"}`,children:[e.jsxs("div",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Icon,{emoji:"üìä",size:16}),"√âtat du Cache"]}),e.jsx("div",{className:"space-y-2 text-xs",children:Object.keys(cacheStatus).length===0?e.jsx("div",{className:`text-center py-2 ${isDarkMode?"text-gray-400":"text-gray-500"}`,children:`Cliquez sur "Actualiser" pour voir l'√©tat du cache`}):Object.entries(cacheStatus).map(([r,l])=>e.jsxs("div",{className:`p-2 rounded border ${l.expired?isDarkMode?"bg-yellow-900/30 border-yellow-800":"bg-yellow-50 border-yellow-200":isDarkMode?"bg-green-900/30 border-green-800":"bg-green-50 border-green-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-semibold capitalize",children:r.replace("_"," ")}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${l.expired?"bg-yellow-500 text-white":"bg-green-500 text-white"}`,children:l.expired?"‚ö†Ô∏è Expir√©":"‚úÖ Valide"})]}),l.age_hours&&e.jsxs("div",{className:"mt-1 text-gray-600",children:["√Çge: ",parseFloat(l.age_hours).toFixed(1),"h / ",l.max_age_hours||cacheSettings.maxAgeHours,"h max"]})]},r))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:async()=>{if(confirm("Vider tout le cache Supabase ? Les donn√©es seront recharg√©es depuis les APIs."))try{(await fetch(`${API_BASE_URL}/api/supabase-daily-cache`,{method:"DELETE"})).ok&&(alert("Cache vid√© avec succ√®s"),setCacheStatus({}))}catch{alert("Erreur lors du vidage du cache")}},className:`px-4 py-2 rounded text-sm font-semibold transition-colors ${isDarkMode?"bg-red-600 hover:bg-red-700 text-white":"bg-red-500 hover:bg-red-600 text-white"}`,children:"üóëÔ∏è Vider le Cache"}),e.jsx("button",{onClick:()=>{const r={maxAgeHours:4,refreshOnNavigation:!0,refreshIntervalMinutes:10};setCacheSettings(r),localStorage.setItem("cacheSettings",JSON.stringify(r)),alert("Param√®tres r√©initialis√©s aux valeurs par d√©faut")},className:`px-4 py-2 rounded text-sm font-semibold transition-colors ${isDarkMode?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-600 hover:bg-gray-700 text-white"}`,children:"üîÑ R√©initialiser"})]})]})]}),e.jsxs("div",{className:`rounded-lg p-4 border transition-colors duration-300 ${isDarkMode?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:`text-lg font-semibold flex items-center gap-2 ${isDarkMode?"text-white":"text-gray-900"}`,children:[e.jsx(Icon,{emoji:"üìã",size:20}),"Logs Syst√®me"]}),e.jsx("button",{onClick:()=>setSystemLogs([]),className:"px-3 py-1 text-xs bg-red-500 text-white rounded hover:bg-red-600 transition-colors",children:"Effacer logs"})]}),e.jsx("div",{className:`max-h-64 overflow-y-auto rounded p-3 font-mono text-xs ${isDarkMode?"bg-gray-800":"bg-white"}`,children:systemLogs.length===0?e.jsx("div",{className:`text-center py-4 ${isDarkMode?"text-gray-400":"text-gray-500"}`,children:"Aucun log pour le moment"}):systemLogs.map((r,l)=>e.jsxs("div",{className:`py-1 border-b ${isDarkMode?"border-gray-700":"border-gray-200"} ${r.type==="error"?"text-red-500":r.type==="success"?"text-green-500":r.type==="warning"?"text-yellow-500":isDarkMode?"text-gray-300":"text-gray-700"}`,children:[e.jsxs("span",{className:"text-gray-500",children:["[",r.timestamp,"]"]})," ",r.text]},l))})]}),e.jsxs("div",{className:`rounded-lg p-4 border transition-colors duration-300 ${isDarkMode?"bg-gradient-to-br from-purple-900/20 to-gray-900 border-purple-700":"bg-gradient-to-br from-purple-50 to-gray-50 border-purple-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:`text-lg font-semibold flex items-center gap-2 ${isDarkMode?"text-purple-300":"text-purple-900"}`,children:[e.jsx(Icon,{emoji:"üß†",size:20}),"Deep Think"]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded ${isDarkMode?"bg-purple-900/50 text-purple-300":"bg-purple-200 text-purple-900"}`,children:"AI Analysis System"})]}),e.jsxs("div",{className:`space-y-2 text-sm ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:[e.jsxs("div",{className:`p-3 rounded ${isDarkMode?"bg-gray-800":"bg-white"}`,children:[e.jsxs("div",{className:"font-semibold mb-1 flex items-center gap-2",children:[e.jsx(Icon,{emoji:"üéØ",size:16}),"Statut du syst√®me"]}),e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{children:["‚Ä¢ Gemini API: ",typeof window<"u"?"‚úÖ Actif":"‚ö†Ô∏è V√©rification..."]}),e.jsxs("div",{children:["‚Ä¢ Emma Agent: ",systemLogs.filter(r=>r.text.includes("Emma")).length>0?"‚úÖ Op√©rationnel":"‚è∏Ô∏è En attente"]}),e.jsxs("div",{children:["‚Ä¢ Deep Analysis: ",stockData&&Object.keys(stockData).length>0?"‚úÖ Donn√©es disponibles":"‚ö†Ô∏è Pas de donn√©es"]})]})]}),e.jsxs("div",{className:`p-3 rounded ${isDarkMode?"bg-gray-800":"bg-white"}`,children:[e.jsxs("div",{className:"font-semibold mb-1 flex items-center gap-2",children:[e.jsx(Icon,{emoji:"üìä",size:16}),"M√©triques"]}),e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{children:["‚Ä¢ Analyses effectu√©es: ",systemLogs.filter(r=>r.type==="success").length]}),e.jsxs("div",{children:["‚Ä¢ Requ√™tes API: ",systemLogs.length]}),e.jsxs("div",{children:["‚Ä¢ Derni√®re analyse: ",systemLogs[0]?.timestamp||"N/A"]})]})]})]})]}),e.jsxs("div",{className:`rounded-lg p-4 border transition-colors duration-300 ${isDarkMode?"bg-gradient-to-br from-red-900/20 to-gray-900 border-red-700":"bg-gradient-to-br from-red-50 to-gray-50 border-red-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:`text-lg font-semibold flex items-center gap-2 ${isDarkMode?"text-red-300":"text-red-900"}`,children:[e.jsx(Icon,{emoji:"‚ö†Ô∏è",size:20}),"Violations"]}),e.jsxs("span",{className:`px-2 py-1 text-xs rounded ${systemLogs.filter(r=>r.type==="error").length>0?"bg-red-500 text-white":isDarkMode?"bg-green-900/50 text-green-300":"bg-green-200 text-green-900"}`,children:[systemLogs.filter(r=>r.type==="error").length," erreur(s)"]})]}),e.jsx("div",{className:`max-h-48 overflow-y-auto rounded p-3 font-mono text-xs ${isDarkMode?"bg-gray-800":"bg-white"}`,children:systemLogs.filter(r=>r.type==="error").length===0?e.jsx("div",{className:`text-center py-4 ${isDarkMode?"text-green-400":"text-green-600"}`,children:"‚úÖ Aucune violation d√©tect√©e - Syst√®me op√©rationnel"}):e.jsx("div",{className:"space-y-2",children:systemLogs.filter(r=>r.type==="error").map((r,l)=>e.jsx("div",{className:`p-2 rounded border ${isDarkMode?"bg-red-900/30 border-red-800 text-red-200":"bg-red-50 border-red-200 text-red-800"}`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-red-500",children:"‚ö†Ô∏è"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-semibold text-xs",children:["[",r.timestamp,"]"]}),e.jsx("div",{className:"mt-1",children:r.text})]})]})},l))})}),e.jsxs("div",{className:`mt-3 p-2 rounded text-xs ${isDarkMode?"bg-gray-800 text-gray-400":"bg-white text-gray-600"}`,children:["üí° ",e.jsx("strong",{children:"Info:"})," Les violations sont automatiquement track√©es. Consultez les logs syst√®me ci-dessus pour plus de d√©tails."]})]}),e.jsxs("div",{className:`rounded-lg p-4 border transition-colors duration-300 ${isDarkMode?"bg-gradient-to-br from-indigo-900/20 to-gray-900 border-indigo-700":"bg-gradient-to-br from-indigo-50 to-gray-50 border-indigo-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:`text-lg font-semibold flex items-center gap-2 ${isDarkMode?"text-indigo-300":"text-indigo-900"}`,children:[e.jsx(Icon,{emoji:"üé®",size:20}),"Mode d'Affichage des Ic√¥nes"]}),e.jsx("div",{className:`px-3 py-1 rounded text-xs font-medium ${isProfessionalMode?isDarkMode?"bg-blue-900/50 text-blue-300":"bg-blue-200 text-blue-900":isDarkMode?"bg-purple-900/50 text-purple-300":"bg-purple-200 text-purple-900"}`,children:isProfessionalMode?"üíº Professionnel":"üéâ Fun"})]}),e.jsxs("div",{className:`space-y-3 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:[e.jsxs("div",{className:`p-3 rounded ${isDarkMode?"bg-gray-800":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Icon,{emoji:isProfessionalMode?"üíº":"üéâ",size:18}),e.jsx("span",{className:"font-semibold",children:isProfessionalMode?"Mode Professionnel":"Mode Fun"})]}),e.jsx("button",{onClick:()=>{const r=window.ProfessionalModeSystem.toggle();setIsProfessionalMode(r)},className:`px-4 py-2 rounded-lg transition-all duration-300 border-2 font-semibold ${isProfessionalMode?"bg-gradient-to-br from-blue-600 to-blue-700 border-blue-400 text-white hover:from-blue-700 hover:to-blue-800":"bg-gradient-to-br from-purple-600 to-pink-600 border-purple-400 text-white hover:from-purple-700 hover:to-pink-700"}`,children:isProfessionalMode?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"iconoir-briefcase"}),"Mode Professionnel"]}):e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"üéâ"}),"Mode Fun"]})})]}),e.jsx("div",{className:`text-xs mt-2 ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:isProfessionalMode?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mb-1",children:"‚úÖ Ic√¥nes professionnelles Iconoir activ√©es"}),e.jsx("p",{children:"Les emojis sont remplac√©s par des ic√¥nes vectorielles modernes pour une apparence plus professionnelle."})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mb-1",children:"‚úÖ Mode Fun avec emojis activ√©"}),e.jsx("p",{children:"Les ic√¥nes sont affich√©es sous forme d'emojis color√©s pour une exp√©rience plus d√©contract√©e."})]})})]}),e.jsxs("div",{className:`p-2 rounded text-xs ${isDarkMode?"bg-gray-800/50 text-gray-400":"bg-gray-50 text-gray-600"}`,children:["üí° ",e.jsx("strong",{children:"Astuce:"})," Le mode s√©lectionn√© est sauvegard√© automatiquement et s'applique √† tous les onglets du dashboard."]})]})]}),e.jsxs("div",{className:`rounded-lg p-4 border transition-colors duration-300 ${isDarkMode?"bg-gradient-to-br from-emerald-900/20 to-gray-900 border-emerald-700":"bg-gradient-to-br from-emerald-50 to-gray-50 border-emerald-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:`text-lg font-semibold flex items-center gap-2 ${isDarkMode?"text-emerald-300":"text-emerald-900"}`,children:[e.jsx(Icon,{emoji:"ü§ñ",size:20}),"Configuration Emma IA"]}),e.jsx("div",{className:`px-3 py-1 rounded text-xs font-medium ${t?isDarkMode?"bg-green-900/50 text-green-300":"bg-green-200 text-green-900":isDarkMode?"bg-red-900/50 text-red-300":"bg-red-200 text-red-900"}`,children:t?"‚úÖ Gemini Actif":"‚ùå Gemini Inactif"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsx("button",{onClick:()=>h(!F),className:`px-4 py-2 rounded transition-colors ${isDarkMode?"bg-purple-800 hover:bg-purple-700 text-white":"bg-purple-600 hover:bg-purple-700 text-white"}`,children:"üìù Modifier Prompt"}),e.jsx("button",{onClick:()=>L(!M),className:`px-4 py-2 rounded transition-colors ${isDarkMode,"bg-gray-800 hover:bg-gray-700 text-white"}`,children:"üå°Ô∏è Temp√©rature"}),e.jsx("button",{onClick:()=>E(!G),className:`px-4 py-2 rounded transition-colors ${isDarkMode?"bg-green-800 hover:bg-green-700 text-white":"bg-green-600 hover:bg-green-700 text-white"}`,children:"üìè Longueur R√©ponse"})]}),e.jsxs("div",{className:`space-y-4 ${isDarkMode?"bg-gray-800/50":"bg-white"} p-4 rounded-lg border ${isDarkMode?"border-gray-700":"border-gray-200"}`,children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("label",{className:`text-sm font-semibold ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:["üå°Ô∏è Temp√©rature: ",e.jsx("span",{className:"font-bold text-blue-600",children:I.toFixed(1)})]}),e.jsx("span",{className:`text-xs ${isDarkMode?"text-gray-400":"text-gray-500"}`,children:I<=.3?"Pr√©cis":I<=.5?"√âquilibr√©":I<=.7?"Naturel":"Cr√©atif"})]}),e.jsx("input",{type:"range",min:"0.1",max:"1.0",step:"0.1",value:I,onChange:r=>{const l=parseFloat(r.target.value);u(l),localStorage.setItem("emma-temperature",l.toString())},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, #3b82f6 0%, #3b82f6 ${(I-.1)/.9*100}%, #e5e7eb ${(I-.1)/.9*100}%, #e5e7eb 100%)`}}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"0.1"}),e.jsx("span",{children:"0.5"}),e.jsx("span",{children:"1.0"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("label",{className:`text-sm font-semibold ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:["üìè Longueur: ",e.jsx("span",{className:"font-bold text-green-600",children:T})," tokens"]}),e.jsx("span",{className:`text-xs ${isDarkMode?"text-gray-400":"text-gray-500"}`,children:T<=2048?"Concis":T<=4096?"D√©taill√©":"Tr√®s d√©taill√©"})]}),e.jsx("input",{type:"range",min:"512",max:"8192",step:"512",value:T,onChange:r=>{const l=parseInt(r.target.value);z(l),localStorage.setItem("emma-max-tokens",l.toString())},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, #10b981 0%, #10b981 ${(T-512)/7680*100}%, #e5e7eb ${(T-512)/7680*100}%, #e5e7eb 100%)`}}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"512"}),e.jsx("span",{children:"4096"}),e.jsx("span",{children:"8192"})]})]})]}),e.jsxs("div",{className:`mt-3 p-2 rounded text-xs ${isDarkMode?"bg-gray-800 text-gray-400":"bg-white text-gray-600"}`,children:["üí° ",e.jsx("strong",{children:"Info:"})," Ces param√®tres affectent le comportement d'Emma IA dans l'onglet Ask Emma. Modifications appliqu√©es imm√©diatement et sauvegard√©es dans localStorage."]})]}),e.jsxs("div",{className:`rounded-lg p-4 border transition-colors duration-300 ${isDarkMode?"bg-gradient-to-br from-orange-900/20 to-gray-900 border-orange-700":"bg-gradient-to-br from-orange-50 to-gray-50 border-orange-200"}`,children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("h3",{className:`text-lg font-semibold flex items-center gap-2 ${isDarkMode?"text-orange-300":"text-orange-900"}`,children:[e.jsx(Icon,{emoji:"üîê",size:20}),"Configuration Scraping Seeking Alpha"]})}),e.jsxs("div",{className:`space-y-4 ${isDarkMode?"bg-gray-800/50":"bg-white"} p-4 rounded-lg border ${isDarkMode?"border-gray-700":"border-gray-200"}`,children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-semibold mb-2 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"üìß Email:"}),e.jsx("div",{className:`p-3 rounded-lg border ${isDarkMode?"bg-gray-700 border-gray-600 text-gray-200":"bg-gray-50 border-gray-300 text-gray-900"}`,children:"mvilla@videotron.ca"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-semibold mb-2 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"üîë Mot de passe:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`flex-1 p-3 rounded-lg border ${isDarkMode?"bg-gray-700 border-gray-600 text-gray-200":"bg-gray-50 border-gray-300 text-gray-900"}`,children:e.jsx("span",{id:"seeking-alpha-password-display",children:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"})}),e.jsx("button",{onClick:()=>{const r=document.getElementById("seeking-alpha-password-display");r&&(r.textContent==="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"?r.textContent="Mickey69":r.textContent="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢")},className:`px-4 py-3 rounded-lg border transition-colors ${isDarkMode?"bg-orange-700 hover:bg-orange-600 border-orange-600 text-white":"bg-orange-500 hover:bg-orange-600 border-orange-400 text-white"}`,children:"üëÅÔ∏è"})]})]}),e.jsxs("div",{className:`mt-4 p-3 rounded-lg border ${isDarkMode?"bg-blue-900/20 border-blue-700 text-blue-200":"bg-blue-50 border-blue-200 text-blue-800"}`,children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:"üìã Instructions d'utilisation:"}),e.jsxs("ol",{className:"text-xs space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:"Connectez-vous √† Seeking Alpha avec les identifiants ci-dessus"}),e.jsx("li",{children:'Utilisez la section "√âTAPE 1: SCRAPING BATCH" ci-dessous pour lancer le scraping'}),e.jsx("li",{children:"Pour chaque popup ouverte, appuyez sur F12, allez dans la Console, et collez le script g√©n√©r√©"}),e.jsx("li",{children:"Les donn√©es sont automatiquement sauvegard√©es dans Supabase"}),e.jsx("li",{children:'Utilisez "√âTAPE 2: ANALYSE BATCH PERPLEXITY" pour analyser les donn√©es scrap√©es'})]})]})]})]}),e.jsxs("div",{className:`backdrop-blur-sm rounded-lg p-6 border transition-colors duration-300 ${isDarkMode?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("h3",{className:`text-lg font-semibold mb-4 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:[e.jsx(Icon,{emoji:"üìä",size:20,className:"mr-2 inline-block"}),"Gestion des Stocks"]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:refreshAllStocks,disabled:loading,className:"px-4 py-2 bg-emerald-600 text-white rounded hover:bg-emerald-700 disabled:opacity-50 transition-colors",children:loading?"Actualisation...":"Actualiser Stocks"}),e.jsx("button",{onClick:fetchNews,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors",children:"Actualiser News"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:`backdrop-blur-sm rounded-xl p-6 border-2 transition-colors duration-300 ${isDarkMode?"bg-gradient-to-r from-gray-900/40 to-gray-800/40 border-gray-500/50":"bg-gradient-to-r from-gray-800/40 to-gray-700/40 border-gray-400/50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:`text-xl font-bold transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:[e.jsx(Icon,{emoji:"üìä",size:20,className:"mr-2 inline-block"}),"√âTAPE 1: SCRAPING BATCH (25 tickers)"]}),e.jsx("span",{className:`px-4 py-2 rounded-full text-sm font-bold ${scrapingStatus==="idle"?"bg-gray-500 text-white":scrapingStatus==="running"?"bg-gray-700 text-white animate-pulse":scrapingStatus==="completed"?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:scrapingStatus==="idle"?"‚è∏Ô∏è EN ATTENTE":scrapingStatus==="running"?"üîÑ SCRAPING...":scrapingStatus==="completed"?"‚úÖ TERMIN√â":"‚ùå ERREUR"})]}),scrapingStatus==="running"&&e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-4",children:e.jsxs("div",{className:"bg-gradient-to-r from-gray-700 to-gray-600 h-4 rounded-full transition-all duration-300 flex items-center justify-center text-white text-xs font-bold",style:{width:`${scrapingProgress}%`},children:[scrapingProgress,"%"]})})}),e.jsxs("div",{className:`mb-4 p-4 rounded-lg transition-colors duration-300 ${isDarkMode?"bg-black/30":"bg-white/60"}`,children:[e.jsx("p",{className:`text-sm mb-3 font-semibold transition-colors duration-300 ${isDarkMode?"text-yellow-300":"text-yellow-800"}`,children:"‚ö†Ô∏è IMPORTANT: Connectez-vous AVANT de lancer le scraping!"}),e.jsxs("ol",{className:`text-sm space-y-2 transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:[e.jsxs("li",{children:[e.jsx("strong",{children:"1."}),' Cliquez "üîê SE CONNECTER" ‚Üí Login Seeking Alpha']}),e.jsxs("li",{children:[e.jsx("strong",{children:"2."}),` Cliquez "üöÄ LANCER SCRAPING BATCH" ‚Üí Toutes les popups s'ouvrent`]}),e.jsxs("li",{children:[e.jsx("strong",{children:"3."})," Pour CHAQUE popup: F12 ‚Üí Console ‚Üí Collez script ‚Üí Entr√©e"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"4."})," Fermez la popup apr√®s copie"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"5."})," Les donn√©es sont auto-sauvegard√©es dans Supabase"]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{addScrapingLog("üîê Ouverture de la page de connexion Seeking Alpha...","info"),window.open("https://seekingalpha.com/account/login","_blank"),addScrapingLog("‚úÖ Connectez-vous, puis revenez ici","success")},className:"flex-1 px-6 py-4 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-lg hover:from-green-700 hover:to-emerald-700 transition-all font-bold text-lg shadow-lg",children:"üîê SE CONNECTER √Ä SEEKING ALPHA"}),e.jsx("button",{onClick:runSeekingAlphaScraper,disabled:scrapingStatus==="running",className:"flex-1 px-6 py-4 bg-gradient-to-r from-violet-600 to-purple-600 text-white rounded-lg hover:from-violet-700 hover:to-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all font-bold text-lg shadow-lg",children:scrapingStatus==="running"?"‚è≥ SCRAPING EN COURS...":"üöÄ LANCER SCRAPING BATCH"})]})]}),e.jsxs("div",{className:`backdrop-blur-sm rounded-xl p-6 border-2 transition-colors duration-300 ${isDarkMode?"bg-gradient-to-r from-pink-900/40 to-rose-900/40 border-pink-500/50":"bg-gradient-to-r from-pink-50 to-rose-50 border-pink-400/50"}`,children:[e.jsxs("h3",{className:`text-xl font-bold mb-4 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:[e.jsx(Icon,{emoji:"ü§ñ",size:20,className:"mr-2 inline-block"}),"√âTAPE 2: ANALYSE BATCH PERPLEXITY"]}),e.jsxs("div",{className:`mb-4 p-4 rounded-lg transition-colors duration-300 ${isDarkMode?"bg-black/30":"bg-white/60"}`,children:[e.jsx("p",{className:`text-sm mb-3 transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"üìä Cliquez pour analyser TOUTES les donn√©es scrap√©es en une seule fois:"}),e.jsxs("ul",{className:`text-sm space-y-2 transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:[e.jsx("li",{children:"‚úì R√©cup√®re tous les raw scrapes depuis Supabase"}),e.jsx("li",{children:"‚úì Analyse avec Perplexity AI en batch"}),e.jsx("li",{children:"‚úì Formate en JSON structur√©"}),e.jsx("li",{children:"‚úì Sauvegarde dans seeking_alpha_analysis"}),e.jsx("li",{children:"‚úì Affiche les r√©sultats dans le tableau ci-dessous"})]})]}),e.jsxs("button",{onClick:async()=>{addScrapingLog("ü§ñ D√©marrage analyse Perplexity BATCH...","info");try{addScrapingLog("üì• R√©cup√©ration des donn√©es depuis Supabase...","info");const l=await(await fetch("/api/seeking-alpha-scraping?type=raw&limit=100")).json();if(l.success&&l.data&&l.data.length>0){addScrapingLog(`‚úÖ ${l.data.length} raw scrapes trouv√©s`,"success");for(const y of l.data){const w=y.ticker;addScrapingLog(`üîÑ Analyse de ${w} avec Perplexity...`,"info"),await analyzeWithPerplexityAndUpdate(w,{fullText:y.raw_text,url:y.url,content:{}})}addScrapingLog("üéâ Analyse Perplexity termin√©e pour TOUS les tickers!","success"),addScrapingLog("üíæ R√©sultats sauvegard√©s dans Supabase","success")}else addScrapingLog("‚ö†Ô∏è Aucune donn√©e trouv√©e dans Supabase","warning"),addScrapingLog("üí° Effectuez d'abord le scraping (√âtape 1)","info")}catch(r){addScrapingLog(`‚ùå Erreur: ${r.message}`,"error")}},className:"w-full px-6 py-4 bg-gradient-to-r from-pink-600 to-rose-600 text-white rounded-lg hover:from-pink-700 hover:to-rose-700 transition-all font-bold text-lg shadow-lg",children:["ü§ñ ANALYSER TOUT AVEC PERPLEXITY (",tickers.length," tickers)"]})]}),e.jsxs("div",{className:`backdrop-blur-sm rounded-xl p-6 border-2 transition-colors duration-300 ${isDarkMode?"bg-gradient-to-r from-emerald-900/40 to-teal-900/40 border-emerald-500/50":"bg-gradient-to-r from-emerald-50 to-teal-50 border-emerald-400/50"}`,children:[e.jsxs("h3",{className:`text-xl font-bold mb-4 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:[e.jsx(Icon,{emoji:"üìä",size:20,className:"mr-2 inline-block"}),"√âTAPE 3: R√âSULTATS & AFFICHAGE"]}),e.jsx("div",{className:`mb-4 p-4 rounded-lg transition-colors duration-300 ${isDarkMode?"bg-black/30":"bg-white/60"}`,children:e.jsx("p",{className:`text-sm transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:'Toutes les analyses apparaissent dans le tableau ci-dessous. Cliquez sur "RAFRA√éCHIR" pour recharger les derni√®res donn√©es depuis Supabase.'})}),e.jsx("button",{onClick:async()=>{addScrapingLog("üîÑ Rafra√Æchissement des donn√©es depuis Supabase...","info"),await fetchSeekingAlphaData(),await fetchSeekingAlphaStockData(),addScrapingLog("‚úÖ Donn√©es rafra√Æchies!","success")},className:"w-full px-6 py-4 bg-gradient-to-r from-emerald-600 to-teal-600 text-white rounded-lg hover:from-emerald-700 hover:to-teal-700 transition-all font-bold text-lg shadow-lg",children:"üîÑ RAFRA√éCHIR LES DONN√âES DU TABLEAU"})]})]}),scrapingLogs.length>0&&e.jsxs("div",{className:`backdrop-blur-sm rounded-lg p-6 border transition-colors duration-300 ${isDarkMode?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:"üìã Logs de Scraping"}),e.jsx("div",{className:`max-h-64 overflow-y-auto space-y-2 ${isDarkMode?"bg-gray-800":"bg-white"} rounded-lg p-4`,children:scrapingLogs.map((r,l)=>e.jsxs("div",{className:`text-sm p-2 rounded ${r.type==="error"?"bg-red-100 text-red-800":r.type==="success"?"bg-green-100 text-green-800":r.type==="warning"?"bg-yellow-100 text-yellow-800":"bg-gray-700 text-gray-200"}`,children:[e.jsx("span",{className:"font-mono text-xs opacity-70",children:new Date(r.timestamp).toLocaleTimeString()}),e.jsx("span",{className:"ml-2",children:r.message})]},l))})]}),e.jsxs("div",{className:`backdrop-blur-sm rounded-lg p-6 border transition-colors duration-300 ${isDarkMode?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:`text-lg font-semibold transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:"üîó √âtat des Connexions & Diagnostic des APIs"}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:async()=>{await checkApiStatus(),await runHealthCheck()},disabled:healthCheckLoading,className:`px-4 py-2 rounded-lg font-medium transition-colors duration-300 ${healthCheckLoading?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-gray-800 text-white hover:bg-gray-700"}`,children:healthCheckLoading?"V√©rification...":"üîÑ V√©rifier Toutes"})})]}),healthStatus&&e.jsx("div",{className:`p-4 rounded-lg border-2 mb-4 ${healthStatus.overall_status==="healthy"?"bg-green-50 border-green-200":healthStatus.overall_status==="degraded"?"bg-yellow-50 border-yellow-200":"bg-red-50 border-red-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:`font-bold text-lg ${healthStatus.overall_status==="healthy"?"text-green-800":healthStatus.overall_status==="degraded"?"text-yellow-800":"text-red-800"}`,children:[healthStatus.overall_status==="healthy"?"üü¢":healthStatus.overall_status==="degraded"?"üü°":"üî¥","Status Global: ",healthStatus.overall_status.toUpperCase()]}),e.jsxs("p",{className:`text-sm ${healthStatus.overall_status==="healthy"?"text-green-600":healthStatus.overall_status==="degraded"?"text-yellow-600":"text-red-600"}`,children:[healthStatus.healthy_apis,"/",healthStatus.total_apis," APIs op√©rationnelles (",Math.round(healthStatus.healthy_apis/healthStatus.total_apis*100),"%)"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`text-sm font-medium ${healthStatus.overall_status==="healthy"?"text-green-600":healthStatus.overall_status==="degraded"?"text-yellow-600":"text-red-600"}`,children:[healthStatus.response_time_ms,"ms"]}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(healthStatus.timestamp).toLocaleTimeString("fr-FR")})]})]})}),Object.keys(apiStatus).length>0&&e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsx("h4",{className:`text-sm font-semibold mb-2 transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"Connexions d√©taill√©es:"}),Object.entries(apiStatus).map(([r,l])=>e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg transition-colors duration-300 ${isDarkMode?"bg-gray-800":"bg-gray-100"}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:`font-mono capitalize transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:r}),l.error&&e.jsx("div",{className:`text-xs mt-1 transition-colors duration-300 ${isDarkMode?"text-red-400":"text-red-600"}`,children:l.error}),l.source&&e.jsxs("div",{className:`text-xs mt-1 transition-colors duration-300 ${isDarkMode,"text-gray-500"}`,children:["Source: ",l.source]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-3 h-3 rounded-full ${l.status==="success"?"bg-green-500":l.status==="warning"?"bg-yellow-500":l.status==="error"?"bg-red-500":"bg-gray-500"}`}),e.jsxs("span",{className:`text-sm transition-colors duration-300 ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:[l.responseTime,"ms"]})]})]},r))]}),healthStatus&&healthStatus.recommendations&&healthStatus.recommendations.length>0&&e.jsxs("div",{className:`p-4 rounded-lg mt-4 ${isDarkMode?"bg-gray-800":"bg-gray-700"}`,children:[e.jsx("h4",{className:`font-semibold mb-3 ${isDarkMode?"text-white":"text-blue-900"}`,children:"üí° Recommandations"}),e.jsx("div",{className:"space-y-2",children:healthStatus.recommendations.map((r,l)=>e.jsx("div",{className:`p-3 rounded-lg ${r.priority==="critical"?"bg-red-100 border border-red-200":r.priority==="high"?"bg-green-100 border border-green-200":"bg-yellow-100 border border-yellow-200"}`,children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:`font-medium text-sm ${r.priority==="critical"?"text-red-800":r.priority==="high"?"text-green-800":"text-yellow-800"}`,children:[r.priority==="critical"?"üö®":r.priority==="high"?"‚ö†Ô∏è":"üí°",r.message]}),e.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:[e.jsx("strong",{children:"Action:"})," ",r.action]})]})})},l))})]}),Object.keys(apiStatus).length===0&&!healthStatus&&e.jsx("div",{className:`text-center py-8 ${isDarkMode?"text-gray-400":"text-gray-600"}`,children:e.jsx("p",{children:'Cliquez sur "üîÑ V√©rifier Toutes" pour diagnostiquer les connexions'})})]}),e.jsxs("div",{className:`backdrop-blur-sm rounded-lg p-6 border transition-colors duration-300 ${isDarkMode?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("h3",{className:`text-lg font-semibold mb-4 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:[e.jsx(Icon,{emoji:"ü§ñ",size:20,className:"mr-2 inline-block"}),"Monitoring Emma AI"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:`p-4 rounded-lg border transition-colors duration-300 ${isDarkMode?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"text-purple-600 font-medium mb-2 flex items-center gap-2",children:[e.jsx(Icon,{emoji:"üß†",size:18}),"Emma Agent"]}),e.jsxs("div",{className:`text-sm transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:["Status: ",e.jsx("span",{className:"text-green-500",children:"‚úÖ Op√©rationnel"})]}),e.jsx("div",{className:`text-sm transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"Outils: 12 disponibles"})]}),e.jsxs("div",{className:`p-4 rounded-lg border transition-colors duration-300 ${isDarkMode?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:"text-blue-600 font-medium mb-2",children:"üìß Briefings"}),e.jsxs("div",{className:`text-sm transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:["Cron: ",e.jsx("span",{className:"text-green-500",children:"‚úÖ Actif"})]}),e.jsx("div",{className:`text-sm transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"Horaires: 7h20 ‚Ä¢ 11h50 ‚Ä¢ 16h20"})]}),e.jsxs("div",{className:`p-4 rounded-lg border transition-colors duration-300 ${isDarkMode?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:"text-emerald-600 font-medium mb-2",children:"üóÑÔ∏è Supabase"}),e.jsx("div",{className:`text-sm transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"Tables: 4 cr√©√©es"}),e.jsxs("div",{className:`text-sm transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:["Tickers: ",teamTickers.length," team + ",watchlistTickers.length," watchlist"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{fetch("/api/emma-agent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:"Test de connexion Emma Agent",context:{test:!0}})}).then(r=>r.json()).then(r=>{r.success?showMessage("‚úÖ Emma Agent op√©rationnel","success"):showMessage("‚ùå Emma Agent erreur: "+r.error,"error")}).catch(r=>{showMessage("‚ùå Erreur connexion Emma Agent","error")})},className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 transition-colors",children:"üß™ Tester Emma Agent"}),e.jsx("button",{onClick:()=>{fetch("/api/emma-briefing?type=morning").then(r=>r.json()).then(r=>{r.success?showMessage("‚úÖ Emma Briefing op√©rationnel","success"):showMessage("‚ùå Emma Briefing erreur: "+r.error,"error")}).catch(r=>{showMessage("‚ùå Erreur connexion Emma Briefing","error")})},className:"px-4 py-2 bg-gray-800 text-white rounded hover:bg-gray-700 transition-colors",children:"üìß Tester Briefing"})]})]})]}),e.jsxs("div",{className:`backdrop-blur-sm rounded-lg p-6 border transition-colors duration-300 ${isDarkMode?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:"üîß Gestion des Outils Emma"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:`p-4 rounded-lg border transition-colors duration-300 ${isDarkMode?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsxs("h4",{className:`font-medium mb-2 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:[e.jsx(Icon,{emoji:"üìä",size:18,className:"mr-2 inline-block"}),"Outils Financiers"]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("div",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"‚Ä¢ Polygon Stock Price"}),e.jsx("div",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"‚Ä¢ FMP Fundamentals"}),e.jsx("div",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"‚Ä¢ Finnhub News"}),e.jsx("div",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"‚Ä¢ Twelve Data Technical"}),e.jsx("div",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"‚Ä¢ Alpha Vantage Ratios"})]})]}),e.jsxs("div",{className:`p-4 rounded-lg border transition-colors duration-300 ${isDarkMode?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx("h4",{className:`font-medium mb-2 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:"üóÑÔ∏è Outils Supabase"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("div",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"‚Ä¢ Watchlist Manager"}),e.jsx("div",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"‚Ä¢ Team Tickers"}),e.jsx("div",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"‚Ä¢ Economic Calendar"}),e.jsx("div",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"‚Ä¢ Earnings Calendar"}),e.jsx("div",{className:`transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"‚Ä¢ Analyst Recommendations"})]})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:()=>{fetch("/api/emma-agent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:"Afficher la configuration des outils",context:{action:"show_tools_config"}})}).then(r=>r.json()).then(r=>{r.success?(showMessage("‚úÖ Configuration des outils r√©cup√©r√©e","success"),console.log("Tools Config:",r.tools_config)):showMessage("‚ùå Erreur r√©cup√©ration config","error")}).catch(r=>{showMessage("‚ùå Erreur connexion","error")})},className:"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 transition-colors",children:"‚öôÔ∏è Voir Configuration"})})]})]}),e.jsxs("div",{className:`backdrop-blur-sm rounded-lg p-6 border transition-colors duration-300 ${isDarkMode?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("h3",{className:`text-lg font-semibold mb-4 transition-colors duration-300 ${isDarkMode?"text-white":"text-gray-900"}`,children:[e.jsx(Icon,{emoji:"‚öôÔ∏è",size:20,className:"mr-2 inline-block"}),"Configuration"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors duration-300 ${isDarkMode?"text-gray-300":"text-gray-700"}`,children:"Token GitHub (pour les mises √† jour)"}),e.jsx("input",{type:"password",value:githubToken,onChange:r=>setGithubToken(r.target.value),placeholder:"Entrez votre token GitHub",className:`w-full px-3 py-2 rounded-lg border transition-colors duration-300 ${isDarkMode?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"}`})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{onClick:()=>setShowSettings(!showSettings),className:"px-4 py-2 bg-gray-800 text-white rounded hover:bg-gray-700 transition-colors",children:[showSettings?"Masquer":"Afficher"," les param√®tres"]})})]})]})]})},Nt=D=>{const{isDarkMode:t=!0}=D,b=()=>{sessionStorage.clear(),localStorage.clear(),window.location.href="/login.html"};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:`backdrop-blur-sm rounded-lg p-6 border transition-colors duration-300 ${t?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("h2",{className:`text-2xl font-bold mb-6 transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:"‚öôÔ∏è Param√®tres & Actions"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:`p-4 rounded-lg border transition-colors duration-300 ${t?"bg-gray-800 border-gray-600":"bg-white border-gray-300"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-2 transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:"Gestion de Session"}),e.jsx("p",{className:`text-sm mb-4 transition-colors duration-300 ${t?"text-gray-400":"text-gray-600"}`,children:"D√©connectez-vous pour revenir √† la page de connexion"}),e.jsxs("button",{onClick:b,className:"bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors duration-200 flex items-center space-x-2",children:[e.jsx("span",{children:"üö™"}),e.jsx("span",{children:"D√©connexion"})]})]}),e.jsxs("div",{className:`p-4 rounded-lg border transition-colors duration-300 ${t?"bg-gray-800 border-gray-600":"bg-white border-gray-300"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-2 transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:"Fonctionnalit√©s √† venir"}),e.jsxs("ul",{className:`list-disc list-inside space-y-1 text-sm transition-colors duration-300 ${t?"text-gray-400":"text-gray-600"}`,children:[e.jsx("li",{children:"Gestion des pr√©f√©rences utilisateur"}),e.jsx("li",{children:"Configuration des notifications"}),e.jsx("li",{children:"Th√®me personnalis√©"}),e.jsx("li",{children:"Export/Import de configuration"})]})]})]})]})})},wt=D=>{const{isDarkMode:t=!0,tickers:b=[],stockData:F={},API_BASE_URL:h,fetchStockData:M,showMessage:L,getCompanyLogo:G,emmaPopulateWatchlist:E,initialLoadComplete:I}=D,[u,T]=p.useState([]),[z,P]=p.useState(""),[H,O]=p.useState({}),[Q,ne]=p.useState(!1),[re,K]=p.useState(!1),[R,J]=p.useState(!1),[de,V]=p.useState([]),[r,l]=p.useState({minMarketCap:0,maxPE:50,minROE:0,sector:"all"}),y=async()=>{const d=u.map(x=>({symbol:x,name:x}));J(!0);try{const x=[];for(const n of d)try{const[i,S,c]=await Promise.allSettled([fetch(`/api/marketdata?endpoint=quote&symbol=${n.symbol}&source=auto`),fetch(`/api/fmp?endpoint=profile&symbol=${n.symbol}`),fetch(`/api/fmp?endpoint=ratios&symbol=${n.symbol}`)]),g=i.status==="fulfilled"&&i.value.ok?await i.value.json():null,j=S.status==="fulfilled"&&S.value.ok?await S.value.json():null,m=c.status==="fulfilled"&&c.value.ok?await c.value.json():null,s={symbol:n.symbol,name:j?.data?.[0]?.companyName||j?.companyName||n.symbol,price:g?.c||0,change:g?.dp||0,marketCap:j?.data?.[0]?.mktCap||j?.mktCap||0,pe:m?.data?.[0]?.peRatioTTM||m?.peRatioTTM||null,roe:m?.data?.[0]?.returnOnEquityTTM||m?.returnOnEquityTTM||null,debtEquity:m?.data?.[0]?.debtEquityRatioTTM||m?.debtEquityRatioTTM||null,sector:j?.data?.[0]?.sector||j?.sector||"Unknown"};s.marketCap>=r.minMarketCap&&(!s.pe||s.pe<=r.maxPE)&&(!s.roe||s.roe*100>=r.minROE)&&(!s.debtEquity||s.debtEquity<=r.maxDebtEquity)&&(r.sector==="all"||s.sector===r.sector)&&x.push(s)}catch(i){console.error(`Erreur pour ${n.symbol}:`,i)}V(x),console.log(`‚úÖ Screener Watchlist: ${x.length} r√©sultats trouv√©s sur ${d.length} titres`)}catch(x){console.error("Erreur screener:",x)}finally{J(!1)}},w=(d,x)=>{if(x==null||x==="N/A")return"text-gray-400";const n=typeof x=="string"?parseFloat(x):x;if(isNaN(n))return"text-gray-400";switch(d){case"PE":return n<0?"text-red-500":n<15?"text-emerald-500":n<25?"text-blue-500":n<35?"text-yellow-500":"text-red-500";case"ROE":return n<0?"text-red-500":n<10?"text-green-500":n<15?"text-yellow-500":n<20?"text-blue-500":"text-emerald-500";case"DE":return n<.3?"text-emerald-500":n<.7?"text-blue-500":n<1.5?"text-yellow-500":n<2.5?"text-green-500":"text-red-500";default:return"text-gray-400"}},k=(d,x="",n="")=>{if(!d&&d!==0)return"N/A";const i=parseFloat(d);return isNaN(i)?"N/A":i>=1e12?`${x}${(i/1e12).toFixed(2)}T${n}`:i>=1e9?`${x}${(i/1e9).toFixed(2)}B${n}`:i>=1e6?`${x}${(i/1e6).toFixed(2)}M${n}`:i>=1e3?`${x}${(i/1e3).toFixed(2)}K${n}`:`${x}${i.toFixed(2)}${n}`},[q,se]=p.useState(!1);p.useEffect(()=>{if(q)return;(async()=>{try{const n=await fetch("/api/supabase-watchlist");if(n.ok){const i=await n.json(),S=Array.isArray(i.tickers)?i.tickers:[];console.log("‚úÖ Watchlist charg√©e depuis Supabase:",S),T(S),localStorage.setItem("dans-watchlist",JSON.stringify(S)),C(S),se(!0);return}}catch{console.log("‚ö†Ô∏è Supabase non disponible, utilisation du localStorage")}const x=localStorage.getItem("dans-watchlist");if(x){const n=JSON.parse(x);console.log("üì¶ Watchlist charg√©e depuis localStorage:",n),T(n),C(n)}se(!0)})()},[]);const B=async(d,x)=>{for(const n of d)try{const i=await M(n);i&&!i.message&&(x[n]={...i,timestamp:new Date().toISOString()})}catch(i){console.error(`Erreur pour ${n}:`,i?.message||String(i))}},C=async(d,x=!1)=>{if(d.length===0)return;ne(!0);const n={};try{if(d.length>1){console.log(`üöÄ Batch loading ${d.length} tickers...`);const i=d.join(","),S=await fetch(`${h}/api/marketdata/batch?symbols=${i}&endpoints=quote,fundamentals`);if(S.ok){const c=await S.json();if(console.log(`‚úÖ Batch loaded: ${c.metadata?.total_data_points||"N/A"} data points`),console.log(`üí∞ API Calls Saved: ${c.metadata?.api_calls_saved||"N/A"}`),c.success&&c.data){const g=c.data.quote||{},j=c.data.fundamentals||{};d.forEach(m=>{const s=m.toUpperCase(),o=g[s],a=j[s];(o||a)&&(n[m]={symbol:s,price:o?.c||a?.quote?.price||0,change:o?.d||a?.quote?.change||0,changePercent:o?.dp||a?.quote?.changesPercentage||0,profile:a?.profile||null,ratios:a?.ratios||null,source:o?.source||a?.source||"batch",timestamp:new Date().toISOString()})})}}else console.warn("‚ö†Ô∏è Batch endpoint failed, falling back to individual requests"),await B(d,n)}else await B(d,n)}catch(i){console.error("‚ùå Batch loading error:",i),await B(d,n)}O(x?i=>({...i,...n}):n),ne(!1)},oe=async()=>{if(!z.trim())return;const d=z.trim().toUpperCase();if(u.includes(d)){L("Ce ticker est d√©j√† dans la watchlist","warning");return}const x=[...u,d];T(x),localStorage.setItem("dans-watchlist",JSON.stringify(x)),P(""),console.log(`‚úÖ ${d} ajout√© √† la watchlist`),O(n=>({...n,[d]:{symbol:d,loading:!0,timestamp:new Date().toISOString()}})),C([d],!0).catch(n=>{console.error("Erreur chargement:",n)}),ce(d,"add").catch(n=>{console.error("Erreur sauvegarde Supabase:",n)})},ue=async d=>{const x=u.filter(n=>n!==d);T(x),localStorage.setItem("dans-watchlist",JSON.stringify(x)),O(n=>{const i={...n};return delete i[d],i}),console.log(`‚úÖ ${d} supprim√© de la watchlist`),ce(d,"remove").catch(n=>{console.error("Erreur sauvegarde Supabase:",n)})},ie=async()=>{await C(u),console.log("‚úÖ Watchlist actualis√©e silencieusement")};let Y=null;const ce=async(d,x)=>{Y&&clearTimeout(Y),Y=setTimeout(async()=>{try{const n=await fetch("/api/supabase-watchlist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:x,ticker:d})});if(!n.ok)throw new Error(`HTTP ${n.status}`);const i=await n.json();console.log(`‚úÖ Supabase: ${i.message}`)}catch(n){console.error("‚ö†Ô∏è Erreur sauvegarde Supabase:",n)}},500)};return p.useEffect(()=>{if(u.length>0){const d=document.getElementById("tradingview-ticker-dan-watchlist");d&&(d.innerHTML="");const x=u.map(S=>S.includes(".TO")||S.includes(".V")?{proName:`TSX:${S.replace(/\.(TO|V)/,"")}`,title:S}:{proName:`NASDAQ:${S}`,title:S}),n=document.createElement("script");n.type="text/javascript",n.src="https://s3.tradingview.com/external-embedding/embed-widget-ticker-tape.js",n.async=!0,n.innerHTML=JSON.stringify({symbols:x.slice(0,20),showSymbolLogo:!0,isTransparent:t,displayMode:"adaptive",colorTheme:t?"dark":"light",locale:"fr"});const i=document.getElementById("tradingview-ticker-dan-watchlist");i&&i.appendChild(n)}},[u,t]),e.jsxs("div",{className:"space-y-6",children:[u.length>0&&e.jsx("div",{className:`rounded-lg overflow-hidden border transition-colors duration-300 ${t?"border-gray-700 bg-gray-900":"border-gray-200 bg-white"}`,children:e.jsx("div",{className:"tradingview-widget-container",style:{height:"62px"},children:e.jsx("div",{id:"tradingview-ticker-dan-watchlist",style:{height:"100%"}})})}),re&&e.jsxs("div",{className:`border rounded-lg p-3 transition-colors duration-300 ${t?"bg-gray-900 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:"üîç"}),e.jsx("h3",{className:`text-sm font-bold ${t?"text-white":"text-gray-900"}`,children:"Screener - Dan's Watchlist"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",u.length," titres)"]})]}),e.jsx("button",{onClick:()=>K(!1),className:`p-1 rounded ${t?"hover:bg-gray-800":"hover:bg-gray-100"}`,children:e.jsx("span",{className:"text-gray-500",children:"‚úï"})})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-2 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] text-gray-500 mb-1 block",children:"Market Cap Min (B$)"}),e.jsx("input",{type:"number",value:r.minMarketCap/1e9,onChange:d=>l({...r,minMarketCap:parseFloat(d.target.value||0)*1e9}),className:`w-full px-2 py-1 text-xs rounded border ${t?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] text-gray-500 mb-1 block",children:"P/E Max"}),e.jsx("input",{type:"number",value:r.maxPE,onChange:d=>l({...r,maxPE:parseFloat(d.target.value||50)}),className:`w-full px-2 py-1 text-xs rounded border ${t?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] text-gray-500 mb-1 block",children:"ROE Min (%)"}),e.jsx("input",{type:"number",value:r.minROE,onChange:d=>l({...r,minROE:parseFloat(d.target.value||0)}),className:`w-full px-2 py-1 text-xs rounded border ${t?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] text-gray-500 mb-1 block",children:"D/E Max"}),e.jsx("input",{type:"number",step:"0.1",value:r.maxDebtEquity,onChange:d=>l({...r,maxDebtEquity:parseFloat(d.target.value||2)}),className:`w-full px-2 py-1 text-xs rounded border ${t?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] text-gray-500 mb-1 block",children:"Secteur"}),e.jsxs("select",{value:r.sector,onChange:d=>l({...r,sector:d.target.value}),className:`w-full px-2 py-1 text-xs rounded border ${t?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"all",children:"Tous"}),e.jsx("option",{value:"Technology",children:"Technologie"}),e.jsx("option",{value:"Consumer Cyclical",children:"Consommation"}),e.jsx("option",{value:"Healthcare",children:"Sant√©"}),e.jsx("option",{value:"Financial",children:"Finance"})]})]})]}),e.jsx("button",{onClick:y,disabled:R||u.length===0,className:`w-full py-2 rounded text-sm font-semibold transition-colors ${R?"bg-gray-400 cursor-not-allowed":"bg-gray-800 hover:bg-gray-700 text-white"}`,children:R?"‚è≥ Analyse en cours...":`üîç Analyser ma Watchlist (${u.length} titres)`}),de.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:[de.length," titre(s) correspondant aux crit√®res"]}),e.jsx("div",{className:`max-h-64 overflow-y-auto border rounded ${t?"border-gray-700":"border-gray-300"}`,children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{className:`sticky top-0 ${t?"bg-gray-800":"bg-gray-100"}`,children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 text-gray-500",children:"Symbole"}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"Prix"}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"Var %"}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"Cap."}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"P/E"}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"ROE"}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"D/E"})]})}),e.jsx("tbody",{children:de.map(d=>e.jsxs("tr",{className:`border-t ${t?"border-gray-700 hover:bg-gray-800":"border-gray-200 hover:bg-gray-50"}`,children:[e.jsxs("td",{className:"p-2",children:[e.jsx("div",{className:`font-bold ${t?"text-white":"text-gray-900"}`,children:d.symbol}),e.jsx("div",{className:"text-[9px] text-gray-500",children:d.name})]}),e.jsxs("td",{className:`text-right p-2 font-semibold ${t?"text-white":"text-gray-900"}`,children:["$",d.price.toFixed(2)]}),e.jsx("td",{className:`text-right p-2 font-semibold ${d.change>=0?"text-emerald-500":"text-red-500"}`,children:(()=>{const x=d.change;if(!x)return"0.00%";const n=typeof x=="number"?x:typeof x=="object"?x.raw||x.fmt||0:parseFloat(x)||0;return(n>=0?"+":"")+n.toFixed(2)+"%"})()}),e.jsx("td",{className:"text-right p-2 text-gray-400",children:k(d.marketCap)}),e.jsx("td",{className:`text-right p-2 font-semibold ${w("PE",d.pe)}`,children:d.pe?d.pe.toFixed(1):"N/A"}),e.jsx("td",{className:`text-right p-2 font-semibold ${w("ROE",d.roe?d.roe*100:null)}`,children:d.roe?(d.roe*100).toFixed(1)+"%":"N/A"}),e.jsx("td",{className:`text-right p-2 font-semibold ${w("DE",d.debtEquity)}`,children:d.debtEquity?d.debtEquity.toFixed(2):"N/A"})]},d.symbol))})]})})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:`text-2xl font-bold transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:"üëÄ Dan's Watchlist"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>K(!re),className:`px-4 py-2 rounded transition-colors ${re?"bg-gray-800 text-white":t?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-900"}`,children:re?"‚úï Fermer Screener":"üîç Ouvrir Screener"}),e.jsx("button",{onClick:ie,disabled:Q||u.length===0,className:"px-4 py-2 bg-gray-800 text-white rounded hover:bg-gray-700 disabled:opacity-50 transition-colors",children:Q?"Actualisation...":"üîÑ Actualiser"}),e.jsxs("button",{onClick:E,disabled:Q,className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 disabled:opacity-50 flex items-center gap-2",children:[e.jsx("span",{children:"ü§ñ"}),"Emma Populate"]}),e.jsx("div",{className:`text-sm px-4 py-2 rounded ${t?"bg-gray-800 text-gray-400":"bg-gray-100 text-gray-600"}`,children:I?"üöÄ Supabase + Arri√®re-plan silencieux":"‚è≥ Chargement initial..."})]})]}),e.jsxs("div",{className:`backdrop-blur-sm rounded-lg p-6 border transition-colors duration-300 ${t?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:"‚ûï Ajouter un Ticker"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:z,onChange:d=>P(d.target.value),placeholder:"Ex: AAPL, TSLA, GOOGL...",className:`flex-1 px-3 py-2 rounded-lg border transition-colors duration-300 ${t?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"}`,onKeyPress:d=>d.key==="Enter"&&oe()}),e.jsx("button",{onClick:oe,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors",children:"‚ûï Ajouter"})]}),e.jsx("p",{className:`text-sm mt-2 transition-colors duration-300 ${t?"text-gray-400":"text-gray-600"}`,children:"üí° Ces tickers ne seront visibles que dans cette watchlist personnalis√©e"})]}),u.length>0?e.jsxs("div",{className:`backdrop-blur-sm rounded-lg p-6 border transition-colors duration-300 ${t?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("h3",{className:`text-lg font-semibold mb-4 transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:["üìä Tickers de la Watchlist (",u.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:u.map(d=>{const x=H[d],n=x?.dp?(x.dp>=0?"+":"")+x.dp.toFixed(2)+"%":"N/A",i=x?.dp>=0?"text-green-400":"text-red-400",S=x?.dp>=0?"bg-green-500":"bg-red-500";return e.jsxs("div",{className:`rounded-lg p-4 border transition-colors duration-300 ${t?"bg-gray-800 border-gray-600 hover:border-blue-400/50":"bg-white border-gray-300 hover:border-blue-300"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:G(d),alt:`${d} logo`,className:"w-8 h-8 rounded",onError:c=>{c.target.style.display="none"}}),e.jsx("h4",{className:`font-bold text-lg transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:d})]}),e.jsx("button",{onClick:()=>ue(d),className:`p-1 rounded transition-colors duration-300 ${t?"text-gray-400 hover:text-red-400 hover:bg-red-900/20":"text-gray-500 hover:text-red-600 hover:bg-red-50"}`,title:"Supprimer de la watchlist",children:"‚úï"})]}),x?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`rounded-lg p-3 mb-3 transition-colors duration-300 ${t?"bg-gray-700":"bg-gray-100"}`,children:[e.jsxs("div",{className:`text-2xl font-bold mb-1 transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:["$",x.c?.toFixed(2)||"N/A"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 ${S} rounded`}),e.jsx("span",{className:`text-sm font-medium ${i}`,children:n})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:`transition-colors duration-300 ${t?"text-gray-400":"text-gray-600"}`,children:"Volume:"}),e.jsx("span",{className:`transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:x.v?.toLocaleString()||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:`transition-colors duration-300 ${t?"text-gray-400":"text-gray-600"}`,children:"High:"}),e.jsxs("span",{className:`transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:["$",x.h?.toFixed(2)||"N/A"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:`transition-colors duration-300 ${t?"text-gray-400":"text-gray-600"}`,children:"Low:"}),e.jsxs("span",{className:`transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:["$",x.l?.toFixed(2)||"N/A"]})]})]})]}):e.jsxs("div",{className:`text-center py-4 transition-colors duration-300 ${t?"text-gray-400":"text-gray-500"}`,children:[e.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-gray-400 border-t-transparent rounded-full mx-auto mb-2"}),e.jsx("span",{className:"text-sm",children:"Chargement..."})]})]},d)})})]}):e.jsxs("div",{className:`backdrop-blur-sm rounded-lg p-8 border transition-colors duration-300 ${t?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"} text-center`,children:[e.jsx("div",{className:"text-6xl mb-4",children:"üëÄ"}),e.jsx("h3",{className:`text-xl font-semibold mb-2 transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:"Watchlist Vide"}),e.jsx("p",{className:`transition-colors duration-300 ${t?"text-gray-400":"text-gray-600"}`,children:"Ajoutez des tickers pour commencer √† suivre vos investissements personnalis√©s"})]})]})},dt=D=>{const{isDarkMode:t=!0,tickers:b=[],stockData:F={},newsData:h=[],loading:M=!1,lastUpdate:L,setSelectedStock:G,setActiveTab:E,fetchNews:I,refreshAllStocks:u,loadTickersFromSupabase:T,fetchLatestNewsForTickers:z,LucideIcon:P,getCompanyLogo:H}=D,[O,Q]=p.useState("list"),[ne,re]=p.useState(null),K=r=>{const l=r==="bull";return e.jsx("span",{className:`w-9 h-9 rounded-full flex items-center justify-center text-xl font-semibold shadow-inner border ${l?t?"bg-lime-900/70 border-lime-500/40 text-lime-300":"bg-lime-100 border-lime-400 text-lime-700":t?"bg-rose-900/70 border-rose-500/40 text-rose-200":"bg-rose-100 border-rose-300 text-rose-700"}`,children:l?"üêÇ":"üêª"})},R=r=>{if(!r)return 50;const l=r.toLowerCase();return["bloomberg","reuters","wall street journal","wsj","financial times","ft"].some(q=>l.includes(q))?95:["cnbc","marketwatch","barron","seeking alpha","yahoo finance","morningstar","the economist"].some(q=>l.includes(q))?82:["forbes","benzinga","investor","zacks","motley fool","nasdaq","business insider"].some(q=>l.includes(q))?65:40},J=r=>r>=90?"premium":r>=75?"high":r>=50?"medium":"low",de=r=>!r&&r!==0?"N/A":r>=1e9?(r/1e9).toFixed(2)+"B":r>=1e6?(r/1e6).toFixed(2)+"M":r>=1e3?(r/1e3).toFixed(2)+"K":r.toLocaleString("fr-FR"),V={AAPL:"Apple Inc.",TSLA:"Tesla Inc.",GOOGL:"Alphabet Inc.",GOOG:"Alphabet Inc.",MSFT:"Microsoft Corporation",NVDA:"NVIDIA Corporation",AMZN:"Amazon.com Inc.",META:"Meta Platforms Inc.",NFLX:"Netflix Inc.",AMD:"Advanced Micro Devices Inc.",INTC:"Intel Corporation",CRM:"Salesforce Inc.",ORCL:"Oracle Corporation",CSCO:"Cisco Systems Inc.",ADBE:"Adobe Inc.",PYPL:"PayPal Holdings Inc.",DIS:"The Walt Disney Company",BA:"The Boeing Company",GE:"General Electric Company",JPM:"JPMorgan Chase & Co.",BAC:"Bank of America Corporation",WMT:"Walmart Inc.",HD:"The Home Depot Inc.",PG:"Procter & Gamble Company",JNJ:"Johnson & Johnson",V:"Visa Inc.",MA:"Mastercard Incorporated",UNH:"UnitedHealth Group Inc.",PFE:"Pfizer Inc.",MRK:"Merck & Co. Inc."};return e.jsxs("div",{className:"space-y-6",children:[b.length===0&&e.jsxs("div",{className:`p-6 rounded-xl border-2 transition-colors duration-300 ${t?"bg-gray-800 border-yellow-500/30":"bg-yellow-50 border-yellow-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"text-2xl",children:"‚è≥"}),e.jsx("h3",{className:`text-lg font-semibold ${t?"text-white":"text-gray-900"}`,children:"Chargement des donn√©es..."})]}),e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"Les titres et nouvelles sont en cours de chargement. Veuillez patienter quelques instants."}),e.jsx("button",{onClick:async()=>{await T(),await I()},className:`mt-4 px-4 py-2 rounded-lg font-semibold transition-all duration-300 ${t?"bg-blue-600 hover:bg-blue-700 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,children:"üîÑ Forcer le chargement"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:`text-2xl font-bold transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:"üìä Titres & nouvelles"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:`flex gap-1 p-1 rounded-lg transition-colors duration-300 ${t?"bg-gray-800":"bg-gray-200"}`,children:[e.jsx("button",{onClick:()=>Q("list"),className:`px-3 py-1 rounded text-sm font-medium transition-all duration-200 ${O==="list"?t?"bg-blue-600 text-white":"bg-blue-500 text-white":t?"text-gray-400 hover:text-white":"text-gray-600 hover:text-gray-900"}`,children:"üìã Liste"}),e.jsx("button",{onClick:()=>Q("cards"),className:`px-3 py-1 rounded text-sm font-medium transition-all duration-200 ${O==="cards"?t?"bg-blue-600 text-white":"bg-blue-500 text-white":t?"text-gray-400 hover:text-white":"text-gray-600 hover:text-gray-900"}`,children:"üé¥ Cartes"}),e.jsx("button",{onClick:()=>Q("table"),className:`px-3 py-1 rounded text-sm font-medium transition-all duration-200 ${O==="table"?t?"bg-blue-600 text-white":"bg-blue-500 text-white":t?"text-gray-400 hover:text-white":"text-gray-600 hover:text-gray-900"}`,children:"üìä Tableau"})]}),e.jsx("button",{onClick:async()=>{await u(),await I(),await z()},disabled:M,className:`px-4 py-2 rounded-lg font-semibold transition-all duration-300 disabled:opacity-50 ${t?"bg-gray-800 hover:bg-gray-700 text-white":"bg-gray-700 hover:bg-gray-600 text-white"}`,children:M?"‚è≥ Actualisation...":"üîÑ Actualiser"})]})]}),L&&e.jsxs("p",{className:"text-gray-400 text-sm",children:["Derni√®re mise √† jour: ",new Date(L).toLocaleString("fr-FR")]}),b.length>0&&e.jsxs("div",{className:`mt-6 p-6 rounded-xl transition-colors duration-300 ${t?"bg-gradient-to-br from-gray-800 to-gray-900 border border-gray-700":"bg-gradient-to-br from-white to-gray-50 border border-gray-200"}`,children:[e.jsxs("h3",{className:`text-xl font-bold mb-4 flex items-center gap-2 ${t?"text-white":"text-gray-900"}`,children:[e.jsx(P,{name:"Fire",className:"w-6 h-6 text-orange-500"}),"Top Movers du Jour"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:`p-3 sm:p-4 rounded-lg ${t?"bg-green-500/10 border border-green-500/30":"bg-green-50 border border-green-200"}`,children:[e.jsxs("h4",{className:`text-base sm:text-sm font-bold mb-3 sm:mb-3 flex items-center gap-3 ${t?"text-green-400":"text-green-700"}`,children:[e.jsx(P,{name:"TrendingUp",className:"w-5 h-5"}),K("bull"),"Top Gainers"]}),e.jsx("div",{className:"space-y-2.5 sm:space-y-2",children:b.map(r=>({ticker:r,change:F[r]?.dp||0,price:F[r]?.c||0})).filter(r=>r.change>0).sort((r,l)=>l.change-r.change).slice(0,5).map((r,l)=>e.jsx("div",{className:`flex items-start justify-between p-2 sm:p-2 rounded cursor-pointer transition-all hover:scale-[1.02] ${t?"hover:bg-green-500/20":"hover:bg-green-100"}`,onClick:()=>{G(r.ticker),E("intellistocks")},children:e.jsxs("div",{className:"flex-1 min-w-0 pr-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 ${t?"bg-green-500/30 text-green-300":"bg-green-100 text-green-700"}`,children:l+1}),e.jsx("img",{src:H(r.ticker),alt:r.ticker,className:"w-6 h-6 rounded flex-shrink-0",onError:y=>y.target.style.display="none"}),e.jsx("span",{className:`font-mono font-bold text-sm ${t?"text-white":"text-gray-900"} flex-shrink-0`,children:r.ticker}),e.jsxs("div",{className:"text-green-500 font-bold text-sm ml-auto flex-shrink-0",children:["+",r.change.toFixed(2),"% ‚Üë"]}),e.jsxs("div",{className:`text-xs ${t?"text-gray-400":"text-gray-600"} flex-shrink-0`,children:["$",r.price.toFixed(2)]})]}),e.jsx("div",{className:`mt-1 ml-8 min-h-[20px] ${t?"text-gray-400":"text-gray-600"}`,children:(()=>{const y=extractMoveReason(r.ticker,r.change);return y&&y!==""?e.jsx("div",{className:`text-xs flex items-start gap-2 leading-relaxed ${t?"text-gray-300":"text-gray-700"}`,children:tickerMoveReasons[r.ticker]?.source==="Finviz AI"?e.jsxs("span",{className:"inline-flex items-center gap-1.5 flex-wrap",children:[e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-semibold bg-blue-500/20 text-blue-300 border border-blue-500/30 flex-shrink-0",children:"AI"}),e.jsx("span",{className:"leading-relaxed break-words",children:y})]}):e.jsxs("span",{className:"inline-flex items-start gap-1.5",children:[e.jsx("span",{className:"text-blue-400 flex-shrink-0 text-sm",children:"üì∞"}),e.jsx("span",{className:"leading-relaxed break-words",children:y})]})}):e.jsx("div",{className:`text-xs italic ${t?"text-gray-600":"text-gray-400"}`,children:"Chargement des explications..."})})()})]})},r.ticker))})]}),e.jsxs("div",{className:`p-4 rounded-lg ${t?"bg-red-500/10 border border-red-500/30":"bg-red-50 border border-red-200"}`,children:[e.jsxs("h4",{className:`text-sm font-bold mb-3 flex items-center gap-3 ${t?"text-red-400":"text-red-700"}`,children:[e.jsx(P,{name:"TrendingDown",className:"w-5 h-5"}),K("bear"),"Top Losers"]}),e.jsx("div",{className:"space-y-2",children:b.map(r=>({ticker:r,change:F[r]?.dp||0,price:F[r]?.c||0})).filter(r=>r.change<0).sort((r,l)=>r.change-l.change).slice(0,5).map((r,l)=>e.jsx("div",{className:`flex items-start justify-between p-2 rounded cursor-pointer transition-all hover:scale-[1.02] ${t?"hover:bg-red-500/20":"hover:bg-red-100"}`,onClick:()=>{G(r.ticker),E("intellistocks")},children:e.jsxs("div",{className:"flex-1 min-w-0 pr-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 ${t?"bg-red-500/30 text-red-300":"bg-red-100 text-red-700"}`,children:l+1}),e.jsx("img",{src:H(r.ticker),alt:r.ticker,className:"w-6 h-6 rounded flex-shrink-0",onError:y=>y.target.style.display="none"}),e.jsx("span",{className:`font-mono font-bold text-sm ${t?"text-white":"text-gray-900"} flex-shrink-0`,children:r.ticker}),e.jsxs("div",{className:"text-red-500 font-bold text-sm ml-auto flex-shrink-0",children:[r.change.toFixed(2),"% ‚Üì"]}),e.jsxs("div",{className:`text-xs ${t?"text-gray-400":"text-gray-600"} flex-shrink-0`,children:["$",r.price.toFixed(2)]})]}),e.jsx("div",{className:`mt-1 ml-8 min-h-[20px] ${t?"text-gray-400":"text-gray-600"}`,children:(()=>{const y=extractMoveReason(r.ticker,r.change);return y&&y!==""?e.jsx("div",{className:`text-xs flex items-start gap-2 leading-relaxed ${t?"text-gray-300":"text-gray-700"}`,children:tickerMoveReasons[r.ticker]?.source==="Finviz AI"?e.jsxs("span",{className:"inline-flex items-center gap-1.5 flex-wrap",children:[e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-semibold bg-blue-500/20 text-blue-300 border border-blue-500/30 flex-shrink-0",children:"AI"}),e.jsx("span",{className:"leading-relaxed break-words",children:y})]}):e.jsxs("span",{className:"inline-flex items-start gap-1.5",children:[e.jsx("span",{className:"text-blue-400 flex-shrink-0 text-sm",children:"üì∞"}),e.jsx("span",{className:"leading-relaxed break-words",children:y})]})}):e.jsx("div",{className:`text-xs italic ${t?"text-gray-600":"text-gray-400"}`,children:"Chargement des explications..."})})()})]})},r.ticker))})]})]})]}),b.length>0&&Object.keys(F).length>0&&e.jsxs("div",{className:`mt-6 p-6 rounded-xl transition-colors duration-300 ${t?"bg-gradient-to-br from-gray-800 to-gray-900 border border-gray-700":"bg-gradient-to-br from-white to-gray-50 border border-gray-200"}`,children:[e.jsxs("h3",{className:`text-xl font-bold mb-4 flex items-center gap-2 ${t?"text-white":"text-gray-900"}`,children:[e.jsx(P,{name:"Target",className:"w-6 h-6 text-indigo-500"}),"Analyses & Opinions d'Analystes"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:b.map(r=>{const y=F[r]?.recommendation?.[0];if(!y)return null;const w=(y.buy||0)+(y.hold||0)+(y.sell||0)+(y.strongBuy||0)+(y.strongSell||0);if(w===0)return null;const k=(y.strongBuy||0)*2+(y.buy||0),q=(y.strongSell||0)*2+(y.sell||0),se=y.hold||0;let B="Hold",C="yellow";return k>q&&k>se?(B="Buy",C="green"):q>k&&q>se&&(B="Sell",C="red"),{ticker:r,totalAnalysts:w,consensus:B,consensusColor:C,buyScore:k,sellScore:q,holdScore:se,recommendation:y}}).filter(r=>r!==null).sort((r,l)=>l.totalAnalysts-r.totalAnalysts).slice(0,6).map(r=>e.jsxs("div",{className:`p-4 rounded-lg cursor-pointer transition-all hover:scale-[1.02] ${t?"bg-gray-700/50 hover:bg-gray-700/70 border border-gray-600":"bg-white hover:bg-gray-50 border border-gray-200"}`,onClick:()=>{G(r.ticker),E("intellistocks")},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:H(r.ticker),alt:r.ticker,className:"w-8 h-8 rounded",onError:l=>l.target.style.display="none"}),e.jsx("span",{className:`font-mono font-bold text-lg ${t?"text-white":"text-gray-900"}`,children:r.ticker})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-bold ${r.consensusColor==="green"?"bg-green-500/20 text-green-500 border border-green-500/30":r.consensusColor==="red"?"bg-red-500/20 text-red-500 border border-red-500/30":"bg-yellow-500/20 text-yellow-500 border border-yellow-500/30"}`,children:r.consensus==="Buy"?"ACHAT":r.consensus==="Sell"?"VENTE":"CONSERVER"})]}),e.jsxs("div",{className:`text-sm mb-2 ${t?"text-gray-300":"text-gray-600"}`,children:[r.totalAnalysts," analyste",r.totalAnalysts>1?"s":""]}),e.jsxs("div",{className:"space-y-1.5",children:[r.recommendation.strongBuy>0&&e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:t?"text-gray-400":"text-gray-600",children:"Strong Buy"}),e.jsx("span",{className:"font-bold text-green-500",children:r.recommendation.strongBuy})]}),r.recommendation.buy>0&&e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:t?"text-gray-400":"text-gray-600",children:"Buy"}),e.jsx("span",{className:"font-bold text-green-400",children:r.recommendation.buy})]}),r.recommendation.hold>0&&e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:t?"text-gray-400":"text-gray-600",children:"Hold"}),e.jsx("span",{className:"font-bold text-yellow-500",children:r.recommendation.hold})]}),r.recommendation.sell>0&&e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:t?"text-gray-400":"text-gray-600",children:"Sell"}),e.jsx("span",{className:"font-bold text-red-400",children:r.recommendation.sell})]}),r.recommendation.strongSell>0&&e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:t?"text-gray-400":"text-gray-600",children:"Strong Sell"}),e.jsx("span",{className:"font-bold text-red-500",children:r.recommendation.strongSell})]})]}),e.jsx("div",{className:`mt-3 pt-3 border-t ${t?"border-gray-600":"border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{name:"ArrowUpRight",className:"w-3 h-3 text-gray-400"}),e.jsx("span",{className:`text-xs ${t?"text-gray-400":"text-gray-600"}`,children:"Cliquer pour analyse compl√®te"})]})})]},r.ticker))}),b.filter(r=>{const y=F[r]?.recommendation?.[0];return y&&(y.buy||0)+(y.hold||0)+(y.sell||0)+(y.strongBuy||0)+(y.strongSell||0)>0}).length===0&&e.jsxs("div",{className:`text-center py-8 ${t?"text-gray-400":"text-gray-600"}`,children:[e.jsx(P,{name:"AlertCircle",className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Aucune recommandation d'analyste disponible pour le moment"}),e.jsx("p",{className:"text-sm mt-2",children:"Les donn√©es seront charg√©es lors de la prochaine actualisation"})]})]}),O==="list"&&e.jsx("div",{className:"mt-8",children:e.jsxs("div",{className:`backdrop-blur-sm rounded-2xl p-8 border-2 shadow-2xl transition-colors duration-300 ${t?"bg-gradient-to-br from-gray-800/90 to-gray-900/90 border-blue-500/30 shadow-blue-500/10":"bg-gradient-to-br from-white/95 to-gray-50/95 border-blue-400/40 shadow-blue-400/10"}`,children:[e.jsx("h2",{className:`text-2xl font-bold mb-6 transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:"üìä Titres - Vue Liste"}),b.length===0?e.jsxs("div",{className:`text-center py-12 ${t?"text-gray-400":"text-gray-600"}`,children:[e.jsx("p",{className:"text-lg font-semibold mb-2",children:"Aucun titre disponible"}),e.jsx("p",{className:"text-sm",children:"Les donn√©es sont en cours de chargement..."})]}):Object.keys(F).length===0?e.jsxs("div",{className:`text-center py-12 ${t?"text-gray-400":"text-gray-600"}`,children:[e.jsx("p",{className:"text-lg font-semibold mb-2",children:"Chargement des donn√©es de march√©..."}),e.jsx("p",{className:"text-sm",children:"Veuillez patienter quelques instants"})]}):e.jsx("div",{className:"space-y-3",children:b.map(r=>{const l=F[r]||{},y=l.c||l.price||0;l.d||l.change;const w=l.dp||l.changePercent||0,k=w>=0;return e.jsxs("div",{className:`flex items-center justify-between p-4 rounded-xl cursor-pointer transition-all hover:scale-[1.01] ${t?"bg-gray-700/50 hover:bg-gray-700/70 border border-gray-600":"bg-white hover:bg-gray-50 border border-gray-200"}`,onClick:()=>{G(r),E("intellistocks")},children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("img",{src:H(r),alt:r,className:"w-12 h-12 rounded-lg",onError:q=>q.target.style.display="none"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`font-mono font-bold text-lg ${t?"text-white":"text-gray-900"}`,children:r}),e.jsx("div",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:V[r]||r}),e.jsx("div",{className:`mt-2 min-h-[20px] ${t?"text-gray-400":"text-gray-600"}`,children:extractMoveReason(r,w)?e.jsx("div",{className:`text-xs flex items-start gap-2 ${t?"text-gray-300":"text-gray-700"}`,children:tickerMoveReasons[r]?.source==="Finviz AI"?e.jsxs("span",{className:"inline-flex items-center gap-1.5 flex-wrap",children:[e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-semibold bg-blue-500/20 text-blue-300 border border-blue-500/30 flex-shrink-0",children:"AI"}),e.jsx("span",{className:"leading-relaxed",children:extractMoveReason(r,w)})]}):e.jsxs("span",{className:"inline-flex items-start gap-1.5",children:[e.jsx("span",{className:"text-blue-400 flex-shrink-0",children:"üì∞"}),e.jsx("span",{className:"leading-relaxed",children:extractMoveReason(r,w)})]})}):tickerLatestNews[r]?e.jsxs("div",{className:"text-xs text-gray-500",children:["üì∞ ",e.jsx("span",{className:"italic",children:tickerLatestNews[r].title.length>70?tickerLatestNews[r].title.substring(0,70)+"...":tickerLatestNews[r].title})]}):e.jsx("div",{className:`text-xs italic ${t?"text-gray-600":"text-gray-400"}`,children:"Chargement des explications..."})})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`font-bold text-xl ${t?"text-white":"text-gray-900"}`,children:["$",y.toFixed(2)]}),e.jsxs("div",{className:`font-semibold ${k?"text-green-500":"text-red-500"}`,children:[k?"+":"",w.toFixed(2),"%"]})]})]},r)})})]})}),O==="cards"&&e.jsx("div",{className:"mt-8",children:e.jsxs("div",{className:`backdrop-blur-sm rounded-2xl p-8 border-2 shadow-2xl transition-colors duration-300 ${t?"bg-gradient-to-br from-gray-800/90 to-gray-900/90 border-blue-500/30 shadow-blue-500/10":"bg-gradient-to-br from-white/95 to-gray-50/95 border-blue-400/40 shadow-blue-400/10"}`,children:[e.jsx("h2",{className:`text-2xl font-bold mb-6 transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:"üé¥ Titres - Vue Cartes"}),b.length===0?e.jsxs("div",{className:`text-center py-12 ${t?"text-gray-400":"text-gray-600"}`,children:[e.jsx("p",{className:"text-lg font-semibold mb-2",children:"Aucun titre disponible"}),e.jsx("p",{className:"text-sm",children:"Les donn√©es sont en cours de chargement..."})]}):Object.keys(F).length===0?e.jsxs("div",{className:`text-center py-12 ${t?"text-gray-400":"text-gray-600"}`,children:[e.jsx("p",{className:"text-lg font-semibold mb-2",children:"Chargement des donn√©es de march√©..."}),e.jsx("p",{className:"text-sm",children:"Veuillez patienter quelques instants"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:b.map(r=>{const l=F[r]||{},y=l.c||l.price||0,w=l.d||l.change||0,k=l.dp||l.changePercent||0,q=l.h||0,se=l.l||0,B=l.v||0,C=k>=0;return e.jsxs("div",{className:`p-6 rounded-xl cursor-pointer transition-all hover:scale-[1.02] ${t?"bg-gradient-to-br from-gray-700/50 to-gray-800/50 hover:from-gray-700/70 hover:to-gray-800/70 border border-gray-600":"bg-gradient-to-br from-white to-gray-50 hover:from-gray-50 hover:to-gray-100 border border-gray-200 shadow-lg"}`,onClick:()=>{G(r),E("intellistocks")},children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:H(r),alt:r,className:"w-14 h-14 rounded-xl",onError:oe=>oe.target.style.display="none"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`font-mono font-bold text-xl ${t?"text-white":"text-gray-900"}`,children:r}),e.jsx("div",{className:`text-xs ${t?"text-gray-400":"text-gray-600"}`,children:V[r]||r}),e.jsx("div",{className:`mt-2 min-h-[24px] ${t?"text-gray-400":"text-gray-600"}`,children:extractMoveReason(r,k)?e.jsx("div",{className:`text-xs flex items-start gap-2 ${t?"text-gray-300":"text-gray-700"}`,children:tickerMoveReasons[r]?.source==="Finviz AI"?e.jsxs("span",{className:"inline-flex items-center gap-1.5 flex-wrap",children:[e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-semibold bg-blue-500/20 text-blue-300 border border-blue-500/30 flex-shrink-0",children:"AI"}),e.jsx("span",{className:"leading-relaxed",children:extractMoveReason(r,k)})]}):e.jsxs("span",{className:"inline-flex items-start gap-1.5",children:[e.jsx("span",{className:"text-blue-400 flex-shrink-0",children:"üì∞"}),e.jsx("span",{className:"leading-relaxed",children:extractMoveReason(r,k)})]})}):tickerLatestNews[r]?e.jsxs("div",{className:"text-xs text-gray-500",children:["üì∞ ",e.jsx("span",{className:"italic",children:tickerLatestNews[r].title.length>60?tickerLatestNews[r].title.substring(0,60)+"...":tickerLatestNews[r].title})]}):e.jsx("div",{className:`text-xs italic ${t?"text-gray-600":"text-gray-400"}`,children:"Chargement des explications..."})})]})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-bold ${C?"bg-green-500/20 text-green-500 border border-green-500/30":"bg-red-500/20 text-red-500 border border-red-500/30"}`,children:C?"‚ñ≤":"‚ñº"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:`text-3xl font-bold mb-1 ${t?"text-white":"text-gray-900"}`,children:["$",y.toFixed(2)]}),e.jsxs("div",{className:`text-lg font-semibold ${C?"text-green-500":"text-red-500"}`,children:[C?"+":"",w.toFixed(2)," (",C?"+":"",k.toFixed(2),"%)"]})]}),e.jsxs("div",{className:`grid grid-cols-2 gap-2 pt-4 border-t ${t?"border-gray-600":"border-gray-200"}`,children:[e.jsxs("div",{children:[e.jsx("div",{className:`text-xs ${t?"text-gray-400":"text-gray-600"}`,children:"Haut"}),e.jsxs("div",{className:`font-bold ${t?"text-white":"text-gray-900"}`,children:["$",q.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("div",{className:`text-xs ${t?"text-gray-400":"text-gray-600"}`,children:"Bas"}),e.jsxs("div",{className:`font-bold ${t?"text-white":"text-gray-900"}`,children:["$",se.toFixed(2)]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:`text-xs ${t?"text-gray-400":"text-gray-600"}`,children:"Volume"}),e.jsx("div",{className:`font-bold ${t?"text-white":"text-gray-900"}`,children:de(B)})]})]})]},r)})})]})}),O==="table"&&e.jsx("div",{className:"mt-8",children:e.jsxs("div",{className:`backdrop-blur-sm rounded-2xl p-8 border-2 shadow-2xl transition-colors duration-300 ${t?"bg-gradient-to-br from-gray-800/90 to-gray-900/90 border-blue-500/30 shadow-blue-500/10":"bg-gradient-to-br from-white/95 to-gray-50/95 border-blue-400/40 shadow-blue-400/10"}`,children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:`text-2xl font-bold mb-3 transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:"üìä Donn√©es Financi√®res & Actualit√©s"}),e.jsxs("div",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-300 ${t?"bg-gray-600/20 text-gray-300 border border-gray-500/30":"bg-gray-700/80 text-gray-200 border border-gray-600/50"}`,children:[e.jsx("span",{className:"mr-2",children:"üîó"}),"Source: Finnhub API"]}),e.jsx("p",{className:`text-sm mt-3 transition-colors duration-300 ${t?"text-gray-300":"text-gray-600"}`,children:"Donn√©es en temps r√©el avec 3 actualit√©s par titre"})]}),e.jsx("div",{className:"overflow-x-auto max-h-[70vh] overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-200 dark:scrollbar-thumb-gray-600 dark:scrollbar-track-gray-800 relative text-sm",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:`border-b-2 transition-colors duration-300 ${t?"border-blue-500/50 bg-gray-900":"border-blue-400/50 bg-gray-100"}`,children:[e.jsx("th",{className:`text-left py-2 px-3 font-bold transition-colors duration-300 ${t?"text-blue-300":"text-blue-700"}`,children:"üìà Ticker"}),e.jsx("th",{className:`text-left py-2 px-3 font-bold transition-colors duration-300 ${t?"text-blue-300":"text-blue-700"}`,children:"üí∞ Prix"}),e.jsx("th",{className:`text-left py-2 px-3 font-bold transition-colors duration-300 ${t?"text-blue-300":"text-blue-700"}`,children:"üìä Change"}),e.jsx("th",{className:`text-left py-2 px-3 font-bold transition-colors duration-300 ${t?"text-blue-300":"text-blue-700"}`,children:"üìà P/E"}),e.jsx("th",{className:`text-left py-2 px-3 font-bold transition-colors duration-300 ${t?"text-blue-300":"text-blue-700"}`,children:"üíé Dividende"}),e.jsx("th",{className:`text-left py-2 px-3 font-bold transition-colors duration-300 ${t?"text-blue-300":"text-blue-700"}`,children:"üè¢ Secteur"}),e.jsx("th",{className:`text-left py-2 px-3 font-bold transition-colors duration-300 ${t?"text-blue-300":"text-blue-700"}`,children:"‚≠ê Rating"}),e.jsx("th",{className:`text-left py-2 px-3 font-bold transition-colors duration-300 ${t?"text-blue-300":"text-blue-700"}`,children:"üòä Sentiment"}),e.jsx("th",{className:`text-left py-2 px-3 font-bold transition-colors duration-300 ${t?"text-blue-300":"text-blue-700"}`,children:"‚ö° Actions"})]})}),e.jsx("tbody",{children:b.map(r=>{const l=F[r],y=l?.c?`$${l.c.toFixed(2)}`:"N/A",w=l?.d?`${l.d>0?"+":""}${l.d.toFixed(2)}`:"N/A",k=l?.dp?`${l.dp>0?"+":""}${l.dp.toFixed(2)}%`:"N/A",q=l?.d>0?"text-green-400":l?.d<0?"text-red-400":"text-gray-400",se=l?.profile,B=l?.fundamentals,C=B?.peRatio?Number.isFinite(B.peRatio)?B.peRatio.toFixed(2):B.peRatio:se?.pe?se.pe.toFixed(2):"N/A",oe=B?.dividendYield?`${(Number(B.dividendYield)*100).toFixed(2)}%`:se?.dividend?`${(se.dividend*100).toFixed(2)}%`:"N/A",ue=B?.sector||se?.industry||"N/A",ie=l?.recommendation,Y=ie?.length>0?ie[0].buy+ie[0].strongBuy>ie[0].sell+ie[0].strongSell?"Achat":ie[0].sell+ie[0].strongSell>ie[0].buy+ie[0].strongBuy?"Vente":"Neutre":"N/A",ce=sortNewsByCredibility(h.filter(n=>(n.title+" "+n.description).toLowerCase().includes(r.toLowerCase()))).slice(0,2),d=(n,i)=>{const S=(n+" "+i).toLowerCase(),c=["hausse","croissance","gain","profit","positif","am√©lioration","succ√®s","fort","solide"],g=["baisse","chute","perte","n√©gatif","d√©clin","faible","probl√®me","risque","inqui√©tude"],j=c.filter(s=>S.includes(s)).length,m=g.filter(s=>S.includes(s)).length;return j>m?{sentiment:"Positif",color:"text-green-400"}:m>j?{sentiment:"N√©gatif",color:"text-red-400"}:{sentiment:"Neutre",color:"text-gray-400"}},x=ce.length>0?d(ce[0].title,ce[0].description):{sentiment:"N/A"};return e.jsxs(et.Fragment,{children:[e.jsxs("tr",{className:`border-b-2 transition-all duration-300 hover:scale-[1.02] ${t?"border-gray-600/50 hover:bg-gradient-to-r hover:from-gray-800/80 hover:to-gray-700/80 hover:shadow-lg hover:shadow-blue-500/10":"border-gray-300/50 hover:bg-gradient-to-r hover:from-gray-50/80 hover:to-white/80 hover:shadow-lg hover:shadow-blue-400/10"}`,children:[e.jsx("td",{className:"py-4 px-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:H(r),alt:`${r} logo`,className:"w-8 h-8 rounded-lg shadow-md",onError:n=>{n.target.style.display="none"}}),e.jsx("span",{className:`font-mono font-bold text-xl transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:r})]})}),e.jsx("td",{className:`py-2 px-3 font-bold transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:y}),e.jsxs("td",{className:`py-2 px-3 font-semibold transition-colors duration-300 ${q}`,children:[w," (",k,")"]}),e.jsx("td",{className:`py-2 px-3 font-medium transition-colors duration-300 ${t?"text-gray-200":"text-gray-700"}`,children:C}),e.jsx("td",{className:`py-2 px-3 font-medium transition-colors duration-300 ${t?"text-green-300":"text-green-600"}`,children:oe}),e.jsx("td",{className:`py-2 px-3 text-sm transition-colors duration-300 ${t?"text-gray-300":"text-gray-600"}`,children:cleanText(ue)}),e.jsx("td",{className:"py-4 px-3",children:e.jsx("span",{className:`px-4 py-2 rounded-full text-sm font-bold transition-colors duration-300 ${Y==="Achat"?"bg-green-500 text-white":Y==="Vente"?"bg-red-500 text-white":"bg-yellow-500 text-black"}`,children:Y})}),e.jsx("td",{className:"py-4 px-3",children:e.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-full transition-colors duration-300 ${x.sentiment==="Positif"?"bg-green-100 text-green-800":x.sentiment==="N√©gatif"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:[e.jsx("span",{className:"text-lg",children:x.sentiment==="Positif"?"üòä":x.sentiment==="N√©gatif"?"üòü":"üòê"}),e.jsx("span",{className:"font-semibold",children:x.sentiment})]})}),e.jsx("td",{className:"py-4 px-3",children:e.jsx("button",{onClick:()=>{G(r),E("intellistocks")},className:`px-4 py-2 text-xs font-semibold rounded-lg transition-all duration-300 hover:scale-[1.02] shadow ${t?"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 text-white shadow-blue-500/25":"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-400 hover:to-blue-500 text-white shadow-blue-400/25"}`,children:"üìä Voir dans JLab"})})]}),finvizNews[r]&&e.jsx("tr",{className:`border-b-2 transition-all duration-300 ${t?"border-purple-500/30 bg-gradient-to-r from-purple-900/20 to-indigo-900/20 hover:from-purple-900/30 hover:to-indigo-900/30":"border-purple-400/30 bg-gradient-to-r from-purple-50/60 to-indigo-50/60 hover:from-purple-100/80 hover:to-indigo-100/80"}`,children:e.jsx("td",{colSpan:"9",className:"py-4 px-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-full ${t?"bg-purple-500/20":"bg-purple-100"}`,children:e.jsx(P,{name:"Sparkles",className:"w-5 h-5 text-purple-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`text-xs font-bold px-2 py-0.5 rounded ${t?"bg-purple-500/30 text-purple-300":"bg-purple-200 text-purple-700"}`,children:"üî• CE QUI BOUGE"}),e.jsx("span",{className:`text-xs ${t?"text-gray-400":"text-gray-600"}`,children:finvizNews[r].date})]}),e.jsx("p",{className:`text-sm font-medium leading-relaxed ${t?"text-gray-200":"text-gray-800"}`,children:finvizNews[r].headline}),finvizNews[r].link&&e.jsxs("a",{href:finvizNews[r].link,target:"_blank",rel:"noopener noreferrer",onClick:n=>n.stopPropagation(),className:`text-xs mt-2 inline-flex items-center gap-1 hover:underline ${t?"text-purple-400":"text-purple-600"}`,children:[e.jsx(P,{name:"ExternalLink",className:"w-3 h-3"}),"Lire l'article complet"]})]})]})})}),ce.map((n,i)=>e.jsx("tr",{className:`border-b-2 transition-all duration-300 hover:scale-[1.01] ${t?"border-gray-600/30 bg-gradient-to-r from-gray-800/40 to-gray-700/40 hover:from-gray-700/60 hover:to-gray-600/60":"border-gray-300/30 bg-gradient-to-r from-gray-50/60 to-white/60 hover:from-gray-100/80 hover:to-gray-50/80"}`,children:e.jsx("td",{colSpan:"9",className:"py-6 px-4",children:e.jsx("div",{className:`transition-colors duration-300 ${t?"text-gray-200":"text-gray-700"}`,children:e.jsxs("div",{className:"flex items-start gap-4",children:[(()=>{const S=getNewsIcon(n.title,n.description,n.sentiment);return e.jsx("div",{className:`p-3 rounded-full transition-colors duration-300 ${t?"bg-gray-600/20":"bg-gray-200/60"}`,children:e.jsx(P,{name:S.icon,className:`w-6 h-6 ${S.color}`})})})(),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:`font-bold text-lg mb-3 transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:n.url?e.jsx("a",{href:n.url,target:"_blank",rel:"noopener noreferrer",className:`hover:underline transition-colors duration-300 ${t?"text-blue-300 hover:text-blue-200":"text-blue-600 hover:text-blue-700"}`,children:cleanText(n.title)}):cleanText(n.title)}),e.jsx("p",{className:`text-base mb-4 leading-relaxed transition-colors duration-300 ${t?"text-gray-300":"text-gray-600"}`,children:cleanText(n.description)}),e.jsxs("div",{className:`flex items-center gap-4 text-sm transition-colors duration-300 ${t?"text-gray-400":"text-gray-500"}`,children:[e.jsx("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full transition-colors duration-300 ${t?"bg-gray-800":"bg-gray-200"}`,children:e.jsx("span",{className:"font-semibold",children:n.source?.name||"Source inconnue"})}),e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full transition-colors duration-300 ${t?"bg-gray-800":"bg-gray-200"}`,children:[e.jsx("span",{children:"üïí"}),e.jsx("span",{children:n.publishedAt?new Date(n.publishedAt).toLocaleString("fr-FR"):"Date inconnue"})]}),n.url&&e.jsx("a",{href:n.url,target:"_blank",rel:"noopener noreferrer",className:`px-4 py-2 rounded-full font-semibold transition-all duration-300 hover:scale-105 ${t?"bg-gray-800 hover:bg-gray-700 text-white shadow-lg shadow-gray-500/25":"bg-gray-700 hover:bg-gray-600 text-white shadow-lg shadow-gray-400/25"}`,children:"üìñ Lire l'article"})]})]})]})})})},`${r}-news-${i}`))]},r)})})]})}),e.jsxs("div",{className:`text-center mt-8 p-6 rounded-xl transition-colors duration-300 ${t?"bg-gradient-to-r from-blue-900/30 to-purple-900/30 border border-blue-500/20":"bg-gradient-to-r from-blue-100/80 to-purple-100/80 border border-blue-300/30"}`,children:[e.jsx("div",{className:`text-lg font-semibold mb-2 transition-colors duration-300 ${t?"text-blue-300":"text-blue-700"}`,children:"üìú Section Principale - Donn√©es Financi√®res"}),e.jsx("div",{className:`text-sm transition-colors duration-300 ${t?"text-gray-300":"text-gray-600"}`,children:"Faites d√©filer pour voir toutes les donn√©es ‚Ä¢ Source: Finnhub API ‚Ä¢ 3 actualit√©s par titre"}),e.jsx("div",{className:`text-xs mt-2 transition-colors duration-300 ${t?"text-gray-400":"text-gray-500"}`,children:"Donn√©es mises √† jour automatiquement toutes les 5 minutes"})]})]})}),b.length===0&&e.jsx("div",{className:"bg-yellow-900/20 backdrop-blur-sm rounded-lg p-6 border border-yellow-300/20",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-yellow-400 text-2xl",children:"‚ö†Ô∏è"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-yellow-200 font-semibold",children:"Aucun ticker configur√©"}),e.jsx("p",{className:"text-yellow-300/80 text-sm mt-1",children:"Ajoutez des tickers dans l'onglet Seeking Alpha pour voir les donn√©es ici."})]})]})}),h.length>0&&e.jsx("div",{className:"mt-12",children:e.jsxs("div",{className:`backdrop-blur-sm rounded-2xl p-8 border-2 shadow-2xl transition-colors duration-300 ${t?"bg-gradient-to-br from-gray-800/90 to-gray-900/90 border-purple-500/30 shadow-purple-500/10":"bg-gradient-to-br from-white/95 to-gray-50/95 border-purple-400/40 shadow-purple-400/10"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:`text-2xl font-bold transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:"üì∞ Actualit√©s du March√©"}),e.jsxs("div",{className:`px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-300 ${t?"bg-purple-500/20 text-purple-300 border border-purple-500/30":"bg-purple-100 text-purple-700 border border-purple-300"}`,children:[h.length," articles"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.slice(0,12).map((r,l)=>{const y=R(r.source?.name||""),w=J(y);return e.jsxs("div",{role:"button",tabIndex:0,onClick:()=>{r.url&&window.open(r.url,"_blank","noopener,noreferrer")},onKeyDown:k=>{(k.key==="Enter"||k.key===" ")&&r.url&&(k.preventDefault(),window.open(r.url,"_blank","noopener,noreferrer"))},className:`p-6 rounded-xl cursor-pointer transition-all hover:scale-[1.02] focus:outline-none focus:ring-2 focus:ring-emerald-500 ${t?"bg-gradient-to-br from-gray-700/50 to-gray-800/50 hover:from-gray-700/70 hover:to-gray-800/70 border border-gray-600":"bg-gradient-to-br from-white to-gray-50 hover:from-gray-50 hover:to-gray-100 border border-gray-200 shadow-lg"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-bold ${w==="premium"?"bg-yellow-500/20 text-yellow-500 border border-yellow-500/30":w==="high"?"bg-green-500/20 text-green-500 border border-green-500/30":w==="medium"?"bg-blue-500/20 text-blue-500 border border-blue-500/30":w==="low"?"bg-gray-500/20 text-gray-500 border border-gray-500/30":"bg-red-500/20 text-red-500 border border-red-500/30"}`,children:r.source?.name||"Source inconnue"}),e.jsx("div",{className:`text-xs ${t?"text-gray-400":"text-gray-600"}`,children:new Date(r.publishedAt).toLocaleDateString("fr-FR",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),e.jsx("h3",{className:`font-bold text-lg mb-3 line-clamp-2 transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:r.title}),r.description&&e.jsx("p",{className:`text-sm mb-4 line-clamp-3 transition-colors duration-300 ${t?"text-gray-300":"text-gray-600"}`,children:r.description}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs("a",{href:r.url,target:"_blank",rel:"noopener noreferrer",onClick:k=>k.stopPropagation(),className:`flex-1 px-3 py-2 rounded-lg text-center text-sm font-semibold transition-all ${t?"bg-blue-600 hover:bg-blue-500 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,children:[e.jsx(IconoirIcon,{name:"ExternalLink",className:"w-4 h-4 inline mr-1"}),"Lire"]}),e.jsxs("button",{onClick:k=>{k.stopPropagation(),summarizeWithEmma(r.url,r.title)},className:`flex-1 px-3 py-2 rounded-lg text-center text-sm font-semibold transition-all ${t?"bg-purple-600 hover:bg-purple-500 text-white":"bg-purple-500 hover:bg-purple-600 text-white"}`,children:[e.jsx(IconoirIcon,{name:"Brain",className:"w-4 h-4 inline mr-1"}),"Emma"]})]})]},l)})}),h.length>12&&e.jsx("div",{className:"text-center mt-6",children:e.jsxs("button",{onClick:()=>E("markets-economy"),className:`px-6 py-3 rounded-lg font-semibold transition-all ${t?"bg-purple-600 hover:bg-purple-500 text-white":"bg-purple-500 hover:bg-purple-600 text-white"}`,children:["Voir toutes les actualit√©s (",h.length,") ‚Üí"]})})]})})]})},$t=D=>{const{isDarkMode:t=!0}=D,[b,F]=p.useState(new Date),[h,M]=p.useState("AAPL"),[L,G]=p.useState("1D"),[E,I]=p.useState(!1),[u,T]=p.useState(null),[z,P]=p.useState(!0),[H,O]=p.useState(!1),[Q,ne]=p.useState(null),[re,K]=p.useState(!1),[R,J]=p.useState([]),[de,V]=p.useState(!1),[r,l]=p.useState(()=>{const s=localStorage.getItem("jslaiConfig");return s?JSON.parse(s):{valuation:20,profitability:20,growth:15,financialHealth:20,momentum:10,moat:10,sectorPosition:5}});p.useEffect(()=>{localStorage.setItem("jslaiConfig",JSON.stringify(r))},[r]);const y=s=>{const o={AAPL:183.45,TSLA:251.23,GOOGL:143.12,MSFT:384.89,NVDA:485.32,AMZN:178.91}[s]||180,a={AAPL:"Apple Inc.",TSLA:"Tesla Inc.",GOOGL:"Alphabet Inc.",MSFT:"Microsoft Corp.",NVDA:"NVIDIA Corp.",AMZN:"Amazon.com Inc."};return{quote:{symbol:s,name:a[s]||"Company Inc.",price:o,change:parseFloat((Math.random()*6-2).toFixed(2)),changesPercentage:parseFloat((Math.random()*4-1).toFixed(2)),volume:Math.floor(Math.random()*5e7+3e7),marketCap:Math.floor(Math.random()*2e12+1e12),avgVolume:Math.floor(Math.random()*6e7+4e7)},intraday:Array.from({length:20},(v,f)=>({date:`${9+Math.floor(f/4)}:${f%4*15}`,open:o+(Math.random()*4-2),high:o+(Math.random()*5-1),low:o+(Math.random()*3-3),close:o+(Math.random()*4-2),volume:Math.floor(Math.random()*5e6+2e6)})),metrics:{peRatioTTM:parseFloat((Math.random()*40+15).toFixed(1)),pegRatioTTM:parseFloat((Math.random()*2+.5).toFixed(2)),priceToSalesRatioTTM:parseFloat((Math.random()*8+2).toFixed(2)),dividendYieldTTM:parseFloat((Math.random()*.03).toFixed(4))},ratios:{debtEquityRatio:parseFloat((Math.random()*2+.3).toFixed(2)),returnOnEquityTTM:parseFloat((Math.random()*.4+.1).toFixed(3)),returnOnAssetsTTM:parseFloat((Math.random()*.2+.05).toFixed(3)),netProfitMarginTTM:parseFloat((Math.random()*.3+.1).toFixed(3))},profile:{companyName:a[s]||"Company Inc.",price:o,beta:parseFloat((Math.random()*.6+.8).toFixed(2)),sector:"Technology",industry:"Consumer Electronics"},news:[{title:`${s} annonce r√©sultats trimestriels record`,publishedDate:new Date(Date.now()-2*36e5).toISOString(),site:"Reuters"},{title:"Nouveau partenariat strat√©gique annonc√©",publishedDate:new Date(Date.now()-5*36e5).toISOString(),site:"Bloomberg"},{title:"Analystes rel√®vent objectif de prix",publishedDate:new Date(Date.now()-8*36e5).toISOString(),site:"CNBC"}],sentiment:{overall:Math.floor(Math.random()*30+60),news:Math.floor(Math.random()*30+65),social:Math.floor(Math.random()*30+60),institutional:Math.floor(Math.random()*30+55),retail:Math.floor(Math.random()*30+70),summary:"Sentiment globalement positif avec optimisme mod√©r√©"},insights:{catalysts:["R√©sultats trimestriels sup√©rieurs aux attentes","Innovation produit majeure annonc√©e","Expansion internationale r√©ussie"],risks:["Concurrence accrue dans le secteur","Incertitudes macro√©conomiques","Volatilit√© des march√©s"],consensus:"bullish",reasoning:"Les fondamentaux solides et la croissance continue justifient un sentiment positif"}}},w=async(s,o="1D")=>{try{console.log(`üîç R√©cup√©ration des donn√©es r√©elles pour ${s}...`);let a,v;switch(o){case"1D":a="15min",v=20;break;case"1W":a="1hour",v=24;break;case"1M":a="1day",v=30;break;case"3M":a="1day",v=90;break;case"6M":a="1day",v=180;break;case"1A":a="1day",v=365;break;case"5A":a="1week",v=260;break;case"MAX":a="1month",v=120;break;case"YTD":a="1day";const W=new Date,pe=new Date(W.getFullYear(),0,1),je=Math.ceil((W-pe)/(1e3*60*60*24));v=Math.min(je,365);break;default:a="1day",v=30}const[f,Ae,Fe,we,fe,xe,ze]=await Promise.allSettled([fetchHybridData(s,"quote"),fetchHybridData(s,"profile"),fetchHybridData(s,"ratios"),fetchHybridData(s,"news"),fetchHybridData(s,"prices"),fetchHybridData(s,"analyst"),fetchHybridData(s,"earnings")]),X=f.status==="fulfilled"&&f.value.success?f.value.data:null,U=Ae.status==="fulfilled"&&Ae.value.success?Ae.value.data:null,$=Fe.status==="fulfilled"&&Fe.value.success?Fe.value.data:null,Je=we.status==="fulfilled"&&we.value.success?we.value.data:null,be=fe.status==="fulfilled"&&fe.value.success?fe.value.data:null,$e=xe.status==="fulfilled"&&xe.value.success?xe.value.data:null,ke=ze.status==="fulfilled"&&ze.value.success?ze.value.data:null,Ye={quote:f.status==="fulfilled"?f.value.fallback||!1:!0,profile:Ae.status==="fulfilled"?Ae.value.fallback||!1:!0,ratios:Fe.status==="fulfilled"?Fe.value.fallback||!1:!0,news:we.status==="fulfilled"?we.value.fallback||!1:!0,intraday:fe.status==="fulfilled"?fe.value.fallback||!1:!0,analyst:xe.status==="fulfilled"?xe.value.fallback||!1:!0,earnings:ze.status==="fulfilled"?ze.value.fallback||!1:!0};console.log("‚úÖ Donn√©es r√©cup√©r√©es:",{hasQuote:!!X,hasProfile:!!U,hasRatios:!!$,hasNews:!!Je,hasIntraday:!!be,hasAnalyst:!!$e,hasEarnings:!!ke,fallbackIndicators:Ye});const Xe=Object.keys(Ye).length,at=Object.values(Ye).filter(Boolean).length,rt=Xe-at,Ve=Math.round(rt/Xe*100);console.log(`üìä Qualit√© des donn√©es: ${Ve}% (${rt}/${Xe} sections en production)`);const Oe=[];X||Oe.push("Quote manquant"),U||Oe.push("Profile manquant"),$||Oe.push("Ratios manquant"),Je||Oe.push("News manquant"),Oe.length>0&&console.warn("‚ö†Ô∏è Donn√©es manquantes:",Oe),console.log("‚úÖ Donn√©es hybrides r√©cup√©r√©es:",{hasQuote:!!X,hasProfile:!!U,hasRatios:!!$,hasNews:!!Je,hasIntraday:!!be,hasAnalyst:!!$e,hasEarnings:!!ke,quoteSource:X?.source||"unknown",profileSource:U?.source||"unknown",ratiosSource:$?.source||"unknown",quoteConfidence:X?.metadata?.confidence||0,profileConfidence:U?.metadata?.confidence||0,ratiosConfidence:$?.metadata?.confidence||0,quoteFreshness:X?.metadata?.freshness||"unknown",profileFreshness:U?.metadata?.freshness||"unknown",ratiosFreshness:$?.metadata?.freshness||"unknown"});const De=(()=>{let W=0,pe={};const je=$?.data?.[0]?.peRatioTTM||$?.peRatioTTM||null;let _=50;je&&(je<10?_=100:je<15?_=85:je<20?_=70:je<25?_=55:je<30?_=40:_=25),pe.valuation=_,W+=_*r.valuation/100;const Z=$?.data?.[0]?.returnOnEquityTTM||$?.returnOnEquityTTM||null;let ee=50;if(Z){const le=Z*100;le>25?ee=100:le>20?ee=85:le>15?ee=70:le>10?ee=55:le>5?ee=40:ee=25}pe.profitability=ee,W+=ee*r.profitability/100;const ae=$?.data?.[0]?.grossProfitMarginTTM||$?.grossProfitMarginTTM||null,ge=$?.data?.[0]?.netProfitMarginTTM||$?.netProfitMarginTTM||null;let te=60;if(ae&&ge){const le=(ae+ge)/2;le>.3?te=100:le>.2?te=85:le>.15?te=70:le>.1?te=55:le>.05?te=40:te=25}pe.growth=te,W+=te*r.growth/100;const A=$?.data?.[0]?.debtEquityRatioTTM||$?.debtEquityRatioTTM||null,N=$?.data?.[0]?.currentRatio||$?.currentRatio||null;let Le=50,Pe=50;A!==null&&(A<.3?Pe=100:A<.5?Pe=85:A<1?Pe=70:A<1.5?Pe=55:A<2?Pe=40:Pe=25);let Se=50;N!==null&&(N>3?Se=100:N>2?Se=85:N>1.5?Se=70:N>1?Se=55:N>.5?Se=40:Se=25),Le=Math.round(Pe*.6+Se*.4),pe.financialHealth=Le,W+=Le*r.financialHealth/100;const Me=X?.dp||0;let ye=50;Me>10?ye=100:Me>5?ye=85:Me>2?ye=70:Me>0?ye=60:Me>-2?ye=45:Me>-5?ye=30:ye=15,pe.momentum=ye,W+=ye*r.momentum/100;const Ke=$?.data?.[0]?.operatingProfitMarginTTM||$?.operatingProfitMarginTTM||null;let Ce=60;if(ae&&Ke){const le=(ae+Ke)/2;le>.4?Ce=100:le>.3?Ce=85:le>.2?Ce=70:le>.15?Ce=60:le>.1?Ce=45:Ce=30}pe.moat=Ce,W+=Ce*r.moat/100;const ve=U?.data?.[0]?.beta||U?.beta||null;let he=60;ve!==null&&(ve<.5?he=100:ve<.8?he=85:ve<1?he=75:ve<1.2?he=60:ve<1.5?he=45:he=30),pe.sectorPosition=he,W+=he*r.sectorPosition/100;const me=Math.round(W);return{total:me,breakdown:pe,interpretation:me>=85?"Excellent":me>=75?"Tr√®s Bon":me>=65?"Bon":me>=50?"Moyen":me>=35?"Faible":"Mauvais",recommendation:me>=75?"Achat Fort":me>=65?"Achat":me>=50?"Conserver":me>=35?"Surveiller":"√âviter"}})();console.log("ü§ñ Calcul du sentiment et insights √† partir des donn√©es r√©elles...");const Ie=X?.dp||0,Qe=($?.data?.[0]?.returnOnEquityTTM||$?.returnOnEquityTTM||0)*100,Te=$?.data?.[0]?.peRatioTTM||$?.peRatioTTM||0;let Ue=50;Qe>20?Ue+=20:Qe>15&&(Ue+=10),Te>0&&Te<15?Ue+=15:Te>0&&Te<25&&(Ue+=5);let Re=60;Ie>5?Re=85:Ie>2?Re=75:Ie>0?Re=65:Ie>-2?Re=55:Ie>-5?Re=45:Re=30;const Ge=Math.round(Ue*.6+Re*.4),qe=[];Qe>20&&qe.push(`ROE excellent √† ${Qe.toFixed(1)}%`),Ie>2&&qe.push(`Forte dynamique haussi√®re (+${Ie.toFixed(2)}%)`),Te>0&&Te<15&&qe.push(`Valorisation attractive (P/E: ${Te.toFixed(1)})`),qe.length===0&&qe.push("Fondamentaux stables");const Be=[],nt=$?.data?.[0]?.debtEquityRatioTTM||$?.debtEquityRatioTTM||0;nt>2&&Be.push(`Endettement √©lev√© (D/E: ${nt.toFixed(2)})`),Ie<-5&&Be.push("Momentum baissier significatif"),Te>40&&Be.push(`Valorisation √©lev√©e (P/E: ${Te.toFixed(1)})`),Be.length===0&&Be.push("Volatilit√© de march√© normale");let _e="neutral";Ge>=70?_e="bullish":Ge<=45&&(_e="bearish");let He="HOLD",Ee=Ge;De.total>=75?(He="STRONG_BUY",Ee=Math.min(90,Ee+10)):De.total>=65?(He="BUY",Ee=Math.min(85,Ee+5)):De.total<=35?(He="SELL",Ee=Math.min(85,Ee)):De.total<=25&&(He="STRONG_SELL",Ee=Math.min(90,Ee));const Ne={sentiment:{overall:Ge,news:Re,summary:`Sentiment ${_e==="bullish"?"positif":_e==="bearish"?"n√©gatif":"neutre"} bas√© sur les fondamentaux et le momentum`},insights:{catalysts:qe,risks:Be,consensus:_e,reasoning:`Score JSLAI‚Ñ¢ de ${De.total}/100 (${De.interpretation}). ${De.recommendation}.`},analyst:{recommendation:He,confidence:Ee,keyPoints:[`Score JSLAI‚Ñ¢: ${De.total}/100`,`Sentiment: ${Ge}/100`,`Tendance: ${_e}`]}};return console.log("‚úÖ Sentiment et insights calcul√©s √† partir des donn√©es r√©elles (sans Perplexity)"),{jslaiScore:De,quote:{symbol:s,name:U?.data?.[0]?.companyName||U?.companyName||`${s} Inc.`,price:X?.c||0,change:X?.d||0,changesPercentage:X?.dp||0,volume:X?.volume||0,marketCap:U?.data?.[0]?.mktCap||U?.mktCap||0,avgVolume:X?.avgVolume||0},intraday:(()=>{if(be&&Array.isArray(be)&&be.length>0)return console.log(`üìä Donn√©es historiques r√©elles r√©cup√©r√©es: ${be.length} points`),be.map((_,Z)=>({date:_.date||new Date(_.timestamp||Date.now()-Z*6e4).toLocaleString("fr-FR"),open:_.open||0,high:_.high||0,low:_.low||0,close:_.close||0,volume:_.volume||0}));if(be?.historical&&Array.isArray(be.historical)&&be.historical.length>0){console.log(`üìä Donn√©es FMP historiques r√©cup√©r√©es: ${be.historical.length} points`);let _=be.historical;if(o==="YTD"){const Z=new Date().getFullYear();_=be.historical.filter(ee=>new Date(ee.date).getFullYear()===Z),console.log(`üìä Donn√©es YTD filtr√©es: ${_.length} points`)}return _.map((Z,ee)=>({date:Z.date||new Date(Z.timestamp||Date.now()-ee*6e4).toLocaleString("fr-FR"),open:Z.open||0,high:Z.high||0,low:Z.low||0,close:Z.close||0,volume:Z.volume||0}))}const W=X?.c||0,pe=X?.d||0,je=X?.dp||0;if(W>0){const _=[],Z=W-pe,ee=o;let ae,ge,te;switch(ee){case"1D":ae=20,ge=3,te=A=>{const N=new Date;return N.setHours(9,A*ge,0,0),N.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})};break;case"1W":ae=7,ge=1,te=A=>{const N=new Date;return N.setDate(N.getDate()-(6-A)),N.toLocaleDateString("fr-FR",{weekday:"short"})};break;case"1M":ae=30,ge=1,te=A=>{const N=new Date;return N.setDate(N.getDate()-(29-A)),N.toLocaleDateString("fr-FR",{day:"2-digit"})};break;case"3M":ae=12,ge=7,te=A=>{const N=new Date;return N.setDate(N.getDate()-(11-A)*7),N.toLocaleDateString("fr-FR",{month:"short"})};break;case"6M":ae=24,ge=7,te=A=>{const N=new Date;return N.setDate(N.getDate()-(23-A)*7),N.toLocaleDateString("fr-FR",{month:"short"})};break;case"1A":ae=12,ge=30,te=A=>{const N=new Date;return N.setMonth(N.getMonth()-(11-A)),N.toLocaleDateString("fr-FR",{month:"short"})};break;case"5A":ae=20,ge=90,te=A=>{const N=new Date;return N.setMonth(N.getMonth()-(19-A)*3),N.toLocaleDateString("fr-FR",{year:"2-digit",month:"short"})};break;case"MAX":ae=30,ge=120,te=A=>{const N=new Date;return N.setMonth(N.getMonth()-(29-A)*4),N.toLocaleDateString("fr-FR",{year:"2-digit",month:"short"})};break;case"YTD":ae=12,ge=30,te=A=>{const N=new Date;return N.setMonth(A),N.toLocaleDateString("fr-FR",{month:"short"})};break;default:ae=20,ge=3,te=A=>{const N=new Date;return N.setHours(9,A*ge,0,0),N.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})}}for(let A=0;A<ae;A++){const N=A/(ae-1);let Le;if(ee==="YTD"){const ve=Z*(1-je/100*.8),he=A/(ae-1);Le=ve+he*(W-ve)}else if(ee==="5A"||ee==="MAX"){const ve=ee==="5A"?5:10,he=1-je/100*(ve*.2),me=W*he;Le=me+N*(W-me)}else{const ve=je>0?1:-1,he=Math.random()*.02-.01,me=N*pe+he*Z;Le=Math.max(.01,Z+me)}const Pe=Math.random()*.015-.0075,Se=Le*(1+Pe),Me=A===0?ee==="YTD"?Z*.9:Z:_[A-1]?.close||Se,ye=Math.max(.01,Se),Ke=Math.max(Me,ye)*(1+Math.random()*.01),Ce=Math.min(Me,ye)*(1-Math.random()*.01);_.push({date:te(A),open:Me,high:Ke,low:Ce,close:ye,volume:Math.floor(Math.random()*2e6)+5e5})}return console.log(`üìä Donn√©es ${ee} g√©n√©r√©es pour ${s}: ${_.length} points`),_}return[]})(),metrics:{peRatioTTM:$?.valuation?.peRatio||null,pegRatioTTM:$?.valuation?.pegRatio||null,priceToSalesRatioTTM:$?.valuation?.psRatio||null,dividendYieldTTM:$?.debt?.dividendYield||null},ratios:{debtEquityRatio:$?.debt?.debtEquityRatio||null,returnOnEquityTTM:$?.profitability?.returnOnEquity||null,returnOnAssetsTTM:$?.profitability?.returnOnAssets||null,netProfitMarginTTM:$?.profitability?.netProfitMargin||null,currentRatio:$?.liquidity?.currentRatio||null,quickRatio:$?.liquidity?.quickRatio||null,grossProfitMargin:$?.profitability?.grossProfitMargin||null,operatingProfitMargin:$?.profitability?.operatingIncomeMargin||null},profile:{companyName:U?.data?.[0]?.companyName||U?.companyName||`${s} Inc.`,price:X?.c||0,beta:U?.data?.[0]?.beta||U?.beta||null,sector:U?.data?.[0]?.sector||U?.sector||"Unknown",industry:U?.data?.[0]?.industry||U?.industry||"Unknown"},news:Je?.news?.slice(0,5)?.map(W=>({title:W.title,source:W.source?.name||"Marketaux",time:W.publishedAt,url:W.url||"#",sentiment:W.sentiment||"neutral"}))||[],sentiment:{overall:Ne?.sentiment?.overall||60,news:Ne?.sentiment?.news||65,social:60,institutional:55,retail:70,summary:Ne?.sentiment?.summary||"Analyse en cours"},analystRecommendations:$e?{consensus:$e.consensus?.rating||"N/A",targetPrice:$e.consensus?.targetPrice||null,upside:$e.consensus?.upside||null,analystCount:$e.consensus?.analystCount||0,breakdown:$e.breakdown||{},confidence:$e.validation?.confidence||0,sources:$e.validation?.sources||[]}:null,earningsCalendar:ke?{nextEarningsDate:ke.consensus?.nextEarningsDate||null,estimatedEPS:ke.consensus?.estimatedEPS||null,estimatedRevenue:ke.consensus?.estimatedRevenue||null,upcoming:ke.upcoming||[],historical:ke.historical?.slice(0,4)||[],statistics:ke.statistics||null,confidence:ke.validation?.confidence||0}:null,dataValidation:{quote:{confidence:X?.metadata?.confidence||0,status:X?.metadata?.freshness||"unknown",source:X?.source||"unknown",lastUpdated:X?.metadata?.lastUpdated||null},profile:{confidence:U?.metadata?.confidence||0,status:U?.metadata?.freshness||"unknown",source:U?.source||"unknown",lastUpdated:U?.metadata?.lastUpdated||null},ratios:{confidence:$?.metadata?.confidence||0,quality:$?.metadata?.dataQuality||"Unknown",source:$?.source||"unknown",lastUpdated:$?.metadata?.lastUpdated||null}},insights:{catalysts:Ne?.insights?.catalysts||["Analyse en cours des catalyseurs de march√©","Surveillance des annonces d'entreprise","Suivi des tendances du secteur"],risks:Ne?.insights?.risks||["Volatilit√© du march√©","Conditions macro√©conomiques","Concurrence sectorielle"],consensus:Ne?.insights?.consensus||"neutral",reasoning:Ne?.insights?.reasoning||"Analyse bas√©e sur les donn√©es de march√© actuelles"},aiAnalyst:Ne?.analyst?{recommendation:Ne.analyst.recommendation,confidence:Ne.analyst.confidence,keyPoints:Ne.analyst.keyPoints}:null,fallbackIndicators:Ye,dataQuality:{total_sections:Xe,fallback_sections:at,production_sections:rt,quality_percentage:Ve,status:Ve>=80?"EXCELLENT":Ve>=60?"GOOD":Ve>=40?"FAIR":"POOR"}}}catch(a){return console.error(`Error fetching real data for ${s}:`,a),null}};p.useEffect(()=>{(async()=>{try{P(!0),console.log(`üìä Chargement des donn√©es pour ${h}...`);const o=await w(h,L);if(o&&o.quote&&o.quote.price>0)T(o),O(!0),ne(new Date),console.log("‚úÖ Donn√©es charg√©es avec succ√®s"),(!o.intraday||o.intraday.length===0)&&J(a=>a.find(v=>v.code==="intraday_missing")?a:[...a,{code:"intraday_missing",severity:"low",message:"Donn√©es intraday non disponibles - utilisation des donn√©es quote uniquement."}]);else throw new Error("Donn√©es invalides re√ßues de l'API")}catch(o){console.error("‚ùå Erreur lors du chargement:",o?.message||String(o)),O(!1);const a=y(h);T(a),J(v=>v.find(f=>f.code==="data_fetch_error")?v:[...v,{code:"data_fetch_error",severity:"high",message:"√âchec de r√©cup√©ration API. V√©rifiez votre connexion et les cl√©s API."}]),K(!0)}finally{P(!1)}})()},[h]),p.useEffect(()=>{const s=document.getElementById("tradingview-mini-chart-jlab");if(s){s.innerHTML="";const o=document.createElement("script");o.type="text/javascript",o.src="https://s3.tradingview.com/external-embedding/embed-widget-mini-symbol-overview.js",o.async=!0,o.innerHTML=JSON.stringify({symbol:`NASDAQ:${h}`,width:"100%",height:"100%",locale:"fr",dateRange:"1D",colorTheme:t?"dark":"light",isTransparent:!1,autosize:!0,largeChartUrl:""}),s.appendChild(o),console.log(`üìä TradingView Mini Chart recharg√© pour ${h}`)}},[h,t]),p.useEffect(()=>{const s=[];try{const o=typeof window.Recharts<"u"||typeof Recharts<"u"||typeof window<"u"&&window.Recharts,a=typeof Chart<"u"||typeof window<"u"&&window.Chart;!o&&!a?s.push({code:"charts_missing",severity:"high",message:"Aucune biblioth√®que de graphiques disponible ‚Äî graphiques d√©sactiv√©s."}):!o&&a&&s.push({code:"recharts_missing",severity:"medium",message:"Recharts non disponible ‚Äî utilisation de Chart.js comme alternative."})}catch{s.push({code:"charts_missing",severity:"high",message:"Erreur de d√©tection des biblioth√®ques de graphiques."})}try{typeof window.LucideIcon<"u"&&typeof window.LucideIcon=="function"||s.push({code:"icons_missing",severity:"low",message:"Composant d'ic√¥nes personnalis√© non disponible (fallback activ√©)."})}catch{s.push({code:"icons_missing",severity:"low",message:"Composant d'ic√¥nes personnalis√© non disponible (fallback activ√©)."})}J(s),s.length>0&&K(!0)},[]);const k=[{symbol:"AAPL",name:"Apple Inc."},{symbol:"TSLA",name:"Tesla Inc."},{symbol:"GOOGL",name:"Alphabet Inc."},{symbol:"MSFT",name:"Microsoft Corp."},{symbol:"NVDA",name:"NVIDIA Corp."},{symbol:"AMZN",name:"Amazon.com Inc."},{symbol:"META",name:"Meta Platforms Inc."},{symbol:"NFLX",name:"Netflix Inc."},{symbol:"AMD",name:"Advanced Micro Devices"},{symbol:"INTC",name:"Intel Corporation"}],q=(s,o)=>{if(o==null||o==="N/A")return"text-gray-400";const a=typeof o=="string"?parseFloat(o):o;if(isNaN(a))return"text-gray-400";switch(s){case"PE":return a<0?"text-red-500":a<15?"text-emerald-500":a<25?"text-blue-500":a<35?"text-yellow-500":"text-red-500";case"PEG":return a<0?"text-red-500":a<1?"text-emerald-500":a<1.5?"text-blue-500":a<2?"text-yellow-500":"text-green-500";case"PS":return a<1?"text-emerald-500":a<3?"text-blue-500":a<5?"text-yellow-500":"text-green-500";case"ROE":return a<0?"text-red-500":a<10?"text-green-500":a<15?"text-yellow-500":a<20?"text-blue-500":"text-emerald-500";case"ROA":return a<0?"text-red-500":a<5?"text-green-500":a<10?"text-blue-500":a<15?"text-emerald-500":"text-emerald-400";case"DE":return a<.3?"text-emerald-500":a<.7?"text-blue-500":a<1.5?"text-yellow-500":a<2.5?"text-green-500":"text-red-500";case"Margin":return a<0?"text-red-500":a<5?"text-green-500":a<10?"text-yellow-500":a<20?"text-blue-500":"text-emerald-500";case"Beta":return a<0?"text-purple-500":a<.8?"text-emerald-500":a<1?"text-blue-500":a<1.3?"text-yellow-500":a<1.7?"text-green-500":"text-red-500";case"Div":return a<1?"text-gray-400":a<2?"text-blue-400":a<4?"text-blue-500":a<6?"text-emerald-500":a<8?"text-yellow-500":"text-green-500";case"CurrentRatio":return a<1?"text-red-500":a<1.5?"text-green-500":a<2.5?"text-emerald-500":a<3.5?"text-blue-500":"text-yellow-500";case"QuickRatio":return a<.5?"text-red-500":a<1?"text-green-500":a<1.5?"text-blue-500":"text-emerald-500";case"EPS":return a<0?"text-red-500":a<1?"text-green-500":a<3?"text-blue-500":"text-emerald-500";default:return"text-gray-400"}},se=async s=>{setLoadingScreener(!0);try{const o=[];for(const a of s)try{const[v,f,Ae]=await Promise.allSettled([fetch(`/api/marketdata?endpoint=quote&symbol=${a.symbol}&source=auto`),fetch(`/api/fmp?endpoint=profile&symbol=${a.symbol}`),fetch(`/api/fmp?endpoint=ratios&symbol=${a.symbol}`)]),Fe=v.status==="fulfilled"&&v.value.ok?await v.value.json():null,we=f.status==="fulfilled"&&f.value.ok?await f.value.json():null,fe=Ae.status==="fulfilled"&&Ae.value.ok?await Ae.value.json():null,xe={symbol:a.symbol,name:a.name,price:Fe?.c||0,change:Fe?.dp||0,marketCap:we?.data?.[0]?.mktCap||we?.mktCap||0,pe:fe?.data?.[0]?.peRatioTTM||fe?.peRatioTTM||null,roe:fe?.data?.[0]?.returnOnEquityTTM||fe?.returnOnEquityTTM||null,debtEquity:fe?.data?.[0]?.debtEquityRatioTTM||fe?.debtEquityRatioTTM||null,sector:we?.data?.[0]?.sector||we?.sector||"Unknown"};xe.marketCap>=screenerFilters.minMarketCap&&(!xe.pe||xe.pe<=screenerFilters.maxPE)&&(!xe.roe||xe.roe*100>=screenerFilters.minROE)&&(!xe.debtEquity||xe.debtEquity<=screenerFilters.maxDebtEquity)&&(screenerFilters.sector==="all"||xe.sector===screenerFilters.sector)&&o.push(xe)}catch(v){console.error(`Erreur pour ${a.symbol}:`,v)}setScreenerResults(o),console.log(`‚úÖ Screener: ${o.length} r√©sultats trouv√©s sur ${s.length} titres`)}catch(o){console.error("Erreur screener:",o)}finally{setLoadingScreener(!1)}},B=k.find(s=>s.symbol===h),C=u?.quote||{},oe=u?.metrics||{},ue=u?.ratios||{},ie=u?.profile||{},Y=u?.intraday||[],ce=u?.news||[],d=u?.sentiment||{},x=u?.insights||{},n=u?.historicalRatios||[],i=u?.movingAverages||{},S=(s,o="",a="")=>{if(!s&&s!==0)return"N/A";const v=parseFloat(s);return isNaN(v)?"N/A":v>=1e12?`${o}${(v/1e12).toFixed(2)}T${a}`:v>=1e9?`${o}${(v/1e9).toFixed(2)}B${a}`:v>=1e6?`${o}${(v/1e6).toFixed(2)}M${a}`:v>=1e3?`${o}${(v/1e3).toFixed(2)}K${a}`:`${o}${v.toFixed(2)}${a}`},c=s=>{const o=new Date(s),a=Math.floor((Date.now()-o.getTime())/36e5);return a<1?"maintenant":a<24?`${a}h`:`${Math.floor(a/24)}j`},g={RSI:{value:67.8,signal:"Achat"},MACD:{value:2.34,signal:"Bullish"},SMA_50:{value:(C.price||0)*.98,signal:"Au-dessus"},SMA_200:{value:(C.price||0)*.94,signal:"Au-dessus"}},j={buyVolume:68.4,sellVolume:31.6};if(oe.peRatioTTM,(ue.netProfitMarginTTM||.25)*100,z)return e.jsx("div",{className:`min-h-screen p-2 flex items-center justify-center transition-colors duration-300 ${t?"bg-neutral-950 text-gray-100":"bg-gray-50 text-gray-900"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-500 mx-auto mb-4"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Chargement des donn√©es‚Ä¶"})]})});const m=window.LucideIcon;return e.jsxs("div",{className:`min-h-screen p-2 transition-colors duration-300 ${t?"bg-neutral-950 text-gray-100":"bg-gray-50 text-gray-900"}`,children:[de&&e.jsxs("div",{className:`mb-2 border rounded-lg p-3 transition-colors duration-300 ${t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{name:"Filter",className:"w-4 h-4 text-blue-500"}),e.jsx("h3",{className:`text-sm font-bold ${t?"text-white":"text-gray-900"}`,children:"üîç Screener de Titres"})]}),e.jsx("button",{onClick:()=>V(!1),className:`p-1 rounded ${t?"hover:bg-neutral-800":"hover:bg-gray-100"}`,children:e.jsx(m,{name:"X",className:"w-4 h-4 text-gray-500"})})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-2 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] text-gray-500 mb-1 block",children:"Market Cap Min (B$)"}),e.jsx("input",{type:"number",value:screenerFilters.minMarketCap/1e9,onChange:s=>setScreenerFilters({...screenerFilters,minMarketCap:parseFloat(s.target.value||0)*1e9}),className:`w-full px-2 py-1 text-xs rounded border ${t?"bg-neutral-800 border-neutral-700 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] text-gray-500 mb-1 block",children:"P/E Max"}),e.jsx("input",{type:"number",value:screenerFilters.maxPE,onChange:s=>setScreenerFilters({...screenerFilters,maxPE:parseFloat(s.target.value||50)}),className:`w-full px-2 py-1 text-xs rounded border ${t?"bg-neutral-800 border-neutral-700 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] text-gray-500 mb-1 block",children:"ROE Min (%)"}),e.jsx("input",{type:"number",value:screenerFilters.minROE,onChange:s=>setScreenerFilters({...screenerFilters,minROE:parseFloat(s.target.value||0)}),className:`w-full px-2 py-1 text-xs rounded border ${t?"bg-neutral-800 border-neutral-700 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] text-gray-500 mb-1 block",children:"D/E Max"}),e.jsx("input",{type:"number",step:"0.1",value:screenerFilters.maxDebtEquity,onChange:s=>setScreenerFilters({...screenerFilters,maxDebtEquity:parseFloat(s.target.value||2)}),className:`w-full px-2 py-1 text-xs rounded border ${t?"bg-neutral-800 border-neutral-700 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] text-gray-500 mb-1 block",children:"Secteur"}),e.jsxs("select",{value:screenerFilters.sector,onChange:s=>setScreenerFilters({...screenerFilters,sector:s.target.value}),className:`w-full px-2 py-1 text-xs rounded border ${t?"bg-neutral-800 border-neutral-700 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"all",children:"Tous"}),e.jsx("option",{value:"Technology",children:"Technologie"}),e.jsx("option",{value:"Consumer Cyclical",children:"Consommation"}),e.jsx("option",{value:"Healthcare",children:"Sant√©"}),e.jsx("option",{value:"Financial",children:"Finance"})]})]})]}),e.jsx("button",{onClick:()=>se(k),disabled:loadingScreener,className:`w-full py-2 rounded text-sm font-semibold transition-colors ${loadingScreener?"bg-gray-400 cursor-not-allowed":"bg-gray-800 hover:bg-gray-700 text-white"}`,children:loadingScreener?"‚è≥ Analyse en cours...":"üîç Lancer le Screener"}),screenerResults.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:[screenerResults.length," titre(s) trouv√©(s)"]}),e.jsx("div",{className:`max-h-64 overflow-y-auto border rounded ${t?"border-neutral-700":"border-gray-300"}`,children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{className:`sticky top-0 ${t?"bg-neutral-800":"bg-gray-100"}`,children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 text-gray-500",children:"Symbole"}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"Prix"}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"Var %"}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"Cap."}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"P/E"}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"ROE"}),e.jsx("th",{className:"text-right p-2 text-gray-500",children:"D/E"}),e.jsx("th",{className:"text-center p-2 text-gray-500",children:"Action"})]})}),e.jsx("tbody",{children:screenerResults.map(s=>e.jsxs("tr",{className:`border-t ${t?"border-neutral-700 hover:bg-neutral-800":"border-gray-200 hover:bg-gray-50"}`,children:[e.jsxs("td",{className:"p-2",children:[e.jsx("div",{className:`font-bold ${t?"text-white":"text-gray-900"}`,children:s.symbol}),e.jsx("div",{className:"text-[9px] text-gray-500",children:s.name})]}),e.jsxs("td",{className:`text-right p-2 font-semibold ${t?"text-white":"text-gray-900"}`,children:["$",s.price.toFixed(2)]}),e.jsx("td",{className:`text-right p-2 font-semibold ${s.change>=0?"text-emerald-500":"text-red-500"}`,children:(()=>{const o=s.change;if(!o)return"0.00%";const a=typeof o=="number"?o:typeof o=="object"?o.raw||o.fmt||0:parseFloat(o)||0;return(a>=0?"+":"")+a.toFixed(2)+"%"})()}),e.jsx("td",{className:"text-right p-2 text-gray-400",children:S(s.marketCap)}),e.jsx("td",{className:`text-right p-2 font-semibold ${q("PE",s.pe)}`,children:s.pe?s.pe.toFixed(1):"N/A"}),e.jsx("td",{className:`text-right p-2 font-semibold ${q("ROE",s.roe?s.roe*100:null)}`,children:s.roe?(s.roe*100).toFixed(1)+"%":"N/A"}),e.jsx("td",{className:`text-right p-2 font-semibold ${q("DE",s.debtEquity)}`,children:s.debtEquity?s.debtEquity.toFixed(2):"N/A"}),e.jsx("td",{className:"text-center p-2",children:e.jsx("button",{onClick:()=>{M(s.symbol),V(!1)},className:"px-2 py-1 bg-gray-800 text-white rounded text-[9px] hover:bg-gray-700 transition-colors",children:"Voir"})})]},s.symbol))})]})})]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`p-1.5 border rounded-lg transition-colors duration-300 ${t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:e.jsx(m,{name:"Activity",className:"w-4 h-4 text-gray-400"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:`text-base font-bold flex items-center gap-2 transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:["Expert Trading Analytics",H?e.jsx(m,{name:"Wifi",className:"w-3 h-3 text-green-500"}):e.jsx(m,{name:"WifiOff",className:"w-3 h-3 text-red-500"}),u?.jslaiScore&&e.jsxs("div",{className:`px-4 py-1.5 rounded text-sm font-bold border-2 ${u.jslaiScore.total>=75?"bg-emerald-900/30 text-emerald-400 border-emerald-600 glow-pulse":u.jslaiScore.total>=65?"bg-gray-900/30 text-gray-400 border-gray-600":u.jslaiScore.total>=50?"bg-yellow-900/30 text-yellow-400 border-yellow-600":"bg-red-900/30 text-red-400 border-red-600 glow-pulse-red"}`,children:["üéØ JSLAI‚Ñ¢ ",u.jslaiScore.total,"/100"]}),e.jsxs("button",{onClick:()=>{const s=`Analyse approfondie de ${h}: fondamentaux, techniques, actualit√©s et recommandation d'investissement`;setEmmaPrefillMessage(s),setTimeout(()=>handleTabChange("ask-emma"),50)},className:`flex items-center gap-2 px-4 py-1.5 rounded text-sm font-semibold border-2 transition-all hover:scale-105 ${t?"bg-purple-900/30 hover:bg-purple-800/40 text-purple-400 border-purple-600":"bg-purple-100 hover:bg-purple-200 text-purple-700 border-purple-400"}`,title:`Demander une analyse d√©taill√©e de ${h} √† Emma IA`,children:[e.jsx("img",{src:"EMMA-JSLAI-GOB-dark.jpg",alt:"Emma",className:"w-4 h-4 rounded-full"}),"Analyse d'Emma IA"]})]}),e.jsxs("p",{className:"text-[8px] text-gray-600",children:[u?.dataQuality?e.jsxs(e.Fragment,{children:["üìä Qualit√©: ",u.dataQuality.quality_percentage,"% (",u.dataQuality.production_sections,"/",u.dataQuality.total_sections," r√©elles)",u.dataQuality.status==="EXCELLENT"&&" ‚úÖ",u.dataQuality.status==="GOOD"&&" üü¢",u.dataQuality.status==="FAIR"&&" üü°",u.dataQuality.status==="POOR"&&" üî¥"]}):"Mode D√©mo Hybride ‚Ä¢ FMP + Perplexity AI",u?.jslaiScore&&e.jsxs("span",{className:"ml-2",children:["‚Ä¢ ",u.jslaiScore.interpretation," (",u.jslaiScore.recommendation,")"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:async()=>{try{P(!0),console.log("üîÑ Actualisation des donn√©es...");const s=await w(h,L);if(s&&s.quote&&s.quote.price>0)T(s),O(!0),ne(new Date),console.log("‚úÖ Donn√©es actualis√©es avec succ√®s");else throw new Error("Donn√©es invalides re√ßues de l'API")}catch(s){console.error("‚ùå Erreur lors de l'actualisation:",s),O(!1)}finally{P(!1)}},className:`p-1.5 border rounded-md transition-all ${t?"bg-neutral-900 hover:bg-neutral-800 border-neutral-800":"bg-white hover:bg-gray-100 border-gray-300"}`,children:e.jsx(m,{name:"RefreshCw",className:"w-3 h-3 text-gray-400"})}),e.jsxs("button",{onClick:emmaPopulateJLab,disabled:z,className:`px-3 py-1.5 border rounded-lg transition-all flex items-center gap-2 ${t?"bg-purple-900 hover:bg-purple-800 border-purple-800 text-purple-200":"bg-purple-600 hover:bg-purple-700 border-purple-600 text-white"} disabled:opacity-50`,children:[e.jsx("span",{children:"ü§ñ"}),e.jsx("span",{className:"text-xs font-semibold",children:"Emma Populate"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>I(!E),className:`flex items-center gap-2 px-3 py-1.5 border rounded-lg transition-all ${t?"bg-neutral-900 hover:bg-neutral-800 border-neutral-800":"bg-white hover:bg-gray-100 border-gray-300"}`,children:[e.jsxs("div",{children:[e.jsx("div",{className:`text-xs font-bold transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:h}),e.jsx("div",{className:"text-[8px] text-gray-600",children:ie.companyName||B?.name})]}),e.jsx(m,{name:"ChevronDown",className:`w-3 h-3 text-gray-400 transition-transform ${E?"rotate-180":""}`})]}),E&&e.jsx("div",{className:`absolute top-full mt-1 right-0 w-48 border rounded-lg shadow-2xl overflow-hidden z-50 transition-colors duration-300 ${t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:k.map(s=>e.jsx("button",{onClick:()=>{M(s.symbol),I(!1)},className:`w-full p-2 flex items-center justify-between transition-all text-xs ${h===s.symbol?t?"bg-neutral-800":"bg-gray-100":t?"hover:bg-neutral-800":"hover:bg-gray-50"}`,children:e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:`font-bold transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:s.symbol}),e.jsx("div",{className:"text-[8px] text-gray-600",children:s.name})]})},s.symbol))})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs font-mono font-bold text-gray-300",children:b.toLocaleTimeString("fr-FR")}),e.jsx("div",{className:"text-[8px] text-gray-600",children:b.toLocaleDateString("fr-FR",{day:"numeric",month:"short"})})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>V(!de),className:`p-1.5 border rounded-md transition-all ${de?"bg-gray-800 border-gray-800":t?"bg-neutral-900 hover:bg-neutral-800 border-neutral-800":"bg-white hover:bg-gray-100 border-gray-300"}`,title:"Ouvrir le screener de titres",children:e.jsx(m,{name:"Filter",className:`w-3 h-3 ${de?"text-white":"text-gray-500"}`})}),e.jsx("button",{className:`p-1.5 border rounded-md transition-all ${t?"bg-neutral-900 hover:bg-neutral-800 border-neutral-800":"bg-white hover:bg-gray-100 border-gray-300"}`,children:e.jsx(m,{name:"Bell",className:"w-3 h-3 text-gray-500"})}),e.jsx("button",{className:`p-1.5 border rounded-md transition-all ${t?"bg-neutral-900 hover:bg-neutral-800 border-neutral-800":"bg-white hover:bg-gray-100 border-gray-300"}`,children:e.jsx(m,{name:"Search",className:"w-3 h-3 text-gray-500"})}),e.jsx("button",{className:`p-1.5 border rounded-md transition-all ${t?"bg-neutral-900 hover:bg-neutral-800 border-neutral-800":"bg-white hover:bg-gray-100 border-gray-300"}`,children:e.jsx(m,{name:"Settings",className:"w-3 h-3 text-gray-500"})}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>K(!re),className:`p-1.5 border rounded-md transition-all ${t?"bg-neutral-900 hover:bg-neutral-800 border-neutral-800":"bg-white hover:bg-gray-100 border-gray-300"}`,title:R.length?"Diagnostics: probl√®mes d√©tect√©s":"Aide IntelliStocks",children:e.jsxs("div",{className:"relative",children:[e.jsx(m,{name:R.length?"AlertTriangle":"HelpCircle",className:`w-3 h-3 ${R.length?"text-yellow-500":"text-gray-500"}`}),R.length>0&&e.jsx("span",{className:"absolute -top-0.5 -right-0.5 w-2 h-2 bg-red-500 rounded-full"})]})}),re&&e.jsxs("div",{className:`absolute right-0 mt-2 w-80 border rounded-xl shadow-2xl z-50 ${t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("div",{className:`p-3 border-b flex items-center justify-between gap-2 ${t?"border-neutral-800":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{name:"LifeBuoy",className:"w-4 h-4 text-blue-500"}),e.jsxs("div",{children:[e.jsx("div",{className:`text-xs font-bold ${t?"text-white":"text-gray-900"}`,children:"Aide & diagnostics IntelliStocks"}),e.jsx("div",{className:"text-[10px] text-gray-500",children:"Mode D√©mo Hybride ‚Ä¢ FMP + Perplexity"})]})]}),e.jsx("button",{onClick:()=>K(!1),className:`p-1 rounded ${t?"hover:bg-neutral-800":"hover:bg-gray-100"}`,children:e.jsx(m,{name:"X",className:"w-3 h-3 text-gray-500"})})]}),e.jsxs("div",{className:"p-3 space-y-2 text-[11px]",children:[R.length>0?e.jsxs("div",{children:[e.jsx("div",{className:`mb-1 font-semibold ${t?"text-white":"text-gray-900"}`,children:"Probl√®mes d√©tect√©s"}),e.jsx("ul",{className:"space-y-1",children:R.map((s,o)=>e.jsx("li",{className:`p-2 rounded border ${s.severity==="high"?t?"bg-red-900/30 border-red-800 text-red-200":"bg-red-50 border-red-200 text-red-800":s.severity==="medium"?t?"bg-yellow-900/30 border-yellow-800 text-yellow-200":"bg-yellow-50 border-yellow-200 text-yellow-800":t?"bg-gray-900/30 border-gray-800 text-gray-200":"bg-gray-50 border-gray-200 text-gray-800"}`,children:s.message},o))})]}):e.jsx("div",{className:`p-2 rounded border ${t?"bg-emerald-900/20 border-emerald-800 text-emerald-200":"bg-emerald-50 border-emerald-200 text-emerald-800"}`,children:"Aucun probl√®me d√©tect√©."}),e.jsx("div",{className:`pt-1 border-t ${t?"border-neutral-800":"border-gray-200"}`}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:`font-semibold ${t?"text-white":"text-gray-900"}`,children:"Conseils rapides"}),e.jsxs("ul",{className:"list-disc pl-4 space-y-1 text-gray-500",children:[e.jsx("li",{children:"Les graphiques utilisent Chart.js pour afficher les donn√©es en temps r√©el."}),e.jsx("li",{children:"Les donn√©es proviennent de FMP et Marketaux via les APIs configur√©es."}),e.jsx("li",{children:"Actualisez avec le bouton rafra√Æchir pour recharger les derni√®res donn√©es du march√©."}),e.jsx("li",{children:"Les graphiques s'adaptent au th√®me sombre/clair automatiquement."})]}),e.jsx("div",{className:`mt-2 pt-2 border-t ${t?"border-neutral-800":"border-gray-200"}`}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:`font-semibold ${t?"text-white":"text-gray-900"}`,children:"Code couleur des m√©triques"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1 text-[10px]",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),e.jsx("span",{children:"Excellent / Sous-√©valu√©"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-700"}),e.jsx("span",{children:"Bon / Juste valoris√©"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500"}),e.jsx("span",{children:"Moyen / Attention"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),e.jsx("span",{children:"Faible / Risque"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"}),e.jsx("span",{children:"Mauvais / Danger"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400"}),e.jsx("span",{children:"Non disponible"})]})]})]}),e.jsx("div",{className:`mt-2 pt-2 border-t ${t?"border-neutral-800":"border-gray-200"}`}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:`font-semibold text-[10px] ${t?"text-white":"text-gray-900"}`,children:"Standards utilis√©s"}),e.jsxs("ul",{className:"space-y-0.5 text-[9px] text-gray-500",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"P/E:"})," <15 excellent, 15-25 bon, >25 √©lev√©"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"PEG:"})," <1 sous-√©valu√© (Peter Lynch), >2 sur√©valu√©"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"ROE:"})," >20% excellent (Warren Buffett), >15% bon"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"D/E:"})," <0.7 sain, >2 risqu√©"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Marge:"})," >20% excellente, 10-20% bonne"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Beta:"})," <1 d√©fensif, >1.5 volatil"]})]})]})]})]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-2",children:[e.jsxs("div",{className:"col-span-8 space-y-2",children:[e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 hover-lift shine-effect ${t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-sm font-bold mb-0.5 transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:h}),e.jsxs("p",{className:"text-[8px] text-gray-600",children:[ie.companyName||B?.name," ‚Ä¢ ",ie.sector||"NASDAQ"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`text-lg font-bold transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:["$",parseFloat(C.price||0).toFixed(2)]}),e.jsxs("div",{className:`flex items-center gap-1 justify-end text-xs ${parseFloat(C.changesPercentage||0)>=0?"text-emerald-500":"text-red-500"}`,children:[parseFloat(C.changesPercentage||0)>=0?e.jsx(m,{name:"ArrowUpRight",className:"w-3 h-3"}):e.jsx(m,{name:"ArrowDownRight",className:"w-3 h-3"}),e.jsxs("span",{className:"font-semibold",children:[parseFloat(C.changesPercentage||0)>=0?"+":"",parseFloat(C.changesPercentage||0).toFixed(2),"%"]})]})]})]}),e.jsx("div",{style:{width:"100%",height:140},children:typeof Chart<"u"&&Y&&Y.length>0?e.jsx("canvas",{ref:s=>{if(s){s.chart&&(s.chart.destroy(),s.chart=null);const o=s.getContext("2d");s.chart=new Chart(o,{type:"line",data:{labels:Y.map(a=>a.date),datasets:[{label:"Prix",data:Y.map(a=>a.close),borderColor:parseFloat(C.changesPercentage||0)>=0?"rgb(34, 197, 94)":"rgb(239, 68, 68)",backgroundColor:parseFloat(C.changesPercentage||0)>=0?"rgba(34, 197, 94, 0.1)":"rgba(239, 68, 68, 0.1)",tension:.4,fill:!0,borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{mode:"index",intersect:!1,backgroundColor:t?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.8)",titleColor:t?"#fff":"#000",bodyColor:t?"#fff":"#000",borderColor:t?"#444":"#ddd",borderWidth:1}},scales:{x:{display:L!=="1D",grid:{display:!1},ticks:{color:t?"#888":"#666",font:{size:8},maxTicksLimit:6}},y:{display:!0,position:"right",grid:{color:t?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},ticks:{color:t?"#888":"#666",font:{size:10},callback:function(a){return"$"+a.toFixed(2)}}}}}})}},width:"100%",height:"140"},`chart-${h}-${L}`):e.jsx("div",{className:"text-center text-gray-500 text-xs py-8",children:"üìà Chargement des donn√©es du graphique..."})}),e.jsx("div",{className:"flex gap-1 mt-1.5",children:["1D","1W","1M","3M","6M","1A","5A","MAX","YTD"].map(s=>e.jsx("button",{onClick:async()=>{G(s);try{P(!0),console.log(`üìä Changement de timeframe vers ${s}...`);const o=await w(h,s);o&&o.quote&&o.quote.price>0&&(T(o),O(!0),ne(new Date),console.log(`‚úÖ Donn√©es ${s} charg√©es avec succ√®s`))}catch(o){console.error("‚ùå Erreur lors du changement de timeframe:",o)}finally{P(!1)}},className:`px-2 py-0.5 rounded text-[9px] font-semibold transition-all ${L===s?t?"bg-neutral-700 text-white border border-neutral-600":"bg-gray-300 text-gray-900 border border-gray-400":t?"bg-neutral-800 hover:bg-neutral-700 border border-neutral-800 text-gray-500":"bg-gray-100 hover:bg-gray-200 border border-gray-200 text-gray-600"}`,children:s},s))})]}),e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("h3",{className:"text-[10px] font-bold mb-1.5 flex items-center gap-1 text-gray-400",children:[e.jsx(m,{name:"BarChart3",className:"w-3 h-3 text-gray-500"}),"Volume & Flux d'Ordres"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{style:{width:"100%",height:80},children:typeof Chart<"u"&&Y.length>0?e.jsx("canvas",{ref:s=>{if(s&&!s.chart){const o=s.getContext("2d");s.chart=new Chart(o,{type:"bar",data:{labels:Y.map(a=>a.date),datasets:[{label:"Volume",data:Y.map(a=>a.volume),backgroundColor:Y.map((a,v)=>v===0||a.close>=Y[v-1].close?"rgba(34, 197, 94, 0.6)":"rgba(239, 68, 68, 0.6)"),borderColor:Y.map((a,v)=>v===0||a.close>=Y[v-1].close?"rgb(34, 197, 94)":"rgb(239, 68, 68)"),borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:t?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.8)",titleColor:t?"#fff":"#000",bodyColor:t?"#fff":"#000"}},scales:{x:{display:!1},y:{display:!0,position:"right",grid:{color:t?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},ticks:{color:t?"#888":"#666",font:{size:9}}}}}})}},width:"100%",height:"80"}):e.jsx("div",{className:"text-center text-gray-500 text-xs py-4",children:"üìä Chargement du volume..."})}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:`flex items-center justify-between p-1.5 border rounded text-[9px] transition-colors duration-300 ${t?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("span",{className:"text-gray-500",children:"Acheteurs"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:`w-16 h-1.5 rounded-full overflow-hidden ${t?"bg-neutral-700":"bg-gray-200"}`,children:e.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${j.buyVolume}%`}})}),e.jsxs("span",{className:"text-emerald-500 font-bold",children:[j.buyVolume,"%"]})]})]}),e.jsxs("div",{className:`flex items-center justify-between p-1.5 border rounded text-[9px] transition-colors duration-300 ${t?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("span",{className:"text-gray-500",children:"Vendeurs"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:`w-16 h-1.5 rounded-full overflow-hidden ${t?"bg-neutral-700":"bg-gray-200"}`,children:e.jsx("div",{className:"h-full bg-red-500",style:{width:`${j.sellVolume}%`}})}),e.jsxs("span",{className:"text-red-500 font-bold",children:[j.sellVolume,"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsxs("div",{className:`p-1.5 border rounded text-center transition-colors duration-300 ${t?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:"text-[8px] text-gray-600",children:"Volume"}),e.jsx("div",{className:`text-xs font-bold transition-colors duration-300 ${t?"text-gray-300":"text-gray-700"}`,children:S(C.volume)})]}),e.jsxs("div",{className:`p-1.5 border rounded text-center transition-colors duration-300 ${t?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:"text-[8px] text-gray-600",children:"Cap"}),e.jsx("div",{className:`text-xs font-bold transition-colors duration-300 ${t?"text-gray-300":"text-gray-700"}`,children:S(C.marketCap)})]})]})]})]})]}),e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 hover-lift shine-effect ${t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("h3",{className:"text-[10px] font-bold mb-2 flex items-center gap-1 text-gray-400",children:[e.jsx(m,{name:"LineChart",className:"w-3 h-3 text-gray-500"}),"TradingView Mini Chart"]}),e.jsx("div",{style:{height:"250px"},children:e.jsx("div",{id:"tradingview-mini-chart-jlab",className:"tradingview-widget-container",style:{height:"100%",width:"100%"},ref:s=>{if(s&&!s.hasChildNodes()){const o=document.createElement("script");o.type="text/javascript",o.src="https://s3.tradingview.com/external-embedding/embed-widget-mini-symbol-overview.js",o.async=!0,o.innerHTML=JSON.stringify({symbol:`NASDAQ:${h}`,width:"100%",height:"100%",locale:"fr",dateRange:"1D",colorTheme:t?"dark":"light",isTransparent:!1,autosize:!0,largeChartUrl:""}),s.appendChild(o)}}})})]}),e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("h3",{className:"text-[10px] font-bold mb-1.5 flex items-center gap-1 text-gray-400",children:[e.jsx(m,{name:"TrendingUp",className:"w-3 h-3 text-gray-500"}),"Moyennes Mobiles & Croisements"]}),e.jsxs("div",{className:`mb-2 p-2 border rounded text-center ${i.interpretation?.trend?.includes("Haussier fort")?t?"bg-emerald-900/30 border-emerald-800":"bg-emerald-50 border-emerald-200":i.interpretation?.trend?.includes("Haussier")?t?"bg-gray-900/30 border-gray-800":"bg-gray-800 border-gray-700":i.interpretation?.trend?.includes("Baissier fort")?t?"bg-red-900/30 border-red-800":"bg-red-50 border-red-200":i.interpretation?.trend?.includes("Baissier")?t?"bg-green-900/30 border-green-800":"bg-green-50 border-green-200":t?"bg-gray-900/30 border-gray-800":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:"text-[8px] text-gray-500 mb-0.5",children:"Tendance Globale"}),e.jsxs("div",{className:`text-xs font-bold ${i.interpretation?.trend?.includes("Haussier")?"text-emerald-500":i.interpretation?.trend?.includes("Baissier")?"text-red-500":"text-gray-400"}`,children:[i.interpretation?.trend==="Haussier fort"&&"üìà ",i.interpretation?.trend==="Baissier fort"&&"üìâ ",i.interpretation?.trend||"Calcul en cours..."]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:`p-1.5 border rounded transition-colors duration-300 ${t?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("div",{className:"text-[9px] font-semibold text-gray-400",children:"SMA 20 jours"}),e.jsxs("div",{className:"text-[9px] text-gray-500",children:["$",i.sma20?.value?.toFixed(2)||"N/A"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:`text-[8px] font-semibold ${i.sma20?.diff>0?"text-emerald-500":"text-red-500"}`,children:[i.interpretation?.sma20,i.sma20?.diff>0?" ‚Üë":" ‚Üì"]}),e.jsxs("div",{className:`text-xs font-bold ${Math.abs(i.sma20?.diff||0)>5?i.sma20?.diff>0?"text-emerald-500":"text-red-500":"text-blue-500"}`,children:[i.sma20?.diff>0?"+":"",i.sma20?.diff?.toFixed(2)||0,"%"]})]}),e.jsx("div",{className:"text-[7px] text-gray-500 mt-1 italic",children:Math.abs(i.sma20?.diff||0)<2?"üí° Proche de la moyenne - Zone de consolidation":i.sma20?.diff>5?"üöÄ Fort au-dessus - Momentum haussier":i.sma20?.diff<-5?"‚ö†Ô∏è Fort en-dessous - Pression baissi√®re":i.sma20?.diff>0?"‚úÖ Au-dessus - Signal positif":"‚ö†Ô∏è En-dessous - Signal n√©gatif"})]}),e.jsxs("div",{className:`p-1.5 border rounded transition-colors duration-300 ${t?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("div",{className:"text-[9px] font-semibold text-gray-400",children:"SMA 50 jours"}),e.jsxs("div",{className:"text-[9px] text-gray-500",children:["$",i.sma50?.value?.toFixed(2)||"N/A"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:`text-[8px] font-semibold ${i.sma50?.diff>0?"text-emerald-500":"text-red-500"}`,children:[i.interpretation?.sma50,i.sma50?.diff>0?" ‚Üë":" ‚Üì"]}),e.jsxs("div",{className:`text-xs font-bold ${Math.abs(i.sma50?.diff||0)>5?i.sma50?.diff>0?"text-emerald-500":"text-red-500":"text-blue-500"}`,children:[i.sma50?.diff>0?"+":"",i.sma50?.diff?.toFixed(2)||0,"%"]})]}),e.jsx("div",{className:"text-[7px] text-gray-500 mt-1 italic",children:i.sma50?.diff>0&&i.sma20?.diff>0?"üìä Tendance moyen terme positive":i.sma50?.diff<0&&i.sma20?.diff<0?"üìâ Tendance moyen terme n√©gative":i.sma50?.diff>0?"‚ö° Support potentiel - Test en cours":"‚ö†Ô∏è R√©sistance - Vigilance recommand√©e"})]}),e.jsxs("div",{className:`p-1.5 border rounded transition-colors duration-300 ${t?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("div",{className:"text-[9px] font-semibold text-gray-400",children:"SMA 200 jours"}),e.jsxs("div",{className:"text-[9px] text-gray-500",children:["$",i.sma200?.value?.toFixed(2)||"N/A"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:`text-[8px] font-semibold ${i.sma200?.diff>0?"text-emerald-500":"text-red-500"}`,children:[i.interpretation?.sma200,i.sma200?.diff>0?" ‚Üë":" ‚Üì"]}),e.jsxs("div",{className:`text-xs font-bold ${Math.abs(i.sma200?.diff||0)>10?i.sma200?.diff>0?"text-emerald-500":"text-red-500":"text-blue-500"}`,children:[i.sma200?.diff>0?"+":"",i.sma200?.diff?.toFixed(2)||0,"%"]})]}),e.jsx("div",{className:"text-[7px] text-gray-500 mt-1 italic",children:i.sma200?.diff>10?"üéØ Bull Market confirm√© - Tendance long terme haussi√®re":i.sma200?.diff>0?"‚úÖ Au-dessus SMA200 - March√© haussier":i.sma200?.diff<-10?"üêª Bear Market - Tendance long terme baissi√®re":"‚ö†Ô∏è En-dessous SMA200 - March√© baissier"})]})]}),i.sma20&&i.sma50&&e.jsxs("div",{className:`mt-2 p-2 border rounded text-[8px] ${i.sma20.value>i.sma50.value&&i.sma50.value>i.sma200.value?t?"bg-emerald-900/20 border-emerald-800 text-emerald-300":"bg-emerald-50 border-emerald-200 text-emerald-700":i.sma20.value<i.sma50.value&&i.sma50.value<i.sma200.value?t?"bg-red-900/20 border-red-800 text-red-300":"bg-red-50 border-red-200 text-red-700":t?"bg-yellow-900/20 border-yellow-800 text-yellow-300":"bg-yellow-50 border-yellow-200 text-yellow-700"}`,children:[e.jsxs("div",{className:"font-semibold mb-1 flex items-center gap-2",children:[e.jsx(Icon,{emoji:"üìä",size:16}),"Analyse des Croisements"]}),i.sma20.value>i.sma50.value&&i.sma50.value>i.sma200.value?e.jsx("div",{children:"‚úÖ Configuration id√©ale : SMA20 > SMA50 > SMA200. Tendance haussi√®re confirm√©e sur tous les horizons temporels."}):i.sma20.value<i.sma50.value&&i.sma50.value<i.sma200.value?e.jsx("div",{children:"‚ö†Ô∏è Configuration baissi√®re : SMA20 < SMA50 < SMA200. Pression vendeuse sur tous les horizons. Prudence recommand√©e."}):i.sma20.value>i.sma50.value?e.jsx("div",{children:"‚ö° Croisement r√©cent possible : SMA20 au-dessus de SMA50. Signal de retournement haussier √† confirmer."}):e.jsx("div",{children:"üìâ Moyennes d√©salign√©es : Configuration mixte. Attendre confirmation de tendance avant prise de position."})]})]}),e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("h3",{className:"text-[10px] font-bold mb-1.5 flex items-center gap-1 text-gray-400",children:[e.jsx(m,{name:"Activity",className:"w-3 h-3 text-gray-500"}),"Indicateurs Techniques"]}),e.jsx("div",{className:"grid grid-cols-2 gap-1.5",children:Object.entries(g).map(([s,o])=>{const a=o.signal==="Achat"||o.signal==="Bullish"||o.signal==="Au-dessus"?"text-emerald-500":o.signal==="Neutre"?"text-blue-500":"text-red-500";return e.jsxs("div",{className:`flex items-center justify-between p-1.5 border rounded transition-colors duration-300 ${t?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-[9px] text-gray-400",children:s.replace("_"," ")}),e.jsx("div",{className:`text-[8px] font-semibold ${a}`,children:o.signal})]}),e.jsx("div",{className:`text-sm font-bold ${a}`,children:typeof o.value=="number"?o.value.toFixed(2):o.value})]},s)})})]}),e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("h3",{className:"text-[10px] font-bold mb-1.5 flex items-center gap-1 text-gray-400",children:[e.jsx(m,{name:"DollarSign",className:"w-3 h-3 text-gray-500"}),"Analyse Fondamentale"]}),e.jsx("div",{className:"grid grid-cols-3 gap-1.5",children:[{label:"P/E",value:oe.peRatioTTM,suffix:"x",metric:"PE"},{label:"PEG",value:oe.pegRatioTTM,suffix:"",metric:"PEG"},{label:"P/S",value:oe.priceToSalesRatioTTM,suffix:"x",metric:"PS"},{label:"ROE",value:ue.returnOnEquityTTM?ue.returnOnEquityTTM*100:null,suffix:"%",metric:"ROE",isPercent:!0},{label:"ROA",value:ue.returnOnAssetsTTM?ue.returnOnAssetsTTM*100:null,suffix:"%",metric:"ROA",isPercent:!0},{label:"D/E",value:ue.debtEquityRatio,suffix:"x",metric:"DE"},{label:"Marge",value:ue.netProfitMarginTTM?ue.netProfitMarginTTM*100:null,suffix:"%",metric:"Margin",isPercent:!0},{label:"Beta",value:ie.beta,suffix:"",metric:"Beta"},{label:"Div",value:oe.dividendYieldTTM?oe.dividendYieldTTM*100:null,suffix:"%",metric:"Div",isPercent:!0}].map(s=>e.jsxs("div",{className:`p-1.5 border rounded text-center transition-colors duration-300 ${t?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:"text-[8px] text-gray-600 mb-0.5",children:s.label}),e.jsx("div",{className:`text-xs font-bold transition-colors duration-300 ${q(s.metric,s.value)}`,children:s.value!=null?typeof s.value=="number"?s.value.toFixed(s.isPercent?1:2)+s.suffix:s.value:"N/A"})]},s.label))})]}),e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("h3",{className:"text-[10px] font-bold mb-2 flex items-center gap-1 text-gray-400",children:[e.jsx(m,{name:"TrendingUp",className:"w-3 h-3 text-gray-500"}),"Ratios Historiques (Tendances)"]}),n.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:`border rounded p-1.5 ${t?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:"text-[9px] font-semibold text-gray-400 mb-1",children:"P/E Ratio (Price to Earnings)"}),e.jsx("div",{style:{width:"100%",height:60},children:e.jsx("canvas",{ref:s=>{if(s&&!s.chart&&n.length>0){const o=s.getContext("2d"),a=n.map(f=>f.peRatioTTM).filter(f=>f!=null).reverse(),v=n.map(f=>new Date(f.date).toLocaleDateString("fr-FR",{month:"short",year:"2-digit"})).reverse();s.chart=new Chart(o,{type:"line",data:{labels:v,datasets:[{label:"P/E",data:a,borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.3,fill:!0,borderWidth:2,pointRadius:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:t?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.8)",titleColor:t?"#fff":"#000",bodyColor:t?"#fff":"#000",borderColor:t?"#444":"#ddd",borderWidth:1}},scales:{x:{display:!0,grid:{display:!1},ticks:{color:t?"#888":"#666",font:{size:8}}},y:{display:!0,position:"right",grid:{color:t?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},ticks:{color:t?"#888":"#666",font:{size:8}}}}}})}},width:"100%",height:"60"})})]}),e.jsxs("div",{className:`border rounded p-1.5 ${t?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:"text-[9px] font-semibold text-gray-400 mb-1",children:"ROE (Return on Equity)"}),e.jsx("div",{style:{width:"100%",height:60},children:e.jsx("canvas",{ref:s=>{if(s&&!s.chart&&n.length>0){const o=s.getContext("2d"),a=n.map(f=>f.returnOnEquityTTM?f.returnOnEquityTTM*100:null).filter(f=>f!=null).reverse(),v=n.map(f=>new Date(f.date).toLocaleDateString("fr-FR",{month:"short",year:"2-digit"})).reverse();s.chart=new Chart(o,{type:"line",data:{labels:v,datasets:[{label:"ROE %",data:a,borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.3,fill:!0,borderWidth:2,pointRadius:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:t?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.8)",titleColor:t?"#fff":"#000",bodyColor:t?"#fff":"#000",borderColor:t?"#444":"#ddd",borderWidth:1,callbacks:{label:f=>`ROE: ${f.parsed.y.toFixed(2)}%`}}},scales:{x:{display:!0,grid:{display:!1},ticks:{color:t?"#888":"#666",font:{size:8}}},y:{display:!0,position:"right",grid:{color:t?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},ticks:{color:t?"#888":"#666",font:{size:8},callback:f=>f.toFixed(1)+"%"}}}}})}},width:"100%",height:"60"})})]}),e.jsxs("div",{className:`border rounded p-1.5 ${t?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:"text-[9px] font-semibold text-gray-400 mb-1",children:"D/E Ratio (Debt to Equity)"}),e.jsx("div",{style:{width:"100%",height:60},children:e.jsx("canvas",{ref:s=>{if(s&&!s.chart&&n.length>0){const o=s.getContext("2d"),a=n.map(f=>f.debtEquityRatioTTM).filter(f=>f!=null).reverse(),v=n.map(f=>new Date(f.date).toLocaleDateString("fr-FR",{month:"short",year:"2-digit"})).reverse();s.chart=new Chart(o,{type:"bar",data:{labels:v,datasets:[{label:"D/E",data:a,backgroundColor:a.map(f=>f>1?"rgba(239, 68, 68, 0.6)":"rgba(34, 197, 94, 0.6)"),borderColor:a.map(f=>f>1?"rgb(239, 68, 68)":"rgb(34, 197, 94)"),borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:t?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.8)",titleColor:t?"#fff":"#000",bodyColor:t?"#fff":"#000",borderColor:t?"#444":"#ddd",borderWidth:1}},scales:{x:{display:!0,grid:{display:!1},ticks:{color:t?"#888":"#666",font:{size:8}}},y:{display:!0,position:"right",grid:{color:t?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},ticks:{color:t?"#888":"#666",font:{size:8}}}}}})}},width:"100%",height:"60"})})]}),e.jsxs("div",{className:`border rounded p-1.5 ${t?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:"text-[9px] font-semibold text-gray-400 mb-1",children:"Marge Nette (Net Profit Margin)"}),e.jsx("div",{style:{width:"100%",height:60},children:e.jsx("canvas",{ref:s=>{if(s&&!s.chart&&n.length>0){const o=s.getContext("2d"),a=n.map(f=>f.netProfitMarginTTM?f.netProfitMarginTTM*100:null).filter(f=>f!=null).reverse(),v=n.map(f=>new Date(f.date).toLocaleDateString("fr-FR",{month:"short",year:"2-digit"})).reverse();s.chart=new Chart(o,{type:"line",data:{labels:v,datasets:[{label:"Marge %",data:a,borderColor:"rgb(168, 85, 247)",backgroundColor:"rgba(168, 85, 247, 0.1)",tension:.3,fill:!0,borderWidth:2,pointRadius:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:t?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.8)",titleColor:t?"#fff":"#000",bodyColor:t?"#fff":"#000",borderColor:t?"#444":"#ddd",borderWidth:1,callbacks:{label:f=>`Marge: ${f.parsed.y.toFixed(2)}%`}}},scales:{x:{display:!0,grid:{display:!1},ticks:{color:t?"#888":"#666",font:{size:8}}},y:{display:!0,position:"right",grid:{color:t?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},ticks:{color:t?"#888":"#666",font:{size:8},callback:f=>f.toFixed(1)+"%"}}}}})}},width:"100%",height:"60"})})]})]}):e.jsxs("div",{className:"text-center text-gray-500 text-xs py-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(Icon,{emoji:"üìä",size:24})}),e.jsx("div",{children:"Chargement des ratios historiques..."})]})]}),x.catalysts&&e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("h3",{className:"text-[10px] font-bold mb-1.5 flex items-center gap-1 text-gray-400",children:[e.jsx(m,{name:"Brain",className:"w-3 h-3 text-gray-500"}),"Insights IA (Perplexity)"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[9px] text-gray-500 mb-1 font-semibold",children:"üöÄ Catalyseurs"}),x.catalysts.map((s,o)=>e.jsxs("div",{className:"text-[8px] text-emerald-400 mb-0.5",children:["‚Ä¢ ",s]},o))]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[9px] text-gray-500 mb-1 font-semibold",children:"‚ö†Ô∏è Risques"}),x.risks.map((s,o)=>e.jsxs("div",{className:"text-[8px] text-green-400 mb-0.5",children:["‚Ä¢ ",s]},o))]}),e.jsxs("div",{className:`p-1.5 border rounded transition-colors duration-300 ${t?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{className:"text-[9px] text-gray-500 mb-0.5",children:["Consensus :",e.jsx("span",{className:`ml-1 font-bold ${x.consensus==="bullish"?"text-emerald-500":x.consensus==="bearish"?"text-red-500":"text-gray-400"}`,children:x.consensus==="bullish"?"üìà Bullish":x.consensus==="bearish"?"üìâ Bearish":"‚ûñ Neutre"})]}),e.jsx("div",{className:"text-[8px] text-gray-400",children:x.reasoning})]})]})]}),e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("h3",{className:"text-[10px] font-bold mb-1.5 flex items-center gap-1 text-gray-400",children:[e.jsx(m,{name:"TrendingUp",className:"w-3 h-3 text-gray-500"}),"Comparaison Pairs"]}),e.jsx("div",{style:{width:"100%",height:120},children:e.jsx("div",{className:"text-center text-gray-500 text-xs py-8",children:"üìä Graphique Radar (Recharts n√©cessite une configuration avanc√©e)"})})]})]}),e.jsxs("div",{className:"col-span-4 space-y-2",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsx("div",{className:"text-[8px] text-gray-600 mb-0.5",children:"Capitalisation"}),e.jsx("div",{className:`text-base font-bold transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:S(C.marketCap)}),e.jsxs("div",{className:"text-[8px] text-gray-500",children:["P/E: ",oe.peRatioTTM?.toFixed(1)||"N/A"]})]}),e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsx("div",{className:"text-[8px] text-gray-600 mb-0.5",children:"Sentiment IA"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("div",{className:"text-base font-bold text-emerald-500",children:[d.overall||0,"%"]}),e.jsx("div",{className:`flex-1 h-1.5 rounded-full overflow-hidden ${t?"bg-neutral-700":"bg-gray-200"}`,children:e.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${d.overall||0}%`}})})]}),e.jsx("div",{className:"text-[8px] text-emerald-500 mt-0.5",children:(d.overall||0)>70?"Tr√®s Bullish":(d.overall||0)>50?"Bullish":"Neutre"})]}),e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsx("div",{className:"text-[8px] text-gray-600 mb-0.5",children:"Prix Actuel"}),e.jsxs("div",{className:`text-base font-bold transition-colors duration-300 ${t?"text-white":"text-gray-900"}`,children:["$",parseFloat(C.price||0).toFixed(2)]}),e.jsxs("div",{className:"text-[8px] text-emerald-500 mt-0.5",children:["Volume: ",S(C.volume)]})]})]}),d.overall&&e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("h3",{className:"text-[9px] font-bold mb-1.5 flex items-center gap-1 text-gray-400",children:[e.jsx(m,{name:"Brain",className:"w-3 h-3 text-gray-500"}),"Sentiment IA"]}),e.jsx("div",{style:{width:"100%",height:90},children:e.jsx("div",{className:"text-center text-gray-500 text-xs py-6",children:"üìä Graphique Sentiment"})}),d.summary&&e.jsx("div",{className:`mt-1.5 p-1.5 border rounded transition-colors duration-300 ${t?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200"}`,children:e.jsx("div",{className:"text-[8px] text-gray-400",children:d.summary})})]}),e.jsxs("div",{className:`border rounded-lg p-2 transition-colors duration-300 ${t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:[e.jsxs("h3",{className:"text-[9px] font-bold mb-1.5 flex items-center gap-1 text-gray-400",children:[e.jsx(m,{name:"Newspaper",className:"w-3 h-3 text-gray-500"}),"News Temps R√©el"]}),e.jsx("div",{className:"space-y-1 max-h-40 overflow-y-auto",children:ce.map((s,o)=>e.jsxs("div",{className:`p-1.5 border rounded transition-all cursor-pointer ${t?"bg-neutral-800 border-neutral-700 hover:bg-neutral-750":"bg-gray-50 border-gray-200 hover:bg-gray-100"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-0.5",children:[e.jsx("div",{className:"text-[7px] px-1 py-0.5 rounded bg-emerald-900 text-emerald-500",children:"üìà"}),e.jsx("span",{className:"text-[7px] text-gray-600",children:c(s.publishedDate)})]}),e.jsx("div",{className:`font-semibold text-[8px] mb-0.5 transition-colors duration-300 ${t?"text-gray-300":"text-gray-700"}`,children:s.title}),e.jsx("div",{className:"text-[7px] text-gray-500",children:s.site})]},o))})]})]})]}),e.jsx("div",{className:`mt-2 p-1.5 border rounded-lg transition-colors duration-300 ${t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{name:"AlertCircle",className:"w-3 h-3 text-gray-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-[9px] text-gray-400",children:"‚úÖ Dashboard Hybride Fonctionnel"}),e.jsx("div",{className:"text-[7px] text-gray-600",children:"Mode D√©mo ‚Ä¢ FMP (donn√©es pr√©cises) + Perplexity (intelligence IA)"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-[8px] text-gray-500 font-bold",children:"Hybride Optimal"}),e.jsx("div",{className:"text-[7px] text-gray-600",children:"Pr√©cision + IA"})]})]})})]})]})},kt=D=>{const{isDarkMode:t=!0}=D,[b,F]=p.useState("economic"),[h,M]=p.useState([{date:"Mon Oct 16",events:[{time:"12:55 PM",currency:"USD",impact:2,event:"Fed Paulson Speech",actual:"N/A",forecast:"N/A",previous:"N/A"},{time:"08:30 AM",currency:"USD",impact:3,event:"NY Empire State Manufacturing Index",actual:"10.70",forecast:"-1.00",previous:"-8.70"}]}]),[L,G]=p.useState(!1),[E,I]=p.useState(null),[u,T]=p.useState(!1),[z,P]=p.useState(""),[H,O]=p.useState("all"),[Q,ne]=p.useState("all"),[re,K]=p.useState("all"),[R,J]=p.useState("all"),[de,V]=p.useState("week"),[r,l]=p.useState(!0),y=["AAPL","MSFT","GOOGL","GOOG","AMZN","NVDA","META","TSLA","BRK.B","UNH","JNJ","V","XOM","WMT","JPM","MA","PG","CVX","HD","ABBV","MRK","PEP","COST","AVGO","ADBE","TMO","CSCO","ACN","DHR","NFLX","VZ","ABT","NKE","CMCSA","WFC","PM","TXN","LIN","NEE","DIS","HON","QCOM","UPS","IBM","RTX","AMGN","T","SPGI","INTU","DE","AMAT","LOW","SBUX","GS","CAT","AXP","BKNG","ADP","SYK","TJX","GE","ISRG","VRTX","ZTS","MU","FI","C","MDT","GILD","REGN","BLK","ETN","SHW","KLAC","WM","APH","LRCX","ADI","CDNS","SNPS"],[w,k]=p.useState([]),[q,se]=p.useState([]),B=()=>[{date:"Mon Oct 16",events:[{time:"12:55 PM",currency:"USD",impact:2,event:"Fed Paulson Speech",actual:"N/A",forecast:"N/A",previous:"N/A"},{time:"08:30 AM",currency:"USD",impact:3,event:"NY Empire State Manufacturing Index",actual:"10.70",forecast:"-1.00",previous:"-8.70"}]}];console.log("üìÖ EconomicCalendarTab charg√©"),console.log("üìä Donn√©es init:",h),console.log("üîß √âtat du composant:",{activeSubTab:b,loading:L,error:E}),et.useEffect(()=>{(async()=>{try{const j=await(await fetch("/api/tickers-config")).json();j.success&&(k(j.team_tickers||[]),console.log(`‚úÖ Team tickers loaded: ${j.team_tickers?.length||0}`))}catch(g){console.error("‚ùå Error loading team tickers:",g)}try{const j=await(await fetch("/api/supabase-watchlist")).json();j.tickers&&Array.isArray(j.tickers)&&(se(j.tickers),console.log(`‚úÖ Watchlist tickers loaded: ${j.tickers.length}`))}catch(g){console.error("‚ùå Error loading watchlist tickers:",g);const j=localStorage.getItem("dans-watchlist");if(j){const m=JSON.parse(j);se(m),console.log(`üì¶ Watchlist loaded from localStorage: ${m.length}`)}}})()},[]),et.useEffect(()=>{C(),K("all"),J("all"),l(b==="earnings")},[b]);const C=async()=>{console.log("üîÑ fetchCalendarData appel√© pour:",b),G(!0),I(null);try{if(b==="earnings"){const g=await(await fetch("/api/calendar-earnings")).json();g.success&&g.data?(M(g.data),console.log(`‚úÖ ${g.data.length} earnings calendar days loaded from ${g.source}`),g.fallback_tried&&console.log("‚ö†Ô∏è Fallback sources tried:",g.fallback_tried)):(I("Aucune donn√©e d'earnings disponible"),M(B()))}else if(b==="economic"){const g=await(await fetch("/api/calendar-economic")).json();g.success&&g.data?(M(g.data),console.log(`‚úÖ ${g.data.length} economic calendar days loaded from ${g.source}`),g.fallback_tried&&console.log("‚ö†Ô∏è Fallback sources tried:",g.fallback_tried)):(I("Aucune donn√©e √©conomique disponible"),M(B()))}else if(b==="dividends"){const g=await(await fetch("/api/calendar-dividends")).json();g.success&&g.data?(M(g.data),console.log(`‚úÖ ${g.data.length} dividend events loaded from ${g.source}`),g.fallback_tried&&console.log("‚ö†Ô∏è Fallback sources tried:",g.fallback_tried)):(I("Aucune donn√©e de dividendes disponible"),M(B()))}else M(B())}catch(c){console.error("‚ùå Erreur fetchCalendarData:",c),I(`Impossible de charger les donn√©es: ${c.message}`),M(B())}finally{G(!1)}},oe=async()=>{console.log("üîÑ Actualisation du calendrier..."),T(!0),await C(),setTimeout(()=>T(!1),1e3)},ue=c=>{const g=[],j=["bg-yellow-500","bg-green-500","bg-red-500"];for(let m=0;m<3;m++)g.push(e.jsx("div",{className:`w-3 h-5 rounded-sm ${m<c?j[m]:"bg-gray-600"} ${m<c?"opacity-100":"opacity-30"}`},m));return g},ie=(c,g)=>{if(c==="N/A"||g==="N/A")return"text-gray-400";const j=parseFloat(c),m=parseFloat(g);return j>m?"text-green-400":j<m?"text-red-400":"text-gray-400"},Y=c=>({USD:"üá∫üá∏",EUR:"üá™üá∫",GBP:"üá¨üáß",JPY:"üáØüáµ",CAD:"üá®üá¶",AUD:"üá¶üá∫",CHF:"üá®üá≠",CNY:"üá®üá≥",NZD:"üá≥üáø"})[c]||"üåç",ce=c=>{const g=c.match(/^([A-Z]{1,5})\s/);return g?g[1]:null},d=c=>{const g=ce(c.event);return g&&w.includes(g)?1:c.currency==="CAD"||g&&g.endsWith(".TO")?2:c.currency==="USD"&&(!g||!g.endsWith(".TO"))?3:4},x=c=>[...c].sort((g,j)=>{const m=d(g),s=d(j);if(m!==s)return m-s;const o=g.time||"",a=j.time||"";return o.localeCompare(a)}),n=(Array.isArray(h)?h:[]).map(c=>{const g=(Array.isArray(c.events)?c.events:[]).filter(m=>{if(z&&!m.event.toLowerCase().includes(z.toLowerCase())||H!=="all"&&m.impact!==parseInt(H)||Q!=="all"&&m.currency!==Q)return!1;if(re!=="all"&&(b==="earnings"||b==="dividends")){const s=ce(m.event);if(!s||s!==re)return!1}if(R!=="all"&&(b==="earnings"||b==="dividends")){const s=ce(m.event);if(!s)return!1;const o=w.includes(s),a=q.includes(s);if(R==="team"&&!o||R==="watchlist"&&!a||R==="both"&&!(o||a))return!1}if(r&&b==="earnings"){const s=ce(m.event);if(!s||!y.includes(s))return!1}return!0}),j=x(g);return{...c,events:j}}).filter(c=>c.events.length>0),i=[...new Set((Array.isArray(h)?h:[]).flatMap(c=>(Array.isArray(c.events)?c.events:[]).map(g=>g.currency||"USD")))].sort(),S=b==="earnings"||b==="dividends"?[...new Set((Array.isArray(h)?h:[]).flatMap(c=>(Array.isArray(c.events)?c.events:[]).map(g=>ce(g.event)).filter(g=>g!==null)))].sort():[];return e.jsx("div",{className:`${t?"bg-gray-900 text-gray-200":"bg-white text-gray-900"} p-6`,children:e.jsxs("div",{className:"max-w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-2xl",children:"üìÖ"}),e.jsx("h2",{className:"text-2xl font-bold",children:"Calendrier financier"})]}),e.jsxs("button",{onClick:oe,disabled:L||u,className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors text-sm ${L||u?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-gray-800 hover:bg-gray-700 text-white"}`,children:[e.jsx("div",{className:`w-4 h-4 ${L||u?"animate-spin":""}`,children:"üîÑ"}),"Actualiser"]})]}),e.jsxs("div",{className:`${t?"bg-gray-800":"bg-gray-100"} rounded-lg p-4 mb-4`,children:[e.jsxs("div",{className:`grid grid-cols-1 gap-3 ${b==="earnings"||b==="dividends"?"md:grid-cols-6":"md:grid-cols-4"}`,children:[e.jsx("div",{className:"col-span-1 md:col-span-2",children:e.jsx("input",{type:"text",placeholder:"üîç Rechercher un √©v√©nement...",value:z,onChange:c=>P(c.target.value),className:`w-full px-3 py-2 rounded-md text-sm ${t?"bg-gray-700 text-white border-gray-600":"bg-white text-gray-900 border-gray-300"} border focus:outline-none focus:ring-2 focus:ring-blue-500`})}),(b==="earnings"||b==="dividends")&&e.jsx("div",{children:e.jsxs("select",{value:R,onChange:c=>{J(c.target.value),c.target.value!=="all"&&K("all")},className:`w-full px-3 py-2 rounded-md text-sm ${t?"bg-gray-700 text-white border-gray-600":"bg-white text-gray-900 border-gray-300"} border focus:outline-none focus:ring-2 focus:ring-blue-500`,children:[e.jsx("option",{value:"all",children:"Tous les titres"}),e.jsxs("option",{value:"team",children:["üë• √âquipe (",w.length,")"]}),e.jsxs("option",{value:"watchlist",children:["‚≠ê Liste de suivi (",q.length,")"]}),e.jsxs("option",{value:"both",children:["üéØ √âquipe + Liste (",w.length+q.length,")"]})]})}),(b==="earnings"||b==="dividends")&&e.jsx("div",{children:e.jsxs("select",{value:re,onChange:c=>K(c.target.value),disabled:R!=="all",className:`w-full px-3 py-2 rounded-md text-sm ${t?"bg-gray-700 text-white border-gray-600":"bg-white text-gray-900 border-gray-300"} border focus:outline-none focus:ring-2 focus:ring-blue-500 ${R!=="all"?"opacity-50 cursor-not-allowed":""}`,children:[e.jsxs("option",{value:"all",children:["S√©lectionner un ticker (",S.length,")"]}),S.map(c=>e.jsx("option",{value:c,children:c},c))]})}),e.jsx("div",{children:e.jsxs("select",{value:H,onChange:c=>O(c.target.value),className:`w-full px-3 py-2 rounded-md text-sm ${t?"bg-gray-700 text-white border-gray-600":"bg-white text-gray-900 border-gray-300"} border focus:outline-none focus:ring-2 focus:ring-blue-500`,children:[e.jsx("option",{value:"all",children:"Tous les impacts"}),e.jsx("option",{value:"3",children:"üî¥ Impact √©lev√©"}),e.jsx("option",{value:"2",children:"üü† Impact moyen"}),e.jsx("option",{value:"1",children:"üü° Impact faible"})]})}),e.jsx("div",{children:e.jsxs("select",{value:Q,onChange:c=>ne(c.target.value),className:`w-full px-3 py-2 rounded-md text-sm ${t?"bg-gray-700 text-white border-gray-600":"bg-white text-gray-900 border-gray-300"} border focus:outline-none focus:ring-2 focus:ring-blue-500`,children:[e.jsx("option",{value:"all",children:"Toutes les devises"}),i.map(c=>e.jsxs("option",{value:c,children:[Y(c)," ",c]},c))]})}),b==="earnings"&&e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm cursor-pointer transition-colors ${t?r?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600":r?"bg-blue-500 text-white":"bg-white text-gray-700 hover:bg-gray-50"} border ${t?"border-gray-600":"border-gray-300"}`,children:[e.jsx("input",{type:"checkbox",checked:r,onChange:c=>l(c.target.checked),className:"w-4 h-4 cursor-pointer"}),e.jsx("span",{className:"font-medium",children:"Grandes capitalisations seulement"})]})})]}),(z||H!=="all"||Q!=="all"||re!=="all"||R!=="all"||b==="earnings"&&r)&&e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"Filtres actifs :"}),b==="earnings"&&r&&e.jsx("span",{className:`text-xs px-2 py-1 rounded ${t?"bg-blue-900 text-blue-200":"bg-blue-100 text-blue-800"}`,children:"üìä Grandes capitalisations"}),z&&e.jsxs("span",{className:`text-xs px-2 py-1 rounded ${t?"bg-gray-900 text-gray-200":"bg-gray-700 text-gray-200"}`,children:['Recherche¬†: "',z,'"']}),R!=="all"&&e.jsx("span",{className:`text-xs px-2 py-1 rounded ${t?"bg-cyan-900 text-cyan-200":"bg-cyan-100 text-cyan-800"}`,children:R==="team"?"üë• Tickers √©quipe":R==="watchlist"?"‚≠ê Tickers liste de suivi":"üéØ √âquipe + Liste de suivi"}),re!=="all"&&e.jsxs("span",{className:`text-xs px-2 py-1 rounded ${t?"bg-purple-900 text-purple-200":"bg-purple-100 text-purple-800"}`,children:["Ticker¬†: ",re]}),H!=="all"&&e.jsxs("span",{className:`text-xs px-2 py-1 rounded ${t?"bg-green-900 text-green-200":"bg-green-100 text-green-800"}`,children:["Impact¬†: ",H==="3"?"√âlev√©":H==="2"?"Moyen":"Faible"]}),Q!=="all"&&e.jsxs("span",{className:`text-xs px-2 py-1 rounded ${t?"bg-green-900 text-green-200":"bg-green-100 text-green-800"}`,children:["Devise¬†: ",Q]}),e.jsx("button",{onClick:()=>{P(""),O("all"),ne("all"),K("all"),J("all"),l(b==="earnings")},className:"text-xs text-red-400 hover:text-red-300 underline",children:"R√©initialiser"})]})]}),E&&e.jsxs("div",{className:"bg-red-900/50 border border-red-500 text-red-200 px-4 py-3 rounded-lg mb-4 text-sm",children:["‚ö†Ô∏è ",E]}),e.jsxs("div",{className:"flex gap-0 mb-4 border-b border-gray-700",children:[e.jsx("button",{onClick:()=>F("economic"),className:`px-4 py-2 font-medium transition-colors text-sm ${b==="economic"?"bg-gray-800 text-white":`${t?"bg-gray-800 text-gray-400 hover:bg-gray-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`}`,children:"√âconomique"}),e.jsx("button",{onClick:()=>F("earnings"),className:`px-4 py-2 font-medium transition-colors text-sm ${b==="earnings"?"bg-gray-800 text-white":`${t?"bg-gray-800 text-gray-400 hover:bg-gray-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`}`,children:"Earnings"}),e.jsx("button",{onClick:()=>F("dividends"),className:`px-4 py-2 font-medium transition-colors text-sm ${b==="dividends"?"bg-gray-800 text-white":`${t?"bg-gray-800 text-gray-400 hover:bg-gray-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`}`,children:"Dividendes"})]}),L?e.jsxs("div",{className:`${t?"bg-gray-800":"bg-gray-100"} rounded-lg p-8 text-center`,children:[e.jsx("div",{className:"w-8 h-8 text-blue-500 animate-spin mx-auto mb-3",children:"üîÑ"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Loading data..."})]}):n.length===0?e.jsxs("div",{className:`${t?"bg-gray-800":"bg-gray-100"} rounded-lg p-8 text-center`,children:[e.jsx("p",{className:"text-gray-400 text-sm",children:h.length===0?"No data available":"No events match your filters"}),h.length>0&&e.jsx("button",{onClick:()=>{P(""),O("all"),ne("all")},className:"mt-3 text-blue-400 hover:text-blue-300 underline text-sm",children:"Clear filters"})]}):e.jsx("div",{className:`${t?"bg-gray-800":"bg-gray-100"} rounded-lg overflow-hidden shadow-lg`,children:n.map((c,g)=>e.jsxs("div",{className:"border-b border-gray-700 last:border-b-0",children:[e.jsx("div",{className:`${t?"bg-gray-750":"bg-gray-200"} px-4 py-2 font-semibold text-sm`,children:c.date}),g===0&&e.jsxs("div",{className:`grid grid-cols-[80px_1fr_80px_60px_90px_90px_90px] gap-3 px-4 py-3 ${t?"bg-gray-900":"bg-gray-300"} text-xs font-bold ${t?"text-gray-300":"text-gray-700"} border-b-2 ${t?"border-gray-600":"border-gray-400"}`,children:[e.jsx("div",{children:"TIME"}),e.jsx("div",{children:"EVENT"}),e.jsx("div",{children:"IMPACT"}),e.jsx("div",{children:"FOR"}),e.jsx("div",{className:"text-center",children:"ACTUAL"}),e.jsx("div",{className:"text-center",children:"FORECAST"}),e.jsx("div",{className:"text-center",children:"PREVIOUS"})]}),c.events.map((j,m)=>e.jsxs("div",{className:`grid grid-cols-[80px_1fr_80px_60px_90px_90px_90px] gap-3 px-4 py-3 ${t?"hover:bg-gray-750":"hover:bg-gray-200"} transition-colors border-b ${t?"border-gray-700":"border-gray-300"} last:border-b-0 items-center text-sm`,children:[e.jsx("div",{className:`${t?"text-gray-400":"text-gray-600"} font-mono text-xs`,children:j.time}),e.jsxs("div",{className:"font-medium flex items-center gap-2",title:j.event,children:[e.jsx("span",{className:"text-lg",children:Y(j.currency)}),e.jsx("span",{className:`${t?"text-gray-200":"text-gray-800"} truncate`,children:j.event})]}),e.jsx("div",{className:"flex gap-1",children:ue(j.impact)}),e.jsx("div",{className:`${t?"text-gray-400":"text-gray-600"} font-semibold text-xs`,children:j.currency}),e.jsx("div",{className:`text-center font-bold ${ie(j.actual,j.forecast)}`,children:j.actual}),e.jsx("div",{className:`text-center ${t?"text-gray-400":"text-gray-600"}`,children:j.forecast}),e.jsx("div",{className:`text-center ${t?"text-gray-400":"text-gray-600"}`,children:j.previous})]},m))]},g))}),e.jsx("div",{className:`mt-4 ${t?"bg-gray-800":"bg-gray-100"} rounded-lg p-4`,children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-xs",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:`${t?"text-gray-400":"text-gray-600"}`,children:["Showing ",n.reduce((c,g)=>c+g.events.length,0)," events"]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold ${isDarkMode ? 'text-gray-300' : 'text-gray-700'}",children:"Impact:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-sm"}),e.jsx("span",{className:`${t?"text-gray-400":"text-gray-600"}`,children:"High"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-sm"}),e.jsx("span",{className:`${t?"text-gray-400":"text-gray-600"}`,children:"Medium"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-sm"}),e.jsx("span",{className:`${t?"text-gray-400":"text-gray-600"}`,children:"Low"})]})]}),e.jsx("div",{className:"ml-auto text-gray-500 text-xs italic",children:"Data powered by FMP API"})]})})]})})},St=()=>{const[D,t]=p.useState("stocks-news"),[b,F]=p.useState(!0),[h,M]=p.useState(["AAPL","GOOGL","MSFT","TSLA","NVDA"]),[L,G]=p.useState({}),[E,I]=p.useState([]),[u,T]=p.useState(!1),[z,P]=p.useState(null),[H,O]=p.useState(!1),Q=typeof window<"u"?window.location.origin:"",ne=async V=>{try{const r=await fetch(`${Q}/api/marketdata?endpoint=quote&symbol=${V}&source=auto`);if(!r.ok)throw new Error(`API error: ${r.status}`);return await r.json()}catch(r){return console.error(`Erreur fetch ${V}:`,r),null}},re=(V,r="info")=>{console.log(`[${r.toUpperCase()}] ${V}`)},K=V=>`https://financialmodelingprep.com/image-stock/${V}.png`,R=async()=>{console.log("Emma populate watchlist appel√©")};p.useEffect(()=>{H||(async()=>{T(!0);try{const r=h.map(w=>ne(w)),l=await Promise.all(r),y={};l.forEach((w,k)=>{w&&(y[h[k]]={symbol:h[k],price:w.c||w.price,change:w.d||w.change,changePercent:w.dp||w.changePercent,...w})}),G(y),P(new Date),O(!0)}catch(r){console.error("Erreur chargement initial:",r)}finally{T(!1)}})()},[]);const J={isDarkMode:b,tickers:h,setTickers:M,stockData:L,setStockData:G,newsData:E,setNewsData:I,loading:u,setLoading:T,lastUpdate:z,setLastUpdate:P,initialLoadComplete:H,API_BASE_URL:Q,fetchStockData:ne,showMessage:re,getCompanyLogo:K,emmaPopulateWatchlist:R},de=()=>{switch(D){case"stocks-news":return e.jsx(dt,{...J});case"intellistocks":return e.jsx($t,{...J});case"admin-jslai":return e.jsx(vt,{...J});case"plus":return e.jsx(Nt,{...J});case"watchlist":return e.jsx(wt,{...J});case"economic-calendar":return e.jsx(kt,{...J});default:return e.jsx(dt,{...J})}};return e.jsxs("div",{className:"min-h-screen bg-gray-900 text-white",children:[e.jsx("header",{className:"bg-gray-800 border-b border-gray-700 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"GOB Dashboard"}),e.jsx("button",{onClick:()=>F(!b),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",children:b?"‚òÄÔ∏è Light":"üåô Dark"})]})}),e.jsx("nav",{className:"bg-gray-800 border-b border-gray-700 px-4",children:e.jsx("div",{className:"flex gap-2 overflow-x-auto",children:[{id:"stocks-news",label:"üìä Stocks & News"},{id:"intellistocks",label:"üß† IntelliStocks"},{id:"watchlist",label:"‚≠ê Watchlist"},{id:"economic-calendar",label:"üìÖ Calendar"},{id:"admin-jslai",label:"‚öôÔ∏è Admin"},{id:"plus",label:"‚ûï Plus"}].map(V=>e.jsx("button",{onClick:()=>t(V.id),className:`px-4 py-3 whitespace-nowrap transition-colors ${D===V.id?"bg-blue-600 text-white border-b-2 border-blue-400":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:V.label},V.id))})}),e.jsx("main",{className:"p-6",children:de()})]})},ct={Activity:"activity",Wifi:"wifi",WifiOff:"wifi-off",RefreshCw:"refresh-double",Refresh:"refresh",ChevronDown:"nav-arrow-down",Bell:"bell",Search:"search",Settings:"settings",AlertTriangle:"warning-triangle",AlertCircle:"info-circle",HelpCircle:"help-circle",LifeBuoy:"lifebelt",X:"xmark",Close:"xmark",Plus:"plus",Minus:"minus",BarChart3:"stat-up",Brain:"brain",TrendingUp:"trending-up",TrendingDown:"trending-down",GraphUp:"graph-up",ChartLine:"chart-line",DollarSign:"dollar",Newspaper:"newspaper",Page:"page",FileText:"page",Briefcase:"briefcase",ArrowUpRight:"arrow-tr",ArrowDownRight:"arrow-br",ArrowUp:"arrow-up",ArrowDown:"arrow-down",Fire:"sparks",Target:"target",Shield:"shield",Sparkles:"sparks",ExternalLink:"open-new-window",Users:"group",User:"user",Calendar:"calendar",Clock:"clock",Image:"media-image",Video:"media-video",Star:"star",StarFilled:"star-solid",Rocket:"rocket",Database:"database",Code:"code",Mail:"mail",Phone:"phone",Globe:"globe",Building:"building",ChatBubble:"chat-bubble"},Mt={"üì°":"antenna-signal","‚öôÔ∏è":"settings","üìÖ":"calendar","üåÖ":"sun-light","‚òÄÔ∏è":"sun-light","üåÜ":"building","üìä":"stat-up","üìà":"trending-up","üìâ":"trending-down","ü§ñ":"brain","üí¨":"chat-bubble","üîç":"search","üìù":"page","üéØ":"target","üíº":"briefcase","üåê":"globe","üí∞":"dollar","üè¢":"building","üìß":"mail","üîî":"bell","‚è∞":"clock","‚úÖ":"check-circle","‚ùå":"xmark-circle","‚ö†Ô∏è":"warning-triangle","üöÄ":"rocket","üî•":"sparks","üí°":"light-bulb","üß†":"brain","üì∞":"newspaper","üíµ":"dollar","üì≤":"smartphone-device","üé®":"palette","üîí":"lock","üîì":"lock-unlock","üë§":"user","üë•":"group","‚≠ê":"star","üèÜ":"trophy","üìå":"pin","üîó":"link","üñºÔ∏è":"media-image","üì∏":"camera","üé¨":"movie","üéµ":"music-note","üìÅ":"folder","üìÑ":"page","üíª":"laptop","‚å®Ô∏è":"keyboard","üñ±Ô∏è":"mouse-button-right","üñ•Ô∏è":"pc-monitor","üì±":"smartphone-device","üîã":"battery-charging","üîå":"plug","üõ†Ô∏è":"tools","üéì":"graduation-cap","üìö":"book-stack","üìñ":"book","‚úèÔ∏è":"edit-pencil","üñäÔ∏è":"pen","üìé":"attachment","üìç":"pin-alt","üß≠":"compass","üó∫Ô∏è":"map","üè†":"home","üè™":"shop","üè¨":"city","üè≠":"industry","‚ö°":"flash","üåü":"star-solid","üíé":"gem-stone","üéÅ":"gift","üõí":"cart","üí≥":"credit-card","üéâ":"party","üéä":"gift","üîê":"lock","üéÆ":"gamepad","üé≤":"dice"},tt=({name:D,className:t="w-4 h-4"})=>{const b=ct[D]||ct.Activity;return e.jsx("i",{className:`iconoir-${b} ${t}`,style:{fontSize:"inherit"}})},mt={isEnabled:function(){const D=localStorage.getItem("gobapps-professional-mode");return D==="true"||D===null},toggle:function(){const D=!this.isEnabled();return localStorage.setItem("gobapps-professional-mode",D.toString()),window.dispatchEvent(new CustomEvent("professional-mode-changed",{detail:{enabled:D}})),D},emojiToIcon:Mt,renderIcon:function(D,t=24,b=""){if(!this.isEnabled())return`<span class="inline-block">${D}</span>`;const F=this.emojiToIcon[D];return F?`<i class="iconoir-${F} ${b}" style="font-size: ${t}px;"></i>`:`<span class="inline-block">${D}</span>`}};typeof window<"u"&&(window.IconoirIcon=tt,window.LucideIcon=tt,window.ProfessionalModeSystem=mt);const Ct=()=>(p.useEffect(()=>{if(window.__GOB_DASHBOARD_MOUNTED){console.warn("‚ö†Ô∏è Dashboard d√©j√† mont√©");return}window.__GOB_DASHBOARD_MOUNTED=!0,window.IconoirIcon=tt,window.LucideIcon=tt,window.ProfessionalModeSystem=mt,console.log("‚úÖ GOB Dashboard mont√© (Vite + React + TypeScript)")},[]),e.jsx(St,{}));console.log("üöÄ Vite + React + TypeScript charg√©");console.log("üìö V√©rification des biblioth√®ques CDN:");console.log("  Chart.js:",typeof Chart<"u"?"‚úÖ":"‚ùå");console.log("  Recharts:",typeof window.Recharts<"u"?"‚úÖ":"‚ùå");console.log("  LightweightCharts:",typeof window.LightweightCharts<"u"?"‚úÖ":"‚ùå");const ut=document.getElementById("root");if(!ut)throw new Error("Root element not found");jt.createRoot(ut).render(e.jsx(et.StrictMode,{children:e.jsx(Ct,{})}));
//# sourceMappingURL=index.js.map
