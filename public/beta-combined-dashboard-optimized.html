<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GOB Apps - Dashboard Financier Beta ‚Ä¢ Propuls√© par JSL AI</title>
    
    <!-- Preconnect pour optimiser le chargement -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://unpkg.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    
    <!-- Fonts optimis√©es -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Roboto:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    
    <!-- Scripts avec fallback et optimisation -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js" 
            onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/npm/react@18/umd/react.production.min.js'"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"
            onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.production.min.js'"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"
            onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js'"></script>
    <script src="https://cdn.tailwindcss.com"
            onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/npm/tailwindcss@3/dist/tailwind.min.js'"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"
            onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/npm/chart.js@4/dist/chart.min.js'"></script>
    
    <!-- Styles Emma avec fallback -->
    <link rel="stylesheet" href="./emma-styles.css" onerror="this.onerror=null;this.href='./emma-styles.css'">
    
    <!-- Gestionnaire d'erreurs avanc√© -->
    <script src="/error-handler.js"></script>
    
    <style>
        * {
            font-family: 'Inter', 'Roboto', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        /* Optimisations de performance */
        .tab-content { 
            display: none; 
            will-change: transform;
        }
        .tab-content.active { 
            display: block; 
            animation: fadeIn 0.3s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .tab-button.active { 
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            color: white;
            transform: scale(1.05);
            transition: all 0.3s ease;
        }
        
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .stock-card {
            transition: all 0.3s ease;
            will-change: transform;
        }
        
        .stock-card:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        
        .seeking-alpha-card {
            background: linear-gradient(135deg, #1f1f1f 0%, #2d2d2d 100%);
        }
        
        .stocks-news-card {
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
        }
        
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        /* Scrollbar personnalis√©e optimis√©e */
        .scrollbar-thin {
            scrollbar-width: thin;
            scrollbar-color: #94a3b8 #f1f5f9;
        }
        
        .scrollbar-thin::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        
        .scrollbar-thin::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 3px;
        }
        
        .scrollbar-thin::-webkit-scrollbar-thumb {
            background: #94a3b8;
            border-radius: 3px;
            transition: background 0.2s ease;
        }
        
        .scrollbar-thin::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }
        
        /* Dark mode scrollbar */
        .dark .scrollbar-thin::-webkit-scrollbar-track {
            background: #1e293b;
        }
        
        .dark .scrollbar-thin::-webkit-scrollbar-thumb {
            background: #475569;
        }
        
        .dark .scrollbar-thin::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }

        /* Masquer la scrollbar pour les onglets mobiles */
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        
        /* Optimisations de performance */
        .loading-skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        /* Am√©lioration de l'accessibilit√© */
        .focus-visible:focus {
            outline: 2px solid #4ade80;
            outline-offset: 2px;
        }
        
        /* Optimisation des transitions */
        .smooth-transition {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        /* Indicateur de performance */
        .performance-indicator {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 1000;
        }
        
        /* Mode sombre optimis√© */
        .dark {
            color-scheme: dark;
        }
        
        /* Optimisation des images */
        img {
            loading: lazy;
            decoding: async;
        }
        
        /* Am√©lioration de la lisibilit√© */
        .text-shadow {
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        /* Indicateur de chargement am√©lior√© */
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4ade80;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <!-- Indicateur de performance (d√©veloppement) -->
    <div id="performance-indicator" class="performance-indicator" style="display: none;">
        <span id="load-time">Chargement...</span>
    </div>
    
    <script type="text/babel">
        const { useState, useEffect, useCallback, useMemo, useRef } = React;

        // Configuration optimis√©e
        const CONFIG = {
            API_BASE_URL: window.location.origin,
            REFRESH_INTERVAL: 30000, // 30 secondes
            MAX_RETRIES: 3,
            RETRY_DELAY: 1000,
            CACHE_DURATION: 5 * 60 * 1000, // 5 minutes
            DEBOUNCE_DELAY: 300
        };

        // Cache intelligent
        const cache = new Map();
        const cacheTimestamps = new Map();

        // Utilitaires optimis√©s
        const utils = {
            // Cache avec expiration
            getCached: (key) => {
                const timestamp = cacheTimestamps.get(key);
                if (timestamp && Date.now() - timestamp < CONFIG.CACHE_DURATION) {
                    return cache.get(key);
                }
                return null;
            },
            
            setCached: (key, value) => {
                cache.set(key, value);
                cacheTimestamps.set(key, Date.now());
            },
            
            // Debounce optimis√©
            debounce: (func, delay) => {
                let timeoutId;
                return (...args) => {
                    clearTimeout(timeoutId);
                    timeoutId = setTimeout(() => func.apply(null, args), delay);
                };
            },
            
            // Retry avec backoff exponentiel
            retry: async (fn, retries = CONFIG.MAX_RETRIES) => {
                try {
                    return await fn();
                } catch (error) {
                    if (retries > 0) {
                        await new Promise(resolve => setTimeout(resolve, CONFIG.RETRY_DELAY));
                        return utils.retry(fn, retries - 1);
                    }
                    throw error;
                }
            },
            
            // Formatage des nombres optimis√©
            formatNumber: (num, decimals = 2) => {
                if (num === null || num === undefined) return 'N/A';
                return new Intl.NumberFormat('fr-FR', {
                    minimumFractionDigits: decimals,
                    maximumFractionDigits: decimals
                }).format(num);
            },
            
            // Formatage des pourcentages
            formatPercent: (num) => {
                if (num === null || num === undefined) return 'N/A';
                return `${num >= 0 ? '+' : ''}${num.toFixed(2)}%`;
            },
            
            // Validation des donn√©es
            isValidStockData: (data) => {
                return data && 
                       typeof data === 'object' && 
                       'c' in data && 
                       'd' in data && 
                       'dp' in data;
            }
        };

        // Gestionnaire d'erreurs avanc√©
        const errorHandler = {
            log: (message, type = 'info', data = null) => {
                const timestamp = new Date().toISOString();
                const logEntry = { timestamp, message, type, data };
                
                // Stockage local pour debugging
                const logs = JSON.parse(localStorage.getItem('dashboard_logs') || '[]');
                logs.push(logEntry);
                if (logs.length > 100) logs.shift(); // Garder seulement les 100 derniers
                localStorage.setItem('dashboard_logs', JSON.stringify(logs));
                
                // Console conditionnelle
                if (process?.env?.NODE_ENV !== 'production') {
                    console[type === 'error' ? 'error' : 'log'](`[${type.toUpperCase()}] ${message}`, data);
                }
            },
            
            handle: (error, context = '') => {
                const errorInfo = {
                    message: error.message,
                    stack: error.stack,
                    context,
                    timestamp: new Date().toISOString(),
                    userAgent: navigator.userAgent,
                    url: window.location.href
                };
                
                errorHandler.log(`Erreur dans ${context}: ${error.message}`, 'error', errorInfo);
                
                // Envoi √† un service de monitoring (optionnel)
                if (window.gtag) {
                    gtag('event', 'exception', {
                        description: error.message,
                        fatal: false
                    });
                }
            }
        };

        // API Service optimis√©
        const apiService = {
            // Requ√™te avec cache et retry
            request: async (endpoint, options = {}) => {
                const cacheKey = `${endpoint}_${JSON.stringify(options)}`;
                const cached = utils.getCached(cacheKey);
                if (cached) return cached;
                
                const requestFn = async () => {
                    const response = await fetch(`${CONFIG.API_BASE_URL}${endpoint}`, {
                        ...options,
                        headers: {
                            'Content-Type': 'application/json',
                            ...options.headers
                        }
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    
                    return await response.json();
                };
                
                try {
                    const result = await utils.retry(requestFn);
                    utils.setCached(cacheKey, result);
                    return result;
                } catch (error) {
                    errorHandler.handle(error, `API ${endpoint}`);
                    throw error;
                }
            },
            
            // Donn√©es de march√©
            getStockData: async (ticker) => {
                try {
                    const data = await apiService.request(`/api/finnhub?endpoint=quote&symbol=${ticker}`);
                    if (utils.isValidStockData(data)) {
                        return {
                            ticker,
                            price: data.c,
                            change: data.d,
                            changePercent: data.dp,
                            high: data.h,
                            low: data.l,
                            open: data.o,
                            previousClose: data.pc,
                            timestamp: data.t,
                            volume: data.v
                        };
                    }
                    return null;
                } catch (error) {
                    errorHandler.handle(error, `Stock data for ${ticker}`);
                    return null;
                }
            },
            
            // Actualit√©s
            getNews: async (tickers = []) => {
                try {
                    const tickersQuery = tickers.join(',');
                    const data = await apiService.request(`/api/news?tickers=${encodeURIComponent(tickersQuery)}`);
                    return data.articles || [];
                } catch (error) {
                    errorHandler.handle(error, 'News API');
                    return [];
                }
            },
            
            // Status des APIs
            getApiStatus: async () => {
                const apis = ['finnhub', 'newsapi', 'seekingAlpha', 'gemini', 'github', 'claude', 'vercel'];
                const status = {};
                
                const checkApi = async (api) => {
                    try {
                        const startTime = Date.now();
                        const response = await fetch(`${CONFIG.API_BASE_URL}/api/${api}?test=true`);
                        const responseTime = Date.now() - startTime;
                        
                        return {
                            status: response.ok ? 'success' : 'error',
                            responseTime,
                            error: response.ok ? null : `HTTP ${response.status}`
                        };
                    } catch (error) {
                        return {
                            status: 'error',
                            responseTime: 0,
                            error: error.message
                        };
                    }
                };
                
                const promises = apis.map(async (api) => {
                    status[api] = await checkApi(api);
                });
                
                await Promise.allSettled(promises);
                return status;
            }
        };

        // Composant principal optimis√©
        const BetaCombinedDashboard = () => {
            // √âtats optimis√©s
            const [activeTab, setActiveTab] = useState('stocks-news');
            const [isDarkMode, setIsDarkMode] = useState(() => {
                const saved = localStorage.getItem('dashboard-dark-mode');
                return saved ? JSON.parse(saved) : true;
            });
            const [message, setMessage] = useState(null);
            const [loading, setLoading] = useState(false);
            const [performance, setPerformance] = useState({ loadTime: 0, memoryUsage: 0 });
            
            // √âtats des donn√©es
            const [stockData, setStockData] = useState({});
            const [newsData, setNewsData] = useState([]);
            const [seekingAlphaData, setSeekingAlphaData] = useState([]);
            const [apiStatus, setApiStatus] = useState({});
            
            // Refs pour optimiser les re-renders
            const refreshIntervalRef = useRef(null);
            const lastRefreshRef = useRef(0);
            
            // Fonction de message optimis√©e
            const showMessage = useCallback((text, type = 'info', duration = 5000) => {
                setMessage({ text, type });
                setTimeout(() => setMessage(null), duration);
            }, []);
            
            // Chargement des donn√©es optimis√©
            const loadData = useCallback(async (forceRefresh = false) => {
                const now = Date.now();
                if (!forceRefresh && now - lastRefreshRef.current < CONFIG.REFRESH_INTERVAL) {
                    return;
                }
                
                lastRefreshRef.current = now;
                setLoading(true);
                
                try {
                    const startTime = performance.now();
                    
                    // Chargement parall√®le des donn√©es
                    const [stockDataResult, newsResult, seekingAlphaResult, apiStatusResult] = await Promise.allSettled([
                        loadStockData(),
                        loadNewsData(),
                        loadSeekingAlphaData(),
                        apiService.getApiStatus()
                    ]);
                    
                    const loadTime = performance.now() - startTime;
                    setPerformance(prev => ({ ...prev, loadTime: Math.round(loadTime) }));
                    
                    // Traitement des r√©sultats
                    if (stockDataResult.status === 'fulfilled') {
                        setStockData(stockDataResult.value);
                    }
                    
                    if (newsResult.status === 'fulfilled') {
                        setNewsData(newsResult.value);
                    }
                    
                    if (seekingAlphaResult.status === 'fulfilled') {
                        setSeekingAlphaData(seekingAlphaResult.value);
                    }
                    
                    if (apiStatusResult.status === 'fulfilled') {
                        setApiStatus(apiStatusResult.value);
                    }
                    
                    errorHandler.log('Donn√©es charg√©es avec succ√®s', 'info', { loadTime });
                    
                } catch (error) {
                    errorHandler.handle(error, 'Load data');
                    showMessage('Erreur lors du chargement des donn√©es', 'error');
                } finally {
                    setLoading(false);
                }
            }, []);
            
            // Chargement des donn√©es de march√©
            const loadStockData = useCallback(async () => {
                const tickers = ['AAPL', 'MSFT', 'GOOGL', 'TSLA', 'AMZN', 'META', 'NVDA', 'NFLX'];
                const stockData = {};
                
                const promises = tickers.map(async (ticker) => {
                    const data = await apiService.getStockData(ticker);
                    if (data) {
                        stockData[ticker] = data;
                    }
                });
                
                await Promise.allSettled(promises);
                return stockData;
            }, []);
            
            // Chargement des actualit√©s
            const loadNewsData = useCallback(async () => {
                const tickers = Object.keys(stockData);
                return await apiService.getNews(tickers);
            }, [stockData]);
            
            // Chargement des donn√©es Seeking Alpha
            const loadSeekingAlphaData = useCallback(async () => {
                try {
                    const data = await apiService.request('/api/seeking-alpha');
                    return data.stocks || [];
                } catch (error) {
                    errorHandler.handle(error, 'Seeking Alpha data');
                    return [];
                }
            }, []);
            
            // Auto-refresh optimis√©
            useEffect(() => {
                loadData(true); // Chargement initial
                
                refreshIntervalRef.current = setInterval(() => {
                    loadData();
                }, CONFIG.REFRESH_INTERVAL);
                
                return () => {
                    if (refreshIntervalRef.current) {
                        clearInterval(refreshIntervalRef.current);
                    }
                };
            }, [loadData]);
            
            // Gestion du mode sombre
            useEffect(() => {
                localStorage.setItem('dashboard-dark-mode', JSON.stringify(isDarkMode));
                document.documentElement.classList.toggle('dark', isDarkMode);
            }, [isDarkMode]);
            
            // Monitoring des performances
            useEffect(() => {
                if ('memory' in performance) {
                    const updateMemory = () => {
                        setPerformance(prev => ({
                            ...prev,
                            memoryUsage: Math.round(performance.memory.usedJSHeapSize / 1024 / 1024)
                        }));
                    };
                    
                    updateMemory();
                    const interval = setInterval(updateMemory, 10000);
                    return () => clearInterval(interval);
                }
            }, []);
            
            // Configuration des onglets
            const tabs = useMemo(() => [
                { id: 'stocks-news', label: 'üìä Stocks & News', icon: 'üìà' },
                { id: 'dans-watchlist', label: '‚≠ê Ma Watchlist', icon: '‚≠ê' },
                { id: 'seeking-alpha', label: 'üîç Seeking Alpha', icon: 'üîç' },
                { id: 'ask-emma', label: 'ü§ñ Ask Emma', icon: 'ü§ñ' },
                { id: 'scrapping-sa', label: '‚ö° Scraping SA', icon: '‚ö°' },
                { id: 'email-report', label: 'üìß Email Report', icon: 'üìß' },
                { id: 'admin-jsla', label: 'üîß Admin JSL AI', icon: 'üîß' }
            ], []);
            
            // Composant d'onglet optimis√©
            const TabButton = ({ tab, isActive, onClick }) => (
                <button
                    onClick={() => onClick(tab.id)}
                    className={`px-4 py-2 rounded-lg font-medium transition-all duration-300 focus-visible ${
                        isActive 
                            ? 'bg-gradient-to-r from-green-500 to-green-600 text-white shadow-lg transform scale-105' 
                            : isDarkMode 
                                ? 'text-gray-300 hover:text-white hover:bg-gray-700' 
                                : 'text-gray-600 hover:text-gray-900 hover:bg-gray-100'
                    }`}
                    aria-pressed={isActive}
                >
                    <span className="mr-2">{tab.icon}</span>
                    {tab.label}
                </button>
            );
            
            // Composant de carte de stock optimis√©
            const StockCard = ({ ticker, data }) => {
                if (!data) {
                    return (
                        <div className="bg-gray-100 dark:bg-gray-800 rounded-lg p-4 animate-pulse">
                            <div className="h-4 bg-gray-300 dark:bg-gray-600 rounded mb-2"></div>
                            <div className="h-6 bg-gray-300 dark:bg-gray-600 rounded mb-2"></div>
                            <div className="h-4 bg-gray-300 dark:bg-gray-600 rounded w-1/2"></div>
                        </div>
                    );
                }
                
                const isPositive = data.change >= 0;
                const changeColor = isPositive ? 'text-green-500' : 'text-red-500';
                const changeIcon = isPositive ? 'üìà' : 'üìâ';
                
                return (
                    <div className="bg-white dark:bg-gray-800 rounded-lg p-4 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105">
                        <div className="flex justify-between items-start mb-2">
                            <h3 className="font-bold text-lg">{ticker}</h3>
                            <span className="text-2xl">{changeIcon}</span>
                        </div>
                        <div className="text-2xl font-bold mb-1">
                            ${utils.formatNumber(data.price)}
                        </div>
                        <div className={`text-sm font-medium ${changeColor}`}>
                            {utils.formatPercent(data.changePercent)}
                        </div>
                        <div className="text-xs text-gray-500 dark:text-gray-400 mt-1">
                            Vol: {data.volume ? utils.formatNumber(data.volume, 0) : 'N/A'}
                        </div>
                    </div>
                );
            };
            
            // Composant de news optimis√©
            const NewsItem = ({ article }) => (
                <div className="bg-white dark:bg-gray-800 rounded-lg p-4 shadow-lg hover:shadow-xl transition-all duration-300">
                    <h4 className="font-semibold text-sm mb-2 line-clamp-2">{article.title}</h4>
                    <p className="text-xs text-gray-600 dark:text-gray-400 mb-2 line-clamp-2">
                        {article.description}
                    </p>
                    <div className="flex justify-between items-center text-xs text-gray-500">
                        <span>{article.source}</span>
                        <span>{new Date(article.publishedAt).toLocaleDateString('fr-FR')}</span>
                    </div>
                </div>
            );
            
            // Composant de statut API optimis√©
            const ApiStatusIndicator = ({ api, status }) => {
                const statusColors = {
                    success: 'text-green-500',
                    warning: 'text-yellow-500',
                    error: 'text-red-500',
                    checking: 'text-gray-500'
                };
                
                const statusIcons = {
                    success: '‚úÖ',
                    warning: '‚ö†Ô∏è',
                    error: '‚ùå',
                    checking: '‚è≥'
                };
                
                return (
                    <div className="flex items-center justify-between p-2 bg-gray-100 dark:bg-gray-700 rounded">
                        <span className="font-medium">{api}</span>
                        <div className="flex items-center space-x-2">
                            <span className={statusColors[status.status]}>
                                {statusIcons[status.status]}
                            </span>
                            <span className="text-xs text-gray-500">
                                {status.responseTime}ms
                            </span>
                        </div>
                    </div>
                );
            };
            
            return (
                <div className={`min-h-screen ${isDarkMode ? 'dark bg-gray-900' : 'bg-gray-50'}`}>
                    {/* Header optimis√© */}
                    <header className="bg-white dark:bg-gray-800 shadow-lg sticky top-0 z-50">
                        <div className="max-w-7xl mx-auto px-4 py-4">
                            <div className="flex items-center justify-between">
                                <div className="flex items-center space-x-4">
                                    <div className="w-12 h-12 bg-gradient-to-r from-green-500 to-green-600 rounded-lg flex items-center justify-center">
                                        <span className="text-white font-bold text-xl">G</span>
                                    </div>
                                    <div>
                                        <h1 className="text-2xl font-bold text-gray-900 dark:text-white">
                                            GOB Apps Beta
                                        </h1>
                                        <p className="text-sm text-gray-600 dark:text-gray-400">
                                            Dashboard Financier ‚Ä¢ Propuls√© par JSL AI
                                        </p>
                                    </div>
                                </div>
                                
                                <div className="flex items-center space-x-4">
                                    {/* Indicateur de performance */}
                                    {performance.loadTime > 0 && (
                                        <div className="text-xs text-gray-500 dark:text-gray-400">
                                            Charg√© en {performance.loadTime}ms
                                        </div>
                                    )}
                                    
                                    {/* Bouton mode sombre */}
                                    <button
                                        onClick={() => setIsDarkMode(!isDarkMode)}
                                        className="p-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"
                                        aria-label="Basculer le mode sombre"
                                    >
                                        {isDarkMode ? '‚òÄÔ∏è' : 'üåô'}
                                    </button>
                                    
                                    {/* Bouton refresh */}
                                    <button
                                        onClick={() => loadData(true)}
                                        disabled={loading}
                                        className="p-2 rounded-lg bg-green-100 dark:bg-green-900 hover:bg-green-200 dark:hover:bg-green-800 transition-colors disabled:opacity-50"
                                        aria-label="Actualiser les donn√©es"
                                    >
                                        {loading ? '‚è≥' : 'üîÑ'}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </header>
                    
                    {/* Navigation des onglets */}
                    <nav className="bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-16 z-40">
                        <div className="max-w-7xl mx-auto px-4">
                            <div className="flex space-x-2 py-3 overflow-x-auto scrollbar-hide">
                                {tabs.map(tab => (
                                    <TabButton
                                        key={tab.id}
                                        tab={tab}
                                        isActive={activeTab === tab.id}
                                        onClick={setActiveTab}
                                    />
                                ))}
                            </div>
                        </div>
                    </nav>
                    
                    {/* Contenu principal */}
                    <main className="max-w-7xl mx-auto p-4">
                        {/* Onglet Stocks & News */}
                        {activeTab === 'stocks-news' && (
                            <div className="space-y-6">
                                <h2 className="text-2xl font-bold text-gray-900 dark:text-white">
                                    üìä Donn√©es de March√© en Temps R√©el
                                </h2>
                                
                                {/* Grille des stocks */}
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                                    {Object.entries(stockData).map(([ticker, data]) => (
                                        <StockCard key={ticker} ticker={ticker} data={data} />
                                    ))}
                                </div>
                                
                                {/* Actualit√©s */}
                                <div>
                                    <h3 className="text-xl font-semibold text-gray-900 dark:text-white mb-4">
                                        üì∞ Actualit√©s Financi√®res
                                    </h3>
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                        {newsData.slice(0, 6).map((article, index) => (
                                            <NewsItem key={index} article={article} />
                                        ))}
                                    </div>
                                </div>
                            </div>
                        )}
                        
                        {/* Onglet Watchlist */}
                        {activeTab === 'dans-watchlist' && (
                            <div className="space-y-6">
                                <h2 className="text-2xl font-bold text-gray-900 dark:text-white">
                                    ‚≠ê Ma Watchlist Personnalis√©e
                                </h2>
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    {Object.entries(stockData).map(([ticker, data]) => (
                                        <StockCard key={ticker} ticker={ticker} data={data} />
                                    ))}
                                </div>
                            </div>
                        )}
                        
                        {/* Onglet Seeking Alpha */}
                        {activeTab === 'seeking-alpha' && (
                            <div className="space-y-6">
                                <h2 className="text-2xl font-bold text-gray-900 dark:text-white">
                                    üîç Analyses Seeking Alpha
                                </h2>
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    {seekingAlphaData.map((stock, index) => (
                                        <div key={index} className="bg-white dark:bg-gray-800 rounded-lg p-4 shadow-lg">
                                            <h3 className="font-bold text-lg">{stock.ticker}</h3>
                                            <p className="text-sm text-gray-600 dark:text-gray-400">
                                                {stock.companyName || 'N/A'}
                                            </p>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}
                        
                        {/* Onglet Admin */}
                        {activeTab === 'admin-jsla' && (
                            <div className="space-y-6">
                                <h2 className="text-2xl font-bold text-gray-900 dark:text-white">
                                    üîß Administration JSL AI
                                </h2>
                                
                                {/* Status des APIs */}
                                <div>
                                    <h3 className="text-lg font-semibold text-gray-900 dark:text-white mb-4">
                                        üì° Status des APIs
                                    </h3>
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                        {Object.entries(apiStatus).map(([api, status]) => (
                                            <ApiStatusIndicator key={api} api={api} status={status} />
                                        ))}
                                    </div>
                                </div>
                                
                                {/* Informations de performance */}
                                <div>
                                    <h3 className="text-lg font-semibold text-gray-900 dark:text-white mb-4">
                                        ‚ö° Performances
                                    </h3>
                                    <div className="bg-gray-100 dark:bg-gray-800 rounded-lg p-4">
                                        <div className="grid grid-cols-2 gap-4">
                                            <div>
                                                <span className="text-sm text-gray-600 dark:text-gray-400">Temps de chargement:</span>
                                                <div className="font-bold">{performance.loadTime}ms</div>
                                            </div>
                                            <div>
                                                <span className="text-sm text-gray-600 dark:text-gray-400">M√©moire utilis√©e:</span>
                                                <div className="font-bold">{performance.memoryUsage}MB</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}
                    </main>
                    
                    {/* Messages */}
                    {message && (
                        <div className={`fixed top-20 right-4 p-4 rounded-lg shadow-lg z-50 max-w-sm ${
                            message.type === 'error' ? 'bg-red-500' : 
                            message.type === 'success' ? 'bg-green-500' : 'bg-blue-500'
                        } text-white`}>
                            <div className="flex items-center justify-between">
                                <span>{message.text}</span>
                                <button
                                    onClick={() => setMessage(null)}
                                    className="ml-4 text-white hover:text-gray-200"
                                >
                                    ‚úï
                                </button>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // Rendu optimis√©
        ReactDOM.render(<BetaCombinedDashboard />, document.getElementById('root'));
        
        // Monitoring des performances
        window.addEventListener('load', () => {
            const loadTime = performance.now();
            const indicator = document.getElementById('performance-indicator');
            if (indicator) {
                indicator.style.display = 'block';
                document.getElementById('load-time').textContent = `Charg√© en ${Math.round(loadTime)}ms`;
                setTimeout(() => {
                    indicator.style.display = 'none';
                }, 3000);
            }
        });
    </script>
</body>
</html>