import { r as reactExports, c as calculateRecommendation, j as jsxRuntimeExports, F as ForwardRef$5, a as ForwardRef$6, b as ForwardRef$7, d as ForwardRef$8, e as ForwardRef$9, f as ForwardRef$a, g as ForwardRef$b, h as ForwardRef$c, i as ForwardRef$d, k as ForwardRef$e, R as React, l as ForwardRef$f, m as ForwardRef$g, n as ForwardRef$h, A as AdditionalMetrics, E as EvaluationDetails, o as ForwardRef$i, p as listSnapshots } from "./index.js";
function ArrowsPointingOutIcon({
  title,
  titleId,
  ...props
}, svgRef) {
  return /* @__PURE__ */ reactExports.createElement("svg", Object.assign({
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 24 24",
    strokeWidth: 1.5,
    stroke: "currentColor",
    "aria-hidden": "true",
    "data-slot": "icon",
    ref: svgRef,
    "aria-labelledby": titleId
  }, props), title ? /* @__PURE__ */ reactExports.createElement("title", {
    id: titleId
  }, title) : null, /* @__PURE__ */ reactExports.createElement("path", {
    strokeLinecap: "round",
    strokeLinejoin: "round",
    d: "M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"
  }));
}
const ForwardRef$4 = /* @__PURE__ */ reactExports.forwardRef(ArrowsPointingOutIcon);
function MagnifyingGlassMinusIcon({
  title,
  titleId,
  ...props
}, svgRef) {
  return /* @__PURE__ */ reactExports.createElement("svg", Object.assign({
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 24 24",
    strokeWidth: 1.5,
    stroke: "currentColor",
    "aria-hidden": "true",
    "data-slot": "icon",
    ref: svgRef,
    "aria-labelledby": titleId
  }, props), title ? /* @__PURE__ */ reactExports.createElement("title", {
    id: titleId
  }, title) : null, /* @__PURE__ */ reactExports.createElement("path", {
    strokeLinecap: "round",
    strokeLinejoin: "round",
    d: "m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607ZM13.5 10.5h-6"
  }));
}
const ForwardRef$3 = /* @__PURE__ */ reactExports.forwardRef(MagnifyingGlassMinusIcon);
function MagnifyingGlassPlusIcon({
  title,
  titleId,
  ...props
}, svgRef) {
  return /* @__PURE__ */ reactExports.createElement("svg", Object.assign({
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 24 24",
    strokeWidth: 1.5,
    stroke: "currentColor",
    "aria-hidden": "true",
    "data-slot": "icon",
    ref: svgRef,
    "aria-labelledby": titleId
  }, props), title ? /* @__PURE__ */ reactExports.createElement("title", {
    id: titleId
  }, title) : null, /* @__PURE__ */ reactExports.createElement("path", {
    strokeLinecap: "round",
    strokeLinejoin: "round",
    d: "m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607ZM10.5 7.5v6m3-3h-6"
  }));
}
const ForwardRef$2 = /* @__PURE__ */ reactExports.forwardRef(MagnifyingGlassPlusIcon);
function EyeIcon({
  title,
  titleId,
  ...props
}, svgRef) {
  return /* @__PURE__ */ reactExports.createElement("svg", Object.assign({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 24 24",
    fill: "currentColor",
    "aria-hidden": "true",
    "data-slot": "icon",
    ref: svgRef,
    "aria-labelledby": titleId
  }, props), title ? /* @__PURE__ */ reactExports.createElement("title", {
    id: titleId
  }, title) : null, /* @__PURE__ */ reactExports.createElement("path", {
    d: "M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"
  }), /* @__PURE__ */ reactExports.createElement("path", {
    fillRule: "evenodd",
    d: "M1.323 11.447C2.811 6.976 7.028 3.75 12.001 3.75c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113-1.487 4.471-5.705 7.697-10.677 7.697-4.97 0-9.186-3.223-10.675-7.69a1.762 1.762 0 0 1 0-1.113ZM17.25 12a5.25 5.25 0 1 1-10.5 0 5.25 5.25 0 0 1 10.5 0Z",
    clipRule: "evenodd"
  }));
}
const ForwardRef$1 = /* @__PURE__ */ reactExports.forwardRef(EyeIcon);
function StarIcon({
  title,
  titleId,
  ...props
}, svgRef) {
  return /* @__PURE__ */ reactExports.createElement("svg", Object.assign({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 24 24",
    fill: "currentColor",
    "aria-hidden": "true",
    "data-slot": "icon",
    ref: svgRef,
    "aria-labelledby": titleId
  }, props), title ? /* @__PURE__ */ reactExports.createElement("title", {
    id: titleId
  }, title) : null, /* @__PURE__ */ reactExports.createElement("path", {
    fillRule: "evenodd",
    d: "M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z",
    clipRule: "evenodd"
  }));
}
const ForwardRef = /* @__PURE__ */ reactExports.forwardRef(StarIcon);
const useKeyboardShortcuts = ({
  onSyncAll,
  onSyncNA,
  onToggleNAFilter,
  onExport,
  onOpenSyncDialog,
  enabled = true
}) => {
  const handleKeyDown = reactExports.useCallback((e) => {
    if (!enabled) return;
    const target = e.target;
    if (target.tagName === "INPUT" || target.tagName === "TEXTAREA" || target.isContentEditable) {
      return;
    }
    if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === "S") {
      e.preventDefault();
      onSyncAll == null ? void 0 : onSyncAll();
      return;
    }
    if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === "N") {
      e.preventDefault();
      onSyncNA == null ? void 0 : onSyncNA();
      return;
    }
    if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === "F") {
      e.preventDefault();
      onToggleNAFilter == null ? void 0 : onToggleNAFilter();
      return;
    }
    if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === "E") {
      e.preventDefault();
      onExport == null ? void 0 : onExport();
      return;
    }
    if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === "D") {
      e.preventDefault();
      onOpenSyncDialog == null ? void 0 : onOpenSyncDialog();
      return;
    }
  }, [enabled, onSyncAll, onSyncNA, onToggleNAFilter, onExport, onOpenSyncDialog]);
  reactExports.useEffect(() => {
    if (enabled) {
      window.addEventListener("keydown", handleKeyDown);
      return () => {
        window.removeEventListener("keydown", handleKeyDown);
      };
    }
  }, [enabled, handleKeyDown]);
};
const SyncSelectionDialog = ({
  isOpen,
  profiles,
  onClose,
  onConfirm,
  isSyncing = false
}) => {
  const [selectedFilter, setSelectedFilter] = reactExports.useState("all");
  const [selectedSector, setSelectedSector] = reactExports.useState("");
  const [selectedRecommendation, setSelectedRecommendation] = reactExports.useState("");
  const [selectedMetric, setSelectedMetric] = reactExports.useState("jpegy");
  const [metricRange, setMetricRange] = reactExports.useState("<");
  const [metricValue1, setMetricValue1] = reactExports.useState("10");
  const [metricValue2, setMetricValue2] = reactExports.useState("20");
  const [performanceType, setPerformanceType] = reactExports.useState("top");
  const [performanceCount, setPerformanceCount] = reactExports.useState("10");
  const [statusFilter, setStatusFilter] = reactExports.useState("not-approved");
  const [combinedFilters, setCombinedFilters] = reactExports.useState({});
  const [customSelection, setCustomSelection] = reactExports.useState(/* @__PURE__ */ new Set());
  const [showAdvanced, setShowAdvanced] = reactExports.useState(false);
  const profileMetrics = reactExports.useMemo(() => {
    return profiles.map((profile) => {
      var _a;
      const currentPrice = Math.max(((_a = profile.assumptions) == null ? void 0 : _a.currentPrice) || 0, 0.01);
      const baseYearData = profile.data.find((d) => {
        var _a2;
        return d.year === ((_a2 = profile.assumptions) == null ? void 0 : _a2.baseYear);
      }) || profile.data[profile.data.length - 1];
      const baseEPS = Math.max((baseYearData == null ? void 0 : baseYearData.earningsPerShare) || 0, 0);
      const hasValidEPS = baseEPS > 0.01;
      const basePE = hasValidEPS && currentPrice > 0 ? currentPrice / baseEPS : 0;
      const safeBasePE = basePE > 0 && basePE <= 1e3 ? basePE : 0;
      const baseYield = currentPrice > 0 && profile.assumptions.currentDividend >= 0 ? profile.assumptions.currentDividend / currentPrice * 100 : 0;
      const safeBaseYield = Math.max(0, Math.min(baseYield, 50));
      const growthPlusYield = (profile.assumptions.growthRateEPS || 0) + safeBaseYield;
      let jpegy = null;
      if (growthPlusYield > 0.01 && safeBasePE > 0 && hasValidEPS) {
        const rawJPEGY = safeBasePE / growthPlusYield;
        if (isFinite(rawJPEGY) && rawJPEGY >= 0 && rawJPEGY <= 100) {
          jpegy = rawJPEGY;
        }
      }
      const { recommendation, targetPrice } = calculateRecommendation(profile.data, profile.assumptions);
      const upsidePotential = targetPrice > 0 && currentPrice > 0 ? (targetPrice - currentPrice) / currentPrice * 100 : 0;
      const downsideRisk = Math.abs(upsidePotential < 0 ? upsidePotential : 0);
      const ratio31 = downsideRisk > 0 ? upsidePotential / downsideRisk : 0;
      const totalReturnPercent = targetPrice > 0 && currentPrice > 0 ? (targetPrice - currentPrice) / currentPrice * 100 : 0;
      const prices = profile.data.map((d) => (d.priceHigh + d.priceLow) / 2).filter((p) => p > 0);
      const avgPrice = prices.reduce((a, b) => a + b, 0) / prices.length;
      const variance = prices.reduce((sum, p) => sum + Math.pow(p - avgPrice, 2), 0) / prices.length;
      const volatility = Math.sqrt(variance) / avgPrice * 100;
      const hasInvalidData = currentPrice <= 0 || !isFinite(currentPrice) || jpegy === null;
      return {
        profile,
        hasInvalidData,
        jpegy,
        ratio31: isFinite(ratio31) ? ratio31 : null,
        returnPercent: isFinite(totalReturnPercent) ? totalReturnPercent : null,
        volatility: isFinite(volatility) ? volatility : null,
        currentPE: safeBasePE,
        currentYield: safeBaseYield,
        recommendation,
        targetPrice
      };
    });
  }, [profiles]);
  const sectors = reactExports.useMemo(() => {
    const sectorSet = /* @__PURE__ */ new Set();
    profiles.forEach((profile) => {
      if (profile.info.sector) {
        sectorSet.add(profile.info.sector);
      }
    });
    return Array.from(sectorSet).sort();
  }, [profiles]);
  const recommendations = reactExports.useMemo(() => {
    const recSet = /* @__PURE__ */ new Set();
    profileMetrics.forEach((m) => {
      if (m.recommendation) {
        recSet.add(m.recommendation);
      }
    });
    return Array.from(recSet).sort();
  }, [profileMetrics]);
  const filteredTickers = reactExports.useMemo(() => {
    let filtered = profileMetrics;
    switch (selectedFilter) {
      case "portfolio":
        filtered = filtered.filter((m) => !m.profile.isWatchlist);
        break;
      case "watchlist":
        filtered = filtered.filter((m) => m.profile.isWatchlist);
        break;
      case "na":
        filtered = filtered.filter((m) => m.hasInvalidData || m.jpegy === null);
        break;
      case "sector":
        if (selectedSector) {
          filtered = filtered.filter((m) => m.profile.info.sector === selectedSector);
        }
        break;
      case "recommendation":
        if (selectedRecommendation) {
          filtered = filtered.filter((m) => m.recommendation === selectedRecommendation);
        }
        break;
      case "metric":
        filtered = filtered.filter((m) => {
          let value = null;
          switch (selectedMetric) {
            case "jpegy":
              value = m.jpegy;
              break;
            case "ratio31":
              value = m.ratio31;
              break;
            case "return":
              value = m.returnPercent;
              break;
            case "volatility":
              value = m.volatility;
              break;
            case "pe":
              value = m.currentPE;
              break;
            case "yield":
              value = m.currentYield;
              break;
          }
          if (value === null) return false;
          const val1 = parseFloat(metricValue1) || 0;
          const val2 = parseFloat(metricValue2) || 0;
          switch (metricRange) {
            case "<":
              return value < val1;
            case ">":
              return value > val1;
            case "between":
              return value >= Math.min(val1, val2) && value <= Math.max(val1, val2);
            default:
              return false;
          }
        });
        break;
      case "performance":
        const count = parseInt(performanceCount) || 10;
        const sorted = [...filtered].sort((a, b) => {
          let valA = 0, valB = 0;
          switch (selectedMetric) {
            case "jpegy":
              valA = a.jpegy || 0;
              valB = b.jpegy || 0;
              break;
            case "ratio31":
              valA = a.ratio31 || 0;
              valB = b.ratio31 || 0;
              break;
            case "return":
              valA = a.returnPercent || 0;
              valB = b.returnPercent || 0;
              break;
            case "volatility":
              valA = a.volatility || 0;
              valB = b.volatility || 0;
              break;
            case "pe":
              valA = a.currentPE || 0;
              valB = b.currentPE || 0;
              break;
            case "yield":
              valA = a.currentYield || 0;
              valB = b.currentYield || 0;
              break;
          }
          return performanceType === "top" ? valB - valA : valA - valB;
        });
        filtered = sorted.slice(0, count);
        break;
      case "status":
        if (statusFilter === "skeleton") {
          filtered = filtered.filter((m) => m.profile._isSkeleton);
        } else if (statusFilter === "approved") {
          filtered = filtered.filter((m) => !m.profile._isSkeleton);
        } else {
          filtered = filtered.filter((m) => !m.profile._isSkeleton);
        }
        break;
      case "combined":
        if (combinedFilters.portfolio) {
          filtered = filtered.filter((m) => !m.profile.isWatchlist);
        }
        if (combinedFilters.watchlist) {
          filtered = filtered.filter((m) => m.profile.isWatchlist);
        }
        if (combinedFilters.sector) {
          filtered = filtered.filter((m) => m.profile.info.sector === combinedFilters.sector);
        }
        if (combinedFilters.recommendation) {
          filtered = filtered.filter((m) => m.recommendation === combinedFilters.recommendation);
        }
        break;
      case "custom":
        filtered = filtered.filter((m) => customSelection.has(m.profile.id));
        break;
    }
    return filtered.map((m) => m.profile.id);
  }, [
    selectedFilter,
    selectedSector,
    selectedRecommendation,
    selectedMetric,
    metricRange,
    metricValue1,
    metricValue2,
    performanceType,
    performanceCount,
    statusFilter,
    combinedFilters,
    customSelection,
    profileMetrics
  ]);
  const handleConfirm = () => {
    if (filteredTickers.length === 0) {
      alert("Aucun ticker ne correspond aux crit√®res s√©lectionn√©s.");
      return;
    }
    onConfirm(filteredTickers);
  };
  if (!isOpen) return null;
  return /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "fixed inset-0 z-[10000] flex items-center justify-center bg-black/50 p-4 overflow-y-auto", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white rounded-lg shadow-xl max-w-2xl w-full p-6 relative my-8", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      "button",
      {
        onClick: onClose,
        className: "absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors",
        disabled: isSyncing,
        children: /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$5, { className: "w-5 h-5" })
      }
    ),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-3 mb-6", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$6, { className: "w-6 h-6 text-blue-600" }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("h2", { className: "text-xl font-bold text-gray-900", children: "Synchronisation avec crit√®res avanc√©s" })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "mb-4 flex items-center justify-between", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-sm text-gray-600", children: "Choisissez les crit√®res pour s√©lectionner les tickers √† synchroniser :" }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs(
        "button",
        {
          onClick: () => setShowAdvanced(!showAdvanced),
          className: "text-xs text-blue-600 hover:text-blue-800 flex items-center gap-1",
          children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$7, { className: "w-4 h-4" }),
            showAdvanced ? "Options simples" : "Options avanc√©es"
          ]
        }
      )
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "space-y-3 mb-6 max-h-96 overflow-y-auto", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs(
        "label",
        {
          className: "flex items-center gap-3 p-3 border-2 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",
          style: { borderColor: selectedFilter === "all" ? "#2563eb" : "#e5e7eb" },
          children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "input",
              {
                type: "radio",
                name: "syncFilter",
                value: "all",
                checked: selectedFilter === "all",
                onChange: () => setSelectedFilter("all"),
                className: "w-4 h-4 text-blue-600"
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex-1", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "font-semibold text-gray-900", children: "Tous les tickers" }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-xs text-gray-500", children: [
                profiles.length,
                " ticker(s)"
              ] })
            ] })
          ]
        }
      ),
      /* @__PURE__ */ jsxRuntimeExports.jsxs(
        "label",
        {
          className: "flex items-center gap-3 p-3 border-2 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",
          style: { borderColor: selectedFilter === "portfolio" ? "#2563eb" : "#e5e7eb" },
          children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "input",
              {
                type: "radio",
                name: "syncFilter",
                value: "portfolio",
                checked: selectedFilter === "portfolio",
                onChange: () => setSelectedFilter("portfolio"),
                className: "w-4 h-4 text-blue-600"
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2 flex-1", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$8, { className: "w-5 h-5 text-yellow-500" }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "font-semibold text-gray-900", children: "Portefeuille (√©toiles)" }),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-xs text-gray-500", children: [
                  profileMetrics.filter((m) => !m.profile.isWatchlist).length,
                  " ticker(s)"
                ] })
              ] })
            ] })
          ]
        }
      ),
      /* @__PURE__ */ jsxRuntimeExports.jsxs(
        "label",
        {
          className: "flex items-center gap-3 p-3 border-2 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",
          style: { borderColor: selectedFilter === "watchlist" ? "#2563eb" : "#e5e7eb" },
          children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "input",
              {
                type: "radio",
                name: "syncFilter",
                value: "watchlist",
                checked: selectedFilter === "watchlist",
                onChange: () => setSelectedFilter("watchlist"),
                className: "w-4 h-4 text-blue-600"
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2 flex-1", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$9, { className: "w-5 h-5 text-blue-500" }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "font-semibold text-gray-900", children: "Watchlist (≈ìil)" }),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-xs text-gray-500", children: [
                  profileMetrics.filter((m) => m.profile.isWatchlist).length,
                  " ticker(s)"
                ] })
              ] })
            ] })
          ]
        }
      ),
      /* @__PURE__ */ jsxRuntimeExports.jsxs(
        "label",
        {
          className: "flex items-center gap-3 p-3 border-2 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",
          style: { borderColor: selectedFilter === "na" ? "#2563eb" : "#e5e7eb" },
          children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "input",
              {
                type: "radio",
                name: "syncFilter",
                value: "na",
                checked: selectedFilter === "na",
                onChange: () => setSelectedFilter("na"),
                className: "w-4 h-4 text-blue-600"
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2 flex-1", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$a, { className: "w-5 h-5 text-orange-500" }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "font-semibold text-gray-900", children: "Tickers avec N/A" }),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-xs text-gray-500", children: [
                  profileMetrics.filter((m) => m.hasInvalidData || m.jpegy === null).length,
                  " ticker(s)"
                ] })
              ] })
            ] })
          ]
        }
      ),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs(
          "label",
          {
            className: "flex items-center gap-3 p-3 border-2 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",
            style: { borderColor: selectedFilter === "sector" ? "#2563eb" : "#e5e7eb" },
            children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "input",
                {
                  type: "radio",
                  name: "syncFilter",
                  value: "sector",
                  checked: selectedFilter === "sector",
                  onChange: () => setSelectedFilter("sector"),
                  className: "w-4 h-4 text-blue-600"
                }
              ),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex-1", children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "font-semibold text-gray-900", children: "Par secteur" }),
                /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-500", children: selectedSector ? `${profileMetrics.filter((m) => m.profile.info.sector === selectedSector).length} ticker(s) dans "${selectedSector}"` : "S√©lectionnez un secteur" })
              ] })
            ]
          }
        ),
        selectedFilter === "sector" && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "mt-2 ml-7", children: /* @__PURE__ */ jsxRuntimeExports.jsxs(
          "select",
          {
            value: selectedSector,
            onChange: (e) => setSelectedSector(e.target.value),
            className: "w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",
            children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "", children: "-- S√©lectionnez un secteur --" }),
              sectors.map((sector) => /* @__PURE__ */ jsxRuntimeExports.jsxs("option", { value: sector, children: [
                sector,
                " (",
                profileMetrics.filter((m) => m.profile.info.sector === sector).length,
                " tickers)"
              ] }, sector))
            ]
          }
        ) })
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs(
          "label",
          {
            className: "flex items-center gap-3 p-3 border-2 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",
            style: { borderColor: selectedFilter === "recommendation" ? "#2563eb" : "#e5e7eb" },
            children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "input",
                {
                  type: "radio",
                  name: "syncFilter",
                  value: "recommendation",
                  checked: selectedFilter === "recommendation",
                  onChange: () => setSelectedFilter("recommendation"),
                  className: "w-4 h-4 text-blue-600"
                }
              ),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex-1", children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "font-semibold text-gray-900", children: "Par recommandation" }),
                /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-500", children: selectedRecommendation ? `${profileMetrics.filter((m) => m.recommendation === selectedRecommendation).length} ticker(s) avec "${selectedRecommendation}"` : "S√©lectionnez une recommandation" })
              ] })
            ]
          }
        ),
        selectedFilter === "recommendation" && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "mt-2 ml-7", children: /* @__PURE__ */ jsxRuntimeExports.jsxs(
          "select",
          {
            value: selectedRecommendation,
            onChange: (e) => setSelectedRecommendation(e.target.value),
            className: "w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",
            children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "", children: "-- S√©lectionnez une recommandation --" }),
              recommendations.map((rec) => {
                const count = profileMetrics.filter((m) => m.recommendation === rec).length;
                const emoji = rec === "ACHAT" ? "üü¢" : rec === "CONSERVER" ? "üü°" : rec === "VENTE" ? "üî¥" : "‚ö™";
                return /* @__PURE__ */ jsxRuntimeExports.jsxs("option", { value: rec, children: [
                  emoji,
                  " ",
                  rec,
                  " (",
                  count,
                  " tickers)"
                ] }, rec);
              })
            ]
          }
        ) })
      ] }),
      showAdvanced && /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs(
            "label",
            {
              className: "flex items-center gap-3 p-3 border-2 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",
              style: { borderColor: selectedFilter === "metric" ? "#2563eb" : "#e5e7eb" },
              children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx(
                  "input",
                  {
                    type: "radio",
                    name: "syncFilter",
                    value: "metric",
                    checked: selectedFilter === "metric",
                    onChange: () => setSelectedFilter("metric"),
                    className: "w-4 h-4 text-blue-600"
                  }
                ),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex-1", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "font-semibold text-gray-900", children: "Par m√©trique (plage de valeurs)" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-500", children: "Filtrer par JPEGY, Ratio 3:1, Return %, etc." })
                ] })
              ]
            }
          ),
          selectedFilter === "metric" && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "mt-2 ml-7 space-y-2", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsxs(
              "select",
              {
                value: selectedMetric,
                onChange: (e) => setSelectedMetric(e.target.value),
                className: "w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",
                children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "jpegy", children: "JPEGY" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "ratio31", children: "Ratio 3:1" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "return", children: "Return %" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "volatility", children: "Volatilit√© %" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "pe", children: "P/E" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "yield", children: "Yield %" })
                ]
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex gap-2 items-center", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsxs(
                "select",
                {
                  value: metricRange,
                  onChange: (e) => setMetricRange(e.target.value),
                  className: "px-2 py-1 border border-gray-300 rounded text-sm",
                  children: [
                    /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "<", children: "<" }),
                    /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: ">", children: ">" }),
                    /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "between", children: "Entre" })
                  ]
                }
              ),
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "input",
                {
                  type: "number",
                  value: metricValue1,
                  onChange: (e) => setMetricValue1(e.target.value),
                  placeholder: "Valeur",
                  className: "flex-1 px-2 py-1 border border-gray-300 rounded text-sm"
                }
              ),
              metricRange === "between" && /* @__PURE__ */ jsxRuntimeExports.jsx(
                "input",
                {
                  type: "number",
                  value: metricValue2,
                  onChange: (e) => setMetricValue2(e.target.value),
                  placeholder: "et",
                  className: "flex-1 px-2 py-1 border border-gray-300 rounded text-sm"
                }
              )
            ] })
          ] })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs(
            "label",
            {
              className: "flex items-center gap-3 p-3 border-2 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",
              style: { borderColor: selectedFilter === "performance" ? "#2563eb" : "#e5e7eb" },
              children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx(
                  "input",
                  {
                    type: "radio",
                    name: "syncFilter",
                    value: "performance",
                    checked: selectedFilter === "performance",
                    onChange: () => setSelectedFilter("performance"),
                    className: "w-4 h-4 text-blue-600"
                  }
                ),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex-1", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "font-semibold text-gray-900", children: "Par performance (Top/Bottom)" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-500", children: "Top 10 ou Bottom 10 par m√©trique" })
                ] })
              ]
            }
          ),
          selectedFilter === "performance" && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "mt-2 ml-7 space-y-2", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex gap-2", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsxs(
                "select",
                {
                  value: performanceType,
                  onChange: (e) => setPerformanceType(e.target.value),
                  className: "px-2 py-1 border border-gray-300 rounded text-sm",
                  children: [
                    /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "top", children: "Top" }),
                    /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "bottom", children: "Bottom" })
                  ]
                }
              ),
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "input",
                {
                  type: "number",
                  value: performanceCount,
                  onChange: (e) => setPerformanceCount(e.target.value),
                  placeholder: "Nombre",
                  className: "flex-1 px-2 py-1 border border-gray-300 rounded text-sm"
                }
              )
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs(
              "select",
              {
                value: selectedMetric,
                onChange: (e) => setSelectedMetric(e.target.value),
                className: "w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",
                children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "jpegy", children: "JPEGY" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "ratio31", children: "Ratio 3:1" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "return", children: "Return %" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "volatility", children: "Volatilit√© %" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "pe", children: "P/E" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "yield", children: "Yield %" })
                ]
              }
            )
          ] })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs(
            "label",
            {
              className: "flex items-center gap-3 p-3 border-2 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",
              style: { borderColor: selectedFilter === "status" ? "#2563eb" : "#e5e7eb" },
              children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx(
                  "input",
                  {
                    type: "radio",
                    name: "syncFilter",
                    value: "status",
                    checked: selectedFilter === "status",
                    onChange: () => setSelectedFilter("status"),
                    className: "w-4 h-4 text-blue-600"
                  }
                ),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex-1", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "font-semibold text-gray-900", children: "Par statut" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-500", children: "Approuv√©, non approuv√©, ou squelette" })
                ] })
              ]
            }
          ),
          selectedFilter === "status" && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "mt-2 ml-7", children: /* @__PURE__ */ jsxRuntimeExports.jsxs(
            "select",
            {
              value: statusFilter,
              onChange: (e) => setStatusFilter(e.target.value),
              className: "w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",
              children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "skeleton", children: "Squelette (donn√©es incompl√®tes)" }),
                /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "not-approved", children: "Non approuv√©" }),
                /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "approved", children: "Approuv√©" })
              ]
            }
          ) })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs(
            "label",
            {
              className: "flex items-center gap-3 p-3 border-2 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",
              style: { borderColor: selectedFilter === "combined" ? "#2563eb" : "#e5e7eb" },
              children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx(
                  "input",
                  {
                    type: "radio",
                    name: "syncFilter",
                    value: "combined",
                    checked: selectedFilter === "combined",
                    onChange: () => setSelectedFilter("combined"),
                    className: "w-4 h-4 text-blue-600"
                  }
                ),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex-1", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "font-semibold text-gray-900", children: "Filtres combin√©s" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-500", children: "Combiner plusieurs crit√®res" })
                ] })
              ]
            }
          ),
          selectedFilter === "combined" && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "mt-2 ml-7 space-y-2", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsxs("label", { className: "flex items-center gap-2", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "input",
                {
                  type: "checkbox",
                  checked: combinedFilters.portfolio || false,
                  onChange: (e) => setCombinedFilters({ ...combinedFilters, portfolio: e.target.checked }),
                  className: "w-4 h-4"
                }
              ),
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-sm", children: "Portefeuille (√©toiles)" })
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("label", { className: "flex items-center gap-2", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "input",
                {
                  type: "checkbox",
                  checked: combinedFilters.watchlist || false,
                  onChange: (e) => setCombinedFilters({ ...combinedFilters, watchlist: e.target.checked }),
                  className: "w-4 h-4"
                }
              ),
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-sm", children: "Watchlist (≈ìil)" })
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs(
              "select",
              {
                value: combinedFilters.sector || "",
                onChange: (e) => setCombinedFilters({ ...combinedFilters, sector: e.target.value || void 0 }),
                className: "w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",
                children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "", children: "-- Secteur (optionnel) --" }),
                  sectors.map((sector) => /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: sector, children: sector }, sector))
                ]
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsxs(
              "select",
              {
                value: combinedFilters.recommendation || "",
                onChange: (e) => setCombinedFilters({ ...combinedFilters, recommendation: e.target.value || void 0 }),
                className: "w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",
                children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "", children: "-- Recommandation (optionnel) --" }),
                  recommendations.map((rec) => /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: rec, children: rec }, rec))
                ]
              }
            )
          ] })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs(
            "label",
            {
              className: "flex items-center gap-3 p-3 border-2 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",
              style: { borderColor: selectedFilter === "custom" ? "#2563eb" : "#e5e7eb" },
              children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx(
                  "input",
                  {
                    type: "radio",
                    name: "syncFilter",
                    value: "custom",
                    checked: selectedFilter === "custom",
                    onChange: () => setSelectedFilter("custom"),
                    className: "w-4 h-4 text-blue-600"
                  }
                ),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex-1", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "font-semibold text-gray-900", children: "S√©lection manuelle" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-xs text-gray-500", children: [
                    customSelection.size,
                    " ticker(s) s√©lectionn√©(s)"
                  ] })
                ] })
              ]
            }
          ),
          selectedFilter === "custom" && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "mt-2 ml-7 max-h-48 overflow-y-auto border border-gray-300 rounded-lg p-2", children: profiles.map((profile) => /* @__PURE__ */ jsxRuntimeExports.jsxs("label", { className: "flex items-center gap-2 p-1 hover:bg-gray-50 cursor-pointer", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "input",
              {
                type: "checkbox",
                checked: customSelection.has(profile.id),
                onChange: (e) => {
                  const newSelection = new Set(customSelection);
                  if (e.target.checked) {
                    newSelection.add(profile.id);
                  } else {
                    newSelection.delete(profile.id);
                  }
                  setCustomSelection(newSelection);
                },
                className: "w-4 h-4"
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-sm", children: profile.id }),
            profile.info.name && /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-xs text-gray-500", children: [
              "(",
              profile.info.name,
              ")"
            ] })
          ] }, profile.id)) })
        ] })
      ] })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-sm font-semibold text-blue-900 mb-1", children: [
        "Tickers s√©lectionn√©s : ",
        filteredTickers.length
      ] }),
      filteredTickers.length > 0 && filteredTickers.length <= 10 && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-blue-700 mt-1", children: filteredTickers.join(", ") }),
      filteredTickers.length > 10 && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-xs text-blue-700 mt-1", children: [
        filteredTickers.slice(0, 10).join(", "),
        " ... et ",
        filteredTickers.length - 10,
        " autres"
      ] })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex gap-3 justify-end", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        "button",
        {
          onClick: onClose,
          disabled: isSyncing,
          className: "px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50",
          children: "Annuler"
        }
      ),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        "button",
        {
          onClick: handleConfirm,
          disabled: isSyncing || filteredTickers.length === 0,
          className: "px-4 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",
          children: isSyncing ? /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$b, { className: "w-4 h-4 animate-spin" }),
            "Synchronisation..."
          ] }) : /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$b, { className: "w-4 h-4" }),
            "Synchroniser (",
            filteredTickers.length,
            ")"
          ] })
        }
      )
    ] })
  ] }) });
};
const GuideDialog = ({ isOpen, onClose }) => {
  if (!isOpen) return null;
  return /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "fixed inset-0 z-[10000] flex items-center justify-center bg-black/50 p-4 overflow-y-auto", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white rounded-lg shadow-xl max-w-4xl w-full p-6 relative my-8 max-h-[90vh] overflow-y-auto", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      "button",
      {
        onClick: onClose,
        className: "absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors z-10",
        children: /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$5, { className: "w-6 h-6" })
      }
    ),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-3 mb-6 pb-4 border-b border-gray-200", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$c, { className: "w-8 h-8 text-blue-600" }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("h2", { className: "text-2xl font-bold text-gray-900", children: "Guide : R√©duire les N/A et Actualiser les Profils" }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-sm text-gray-600 mt-1", children: 'Comment r√©duire le nombre de tickers affichant "N/A" dans le KPI Dashboard' })
      ] })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "prose prose-sm max-w-none", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("section", { className: "mb-6", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs("h3", { className: "text-lg font-bold text-gray-900 mb-3 flex items-center gap-2", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$d, { className: "w-5 h-5 text-blue-600" }),
          "Objectif"
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-gray-700", children: 'R√©duire le nombre de tickers affichant "N/A" dans le KPI Dashboard en synchronisant et nettoyant les profils.' })
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("section", { className: "mb-6", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs("h3", { className: "text-lg font-bold text-gray-900 mb-3 flex items-center gap-2", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$a, { className: "w-5 h-5 text-orange-600" }),
          "Causes des N/A"
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-gray-700 mb-3", children: 'Les tickers affichent "N/A" pour JPEGY et "-100%" pour le rendement lorsque :' }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("ul", { className: "list-disc list-inside space-y-2 text-gray-700 ml-4", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Profils non synchronis√©s" }),
            " : Pas encore charg√©s depuis l'API FMP",
            /* @__PURE__ */ jsxRuntimeExports.jsx("ul", { className: "list-circle list-inside ml-4 mt-1 text-sm text-gray-600", children: /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "Solution : Synchroniser depuis Supabase puis actualiser depuis FMP" }) })
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Donn√©es invalides" }),
            " :",
            /* @__PURE__ */ jsxRuntimeExports.jsxs("ul", { className: "list-circle list-inside ml-4 mt-1 text-sm text-gray-600", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "Prix actuel invalide (‚â§ 0)" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "EPS = 0 ou invalide" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "Croissance EPS + Yield ‚â§ 0.01%" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "Aucune donn√©e financi√®re valide" })
            ] })
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Fonds mutuels" }),
            " : Maintenant automatiquement filtr√©s"
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Tickers obsol√®tes" }),
            " : Donn√©es trop anciennes ou corrompues"
          ] })
        ] })
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("section", { className: "mb-6", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs("h3", { className: "text-lg font-bold text-gray-900 mb-3 flex items-center gap-2", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$e, { className: "w-5 h-5 text-green-600" }),
          "Solutions"
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-blue-50 border-l-4 border-blue-500 p-4 mb-4 rounded-r", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("h4", { className: "font-bold text-blue-900 mb-2", children: "Option 1 : Synchronisation en Masse (RECOMMAND√â)" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-blue-800 text-sm mb-3", children: /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Dans l'application Finance Pro 3p1 :" }) }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("ol", { className: "list-decimal list-inside space-y-2 text-blue-800 text-sm ml-2", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "Ouvrez la sidebar (menu hamburger)" }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
              "Cliquez sur ",
              /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: '"Sync Tous les Tickers"' }),
              " (bouton vert)"
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "Confirmez la synchronisation" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "Attendez la fin du processus (peut prendre plusieurs minutes)" })
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "mt-3 p-3 bg-white rounded border border-blue-200", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-xs font-semibold text-blue-900 mb-2", children: "Ce que fait la synchronisation :" }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("ul", { className: "list-check list-inside space-y-1 text-xs text-blue-800", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "‚úÖ Cr√©e un snapshot de sauvegarde avant chaque sync" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "‚úÖ Met √† jour les donn√©es depuis FMP" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "‚úÖ Pr√©serve vos modifications manuelles" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "‚úÖ Recalcule les hypoth√®ses automatiquement" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "‚úÖ D√©tecte et exclut les m√©triques aberrantes" })
            ] })
          ] })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-green-50 border-l-4 border-green-500 p-4 mb-4 rounded-r", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("h4", { className: "font-bold text-green-900 mb-2", children: "Option 2 : Synchronisation avec Crit√®res" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-green-800 text-sm mb-3", children: /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Dans l'onglet KPI :" }) }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("ol", { className: "list-decimal list-inside space-y-2 text-green-800 text-sm ml-2", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
              "Cliquez sur ",
              /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: '"Sync avec crit√®res"' }),
              " (bouton bleu)"
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
              "Choisissez un crit√®re :",
              /* @__PURE__ */ jsxRuntimeExports.jsxs("ul", { className: "list-disc list-inside ml-4 mt-1", children: [
                /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Tous les tickers" }),
                  " - Synchronise tout"
                ] }),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Portefeuille (√©toiles)" }),
                  " - Uniquement les tickers du portefeuille"
                ] }),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Watchlist (≈ìil)" }),
                  " - Uniquement la watchlist"
                ] }),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Tickers avec N/A" }),
                  " - Uniquement les tickers probl√©matiques"
                ] }),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Par secteur" }),
                  " - Un secteur sp√©cifique"
                ] })
              ] })
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "V√©rifiez le r√©sum√© des tickers s√©lectionn√©s" }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
              "Cliquez sur ",
              /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: '"Synchroniser (X)"' })
            ] })
          ] })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-orange-50 border-l-4 border-orange-500 p-4 mb-4 rounded-r", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("h4", { className: "font-bold text-orange-900 mb-2", children: "Option 3 : Synchronisation Individuelle" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-orange-800 text-sm mb-3", children: "Pour chaque ticker avec N/A :" }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("ol", { className: "list-decimal list-inside space-y-2 text-orange-800 text-sm ml-2", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "S√©lectionnez le ticker dans la sidebar" }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
              "Cliquez sur ",
              /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: '"Synchroniser"' }),
              " (bouton avec ic√¥ne de rafra√Æchissement)"
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "Confirmez si des modifications manuelles existent" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "Attendez la fin de la synchronisation" })
          ] })
        ] })
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("section", { className: "mb-6", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("h3", { className: "text-lg font-bold text-gray-900 mb-3", children: "üîÑ Processus Recommand√©" }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "bg-gray-50 border border-gray-200 rounded-lg p-4", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("ol", { className: "list-decimal list-inside space-y-3 text-gray-700", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Nettoyer les Fonds Mutuels (AUTOMATIQUE)" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-sm text-gray-600 ml-6 mt-1", children: "‚úÖ D√©j√† fait - Les fonds mutuels sont automatiquement supprim√©s au chargement" })
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Synchroniser Tous les Tickers" }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("ul", { className: "list-disc list-inside ml-6 mt-1 text-sm text-gray-600", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "Ouvrez Finance Pro 3p1" }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
                "Sidebar ‚Üí ",
                /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: '"Sync Tous les Tickers"' })
              ] }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "Attendez la fin (peut prendre 5-15 minutes selon le nombre de tickers)" })
            ] })
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "V√©rifier les R√©sultats" }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("ul", { className: "list-disc list-inside ml-6 mt-1 text-sm text-gray-600", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
                "Allez dans l'onglet ",
                /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: '"KPI"' })
              ] }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "V√©rifiez le nombre de N/A restants" }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
                "Les tickers avec N/A apr√®s sync sont probablement :",
                /* @__PURE__ */ jsxRuntimeExports.jsxs("ul", { className: "list-circle list-inside ml-4 mt-1", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "Des fonds mutuels non d√©tect√©s" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "Des tickers avec donn√©es vraiment invalides" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "Des tickers obsol√®tes" })
                ] })
              ] })
            ] })
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Synchroniser les N/A Restants (Optionnel)" }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("ul", { className: "list-disc list-inside ml-6 mt-1 text-sm text-gray-600", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
                "Cliquez sur ",
                /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: '"Afficher N/A"' }),
                " dans l'onglet KPI"
              ] }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
                "Cliquez sur ",
                /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: '"Sync N/A (X)"' }),
                " pour synchroniser uniquement les tickers probl√©matiques"
              ] })
            ] })
          ] })
        ] }) })
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("section", { className: "mb-6", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("h3", { className: "text-lg font-bold text-gray-900 mb-3", children: "üìà R√©sultats Attendus" }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-green-50 border-l-4 border-green-500 p-4 rounded-r", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-green-800 text-sm mb-2", children: "Apr√®s la synchronisation en masse :" }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("ul", { className: "list-check list-inside space-y-1 text-green-800 text-sm ml-2", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "‚úÖ Tous les profils valides auront des donn√©es √† jour" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "‚úÖ JPEGY calculable pour la plupart des tickers" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "‚úÖ Rendements projet√©s r√©alistes" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "‚úÖ Moins de N/A dans le dashboard" })
          ] })
        ] })
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("section", { className: "mb-6", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("h3", { className: "text-lg font-bold text-gray-900 mb-3", children: "‚ö†Ô∏è Notes Importantes" }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded-r", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("ul", { className: "list-disc list-inside space-y-2 text-yellow-800 text-sm", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Temps de traitement" }),
            " : La synchronisation en masse peut prendre plusieurs minutes"
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Sauvegarde automatique" }),
            " : Un snapshot est cr√©√© avant chaque sync"
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Pr√©servation des donn√©es" }),
            " : Vos modifications manuelles sont pr√©serv√©es"
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Fonds mutuels" }),
            " : Sont automatiquement exclus (ne peuvent pas √™tre analys√©s)"
          ] })
        ] }) })
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("section", { className: "mb-6", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("h3", { className: "text-lg font-bold text-gray-900 mb-3", children: "üêõ D√©pannage" }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-red-50 border-l-4 border-red-500 p-4 rounded-r", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("h4", { className: "font-semibold text-red-900 mb-2", children: "Si la synchronisation √©choue pour certains tickers :" }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("ul", { className: "list-disc list-inside space-y-1 text-red-800 text-sm ml-2", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "V√©rifiez la console pour les messages d'erreur" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "Certains tickers peuvent √™tre obsol√®tes ou invalides" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "Utilisez le script de nettoyage pour les identifier" })
            ] })
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("h4", { className: "font-semibold text-blue-900 mb-2", children: "Si trop de N/A persistent :" }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("ul", { className: "list-disc list-inside space-y-1 text-blue-800 text-sm ml-2", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "V√©rifiez que les tickers ne sont pas des fonds mutuels" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "V√©rifiez que les donn√©es FMP sont disponibles" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: "Certains tickers peuvent n√©cessiter une synchronisation manuelle" })
            ] })
          ] })
        ] })
      ] })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "mt-6 pt-4 border-t border-gray-200 flex justify-end", children: /* @__PURE__ */ jsxRuntimeExports.jsx(
      "button",
      {
        onClick: onClose,
        className: "px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",
        children: "Fermer"
      }
    ) })
  ] }) });
};
const getJpegyColor = (jpegy) => {
  if (jpegy === null || !isFinite(jpegy)) return null;
  if (jpegy <= 0.5) return "#86efac";
  if (jpegy <= 1.5) return "#16a34a";
  if (jpegy <= 1.75) return "#eab308";
  if (jpegy <= 2) return "#f97316";
  return "#dc2626";
};
const getRatio31Color = (ratio) => {
  if (ratio === null || !isFinite(ratio) || ratio < 0) return null;
  if (ratio >= 3) return "#16a34a";
  if (ratio >= 1) return "#eab308";
  return "#dc2626";
};
const getReturnColor = (returnPercent) => {
  if (returnPercent === null || returnPercent === void 0 || !isFinite(returnPercent)) {
    return "#6b7280";
  }
  if (returnPercent >= 50) return "#16a34a";
  if (returnPercent >= 15) return "#22c55e";
  if (returnPercent >= 0) return "#eab308";
  if (returnPercent >= -15) return "#f97316";
  return "#dc2626";
};
const getRecommendationBgColor = (recommendation) => {
  switch (recommendation) {
    case "ACHAT":
    case "BUY":
      return "bg-green-500/20 text-green-400";
    case "VENTE":
    case "SELL":
      return "bg-red-500/20 text-red-400";
    case "CONSERVER":
    case "HOLD":
      return "bg-yellow-500/20 text-yellow-400";
    default:
      return "bg-gray-500/20 text-gray-400";
  }
};
const StatusBadge = ({
  value,
  type = "custom",
  customColor,
  size = "md",
  className = ""
}) => {
  if (value === null || value === void 0) {
    return /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: `inline-flex items-center px-2 py-0.5 rounded text-gray-400 bg-gray-700/50 ${className}`, children: "N/A" });
  }
  let colorClass = "";
  let bgStyle = {};
  switch (type) {
    case "recommendation":
      colorClass = getRecommendationBgColor(String(value));
      break;
    case "jpegy":
      const jpegyColor = getJpegyColor(Number(value));
      if (jpegyColor) {
        bgStyle = { backgroundColor: `${jpegyColor}20`, color: jpegyColor };
      }
      break;
    case "ratio31":
      const ratioColor = getRatio31Color(Number(value));
      if (ratioColor) {
        bgStyle = { backgroundColor: `${ratioColor}20`, color: ratioColor };
      }
      break;
    case "return":
      const returnColor = getReturnColor(Number(value));
      bgStyle = { backgroundColor: `${returnColor}20`, color: returnColor };
      break;
    case "custom":
      if (customColor) {
        bgStyle = { backgroundColor: `${customColor}20`, color: customColor };
      }
      break;
  }
  const sizeClass = {
    sm: "text-xs px-1.5 py-0.5",
    md: "text-sm px-2 py-0.5",
    lg: "text-base px-2.5 py-1"
  }[size];
  const displayValue = typeof value === "number" ? type === "return" || type === "ratio31" ? `${value.toFixed(1)}%` : value.toFixed(2) : value;
  return /* @__PURE__ */ jsxRuntimeExports.jsx(
    "span",
    {
      className: `inline-flex items-center rounded font-medium ${sizeClass} ${colorClass} ${className}`,
      style: bgStyle,
      children: displayValue
    }
  );
};
const KPIDashboard = ({ profiles, currentId, onSelect, onBulkSync, onSyncNA, isBulkSyncing = false, onUpdateProfile, onOpenSettings }) => {
  var _a, _b, _c;
  const [sortConfig, setSortConfig] = reactExports.useState({ key: "totalReturnPercent", direction: "desc" });
  const [showSyncDialog, setShowSyncDialog] = reactExports.useState(false);
  const [showGuideDialog, setShowGuideDialog] = reactExports.useState(false);
  const [isAnalyzingNA, setIsAnalyzingNA] = reactExports.useState(false);
  const [naAnalysisResult, setNaAnalysisResult] = reactExports.useState(null);
  const [comparisonMode, setComparisonMode] = reactExports.useState(false);
  const [selectedForComparison, setSelectedForComparison] = reactExports.useState([]);
  const [matrixView, setMatrixView] = reactExports.useState("grid");
  const [approvedVersions, setApprovedVersions] = reactExports.useState(/* @__PURE__ */ new Set());
  const [isLoadingApprovedVersions, setIsLoadingApprovedVersions] = reactExports.useState(false);
  const [zoomJPEGY, setZoomJPEGY] = reactExports.useState(1);
  const [panJPEGY, setPanJPEGY] = reactExports.useState({ x: 0, y: 0 });
  const [isPanningJPEGY, setIsPanningJPEGY] = reactExports.useState(false);
  const [panStartJPEGY, setPanStartJPEGY] = reactExports.useState({ x: 0, y: 0 });
  const svgJPEGYRef = reactExports.useRef(null);
  const [zoomRatio31, setZoomRatio31] = reactExports.useState(1);
  const [panRatio31, setPanRatio31] = reactExports.useState({ x: 0, y: 0 });
  const [isPanningRatio31, setIsPanningRatio31] = reactExports.useState(false);
  const [panStartRatio31, setPanStartRatio31] = reactExports.useState({ x: 0, y: 0 });
  const svgRatio31Ref = reactExports.useRef(null);
  const [sectionsVisibility, setSectionsVisibility] = reactExports.useState({
    globalStats: true,
    detailedAnalysis: true,
    comparison: true,
    filters: true,
    performanceMatrix: true,
    scatterPlot: true,
    scatterPlotRatio31: true,
    returnDistribution: true,
    otherVisualizations: true,
    correlationMatrix: true,
    detailedTable: true
  });
  const toggleSection = (sectionKey) => {
    setSectionsVisibility((prev) => ({
      ...prev,
      [sectionKey]: !prev[sectionKey]
    }));
  };
  const profileMetrics = reactExports.useMemo(() => {
    if (profiles.length === 0) return [];
    return profiles.map((profile) => {
      if (profile._isSkeleton || !profile.data || profile.data.length === 0) {
        return {
          profile,
          recommendation: null,
          jpegy: null,
          totalReturnPercent: null,
          ratio31: null,
          downsideRisk: null,
          upsidePotential: null,
          hasApprovedVersion: false,
          targetPrice: null,
          currentPE: null,
          currentPCF: null,
          currentPBV: null,
          currentYield: null,
          historicalGrowth: null,
          volatility: null,
          _isLoading: true
          // Flag pour afficher un indicateur de chargement
        };
      }
      const { recommendation, targetPrice } = calculateRecommendation(profile.data, profile.assumptions);
      const currentPrice = Math.max(profile.assumptions.currentPrice || 0, 0.01);
      if (currentPrice <= 0 || !isFinite(currentPrice)) {
        return {
          profile,
          recommendation,
          jpegy: null,
          totalReturnPercent: -100,
          ratio31: 0,
          downsideRisk: 0,
          upsidePotential: -100,
          hasApprovedVersion: false,
          targetPrice: 0,
          currentPE: 0,
          currentPCF: 0,
          currentPBV: 0,
          currentYield: 0,
          historicalGrowth: 0,
          volatility: 0
        };
      }
      const baseYearData = profile.data.find((d) => d.year === profile.assumptions.baseYear) || profile.data[profile.data.length - 1];
      const baseEPS = Math.max((baseYearData == null ? void 0 : baseYearData.earningsPerShare) || 0, 0);
      const hasValidEPS = baseEPS > 0.01 && isFinite(baseEPS);
      const basePE = hasValidEPS && currentPrice > 0 ? currentPrice / baseEPS : 0;
      const safeBasePE = basePE > 0 && basePE <= 1e3 ? basePE : 0;
      const baseYield = currentPrice > 0 && profile.assumptions.currentDividend >= 0 ? profile.assumptions.currentDividend / currentPrice * 100 : 0;
      const safeBaseYield = Math.max(0, Math.min(baseYield, 50));
      const growthPlusYield = (profile.assumptions.growthRateEPS || 0) + safeBaseYield;
      let jpegy = null;
      if (growthPlusYield > 0.01 && safeBasePE > 0 && hasValidEPS) {
        const rawJPEGY = safeBasePE / growthPlusYield;
        if (isFinite(rawJPEGY) && rawJPEGY >= 0 && rawJPEGY <= 100) {
          jpegy = rawJPEGY;
        }
      }
      const baseValues = {
        eps: Math.max(baseEPS, 0),
        cf: Math.max((baseYearData == null ? void 0 : baseYearData.cashFlowPerShare) || 0, 0),
        bv: Math.max((baseYearData == null ? void 0 : baseYearData.bookValuePerShare) || 0, 0),
        div: Math.max(profile.assumptions.currentDividend || 0, 0)
      };
      const projectFutureValue = (current, rate, years) => {
        if (current <= 0 || !isFinite(current) || !isFinite(rate)) return 0;
        const safeRate = Math.max(-50, Math.min(rate, 50));
        return current * Math.pow(1 + safeRate / 100, years);
      };
      const safeGrowthEPS = Math.max(-50, Math.min(profile.assumptions.growthRateEPS || 0, 50));
      const safeGrowthCF = Math.max(-50, Math.min(profile.assumptions.growthRateCF || 0, 50));
      const safeGrowthBV = Math.max(-50, Math.min(profile.assumptions.growthRateBV || 0, 50));
      const safeGrowthDiv = Math.max(-50, Math.min(profile.assumptions.growthRateDiv || 0, 50));
      const futureValues = {
        eps: projectFutureValue(baseValues.eps, safeGrowthEPS, 5),
        cf: projectFutureValue(baseValues.cf, safeGrowthCF, 5),
        bv: projectFutureValue(baseValues.bv, safeGrowthBV, 5),
        div: projectFutureValue(baseValues.div, safeGrowthDiv, 5)
      };
      const safeTargetPE = Math.max(1, Math.min(profile.assumptions.targetPE || 0, 100));
      const safeTargetPCF = Math.max(1, Math.min(profile.assumptions.targetPCF || 0, 100));
      const safeTargetPBV = Math.max(0.5, Math.min(profile.assumptions.targetPBV || 0, 50));
      const safeTargetYield = Math.max(0.1, Math.min(profile.assumptions.targetYield || 0, 20));
      const targets = {
        eps: futureValues.eps > 0 && safeTargetPE > 0 && safeTargetPE <= 100 ? futureValues.eps * safeTargetPE : 0,
        cf: futureValues.cf > 0 && safeTargetPCF > 0 && safeTargetPCF <= 100 ? futureValues.cf * safeTargetPCF : 0,
        bv: futureValues.bv > 0 && safeTargetPBV > 0 && safeTargetPBV <= 50 ? futureValues.bv * safeTargetPBV : 0,
        div: futureValues.div > 0 && safeTargetYield > 0 && safeTargetYield <= 20 ? futureValues.div / (safeTargetYield / 100) : 0
      };
      const maxReasonableTarget = currentPrice * 50;
      const minReasonableTarget = currentPrice * 0.1;
      const validTargets = [
        !profile.assumptions.excludeEPS && targets.eps > 0 && targets.eps >= minReasonableTarget && targets.eps <= maxReasonableTarget && isFinite(targets.eps) ? targets.eps : null,
        !profile.assumptions.excludeCF && targets.cf > 0 && targets.cf >= minReasonableTarget && targets.cf <= maxReasonableTarget && isFinite(targets.cf) ? targets.cf : null,
        !profile.assumptions.excludeBV && targets.bv > 0 && targets.bv >= minReasonableTarget && targets.bv <= maxReasonableTarget && isFinite(targets.bv) ? targets.bv : null,
        !profile.assumptions.excludeDIV && targets.div > 0 && targets.div >= minReasonableTarget && targets.div <= maxReasonableTarget && isFinite(targets.div) ? targets.div : null
      ].filter((t) => t !== null && t > 0 && isFinite(t));
      const avgTargetPrice = validTargets.length > 0 ? validTargets.reduce((a, b) => a + b, 0) / validTargets.length : 0;
      let totalDividends = 0;
      let currentD = Math.max(0, baseValues.div);
      const maxReasonableDividends = currentPrice * 10;
      for (let i = 0; i < 5; i++) {
        currentD = currentD * (1 + safeGrowthDiv / 100);
        if (isFinite(currentD) && currentD >= 0 && totalDividends + currentD <= maxReasonableDividends) {
          totalDividends += currentD;
        } else {
          break;
        }
      }
      totalDividends = Math.min(totalDividends, maxReasonableDividends);
      let totalReturnPercent = -100;
      if (currentPrice > 0 && avgTargetPrice > 0 && isFinite(avgTargetPrice) && isFinite(totalDividends) && validTargets.length > 0) {
        const rawReturn = (avgTargetPrice + totalDividends - currentPrice) / currentPrice * 100;
        if (isFinite(rawReturn) && rawReturn >= -100 && rawReturn <= 1e3) {
          if (avgTargetPrice <= currentPrice * 100 && avgTargetPrice >= currentPrice * 0.1) {
            totalReturnPercent = rawReturn;
          } else {
            totalReturnPercent = -100;
          }
        } else {
          totalReturnPercent = -100;
        }
      } else if (validTargets.length === 0) {
        totalReturnPercent = -100;
      }
      const validHistory = profile.data.filter((d) => d.priceHigh > 0 && d.priceLow > 0 && isFinite(d.priceHigh) && isFinite(d.priceLow));
      const avgLowPrice = validHistory.length > 0 ? validHistory.reduce((sum, d) => sum + d.priceLow, 0) / validHistory.length : currentPrice * 0.7;
      const safeAvgLowPrice = isFinite(avgLowPrice) && avgLowPrice > 0 ? avgLowPrice : currentPrice * 0.7;
      const downsideRisk = currentPrice > 0 && safeAvgLowPrice > 0 ? Math.max(0, Math.min(100, (currentPrice - safeAvgLowPrice * 0.9) / currentPrice * 100)) : 0;
      const upsidePotential = Math.max(-100, Math.min(1e3, totalReturnPercent));
      const ratio31 = downsideRisk > 0.1 ? Math.max(0, Math.min(100, upsidePotential / downsideRisk)) : 0;
      const hasApprovedVersion = approvedVersions.has(profile.id);
      const currentPE = isFinite(basePE) && basePE >= 0 ? Math.min(basePE, 1e3) : 0;
      const currentPCF = (baseYearData == null ? void 0 : baseYearData.cashFlowPerShare) > 0 && isFinite(baseYearData.cashFlowPerShare) ? Math.min(currentPrice / baseYearData.cashFlowPerShare, 1e3) : 0;
      const currentPBV = (baseYearData == null ? void 0 : baseYearData.bookValuePerShare) > 0 && isFinite(baseYearData.bookValuePerShare) ? Math.min(currentPrice / baseYearData.bookValuePerShare, 100) : 0;
      const currentYield = Math.max(0, Math.min(100, baseYield));
      const validData = profile.data.filter((d) => d.earningsPerShare > 0 && isFinite(d.earningsPerShare));
      let historicalGrowth = 0;
      if (validData.length >= 2) {
        const firstEPS = validData[0].earningsPerShare;
        const lastEPS = validData[validData.length - 1].earningsPerShare;
        const years = validData[validData.length - 1].year - validData[0].year;
        if (years > 0 && firstEPS > 0 && lastEPS > 0 && isFinite(firstEPS) && isFinite(lastEPS)) {
          const rawGrowth = (Math.pow(lastEPS / firstEPS, 1 / years) - 1) * 100;
          historicalGrowth = Math.max(-50, Math.min(100, rawGrowth));
        }
      }
      const priceChanges = [];
      for (let i = 1; i < validHistory.length; i++) {
        if (validHistory[i].priceHigh > 0 && validHistory[i - 1].priceHigh > 0 && isFinite(validHistory[i].priceHigh) && isFinite(validHistory[i - 1].priceHigh)) {
          const change = (validHistory[i].priceHigh - validHistory[i - 1].priceHigh) / validHistory[i - 1].priceHigh * 100;
          if (isFinite(change)) {
            priceChanges.push(change);
          }
        }
      }
      const avgChange = priceChanges.length > 0 ? priceChanges.reduce((a, b) => a + b, 0) / priceChanges.length : 0;
      const variance = priceChanges.length > 0 && isFinite(avgChange) ? priceChanges.reduce((sum, change) => {
        const diff = change - avgChange;
        return sum + (isFinite(diff) ? Math.pow(diff, 2) : 0);
      }, 0) / priceChanges.length : 0;
      const volatility = isFinite(variance) && variance >= 0 ? Math.min(Math.sqrt(variance), 200) : 0;
      const invalidReason = [];
      const hasEmptyData = profile.data.length === 1 && profile.data[0].earningsPerShare === 0 && profile.data[0].cashFlowPerShare === 0 && profile.data[0].bookValuePerShare === 0 && (profile.assumptions.currentPrice === 100 || profile.assumptions.currentPrice === 0) && profile.assumptions.currentDividend === 0;
      if (hasEmptyData) {
        invalidReason.push(`‚ö†Ô∏è DONN√âES NON SYNCHRONIS√âES - Cliquez sur "Synchroniser" dans l'onglet Analysis pour charger les donn√©es r√©elles`);
      } else {
        if (currentPrice <= 0 || !isFinite(currentPrice)) {
          invalidReason.push("Prix actuel invalide ou manquant");
        }
        if (baseEPS === 0 && baseYearData) {
          invalidReason.push("EPS de base = 0 (donn√©es historiques manquantes ou nulles)");
        }
        if (validTargets.length === 0) {
          const excludedMetrics = [];
          if (profile.assumptions.excludeEPS) excludedMetrics.push("EPS");
          if (profile.assumptions.excludeCF) excludedMetrics.push("CF");
          if (profile.assumptions.excludeBV) excludedMetrics.push("BV");
          if (profile.assumptions.excludeDIV) excludedMetrics.push("DIV");
          const excludedText = excludedMetrics.length > 0 ? ` (${excludedMetrics.join(", ")} exclus)` : "";
          invalidReason.push(`Aucun ratio cible valide${excludedText} - V√©rifiez les ratios cibles (P/E, P/CF, P/BV, Yield) et les donn√©es historiques`);
        }
        if (jpegy === null) {
          const growthRate = profile.assumptions.growthRateEPS != null && isFinite(profile.assumptions.growthRateEPS) ? profile.assumptions.growthRateEPS.toFixed(2) : "0.00";
          const yieldValue = baseYield != null && isFinite(baseYield) ? baseYield.toFixed(2) : "0.00";
          invalidReason.push(`JPEGY non calculable: Croissance EPS (${growthRate}%) + Yield (${yieldValue}%) trop faible (‚â§0.01%) ou EPS invalide - Ajustez la croissance, le dividende ou synchronisez les donn√©es`);
        }
        if (totalReturnPercent <= -99.9) {
          invalidReason.push("Rendement impossible √† calculer - V√©rifiez le prix actuel et les ratios cibles");
        }
      }
      const hasInvalidData = invalidReason.length > 0;
      return {
        profile,
        recommendation,
        jpegy,
        totalReturnPercent,
        ratio31,
        downsideRisk,
        upsidePotential,
        hasApprovedVersion,
        targetPrice,
        currentPE,
        currentPCF,
        currentPBV,
        currentYield,
        historicalGrowth,
        volatility,
        hasInvalidData,
        // Nouveau flag pour indiquer donn√©es invalides
        invalidReason: hasInvalidData ? invalidReason.join("; ") : void 0,
        // Raison de l'invalidit√© pour debug
        isNotSynchronized: hasEmptyData
        // Flag sp√©cial pour profils non synchronis√©s
      };
    });
  }, [profiles, approvedVersions]);
  const approvedVersionsCacheRef = React.useRef(null);
  const APPROVED_VERSIONS_CACHE_TTL = 3e5;
  reactExports.useEffect(() => {
    const loadApprovedVersions = async () => {
      const now = Date.now();
      const currentProfileIds = profiles.map((p) => p.id).sort().join(",");
      if (approvedVersionsCacheRef.current && approvedVersionsCacheRef.current.profileIds === currentProfileIds && now - approvedVersionsCacheRef.current.timestamp < APPROVED_VERSIONS_CACHE_TTL) {
        setApprovedVersions(approvedVersionsCacheRef.current.approvedSet);
        setIsLoadingApprovedVersions(false);
        return;
      }
      setIsLoadingApprovedVersions(true);
      const approvedSet = /* @__PURE__ */ new Set();
      const batchSize = 5;
      let batchCount = 0;
      for (let i = 0; i < profiles.length; i += batchSize) {
        const batch = profiles.slice(i, i + batchSize);
        batchCount++;
        await Promise.all(
          batch.map(async (profile) => {
            try {
              if (!profile.id) return;
              const result = await listSnapshots(profile.id, 50);
              if (result.success && result.snapshots) {
                const hasApproved = result.snapshots.some(
                  (snapshot) => snapshot.is_approved === true
                );
                if (hasApproved) {
                  approvedSet.add(profile.id);
                }
              }
            } catch (error) {
            }
          })
        );
        if (i + batchSize < profiles.length) {
          const delay = batchCount % 10 === 0 ? 2e3 : 500;
          await new Promise((resolve) => setTimeout(resolve, delay));
        }
      }
      approvedVersionsCacheRef.current = {
        profileIds: currentProfileIds,
        approvedSet: new Set(approvedSet),
        timestamp: now
      };
      setApprovedVersions(approvedSet);
      setIsLoadingApprovedVersions(false);
    };
    if (profiles.length > 0) {
      loadApprovedVersions();
    } else {
      setIsLoadingApprovedVersions(false);
      setApprovedVersions(/* @__PURE__ */ new Set());
    }
  }, [profiles]);
  reactExports.useEffect(() => {
    const svg = svgJPEGYRef.current;
    if (!svg) return;
    const handleWheel = (e) => {
      e.preventDefault();
      const rect = svg.getBoundingClientRect();
      const mouseX = e.clientX - rect.left;
      const mouseY = e.clientY - rect.top;
      const delta = e.deltaY > 0 ? 0.9 : 1.1;
      setZoomJPEGY((prevZoom) => {
        const newZoom = Math.max(0.5, Math.min(prevZoom * delta, 5));
        const zoomFactor = newZoom / prevZoom;
        setPanJPEGY((prev) => ({
          x: mouseX - (mouseX - prev.x) * zoomFactor,
          y: mouseY - (mouseY - prev.y) * zoomFactor
        }));
        return newZoom;
      });
    };
    svg.addEventListener("wheel", handleWheel, { passive: false });
    return () => {
      svg.removeEventListener("wheel", handleWheel);
    };
  }, []);
  reactExports.useEffect(() => {
    const svg = svgRatio31Ref.current;
    if (!svg) return;
    const handleWheel = (e) => {
      e.preventDefault();
      const rect = svg.getBoundingClientRect();
      const mouseX = e.clientX - rect.left;
      const mouseY = e.clientY - rect.top;
      const delta = e.deltaY > 0 ? 0.9 : 1.1;
      setZoomRatio31((prevZoom) => {
        const newZoom = Math.max(0.5, Math.min(prevZoom * delta, 5));
        const zoomFactor = newZoom / prevZoom;
        setPanRatio31((prev) => ({
          x: mouseX - (mouseX - prev.x) * zoomFactor,
          y: mouseY - (mouseY - prev.y) * zoomFactor
        }));
        return newZoom;
      });
    };
    svg.addEventListener("wheel", handleWheel, { passive: false });
    return () => {
      svg.removeEventListener("wheel", handleWheel);
    };
  }, []);
  const defaultFilterValues = reactExports.useMemo(() => {
    if (profileMetrics.length === 0) {
      return {
        minReturn: -100,
        maxReturn: 500,
        minJPEGY: 0,
        maxJPEGY: 10,
        sector: "",
        recommendation: "all",
        source: "all"
      };
    }
    const returns = profileMetrics.map((m) => m.totalReturnPercent);
    const jpegyValues = profileMetrics.map((m) => m.jpegy).filter((j) => j !== null);
    return {
      minReturn: Math.floor(Math.min(...returns, -100)) - 10,
      // Marge de s√©curit√©
      maxReturn: Math.ceil(Math.max(...returns, 500)) + 10,
      // Marge de s√©curit√©
      minJPEGY: jpegyValues.length > 0 ? Math.max(0, Math.floor(Math.min(...jpegyValues, 0))) : 0,
      maxJPEGY: jpegyValues.length > 0 ? Math.ceil(Math.max(...jpegyValues, 10)) + 2 : 10,
      // Marge de s√©curit√©
      sector: "",
      recommendation: "all",
      source: "all"
    };
  }, [profileMetrics]);
  const [filters, setFilters] = reactExports.useState(() => ({
    minReturn: -100,
    maxReturn: 500,
    minJPEGY: 0,
    maxJPEGY: 10,
    minRatio31: 0,
    maxRatio31: 100,
    minPE: 0,
    maxPE: 1e3,
    minYield: 0,
    maxYield: 50,
    minVolatility: 0,
    maxVolatility: 200,
    minGrowth: -50,
    maxGrowth: 100,
    sector: "",
    recommendation: "all",
    source: "all",
    showOnlyNA: false,
    showOnlyApproved: false,
    showOnlySkeleton: false,
    groupBy: "none"
  }));
  const [displayOptions, setDisplayOptions] = reactExports.useState({
    visibleColumns: {
      ticker: true,
      jpegy: true,
      return: true,
      ratio31: true,
      upside: true,
      downside: true,
      pe: true,
      yield: true,
      growth: true,
      volatility: true,
      approved: true,
      recommendation: true
    },
    compactMode: false,
    showSector: true,
    showNames: true,
    density: "comfortable"
  });
  reactExports.useEffect(() => {
    setFilters((prev) => ({
      ...prev,
      ...defaultFilterValues
    }));
  }, [defaultFilterValues]);
  const filteredMetrics = reactExports.useMemo(() => {
    const filtered = profileMetrics.filter((metric) => {
      if (filters.showOnlyNA && !metric.hasInvalidData && metric.jpegy !== null) {
        return false;
      }
      if (filters.showOnlySkeleton && !metric.profile._isSkeleton) {
        return false;
      }
      if (filters.showOnlyApproved && !metric.hasApprovedVersion) {
        return false;
      }
      if (metric.totalReturnPercent < filters.minReturn || metric.totalReturnPercent > filters.maxReturn) return false;
      if (metric.jpegy !== null && (metric.jpegy < filters.minJPEGY || metric.jpegy > filters.maxJPEGY)) return false;
      if (metric.ratio31 !== null && (metric.ratio31 < filters.minRatio31 || metric.ratio31 > filters.maxRatio31)) return false;
      if (metric.currentPE !== null && (metric.currentPE < filters.minPE || metric.currentPE > filters.maxPE)) return false;
      if (metric.currentYield !== null && (metric.currentYield < filters.minYield || metric.currentYield > filters.maxYield)) return false;
      if (metric.volatility !== null && (metric.volatility < filters.minVolatility || metric.volatility > filters.maxVolatility)) return false;
      if (metric.historicalGrowth !== null && (metric.historicalGrowth < filters.minGrowth || metric.historicalGrowth > filters.maxGrowth)) return false;
      if (filters.sector && metric.profile.info.sector.toLowerCase() !== filters.sector.toLowerCase()) return false;
      if (filters.recommendation !== "all") {
        const filterMap = {
          "BUY": "ACHAT",
          "HOLD": "CONSERVER",
          "SELL": "VENTE",
          "ACHAT": "ACHAT",
          "CONSERVER": "CONSERVER",
          "VENTE": "VENTE"
        };
        const expectedValue = filterMap[filters.recommendation] || filters.recommendation;
        if (metric.recommendation !== expectedValue) return false;
      }
      if (filters.source !== "all") {
        const isWatchlist = metric.profile.isWatchlist ?? false;
        if (filters.source === "watchlist" && !isWatchlist) return false;
        if (filters.source === "portfolio" && isWatchlist) return false;
      }
      return true;
    });
    let grouped = filtered;
    if (filters.groupBy !== "none") {
      const groups = /* @__PURE__ */ new Map();
      filtered.forEach((metric) => {
        let key = "";
        switch (filters.groupBy) {
          case "sector":
            key = metric.profile.info.sector || "Autre";
            break;
          case "recommendation":
            key = metric.recommendation || "N/A";
            break;
          case "source":
            key = metric.profile.isWatchlist ?? false ? "Watchlist" : "Portefeuille";
            break;
        }
        if (!groups.has(key)) {
          groups.set(key, []);
        }
        groups.get(key).push(metric);
      });
      grouped = Array.from(groups.values()).flat();
    }
    const sorted = [...grouped].sort((a, b) => {
      let aValue = a[sortConfig.key];
      let bValue = b[sortConfig.key];
      if (sortConfig.key === "ticker") {
        aValue = a.profile.id;
        bValue = b.profile.id;
      } else if (sortConfig.key === "sector") {
        aValue = a.profile.info.sector;
        bValue = b.profile.info.sector;
      } else if (sortConfig.key === "name") {
        aValue = a.profile.info.name || a.profile.id;
        bValue = b.profile.info.name || b.profile.id;
      } else if (sortConfig.key === "ratio31") {
        aValue = a.ratio31 ?? 0;
        bValue = b.ratio31 ?? 0;
      } else if (sortConfig.key === "upsidePotential") {
        aValue = a.upsidePotential;
        bValue = b.upsidePotential;
      } else if (sortConfig.key === "downsideRisk") {
        aValue = a.downsideRisk;
        bValue = b.downsideRisk;
      } else if (sortConfig.key === "currentPE") {
        aValue = a.currentPE ?? 0;
        bValue = b.currentPE ?? 0;
      } else if (sortConfig.key === "currentYield") {
        aValue = a.currentYield ?? 0;
        bValue = b.currentYield ?? 0;
      } else if (sortConfig.key === "volatility") {
        aValue = a.volatility ?? 0;
        bValue = b.volatility ?? 0;
      } else if (sortConfig.key === "targetPrice") {
        aValue = a.targetPrice ?? 0;
        bValue = b.targetPrice ?? 0;
      }
      if (aValue === null || aValue === void 0) aValue = -Infinity;
      if (bValue === null || bValue === void 0) bValue = -Infinity;
      if (typeof aValue === "string" && typeof bValue === "string") {
        return sortConfig.direction === "asc" ? aValue.localeCompare(bValue) : bValue.localeCompare(aValue);
      }
      if (aValue < bValue) return sortConfig.direction === "asc" ? -1 : 1;
      if (aValue > bValue) return sortConfig.direction === "asc" ? 1 : -1;
      return 0;
    });
    return sorted;
  }, [profileMetrics, filters, sortConfig]);
  const handleSort = reactExports.useCallback((key) => {
    setSortConfig((prev) => ({
      key,
      direction: prev.key === key && prev.direction === "desc" ? "asc" : "desc"
    }));
  }, []);
  const handleExport = reactExports.useCallback(() => {
    const csv = [
      ["Ticker", "Nom", "Secteur", "JPEGY", "Rendement Total", "Ratio 3:1", "Potentiel Hausse", "Risque Baisse", "P/E", "Yield", "Croissance", "Recommandation", "Prix Actuel", "Prix Cible", "Prix Achat", "Prix Vente", "P/CF", "P/BV", "Volatilit√©"].join(","),
      ...filteredMetrics.map((m) => [
        m.profile.id,
        `"${m.profile.info.name}"`,
        m.profile.info.sector,
        m.jpegy !== null ? m.jpegy.toFixed(2) : "N/A",
        m.totalReturnPercent !== null && m.totalReturnPercent !== void 0 ? m.totalReturnPercent.toFixed(2) : "N/A",
        m.ratio31 !== null && m.ratio31 !== void 0 ? m.ratio31.toFixed(2) : "N/A",
        m.upsidePotential !== null && m.upsidePotential !== void 0 ? m.upsidePotential.toFixed(2) : "N/A",
        m.downsideRisk !== null && m.downsideRisk !== void 0 ? m.downsideRisk.toFixed(2) : "N/A",
        m.currentPE !== null && m.currentPE !== void 0 ? m.currentPE.toFixed(1) : "N/A",
        m.currentYield !== null && m.currentYield !== void 0 ? m.currentYield.toFixed(2) : "N/A",
        m.historicalGrowth !== null && m.historicalGrowth !== void 0 ? m.historicalGrowth.toFixed(2) : "N/A",
        m.recommendation,
        m.profile.assumptions.currentPrice !== null && m.profile.assumptions.currentPrice !== void 0 ? m.profile.assumptions.currentPrice.toFixed(2) : "N/A",
        m.targetPrice !== null && m.targetPrice !== void 0 ? m.targetPrice.toFixed(2) : "N/A",
        m.profile.assumptions.currentPrice !== null && m.profile.assumptions.currentPrice !== void 0 ? (m.profile.assumptions.currentPrice * 0.9).toFixed(2) : "N/A",
        m.profile.assumptions.currentPrice !== null && m.profile.assumptions.currentPrice !== void 0 ? (m.profile.assumptions.currentPrice * 1.1).toFixed(2) : "N/A",
        m.currentPCF !== null && m.currentPCF !== void 0 ? m.currentPCF.toFixed(1) : "N/A",
        m.currentPBV !== null && m.currentPBV !== void 0 ? m.currentPBV.toFixed(2) : "N/A",
        m.volatility !== null && m.volatility !== void 0 ? m.volatility.toFixed(2) : "N/A"
      ].join(","))
    ].join("\n");
    const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = `kpi-dashboard-${(/* @__PURE__ */ new Date()).toISOString().split("T")[0]}.csv`;
    link.click();
  }, [filteredMetrics]);
  useKeyboardShortcuts({
    onSyncAll: onBulkSync,
    onSyncNA: () => {
      if (filters.showOnlyNA && onSyncNA && filteredMetrics.length > 0) {
        const naTickers = filteredMetrics.map((m) => m.profile.id);
        onSyncNA(naTickers);
      }
    },
    onToggleNAFilter: () => {
      setFilters((prev) => ({ ...prev, showOnlyNA: !prev.showOnlyNA }));
    },
    onExport: handleExport,
    onOpenSyncDialog: () => setShowSyncDialog(true),
    enabled: true
  });
  const getJpegyColor2 = (jpegy) => {
    if (jpegy === null) return null;
    if (jpegy <= 0.5) return "#86efac";
    if (jpegy <= 1.5) return "#16a34a";
    if (jpegy <= 1.75) return "#eab308";
    if (jpegy <= 2) return "#f97316";
    return "#dc2626";
  };
  const getRatio31Color2 = (ratio) => {
    if (ratio === null || !isFinite(ratio) || ratio < 0) return null;
    if (ratio >= 3) return "#16a34a";
    if (ratio >= 1) return "#eab308";
    return "#dc2626";
  };
  const getReturnTextClass = (returnPercent) => {
    if (returnPercent === null || returnPercent === void 0) return "text-gray-400";
    if (returnPercent >= 50) return "text-green-600";
    if (returnPercent >= 20) return "text-green-300";
    if (returnPercent >= 0) return "text-yellow-600";
    return "text-red-600";
  };
  const getReturnBgClass = (returnPercent) => {
    if (returnPercent === null || returnPercent === void 0) return "bg-gray-100";
    if (returnPercent >= 50) return "bg-green-600";
    if (returnPercent >= 20) return "bg-green-300";
    if (returnPercent >= 0) return "bg-yellow-400";
    return "bg-red-600";
  };
  const getJpegyTextClass = (jpegy) => {
    if (jpegy === null) return "text-gray-400";
    if (jpegy <= 0.5) return "text-green-300";
    if (jpegy <= 1.5) return "text-green-600";
    if (jpegy <= 1.75) return "text-yellow-600";
    if (jpegy <= 2) return "text-orange-500";
    return "text-red-600";
  };
  const getJpegyBgClass = (jpegy) => {
    if (jpegy === null) return "bg-gray-400";
    if (jpegy <= 0.5) return "bg-green-300";
    if (jpegy <= 1.5) return "bg-green-600";
    if (jpegy <= 1.75) return "bg-yellow-500";
    if (jpegy <= 2) return "bg-orange-500";
    return "bg-red-600";
  };
  const getRatioFillClass = (ratio) => {
    if (ratio === null || !isFinite(ratio) || ratio < 0) return "fill-gray-400";
    if (ratio >= 3) return "fill-green-600";
    if (ratio >= 1) return "fill-yellow-500";
    return "fill-red-600";
  };
  if (profiles.length === 0) {
    return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white p-8 rounded-lg shadow border border-gray-200 text-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("h3", { className: "text-xl font-bold text-gray-700 mb-4", children: "Vue KPI Dashboard" }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-gray-500 mb-4", children: "Aucun profil disponible pour afficher les KPI." }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-sm text-gray-400", children: "Ajoutez des tickers dans la sidebar de gauche pour voir les m√©triques." })
    ] });
  }
  const chartWidth = 900;
  const chartHeight = 700;
  const padding = 80;
  const validMetricsForChart = filteredMetrics.filter(
    (m) => !m.hasInvalidData && m.totalReturnPercent >= -100 && m.totalReturnPercent <= 1e3 && m.jpegy !== null && m.jpegy >= 0 && m.jpegy <= 100 && isFinite(m.totalReturnPercent) && isFinite(m.jpegy)
  );
  const maxJPEGY = validMetricsForChart.length > 0 ? Math.max(...validMetricsForChart.map((m) => m.jpegy).filter((j) => j !== null && j !== void 0 && isFinite(j)), 5) : 5;
  const minJPEGY = validMetricsForChart.length > 0 ? Math.min(...validMetricsForChart.map((m) => m.jpegy).filter((j) => j !== null && j !== void 0 && isFinite(j)), 0) : 0;
  const maxReturn = validMetricsForChart.length > 0 ? Math.max(...validMetricsForChart.map((m) => m.totalReturnPercent).filter((r) => r !== null && r !== void 0 && isFinite(r)), 200) : 200;
  const minReturn = validMetricsForChart.length > 0 ? Math.min(...validMetricsForChart.map((m) => m.totalReturnPercent).filter((r) => r !== null && r !== void 0 && isFinite(r)), -50) : -50;
  const xScale = (jpegy) => {
    const range = maxJPEGY - minJPEGY || 1;
    return padding + (jpegy - minJPEGY) / range * (chartWidth - 2 * padding);
  };
  const yScale = (returnPercent) => {
    const range = maxReturn - minReturn || 1;
    return chartHeight - padding - (returnPercent - minReturn) / range * (chartHeight - 2 * padding);
  };
  const xTicks = [];
  const xTickCount = 10;
  for (let i = 0; i <= xTickCount; i++) {
    const value = minJPEGY + (maxJPEGY - minJPEGY) * (i / xTickCount);
    xTicks.push({ value, position: xScale(value) });
  }
  const yTicks = [];
  const yTickCount = 10;
  for (let i = 0; i <= yTickCount; i++) {
    const value = minReturn + (maxReturn - minReturn) * (i / yTickCount);
    yTicks.push({ value, position: yScale(value) });
  }
  const globalStats = reactExports.useMemo(() => {
    if (filteredMetrics.length === 0) return null;
    const returns = filteredMetrics.map((m) => m.totalReturnPercent).filter((r) => r !== null && r !== void 0);
    const jpegyValues = filteredMetrics.map((m) => m.jpegy).filter((j) => j !== null && j !== void 0);
    const ratios = filteredMetrics.map((m) => m.ratio31).filter((r) => r !== null && r !== void 0);
    const avg = (arr) => arr.length > 0 ? arr.reduce((a, b) => a + b, 0) / arr.length : 0;
    const median = (arr) => {
      if (arr.length === 0) return 0;
      const sorted = [...arr].sort((a, b) => a - b);
      const mid = Math.floor(sorted.length / 2);
      return sorted.length % 2 === 0 ? (sorted[mid - 1] + sorted[mid]) / 2 : sorted[mid];
    };
    const stdDev = (arr, mean) => {
      if (arr.length === 0) return 0;
      const variance = arr.reduce((sum, val) => sum + Math.pow(val - mean, 2), 0) / arr.length;
      return Math.sqrt(variance);
    };
    const avgReturn = returns.length > 0 ? avg(returns) : 0;
    const medianReturn = returns.length > 0 ? median(returns) : 0;
    const stdReturn = returns.length > 0 ? stdDev(returns, avgReturn) : 0;
    const avgJPEGY = jpegyValues.length > 0 ? avg(jpegyValues) : null;
    const medianJPEGY = jpegyValues.length > 0 ? median(jpegyValues) : null;
    const avgRatio = ratios.length > 0 ? avg(ratios) : 0;
    const medianRatio = ratios.length > 0 ? median(ratios) : 0;
    return {
      avgReturn,
      medianReturn,
      stdReturn,
      minReturn: returns.length > 0 ? Math.min(...returns) : 0,
      maxReturn: returns.length > 0 ? Math.max(...returns) : 0,
      avgJPEGY,
      medianJPEGY,
      avgRatio,
      medianRatio,
      count: filteredMetrics.length
    };
  }, [filteredMetrics]);
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "space-y-6", children: [
    globalStats && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-gradient-to-r from-blue-50 to-indigo-50 p-3 sm:p-4 md:p-6 rounded-lg shadow-lg border border-blue-200", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between mb-4", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("h3", { className: "text-base sm:text-lg md:text-xl font-bold text-gray-800", children: "üìä Statistiques Globales du Portefeuille" }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          "button",
          {
            onClick: () => toggleSection("globalStats"),
            className: "p-1.5 hover:bg-blue-100 rounded transition-colors cursor-help",
            title: sectionsVisibility.globalStats ? "R√©duire cette section" : "Agrandir cette section",
            children: sectionsVisibility.globalStats ? /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$f, { className: "w-5 h-5 text-gray-600" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$g, { className: "w-5 h-5 text-gray-600" })
          }
        )
      ] }),
      sectionsVisibility.globalStats && globalStats && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-2 sm:gap-3 md:gap-4", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white p-2 sm:p-3 md:p-4 rounded-lg shadow border border-gray-200", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-500 mb-1", children: "Rendement Moyen" }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-lg sm:text-xl md:text-2xl font-bold text-blue-600", children: [
            globalStats.avgReturn !== null && globalStats.avgReturn !== void 0 ? globalStats.avgReturn.toFixed(1) : "N/A",
            "%"
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-xs text-gray-400 mt-1", children: [
            "M√©diane: ",
            globalStats.medianReturn !== null && globalStats.medianReturn !== void 0 ? globalStats.medianReturn.toFixed(1) : "N/A",
            "%"
          ] })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white p-4 rounded-lg shadow border border-gray-200", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-500 mb-1", children: "√âcart-Type" }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-2xl font-bold text-purple-600", children: [
            globalStats.stdReturn !== null && globalStats.stdReturn !== void 0 ? globalStats.stdReturn.toFixed(1) : "N/A",
            "%"
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-400 mt-1", children: "Volatilit√©" })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white p-4 rounded-lg shadow border border-gray-200", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-500 mb-1", children: "Rendement Min" }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-2xl font-bold text-red-600", children: [
            globalStats.minReturn !== null && globalStats.minReturn !== void 0 ? globalStats.minReturn.toFixed(1) : "N/A",
            "%"
          ] })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white p-4 rounded-lg shadow border border-gray-200", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-500 mb-1", children: "Rendement Max" }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-2xl font-bold text-green-600", children: [
            globalStats.maxReturn !== null && globalStats.maxReturn !== void 0 ? globalStats.maxReturn.toFixed(1) : "N/A",
            "%"
          ] })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white p-4 rounded-lg shadow border border-gray-200", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-500 mb-1", children: "JPEGY Moyen" }),
          globalStats.avgJPEGY != null && isFinite(globalStats.avgJPEGY) ? /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: `text-2xl font-bold ${getJpegyTextClass(globalStats.avgJPEGY)}`, children: globalStats.avgJPEGY.toFixed(2) }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-xs text-gray-400 mt-1", children: [
              "M√©diane: ",
              globalStats.medianJPEGY != null && isFinite(globalStats.medianJPEGY) ? globalStats.medianJPEGY.toFixed(2) : "N/A"
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "mt-2 pt-2 border-t border-gray-200", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-[10px] text-gray-400 space-y-0.5", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Source:" }),
                " P/E Actuel √∑ (Croissance EPS % + Yield %)"
              ] }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Fournisseur:" }),
                " M√©trique propri√©taire JSLAI‚Ñ¢ d√©velopp√©e par Jean-S√©bastien. Ajuste le P/E par la somme du taux de croissance et du rendement du dividende pour une √©valuation nuanc√©e de la valorisation."
              ] })
            ] }) })
          ] }) : /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-2xl font-bold text-gray-400 flex items-center gap-2", children: [
              "N/A ",
              /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$a, { className: "w-5 h-5 text-orange-500", title: "JPEGY non calculable pour tous les titres" })
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-400 mt-1", children: "Aucun JPEGY calculable" })
          ] })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white p-4 rounded-lg shadow border border-gray-200", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-500 mb-1", children: "Ratio 3:1 Moyen" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: `text-2xl font-bold ${globalStats.avgRatio != null && globalStats.avgRatio >= 3 ? "text-green-600" : globalStats.avgRatio != null && globalStats.avgRatio >= 1 ? "text-yellow-600" : "text-red-600"}`, children: globalStats.avgRatio != null && isFinite(globalStats.avgRatio) ? globalStats.avgRatio.toFixed(2) : "N/A" })
        ] })
      ] })
    ] }),
    comparisonMode && selectedForComparison.length > 0 && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-gradient-to-r from-purple-50 to-pink-50 p-3 sm:p-4 md:p-6 rounded-lg shadow-lg border-2 border-purple-300", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between mb-4", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs("h3", { className: "text-base sm:text-lg md:text-xl font-bold text-gray-800 flex items-center gap-2", children: [
          "üîç Mode Comparaison (",
          selectedForComparison.length,
          " titre(s))"
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx(
            "button",
            {
              onClick: () => toggleSection("comparison"),
              className: "p-1.5 hover:bg-purple-100 rounded transition-colors cursor-help",
              title: sectionsVisibility.comparison ? "R√©duire cette section" : "Agrandir cette section",
              children: sectionsVisibility.comparison ? /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$f, { className: "w-5 h-5 text-gray-600" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$g, { className: "w-5 h-5 text-gray-600" })
            }
          ),
          /* @__PURE__ */ jsxRuntimeExports.jsx(
            "button",
            {
              onClick: () => {
                setComparisonMode(false);
                setSelectedForComparison([]);
              },
              className: "px-3 sm:px-4 py-1.5 sm:py-2 bg-red-500 text-white text-xs sm:text-sm font-semibold rounded-lg hover:bg-red-600 transition-colors",
              title: "Fermer le mode comparaison",
              children: "Fermer"
            }
          )
        ] })
      ] }),
      sectionsVisibility.comparison && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4", children: selectedForComparison.map((ticker) => {
        var _a2, _b2;
        const metric = filteredMetrics.find((m) => m.profile.id === ticker);
        if (!metric) return null;
        return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white p-4 rounded-lg shadow border border-gray-200", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between mb-3", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("h4", { className: "font-bold text-lg", children: metric.profile.id }),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                onClick: () => setSelectedForComparison((prev) => prev.filter((t) => t !== ticker)),
                className: "text-red-500 hover:text-red-700 text-sm",
                children: "‚úï"
              }
            )
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "space-y-2 text-sm", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-gray-600", children: "Rendement:" }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "font-bold text-green-600", children: [
                metric.totalReturnPercent != null && isFinite(metric.totalReturnPercent) ? metric.totalReturnPercent.toFixed(1) : "N/A",
                "%"
              ] })
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex justify-between items-start", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-gray-600", children: "JPEGY:" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-right", children: metric.jpegy !== null ? /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: `font-bold ${getJpegyTextClass(metric.jpegy)}`, children: metric.jpegy.toFixed(2) }),
                /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "mt-1 pt-1 border-t border-gray-200", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-[9px] text-gray-400 space-y-0.5 text-left", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
                    /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Source:" }),
                    " P/E √∑ (Growth % + Yield %)"
                  ] }),
                  /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
                    /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Fournisseur:" }),
                    " JSLAI‚Ñ¢ - M√©trique propri√©taire ajustant le P/E par croissance et dividende."
                  ] })
                ] }) })
              ] }) : /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "font-bold text-gray-400 flex items-center gap-1", children: [
                "N/A ",
                /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$a, { className: "w-4 h-4 text-orange-500", title: "JPEGY non calculable" })
              ] }) })
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-gray-600", children: "Ratio 3:1:" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: `font-bold ${metric.ratio31 != null && metric.ratio31 >= 3 ? "text-green-600" : metric.ratio31 != null && metric.ratio31 >= 1 ? "text-yellow-600" : "text-red-600"}`, children: metric.ratio31 != null && isFinite(metric.ratio31) ? metric.ratio31.toFixed(2) : "N/A" })
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-gray-600", children: "P/E:" }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "font-bold", children: [
                ((_a2 = metric.currentPE) == null ? void 0 : _a2.toFixed(1)) || "N/A",
                "x"
              ] })
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-gray-600", children: "Yield:" }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "font-bold", children: [
                ((_b2 = metric.currentYield) == null ? void 0 : _b2.toFixed(2)) || "N/A",
                "%"
              ] })
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-gray-600", children: "Signal:" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: `font-bold ${metric.recommendation === "ACHAT" ? "text-green-600" : metric.recommendation === "VENTE" ? "text-red-600" : "text-yellow-600"}`, children: metric.recommendation })
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                onClick: () => onSelect(ticker),
                className: "w-full mt-3 px-3 py-2 bg-blue-500 text-white text-xs font-semibold rounded hover:bg-blue-600 transition-colors",
                children: "Voir d√©tails ‚Üí"
              }
            )
          ] })
        ] }, ticker);
      }) })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: `bg-white p-3 sm:p-4 md:p-6 rounded-lg shadow-lg border-2 transition-all ${filters.minReturn !== -100 || filters.maxReturn !== 500 || filters.minJPEGY !== 0 || filters.maxJPEGY !== 5 || filters.sector !== "" || filters.recommendation !== "all" ? "border-blue-400 bg-blue-50" : "border-gray-200"}`, children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-3 mb-3 sm:mb-4", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2 sm:gap-3", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("h3", { className: "text-base sm:text-lg font-bold", children: "üîç Filtres de Screening" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx(
            "button",
            {
              onClick: () => toggleSection("filters"),
              className: "p-1.5 hover:bg-gray-100 rounded transition-colors cursor-help",
              title: sectionsVisibility.filters ? "R√©duire cette section" : "Agrandir cette section",
              children: sectionsVisibility.filters ? /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$f, { className: "w-5 h-5 text-gray-600" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$g, { className: "w-5 h-5 text-gray-600" })
            }
          ),
          (filters.minReturn !== -100 || filters.maxReturn !== 500 || filters.minJPEGY !== 0 || filters.maxJPEGY !== 5 || filters.sector !== "" || filters.recommendation !== "all") && /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "px-3 py-1 bg-blue-500 text-white text-xs font-bold rounded-full flex items-center gap-1", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "w-2 h-2 bg-white rounded-full animate-pulse" }),
            "Filtres actifs"
          ] })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex flex-wrap gap-1.5 sm:gap-2 w-full sm:w-auto", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx(
            "button",
            {
              onClick: () => setComparisonMode(!comparisonMode),
              className: `px-2 sm:px-3 py-1 text-[10px] sm:text-xs rounded transition-colors ${comparisonMode ? "bg-purple-500 text-white" : "bg-purple-100 hover:bg-purple-200 text-purple-700"}`,
              title: comparisonMode ? "D√©sactiver le Mode Comparaison\n\nCliquez pour d√©sactiver le mode comparaison.\n\nEn mode comparaison, vous pouvez s√©lectionner jusqu'√† 5 tickers pour les comparer c√¥te √† c√¥te." : "Activer le Mode Comparaison\n\nCliquez pour activer le mode comparaison.\n\nEn mode comparaison:\n‚Ä¢ S√©lectionnez jusqu'√† 5 tickers (cliquez sur les tuiles)\n‚Ä¢ Les tickers s√©lectionn√©s sont marqu√©s avec un num√©ro\n‚Ä¢ Comparez leurs m√©triques c√¥te √† c√¥te\n\nUtile pour comparer plusieurs opportunit√©s d'investissement.",
              children: comparisonMode ? "‚úï Mode Comparaison" : "üîç Mode Comparaison"
            }
          ),
          /* @__PURE__ */ jsxRuntimeExports.jsx(
            "button",
            {
              onClick: () => setFilters({
                ...defaultFilterValues,
                minRatio31: 0,
                maxRatio31: 100,
                minPE: 0,
                maxPE: 1e3,
                minYield: 0,
                maxYield: 50,
                minVolatility: 0,
                maxVolatility: 200,
                minGrowth: -50,
                maxGrowth: 100,
                showOnlyNA: false,
                showOnlyApproved: false,
                showOnlySkeleton: false,
                groupBy: "none"
              }),
              className: "px-2 sm:px-3 py-1 text-[10px] sm:text-xs bg-gray-100 hover:bg-gray-200 rounded transition-colors",
              title: "R√©initialiser tous les filtres\\n\\nR√©initialise tous les filtres actifs:\\n‚Ä¢ Rendement\\n‚Ä¢ JPEGY\\n‚Ä¢ Ratio 3:1\\n‚Ä¢ Recommandation\\n‚Ä¢ Secteur\\n‚Ä¢ Source\\n\\nAffiche tous les titres du portefeuille.",
              children: "üîÑ R√©initialiser"
            }
          ),
          /* @__PURE__ */ jsxRuntimeExports.jsx(
            "button",
            {
              onClick: () => {
                const top10 = [...filteredMetrics].sort((a, b) => b.totalReturnPercent - a.totalReturnPercent).slice(0, 10);
                const minReturn2 = Math.min(...top10.map((m) => m.totalReturnPercent));
                const maxReturn2 = Math.max(...top10.map((m) => m.totalReturnPercent));
                setFilters((prev) => ({ ...prev, minReturn: minReturn2 - 5, maxReturn: maxReturn2 + 5 }));
              },
              className: "px-2 sm:px-3 py-1 text-[10px] sm:text-xs bg-gray-100 hover:bg-blue-100 hover:text-blue-600 text-gray-700 rounded transition-colors",
              title: "Zoom Top 10\\n\\nFiltre automatiquement pour afficher uniquement les 10 tickers avec le meilleur rendement total projet√©.\\n\\nAjuste les filtres Min/Max de rendement pour encadrer ces 10 tickers.",
              children: "Top 10"
            }
          ),
          /* @__PURE__ */ jsxRuntimeExports.jsx(
            "button",
            {
              onClick: () => {
                const undervalued = filteredMetrics.filter((m) => m.jpegy !== null && m.jpegy <= 1.5);
                if (undervalued.length > 0) {
                  const validJPEGYs = undervalued.map((m) => m.jpegy).filter((j) => j !== null);
                  Math.min(...validJPEGYs);
                  const maxJPEGY2 = Math.max(...validJPEGYs);
                  setFilters((prev) => ({ ...prev, minJPEGY: 0, maxJPEGY: maxJPEGY2 + 0.5 }));
                }
              },
              className: "px-2 sm:px-3 py-1 text-[10px] sm:text-xs bg-green-100 hover:bg-green-200 rounded transition-colors",
              title: "Sous-√©valu√©s (JPEGY ‚â§ 1.5)\\n\\nFiltre automatiquement pour afficher uniquement les tickers avec un JPEGY ‚â§ 1.5.\\n\\nJPEGY ‚â§ 1.5 indique une action sous-√©valu√©e ou raisonnablement valoris√©e.\\n\\nAjuste automatiquement les filtres JPEGY Min/Max.",
              children: "Sous-√©valu√©s"
            }
          )
        ] })
      ] }),
      sectionsVisibility.filters && /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "mb-4 flex items-center justify-between", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-sm text-gray-600", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "font-bold text-blue-600", children: filteredMetrics.length }),
          " titre(s) affich√©(s) sur",
          " ",
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "font-semibold", children: profileMetrics.length }),
          " total",
          (filters.minReturn !== defaultFilterValues.minReturn || filters.maxReturn !== defaultFilterValues.maxReturn || filters.minJPEGY !== defaultFilterValues.minJPEGY || filters.maxJPEGY !== defaultFilterValues.maxJPEGY || filters.sector !== "" || filters.recommendation !== "all" || filters.source !== "all") && /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "ml-2 text-xs text-blue-600", children: [
            "(",
            profileMetrics.length - filteredMetrics.length,
            " masqu√©(s))"
          ] }),
          isLoadingApprovedVersions && /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "ml-2 text-xs text-gray-400", children: "‚è≥ V√©rification des versions approuv√©es..." })
        ] }) }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 sm:gap-2.5 md:gap-3 lg:gap-4", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("label", { htmlFor: "filter-min-return", className: "block text-[10px] sm:text-xs font-semibold text-gray-600 mb-1 cursor-help", title: "Rendement Total Projet√© Minimum (%)\\n\\nFiltre les tickers avec un rendement total projet√© sup√©rieur ou √©gal √† cette valeur.\\n\\nLe rendement total inclut:\\n‚Ä¢ Appr√©ciation du prix (5 ans)\\n‚Ä¢ Dividendes cumul√©s (5 ans)\\n\\nPlage par d√©faut: -100% √† +1000%", children: "Rendement Min (%)" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "input",
              {
                id: "filter-min-return",
                type: "number",
                value: filters.minReturn,
                onChange: (e) => setFilters({ ...filters, minReturn: parseFloat(e.target.value) || defaultFilterValues.minReturn }),
                className: `w-full px-2 sm:px-2.5 md:px-3 lg:px-4 py-1.5 sm:py-2 border-2 rounded-lg text-xs sm:text-sm transition-all ${filters.minReturn !== defaultFilterValues.minReturn ? "border-blue-400 bg-blue-50 focus:ring-2 focus:ring-blue-500" : "border-gray-300 focus:border-blue-400"}`,
                title: `Filtre: Rendement Min = ${filters.minReturn}%

Affiche uniquement les tickers avec un rendement total projet√© ‚â• ${filters.minReturn}%.

${filters.minReturn !== defaultFilterValues.minReturn ? "‚úÖ Filtre actif" : "Filtre par d√©faut"}`
              }
            )
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("label", { htmlFor: "filter-max-return", className: "block text-[10px] sm:text-xs font-semibold text-gray-600 mb-1 cursor-help", title: "Rendement Total Projet√© Maximum (%)\\n\\nFiltre les tickers avec un rendement total projet√© inf√©rieur ou √©gal √† cette valeur.\\n\\nLe rendement total inclut:\\n‚Ä¢ Appr√©ciation du prix (5 ans)\\n‚Ä¢ Dividendes cumul√©s (5 ans)\\n\\nPlage par d√©faut: -100% √† +1000%", children: "Rendement Max (%)" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "input",
              {
                id: "filter-max-return",
                type: "number",
                value: filters.maxReturn,
                onChange: (e) => setFilters({ ...filters, maxReturn: parseFloat(e.target.value) || defaultFilterValues.maxReturn }),
                className: `w-full px-2 sm:px-2.5 md:px-3 lg:px-4 py-1.5 sm:py-2 border-2 rounded-lg text-xs sm:text-sm transition-all ${filters.maxReturn !== defaultFilterValues.maxReturn ? "border-blue-400 bg-blue-50 focus:ring-2 focus:ring-blue-500" : "border-gray-300 focus:border-blue-400"}`,
                title: `Filtre: Rendement Max = ${filters.maxReturn}%

Affiche uniquement les tickers avec un rendement total projet√© ‚â§ ${filters.maxReturn}%.

${filters.maxReturn !== defaultFilterValues.maxReturn ? "‚úÖ Filtre actif" : "Filtre par d√©faut"}`
              }
            )
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("label", { htmlFor: "filter-min-jpegy", className: "block text-[10px] sm:text-xs font-semibold text-gray-600 mb-1 cursor-help", title: "JPEGY Minimum\\n\\nFiltre les tickers avec un JPEGY sup√©rieur ou √©gal √† cette valeur.\\n\\nJPEGY = P/E √∑ (Croissance % + Yield %)\\n\\nPlage recommand√©e: 0.0 √† 5.0\\n\\nPlus le JPEGY est bas, plus l'action est attractive.", children: "JPEGY Min" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "input",
              {
                id: "filter-min-jpegy",
                type: "number",
                step: "0.1",
                value: filters.minJPEGY,
                onChange: (e) => setFilters({ ...filters, minJPEGY: parseFloat(e.target.value) || defaultFilterValues.minJPEGY }),
                className: `w-full px-2 sm:px-2.5 md:px-3 lg:px-4 py-1.5 sm:py-2 border-2 rounded-lg text-xs sm:text-sm transition-all ${filters.minJPEGY !== defaultFilterValues.minJPEGY ? "border-green-400 bg-green-50 focus:ring-2 focus:ring-green-500" : "border-gray-300 focus:border-green-400"}`,
                title: `Filtre: JPEGY Min = ${filters.minJPEGY}

Affiche uniquement les tickers avec un JPEGY ‚â• ${filters.minJPEGY}.

${filters.minJPEGY !== defaultFilterValues.minJPEGY ? "‚úÖ Filtre actif" : "Filtre par d√©faut"}`
              }
            )
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("label", { htmlFor: "filter-max-jpegy", className: "block text-[10px] sm:text-xs font-semibold text-gray-600 mb-1 cursor-help", title: "JPEGY Maximum\\n\\nFiltre les tickers avec un JPEGY inf√©rieur ou √©gal √† cette valeur.\\n\\nJPEGY = P/E √∑ (Croissance % + Yield %)\\n\\nPlage recommand√©e: 0.0 √† 5.0\\n\\nPlus le JPEGY est bas, plus l'action est attractive.", children: "JPEGY Max" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "input",
              {
                id: "filter-max-jpegy",
                type: "number",
                step: "0.1",
                value: filters.maxJPEGY,
                onChange: (e) => setFilters({ ...filters, maxJPEGY: parseFloat(e.target.value) || defaultFilterValues.maxJPEGY }),
                className: `w-full px-2 sm:px-2.5 md:px-3 lg:px-4 py-1.5 sm:py-2 border-2 rounded-lg text-xs sm:text-sm transition-all ${filters.maxJPEGY !== defaultFilterValues.maxJPEGY ? "border-green-400 bg-green-50 focus:ring-2 focus:ring-green-500" : "border-gray-300 focus:border-green-400"}`,
                title: `Filtre: JPEGY Max = ${filters.maxJPEGY}

Affiche uniquement les tickers avec un JPEGY ‚â§ ${filters.maxJPEGY}.

${filters.maxJPEGY !== defaultFilterValues.maxJPEGY ? "‚úÖ Filtre actif" : "Filtre par d√©faut"}`
              }
            )
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("label", { htmlFor: "filter-sector", className: "block text-[10px] sm:text-xs font-semibold text-gray-600 mb-1 cursor-help", title: "Filtre par Secteur\\n\\nFiltre les tickers par secteur d'activit√©.\\n\\nLaissez vide pour afficher tous les secteurs.\\n\\nLa recherche est insensible √† la casse et cherche dans le nom du secteur.", children: "Secteur" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "input",
              {
                id: "filter-sector",
                type: "text",
                value: filters.sector,
                onChange: (e) => setFilters({ ...filters, sector: e.target.value }),
                placeholder: "Tous",
                className: "w-full px-2 sm:px-2.5 md:px-3 py-1.5 sm:py-2 border border-gray-300 rounded text-xs sm:text-sm",
                title: `Filtre: Secteur = "${filters.sector || "Tous"}"

${filters.sector ? `Affiche uniquement les tickers du secteur contenant "${filters.sector}".` : "Affiche tous les secteurs."}

${filters.sector ? "‚úÖ Filtre actif" : "Filtre par d√©faut"}`
              }
            )
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("label", { htmlFor: "filter-recommendation", className: "block text-[10px] sm:text-xs font-semibold text-gray-600 mb-1 cursor-help", title: "Filtre par Recommandation\\n\\nFiltre les tickers selon la recommandation calcul√©e:\\n\\n‚Ä¢ ACHAT: Prix actuel ‚â§ Limite d'achat\\n‚Ä¢ CONSERVER: Entre limite d'achat et vente\\n‚Ä¢ VENTE: Prix actuel ‚â• Limite de vente\\n\\nS√©lectionnez 'Toutes' pour afficher toutes les recommandations.", children: "Recommandation" }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs(
              "select",
              {
                id: "filter-recommendation",
                value: filters.recommendation,
                onChange: (e) => setFilters({ ...filters, recommendation: e.target.value }),
                className: "w-full px-2 sm:px-2.5 md:px-3 py-1.5 sm:py-2 border border-gray-300 rounded text-xs sm:text-sm",
                title: `Filtre: Recommandation = "${filters.recommendation === "all" ? "Toutes" : filters.recommendation}"

${filters.recommendation !== "all" ? `Affiche uniquement les tickers avec la recommandation "${filters.recommendation}".` : "Affiche toutes les recommandations."}

${filters.recommendation !== "all" ? "‚úÖ Filtre actif" : "Filtre par d√©faut"}`,
                children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "all", children: "Toutes" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "ACHAT", children: "Achat" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "CONSERVER", children: "Conserver" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "VENTE", children: "Vendre" })
                ]
              }
            )
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "relative", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsxs("label", { htmlFor: "filter-source", className: "flex text-[10px] sm:text-xs font-semibold text-gray-700 mb-1.5 sm:mb-2 items-center gap-1.5 sm:gap-2 cursor-help", title: "Filtre par Source\\n\\nFiltre les tickers selon leur source:\\n\\n‚Ä¢ ‚≠ê Portefeuille: Titres d√©tenus actuellement\\n‚Ä¢ üëÅÔ∏è Watchlist: Titres surveill√©s (non d√©tenus)\\n‚Ä¢ Tous: Affiche les deux sources\\n\\nLe badge color√© indique le filtre actif.", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "truncate", children: "Source" }),
              filters.source !== "all" && /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: `px-1.5 sm:px-2 py-0.5 text-[9px] sm:text-[10px] font-bold rounded-full flex items-center gap-0.5 sm:gap-1 flex-shrink-0 ${filters.source === "watchlist" ? "bg-blue-100 text-blue-700" : "bg-yellow-100 text-yellow-700"}`, children: filters.source === "watchlist" ? /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$1, { className: "w-2.5 h-2.5 sm:w-3 sm:h-3" }),
                /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "hidden sm:inline", children: "Watchlist" })
              ] }) : /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef, { className: "w-2.5 h-2.5 sm:w-3 sm:h-3" }),
                /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "hidden sm:inline", children: "Portefeuille" })
              ] }) })
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "relative", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsxs(
                "select",
                {
                  id: "filter-source",
                  value: filters.source,
                  onChange: (e) => setFilters({ ...filters, source: e.target.value }),
                  className: `w-full px-2 sm:px-3 md:px-4 py-1.5 sm:py-2 border-2 rounded-lg text-xs sm:text-sm transition-all appearance-none ${filters.source !== "all" ? filters.source === "watchlist" ? "border-blue-400 bg-blue-50 focus:ring-2 focus:ring-blue-500" : "border-yellow-400 bg-yellow-50 focus:ring-2 focus:ring-yellow-500" : "border-gray-300 focus:border-blue-400"}`,
                  children: [
                    /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "all", children: "Tous (Portefeuille + Watchlist)" }),
                    /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "portfolio", children: "‚≠ê Portefeuille" }),
                    /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "watchlist", children: "üëÅÔ∏è Watchlist" })
                  ]
                }
              ),
              filters.source !== "all" && /* @__PURE__ */ jsxRuntimeExports.jsx(
                "button",
                {
                  onClick: () => setFilters({ ...filters, source: "all" }),
                  className: "absolute right-6 sm:right-8 top-1/2 -translate-y-1/2 text-gray-400 hover:text-red-500 text-xs",
                  title: "R√©initialiser le filtre Source\\n\\nRemet le filtre Source √† 'Tous' (Portefeuille + Watchlist).",
                  children: "‚úï"
                }
              )
            ] })
          ] })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "mt-4 pt-4 border-t border-gray-200", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between mb-3", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("h4", { className: "text-sm font-semibold text-gray-700", children: "Filtres avanc√©s" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                onClick: () => setFilters((prev) => ({ ...prev, showOnlyNA: !prev.showOnlyNA })),
                className: `px-2 py-1 text-xs rounded transition-colors ${filters.showOnlyNA ? "bg-orange-500 text-white" : "bg-gray-100 hover:bg-orange-100 text-gray-700"}`,
                children: filters.showOnlyNA ? "‚úì N/A uniquement" : "Afficher N/A"
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                onClick: () => setFilters((prev) => ({ ...prev, showOnlyApproved: !prev.showOnlyApproved })),
                className: `px-2 py-1 text-xs rounded transition-colors ${filters.showOnlyApproved ? "bg-green-500 text-white" : "bg-gray-100 hover:bg-green-100 text-gray-700"}`,
                children: filters.showOnlyApproved ? "‚úì Approuv√©s uniquement" : "Approuv√©s"
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                onClick: () => setFilters((prev) => ({ ...prev, showOnlySkeleton: !prev.showOnlySkeleton })),
                className: `px-2 py-1 text-xs rounded transition-colors ${filters.showOnlySkeleton ? "bg-blue-500 text-white" : "bg-gray-100 hover:bg-blue-100 text-gray-700"}`,
                children: filters.showOnlySkeleton ? "‚úì Squelettes uniquement" : "Squelettes"
              }
            )
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2 sm:gap-2.5 md:gap-3", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("label", { htmlFor: "filter-ratio31-min", className: "block text-[10px] sm:text-xs font-semibold text-gray-600 mb-1", children: "Ratio 3:1 Min" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "input",
                {
                  id: "filter-ratio31-min",
                  type: "number",
                  step: "0.1",
                  value: filters.minRatio31,
                  onChange: (e) => setFilters({ ...filters, minRatio31: parseFloat(e.target.value) || 0 }),
                  className: "w-full px-2 py-1.5 border border-gray-300 rounded text-xs"
                }
              )
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("label", { htmlFor: "filter-ratio31-max", className: "block text-[10px] sm:text-xs font-semibold text-gray-600 mb-1", children: "Ratio 3:1 Max" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "input",
                {
                  id: "filter-ratio31-max",
                  type: "number",
                  step: "0.1",
                  value: filters.maxRatio31,
                  onChange: (e) => setFilters({ ...filters, maxRatio31: parseFloat(e.target.value) || 100 }),
                  className: "w-full px-2 py-1.5 border border-gray-300 rounded text-xs"
                }
              )
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("label", { htmlFor: "filter-pe-min", className: "block text-[10px] sm:text-xs font-semibold text-gray-600 mb-1", children: "P/E Min" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "input",
                {
                  id: "filter-pe-min",
                  type: "number",
                  step: "0.1",
                  value: filters.minPE,
                  onChange: (e) => setFilters({ ...filters, minPE: parseFloat(e.target.value) || 0 }),
                  className: "w-full px-2 py-1.5 border border-gray-300 rounded text-xs"
                }
              )
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("label", { htmlFor: "filter-pe-max", className: "block text-[10px] sm:text-xs font-semibold text-gray-600 mb-1", children: "P/E Max" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "input",
                {
                  id: "filter-pe-max",
                  type: "number",
                  step: "0.1",
                  value: filters.maxPE,
                  onChange: (e) => setFilters({ ...filters, maxPE: parseFloat(e.target.value) || 1e3 }),
                  className: "w-full px-2 py-1.5 border border-gray-300 rounded text-xs"
                }
              )
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("label", { htmlFor: "filter-yield-min", className: "block text-[10px] sm:text-xs font-semibold text-gray-600 mb-1", children: "Yield Min (%)" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "input",
                {
                  id: "filter-yield-min",
                  type: "number",
                  step: "0.1",
                  value: filters.minYield,
                  onChange: (e) => setFilters({ ...filters, minYield: parseFloat(e.target.value) || 0 }),
                  className: "w-full px-2 py-1.5 border border-gray-300 rounded text-xs"
                }
              )
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("label", { htmlFor: "filter-yield-max", className: "block text-[10px] sm:text-xs font-semibold text-gray-600 mb-1", children: "Yield Max (%)" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "input",
                {
                  id: "filter-yield-max",
                  type: "number",
                  step: "0.1",
                  value: filters.maxYield,
                  onChange: (e) => setFilters({ ...filters, maxYield: parseFloat(e.target.value) || 50 }),
                  className: "w-full px-2 py-1.5 border border-gray-300 rounded text-xs"
                }
              )
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("label", { htmlFor: "filter-volatility-min", className: "block text-[10px] sm:text-xs font-semibold text-gray-600 mb-1", children: "Volatilit√© Min (%)" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "input",
                {
                  id: "filter-volatility-min",
                  type: "number",
                  step: "0.1",
                  value: filters.minVolatility,
                  onChange: (e) => setFilters({ ...filters, minVolatility: parseFloat(e.target.value) || 0 }),
                  className: "w-full px-2 py-1.5 border border-gray-300 rounded text-xs"
                }
              )
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("label", { htmlFor: "filter-volatility-max", className: "block text-[10px] sm:text-xs font-semibold text-gray-600 mb-1", children: "Volatilit√© Max (%)" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "input",
                {
                  id: "filter-volatility-max",
                  type: "number",
                  step: "0.1",
                  value: filters.maxVolatility,
                  onChange: (e) => setFilters({ ...filters, maxVolatility: parseFloat(e.target.value) || 200 }),
                  className: "w-full px-2 py-1.5 border border-gray-300 rounded text-xs"
                }
              )
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("label", { htmlFor: "filter-growth-min", className: "block text-[10px] sm:text-xs font-semibold text-gray-600 mb-1", children: "Croissance Min (%)" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "input",
                {
                  id: "filter-growth-min",
                  type: "number",
                  step: "0.1",
                  value: filters.minGrowth,
                  onChange: (e) => setFilters({ ...filters, minGrowth: parseFloat(e.target.value) || -50 }),
                  className: "w-full px-2 py-1.5 border border-gray-300 rounded text-xs"
                }
              )
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("label", { htmlFor: "filter-growth-max", className: "block text-[10px] sm:text-xs font-semibold text-gray-600 mb-1", children: "Croissance Max (%)" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "input",
                {
                  id: "filter-growth-max",
                  type: "number",
                  step: "0.1",
                  value: filters.maxGrowth,
                  onChange: (e) => setFilters({ ...filters, maxGrowth: parseFloat(e.target.value) || 100 }),
                  className: "w-full px-2 py-1.5 border border-gray-300 rounded text-xs"
                }
              )
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("label", { htmlFor: "filter-group-by", className: "block text-[10px] sm:text-xs font-semibold text-gray-600 mb-1", children: "Grouper par" }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs(
                "select",
                {
                  id: "filter-group-by",
                  value: filters.groupBy,
                  onChange: (e) => setFilters({ ...filters, groupBy: e.target.value }),
                  className: "w-full px-2 py-1.5 border border-gray-300 rounded text-xs",
                  children: [
                    /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "none", children: "Aucun" }),
                    /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "sector", children: "Secteur" }),
                    /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "recommendation", children: "Recommandation" }),
                    /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "source", children: "Source" })
                  ]
                }
              )
            ] })
          ] })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "mt-4 pt-4 border-t border-gray-200", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("h4", { className: "text-sm font-semibold text-gray-700 mb-3", children: "Options d'affichage" }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("label", { htmlFor: "display-density", className: "block text-[10px] sm:text-xs font-semibold text-gray-600 mb-1", children: "Densit√©" }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs(
                "select",
                {
                  id: "display-density",
                  value: displayOptions.density,
                  onChange: (e) => setDisplayOptions({ ...displayOptions, density: e.target.value }),
                  className: "w-full px-2 py-1.5 border border-gray-300 rounded text-xs",
                  children: [
                    /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "compact", children: "Compacte" }),
                    /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "comfortable", children: "Confortable" }),
                    /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "spacious", children: "Spacieuse" })
                  ]
                }
              )
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("div", { children: /* @__PURE__ */ jsxRuntimeExports.jsxs("label", { className: "flex items-center gap-2 text-xs", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "input",
                {
                  type: "checkbox",
                  checked: displayOptions.showSector,
                  onChange: (e) => setDisplayOptions({ ...displayOptions, showSector: e.target.checked }),
                  className: "w-4 h-4"
                }
              ),
              "Afficher secteur"
            ] }) }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("div", { children: /* @__PURE__ */ jsxRuntimeExports.jsxs("label", { className: "flex items-center gap-2 text-xs", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "input",
                {
                  type: "checkbox",
                  checked: displayOptions.showNames,
                  onChange: (e) => setDisplayOptions({ ...displayOptions, showNames: e.target.checked }),
                  className: "w-4 h-4"
                }
              ),
              "Afficher noms"
            ] }) })
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "mt-3", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("label", { className: "block text-[10px] sm:text-xs font-semibold text-gray-600 mb-2", children: "Colonnes visibles" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-2", children: Object.entries(displayOptions.visibleColumns).map(([key, visible]) => /* @__PURE__ */ jsxRuntimeExports.jsxs("label", { className: "flex items-center gap-2 text-xs cursor-pointer", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "input",
                {
                  type: "checkbox",
                  checked: visible,
                  onChange: (e) => setDisplayOptions({
                    ...displayOptions,
                    visibleColumns: { ...displayOptions.visibleColumns, [key]: e.target.checked }
                  }),
                  className: "w-4 h-4"
                }
              ),
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "capitalize", children: key === "ratio31" ? "Ratio 3:1" : key === "pe" ? "P/E" : key })
            ] }, key)) })
          ] })
        ] })
      ] })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white p-3 sm:p-4 md:p-6 rounded-lg shadow-lg border border-gray-200", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between mb-4", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex-1", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2 sm:gap-3", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("h3", { className: "text-base sm:text-lg md:text-xl font-bold text-gray-800", children: "üéØ Matrice de Performance" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                onClick: () => toggleSection("performanceMatrix"),
                className: "p-1.5 hover:bg-gray-100 rounded transition-colors cursor-help",
                title: sectionsVisibility.performanceMatrix ? "R√©duire cette section" : "Agrandir cette section",
                children: sectionsVisibility.performanceMatrix ? /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$f, { className: "w-5 h-5 text-gray-600" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$g, { className: "w-5 h-5 text-gray-600" })
              }
            )
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-xs text-gray-500 mt-1", children: "Cliquez sur un carreau pour s√©lectionner le titre" })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-3", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-0.5 sm:gap-1 bg-gray-100 rounded-lg p-0.5 sm:p-1", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                onClick: () => setMatrixView("grid"),
                className: `px-2 sm:px-3 py-1 sm:py-1.5 text-[10px] sm:text-xs font-semibold rounded transition-all ${matrixView === "grid" ? "bg-white text-blue-600 shadow-sm" : "text-gray-600 hover:text-gray-800"}`,
                title: "Vue grille\\n\\nAffiche les tickers dans une grille de tuiles color√©es.\\n\\nChaque tuile montre:\\n‚Ä¢ Symbole du ticker\\n‚Ä¢ Rendement total projet√©\\n‚Ä¢ JPEGY\\n‚Ä¢ Ic√¥nes (Portefeuille/Watchlist)\\n\\nLes couleurs indiquent le rendement (vert = √©lev√©, rouge = faible).",
                children: "‚¨ú Grille"
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                onClick: () => setMatrixView("list"),
                className: `px-2 sm:px-3 py-1 sm:py-1.5 text-[10px] sm:text-xs font-semibold rounded transition-all ${matrixView === "list" ? "bg-white text-blue-600 shadow-sm" : "text-gray-600 hover:text-gray-800"}`,
                title: "Vue liste d√©taill√©e\\n\\nAffiche les tickers dans un tableau d√©taill√©.\\n\\nColonnes:\\n‚Ä¢ Symbole\\n‚Ä¢ Nom\\n‚Ä¢ Rendement Total\\n‚Ä¢ JPEGY\\n‚Ä¢ Ratio 3:1\\n‚Ä¢ P/E, P/CF, P/BV, Yield\\n‚Ä¢ Recommandation\\n‚Ä¢ Secteur\\n\\nCliquez sur une ligne pour voir l'analyse compl√®te.",
                children: "‚ò∞ Liste"
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                onClick: () => setMatrixView("compact"),
                className: `px-2 sm:px-3 py-1 sm:py-1.5 text-[10px] sm:text-xs font-semibold rounded transition-all ${matrixView === "compact" ? "bg-white text-blue-600 shadow-sm" : "text-gray-600 hover:text-gray-800"}`,
                title: "Vue compacte (matrice)\\n\\nAffiche les tickers dans une matrice compacte.\\n\\nChaque case montre:\\n‚Ä¢ Symbole du ticker\\n‚Ä¢ Rendement total projet√©\\n‚Ä¢ JPEGY\\n\\nId√©al pour une vue d'ensemble rapide de tous les tickers.\\n\\nLes cases sont color√©es selon le rendement.",
                children: "‚ñ¶ Compacte"
              }
            )
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex flex-wrap items-center gap-2 sm:gap-3 md:gap-4 text-[10px] sm:text-xs", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-1", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-2.5 h-2.5 sm:w-3 sm:h-3 rounded bg-green-600" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-gray-600", children: "‚â•50%" })
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-1", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-2.5 h-2.5 sm:w-3 sm:h-3 rounded bg-green-300" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-gray-600", children: "20-50%" })
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-1", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-2.5 h-2.5 sm:w-3 sm:h-3 rounded bg-yellow-400" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-gray-600", children: "0-20%" })
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-1", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-2.5 h-2.5 sm:w-3 sm:h-3 rounded bg-red-600" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-gray-600", children: "<0%" })
            ] })
          ] })
        ] })
      ] }),
      sectionsVisibility.performanceMatrix && /* @__PURE__ */ jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment, { children: filteredMetrics.length === 0 ? /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-center py-8 text-gray-500", children: "Aucun titre ne correspond aux filtres s√©lectionn√©s." }) : /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
        filteredMetrics.some((m) => m.hasInvalidData) && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: `mb-4 p-3 border-l-4 rounded-r ${filteredMetrics.some((m) => m.isNotSynchronized) ? "bg-blue-50 border-blue-400" : "bg-yellow-50 border-yellow-400"}`, children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-start gap-2", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$a, { className: `w-5 h-5 flex-shrink-0 mt-0.5 ${filteredMetrics.some((m) => m.isNotSynchronized) ? "text-blue-600" : "text-yellow-600"}` }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: `flex-1 text-xs sm:text-sm ${filteredMetrics.some((m) => m.isNotSynchronized) ? "text-blue-800" : "text-yellow-800"}`, children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: filteredMetrics.some((m) => m.isNotSynchronized) ? "‚ö†Ô∏è Action requise:" : "Attention:" }),
            " ",
            filteredMetrics.filter((m) => m.hasInvalidData).length,
            " titre(s) ont des donn√©es invalides ou manquantes.",
            filteredMetrics.some((m) => m.isNotSynchronized) && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "font-semibold block mt-1 space-y-2", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("p", { children: "La plupart n√©cessitent une synchronisation depuis l'API." }),
              onBulkSync ? /* @__PURE__ */ jsxRuntimeExports.jsxs(
                "button",
                {
                  onClick: onBulkSync,
                  disabled: isBulkSyncing,
                  className: "mt-2 px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white rounded-lg text-sm font-semibold flex items-center gap-2 transition-colors",
                  children: [
                    /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$b, { className: `w-4 h-4 ${isBulkSyncing ? "animate-spin" : ""}` }),
                    isBulkSyncing ? "Synchronisation en cours..." : "Synchroniser Tous les Tickers"
                  ]
                }
              ) : /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-xs", children: `Allez dans l'onglet "Analysis" et cliquez sur "Synchroniser" pour chaque ticker, ou utilisez "Sync Tous les Tickers" dans la sidebar.` })
            ] }),
            "Ces tickers sont marqu√©s avec ",
            /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$a, { className: "w-4 h-4 inline text-red-500" }),
            ' et affichent "N/A".',
            /* @__PURE__ */ jsxRuntimeExports.jsxs("details", { className: "mt-2", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("summary", { className: "cursor-pointer font-semibold hover:opacity-80", children: "Voir les d√©tails par ticker" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("ul", { className: "mt-2 space-y-1 ml-4 list-disc", children: filteredMetrics.filter((m) => m.hasInvalidData).map((metric) => /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { className: "text-xs", children: [
                /* @__PURE__ */ jsxRuntimeExports.jsxs("strong", { children: [
                  metric.profile.id,
                  ":"
                ] }),
                " ",
                metric.invalidReason || "Donn√©es invalides"
              ] }, metric.profile.id)) })
            ] })
          ] })
        ] }) }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "mb-4 flex items-center justify-between flex-wrap gap-2", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-sm text-gray-600 flex items-center gap-3 flex-wrap", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { children: [
              "Mode: ",
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "font-semibold", children: filters.showOnlyNA ? "Tickers avec N/A uniquement" : "Vue normale" })
            ] }),
            filters.showOnlyNA && /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-xs bg-orange-100 text-orange-800 px-2 py-1 rounded-full", children: [
              filteredMetrics.length,
              " ticker(s) avec N/A"
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs(
              "button",
              {
                onClick: () => setShowGuideDialog(true),
                className: "px-2 py-1 text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 rounded flex items-center gap-1 transition-colors",
                title: "Ouvrir le guide complet pour r√©duire les N/A",
                children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$c, { className: "w-3 h-3" }),
                  "Guide"
                ]
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-xs text-gray-400 hidden sm:inline", title: "Raccourcis clavier disponibles", children: "‚å®Ô∏è Ctrl+Shift+F: Filtre N/A | Ctrl+Shift+E: Export | Ctrl+Shift+D: Sync crit√®res" })
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex gap-2 flex-wrap", children: [
            onOpenSettings && /* @__PURE__ */ jsxRuntimeExports.jsxs(
              "button",
              {
                onClick: onOpenSettings,
                className: "px-3 py-1 text-xs rounded transition-colors bg-gray-100 hover:bg-blue-100 hover:text-blue-600 text-gray-700 flex items-center gap-1",
                title: "‚öôÔ∏è Configuration Compl√®te : Guardrails, Validation, Ajustements\\n\\nOuvre le panneau de configuration unifi√© pour g√©rer tous les param√®tres de l'application.\\n\\nüõ°Ô∏è Guardrails (Limites d'affichage):\\n‚Ä¢ Limites de croissance (min/max pour toutes les m√©triques)\\n‚Ä¢ Limites de ratios (P/E, P/CF, P/BV min/max)\\n‚Ä¢ Multiplicateur maximum raisonnable pour les projections\\n‚Ä¢ Contr√¥lent l'affichage des graphiques et tableaux\\n‚Ä¢ Stock√©s dans localStorage (navigateur)\\n‚Ä¢ Affectent uniquement l'affichage, pas les calculs\\n\\n‚úÖ Validation (Param√®tres de sanitisation):\\n‚Ä¢ Limites de croissance par m√©trique (EPS, CF, BV, DIV)\\n‚Ä¢ Limites de ratios cibles (P/E, P/CF, P/BV, Yield)\\n‚Ä¢ Pr√©cision des calculs (d√©cimales)\\n‚Ä¢ Automatisation de la sanitisation lors de la sync FMP\\n‚Ä¢ Coh√©rence des donn√©es\\n‚Ä¢ Stock√©s dans Supabase (partag√©s entre utilisateurs)\\n‚Ä¢ Affectent les calculs et la sauvegarde\\n\\nüìä Ajustements:\\n‚Ä¢ Param√®tres g√©n√©raux de l'application\\n‚Ä¢ Comportement par d√©faut\\n‚Ä¢ Options d'affichage\\n\\nüí° Impact:\\n‚Ä¢ Les Guardrails affectent l'affichage uniquement\\n‚Ä¢ La Validation affecte les calculs et la sauvegarde\\n‚Ä¢ Les changements sont appliqu√©s imm√©diatement\\n‚Ä¢ Les param√®tres sont persistants (localStorage ou Supabase)",
                children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$h, { className: "w-3 h-3" }),
                  "Param√®tres"
                ]
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                onClick: () => {
                  setFilters((prev) => ({ ...prev, showOnlyNA: !prev.showOnlyNA }));
                },
                className: `px-3 py-1 text-xs rounded transition-colors ${filters.showOnlyNA ? "bg-orange-600 hover:bg-orange-700 text-white" : "bg-gray-100 hover:bg-orange-100 hover:text-orange-600 text-gray-700"}`,
                title: filters.showOnlyNA ? "üëÅÔ∏è Afficher tous les tickers\n\nD√©sactive le filtre N/A pour voir tous les tickers de votre portefeuille et watchlist.\n\nüìä Affichage:\n‚Ä¢ Tous les tickers (valides et avec N/A)\n‚Ä¢ M√©triques compl√®tes pour les tickers valides\n‚Ä¢ Indicateurs N/A pour les tickers incomplets\n\n‚å®Ô∏è Raccourci: Ctrl+Shift+F (Cmd+Shift+F sur Mac)" : "‚ö†Ô∏è Afficher uniquement les tickers avec N/A\n\nFiltre pour ne voir que les tickers avec des donn√©es invalides ou manquantes.\n\nüîç Utilit√©:\n‚Ä¢ Identifier rapidement les tickers n√©cessitant une synchronisation\n‚Ä¢ Voir quels tickers ont des probl√®mes de donn√©es\n‚Ä¢ Faciliter le nettoyage et la maintenance\n‚Ä¢ Permet de synchroniser uniquement les tickers probl√©matiques\n\nüìä Indicateurs N/A:\n‚Ä¢ Prix actuel invalide ou manquant\n‚Ä¢ Donn√©es historiques incompl√®tes\n‚Ä¢ M√©triques impossibles √† calculer\n‚Ä¢ Tickers non synchronis√©s depuis FMP\n\n‚å®Ô∏è Raccourci: Ctrl+Shift+F (Cmd+Shift+F sur Mac)",
                "aria-label": filters.showOnlyNA ? "Afficher tous les tickers" : "Afficher uniquement les tickers avec N/A",
                "aria-pressed": filters.showOnlyNA ? "true" : "false",
                tabIndex: 0,
                children: filters.showOnlyNA ? "Afficher Tous" : "Afficher N/A"
              }
            ),
            filters.showOnlyNA && onSyncNA && filteredMetrics.length > 0 && /* @__PURE__ */ jsxRuntimeExports.jsxs(
              "button",
              {
                onClick: () => {
                  const naTickers = filteredMetrics.map((m) => m.profile.id);
                  if (confirm(`Synchroniser ${naTickers.length} ticker(s) avec N/A ?

Tickers: ${naTickers.slice(0, 10).join(", ")}${naTickers.length > 10 ? `
... et ${naTickers.length - 10} autres` : ""}`)) {
                    onSyncNA(naTickers);
                  }
                },
                disabled: isBulkSyncing,
                className: "px-3 py-1 text-xs bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white rounded transition-colors flex items-center gap-1",
                title: `üîÑ Synchroniser uniquement les ${filteredMetrics.length} ticker(s) avec N/A

Synchronise uniquement les tickers affich√©s (ceux avec des donn√©es invalides ou manquantes).

‚ö° Avantages:
‚Ä¢ Plus rapide que de synchroniser tous les tickers
‚Ä¢ Cible uniquement les tickers probl√©matiques
‚Ä¢ √âconomise les appels API FMP
‚Ä¢ Permet de corriger rapidement les donn√©es manquantes

üìä Processus:
‚Ä¢ R√©cup√®re les donn√©es FMP Premium pour chaque ticker
‚Ä¢ Met √† jour les donn√©es historiques (30 ans)
‚Ä¢ Recalcule les hypoth√®ses automatiquement
‚Ä¢ Pr√©serve les modifications manuelles existantes
‚Ä¢ Sauvegarde un snapshot avant et apr√®s la sync

‚è±Ô∏è Dur√©e:
‚Ä¢ Environ 2-3 secondes par ticker
‚Ä¢ Traitement en batch (3 tickers en parall√®le)
‚Ä¢ Barre de progression affich√©e

üí° Astuce:
‚Ä¢ Utilisez ce bouton apr√®s avoir filtr√© les N/A
‚Ä¢ Plus efficace que 'Sync Warehouse (Deep)' si vous avez beaucoup de tickers`,
                children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$b, { className: `w-3 h-3 ${isBulkSyncing ? "animate-spin" : ""}` }),
                  "Sync N/A (",
                  filteredMetrics.length,
                  ")"
                ]
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsxs(
              "button",
              {
                onClick: async () => {
                  var _a2;
                  setIsAnalyzingNA(true);
                  setNaAnalysisResult(null);
                  try {
                    const response = await fetch("/api/3p1-sync-na?action=analyze&limit=200");
                    if (!response.ok) {
                      throw new Error(`Erreur API: ${response.status}`);
                    }
                    const result = await response.json();
                    if (result.success) {
                      setNaAnalysisResult({
                        total: result.totalTickers || 0,
                        na: ((_a2 = result.naTickers) == null ? void 0 : _a2.length) || 0,
                        valid: result.validTickers || 0,
                        errors: result.errorTickers || 0,
                        naTickers: result.naTickers || []
                      });
                      if (result.naTickers && result.naTickers.length > 0 && onSyncNA) {
                        const shouldSync = confirm(
                          `Analyse termin√©e:

‚úÖ Tickers valides: ${result.validTickers}
‚ö†Ô∏è Tickers avec N/A: ${result.naTickers.length}
‚ùå Erreurs: ${result.errorTickers}

Voulez-vous synchroniser automatiquement les ${result.naTickers.length} tickers avec N/A ?`
                        );
                        if (shouldSync) {
                          onSyncNA(result.naTickers);
                        }
                      } else if (result.naTickers && result.naTickers.length === 0) {
                        alert(`‚úÖ Excellent! Aucun ticker avec N/A trouv√©.

Tous les ${result.validTickers} tickers ont des donn√©es valides.`);
                      }
                    } else {
                      alert(`Erreur: ${result.error || "Erreur inconnue"}`);
                    }
                  } catch (error) {
                    console.error("Erreur analyse N/A:", error);
                    alert(`Erreur lors de l'analyse: ${error.message}`);
                  } finally {
                    setIsAnalyzingNA(false);
                  }
                },
                disabled: isBulkSyncing || isAnalyzingNA,
                className: "px-3 py-1 text-xs bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white rounded transition-colors flex items-center gap-1",
                title: "üîç Analyser les tickers avec N/A\\n\\nAnalyse tous les tickers de votre portefeuille et watchlist pour identifier ceux avec des donn√©es invalides ou manquantes.\\n\\nüìä R√©sultats de l'analyse:\\n‚Ä¢ Nombre total de tickers analys√©s\\n‚Ä¢ Nombre de tickers valides (donn√©es compl√®tes)\\n‚Ä¢ Nombre de tickers avec N/A (donn√©es manquantes)\\n‚Ä¢ Nombre d'erreurs rencontr√©es\\n‚Ä¢ Liste des tickers probl√©matiques\\n\\n‚ö° Fonctionnalit√©s:\\n‚Ä¢ Analyse rapide via l'API backend\\n‚Ä¢ Limite de 200 tickers par analyse\\n‚Ä¢ Propose automatiquement de synchroniser les N/A\\n‚Ä¢ Affiche un r√©sum√© d√©taill√©\\n\\nüí° Utilisation:\\n‚Ä¢ Cliquez pour lancer l'analyse\\n‚Ä¢ Attendez quelques secondes\\n‚Ä¢ Si des N/A sont trouv√©s, vous pouvez les synchroniser automatiquement\\n‚Ä¢ Plus efficace que de v√©rifier manuellement chaque ticker",
                children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$b, { className: `w-3 h-3 ${isAnalyzingNA ? "animate-spin" : ""}` }),
                  isAnalyzingNA ? "Analyse..." : "Auto-Sync N/A"
                ]
              }
            ),
            naAnalysisResult && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "px-3 py-1 text-xs bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 rounded border border-blue-200 dark:border-blue-800", children: naAnalysisResult.na > 0 ? /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { children: [
              "‚ö†Ô∏è ",
              naAnalysisResult.na,
              " N/A trouv√©s"
            ] }) : /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: "‚úÖ Tous valides" }) }),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                onClick: () => {
                  const sorted = [...filteredMetrics].sort((a, b) => b.totalReturnPercent - a.totalReturnPercent);
                  const top10 = sorted.slice(0, 10);
                  requestAnimationFrame(() => {
                    requestAnimationFrame(() => {
                      var _a2;
                      const firstEl = document.querySelector(`[data-ticker="${(_a2 = top10[0]) == null ? void 0 : _a2.profile.id}"]`);
                      firstEl == null ? void 0 : firstEl.scrollIntoView({ behavior: "smooth", block: "center" });
                    });
                  });
                },
                className: "px-3 py-1 text-xs bg-gray-100 hover:bg-blue-100 hover:text-blue-600 text-gray-700 rounded transition-colors",
                title: "Zoom Top 10\\n\\nFait d√©filer automatiquement vers les 10 meilleurs tickers (par rendement total projet√©).\\n\\nUtile pour se concentrer rapidement sur les meilleures opportunit√©s.",
                children: "Zoom Top 10"
              }
            )
          ] })
        ] }),
        matrixView === "grid" && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-8 gap-2 sm:gap-2.5 md:gap-3", children: filteredMetrics.map((metric) => /* @__PURE__ */ jsxRuntimeExports.jsx(
          "div",
          {
            "data-ticker": metric.profile.id,
            onClick: (e) => {
              if (comparisonMode) {
                e.stopPropagation();
                setSelectedForComparison((prev) => {
                  if (prev.includes(metric.profile.id)) {
                    return prev.filter((t) => t !== metric.profile.id);
                  } else if (prev.length < 5) {
                    return [...prev, metric.profile.id];
                  }
                  return prev;
                });
              } else {
                onSelect(metric.profile.id);
              }
            },
            className: `p-1.5 sm:p-2 md:p-2.5 lg:p-3 rounded-lg cursor-pointer transition-all hover:scale-105 sm:hover:scale-110 hover:shadow-xl border-2 ${currentId === metric.profile.id ? "border-blue-600 ring-4 ring-blue-300 shadow-xl" : comparisonMode && selectedForComparison.includes(metric.profile.id) ? "border-purple-600 ring-4 ring-purple-300 shadow-xl" : "border-gray-200"} ${getReturnBgClass(metric.totalReturnPercent)} ${currentId === metric.profile.id ? "opacity-100" : "opacity-85"}`,
            title: `${metric.profile.info.name || metric.profile.id}
Rendement: ${metric.hasInvalidData || metric.totalReturnPercent === null || metric.totalReturnPercent === void 0 ? "N/A (donn√©es invalides)" : `${metric.totalReturnPercent.toFixed(1)}%`}
JPEGY: ${metric.jpegy !== null ? metric.jpegy.toFixed(2) : "N/A (non calculable)"}
Ratio 3:1: ${metric.hasInvalidData || metric.ratio31 === null || metric.ratio31 === void 0 ? "N/A" : metric.ratio31.toFixed(2)}
P/E: ${metric.currentPE !== null && metric.currentPE !== void 0 ? metric.currentPE.toFixed(1) : "N/A"}x
Secteur: ${metric.profile.info.sector}
${metric.hasApprovedVersion ? "‚úì Version approuv√©e" : ""}
${metric.invalidReason ? `‚ö†Ô∏è ${metric.invalidReason}` : ""}`,
            children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex flex-col items-center justify-center h-full text-white relative", children: [
              comparisonMode && selectedForComparison.includes(metric.profile.id) && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "absolute -top-1 -right-1 w-5 h-5 bg-purple-500 rounded-full flex items-center justify-center text-white text-[10px] font-bold z-10", children: selectedForComparison.indexOf(metric.profile.id) + 1 }),
              metric.hasInvalidData && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "absolute -top-1 -left-1 w-4 h-4 bg-red-500 rounded-full flex items-center justify-center z-10", title: "Donn√©es invalides ou manquantes", children: /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$a, { className: "w-3 h-3 text-white" }) }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-1 mb-1", children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: `text-xs font-bold ${metric.hasInvalidData ? "line-through opacity-70" : ""}`, children: metric.profile.id }),
                metric.profile.isWatchlist ?? false ? /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$1, { className: "w-3 h-3 text-blue-300", title: "Watchlist" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef, { className: "w-3 h-3 text-yellow-400", title: "Portefeuille" })
              ] }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: `text-[10px] font-semibold mb-1 ${metric.hasInvalidData ? "opacity-50" : ""}`, children: metric.hasInvalidData || metric.totalReturnPercent === null || metric.totalReturnPercent === void 0 ? "N/A" : `${metric.totalReturnPercent.toFixed(0)}%` }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: `text-[8px] opacity-90 ${metric.hasInvalidData || metric.jpegy === null ? "opacity-50" : ""}`, children: [
                "JPEGY: ",
                metric.jpegy !== null ? metric.jpegy.toFixed(1) : "N/A",
                metric.jpegy === null && /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "ml-1 text-red-400", children: "‚ö†Ô∏è" })
              ] }),
              metric.hasApprovedVersion && !metric.hasInvalidData && /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$e, { className: "w-4 h-4 mt-1 text-white" })
            ] })
          },
          metric.profile.id
        )) }),
        matrixView === "list" && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "space-y-2", children: filteredMetrics.map((metric) => /* @__PURE__ */ jsxRuntimeExports.jsxs(
          "div",
          {
            "data-ticker": metric.profile.id,
            onClick: (e) => {
              if (comparisonMode) {
                e.stopPropagation();
                setSelectedForComparison((prev) => {
                  if (prev.includes(metric.profile.id)) {
                    return prev.filter((t) => t !== metric.profile.id);
                  } else if (prev.length < 5) {
                    return [...prev, metric.profile.id];
                  }
                  return prev;
                });
              } else {
                onSelect(metric.profile.id);
              }
            },
            className: `p-3 sm:p-4 rounded-lg cursor-pointer transition-all hover:shadow-lg border-2 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-4 ${currentId === metric.profile.id ? "border-blue-600 ring-2 ring-blue-300 bg-blue-50" : comparisonMode && selectedForComparison.includes(metric.profile.id) ? "border-purple-600 ring-2 ring-purple-300 bg-purple-50" : "border-gray-200 bg-white hover:bg-gray-50"}`,
            children: [
              /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-4 flex-1", children: [
                /* @__PURE__ */ jsxRuntimeExports.jsxs(
                  "div",
                  {
                    className: `w-12 h-12 rounded-lg flex items-center justify-center text-white font-bold text-sm relative transition-colors ${metric.hasInvalidData ? "bg-red-100" : ""}`,
                    children: [
                      /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: `absolute inset-0 rounded-lg ${metric.hasInvalidData ? "" : getReturnBgClass(metric.totalReturnPercent)}` }),
                      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "relative z-10", children: metric.profile.id }),
                      /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "absolute -top-1 -right-1 z-10", children: metric.profile.isWatchlist ?? false ? /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$1, { className: "w-4 h-4 text-blue-300", title: "Watchlist" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef, { className: "w-4 h-4 text-yellow-400", title: "Portefeuille" }) }),
                      metric.hasInvalidData && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "absolute -top-1 -left-1 w-4 h-4 bg-red-500 rounded-full flex items-center justify-center z-10", title: "Donn√©es invalides", children: /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$a, { className: "w-3 h-3 text-white" }) })
                    ]
                  }
                ),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex-1", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2", children: [
                    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: `font-bold text-gray-800 ${metric.hasInvalidData ? "line-through opacity-70" : ""}`, children: metric.profile.info.name || metric.profile.id }),
                    metric.profile.isWatchlist ?? false ? /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$1, { className: "w-4 h-4 text-blue-500", title: "Watchlist" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef, { className: "w-4 h-4 text-yellow-500", title: "Portefeuille" })
                  ] }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-500", children: metric.profile.info.sector })
                ] }),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-right", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: `font-bold text-lg ${metric.hasInvalidData ? "text-gray-400" : getReturnTextClass(metric.totalReturnPercent)}`, children: metric.hasInvalidData || metric.totalReturnPercent === null || metric.totalReturnPercent === void 0 ? "N/A" : `${metric.totalReturnPercent.toFixed(1)}%` }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-500", children: "Rendement" })
                ] }),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-right", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: `font-semibold flex items-center justify-end gap-1 ${metric.jpegy === null ? "text-gray-400" : getJpegyTextClass(metric.jpegy)}`, children: [
                    metric.jpegy !== null ? metric.jpegy.toFixed(2) : "N/A",
                    metric.jpegy === null && /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$a, { className: "w-3 h-3 text-orange-500", title: "JPEGY non calculable" })
                  ] }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-500", children: "JPEGY" }),
                  metric.jpegy !== null && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "mt-1 pt-1 border-t border-gray-200", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-[9px] text-gray-400 space-y-0.5 text-left", children: [
                    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
                      /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Source:" }),
                      " P/E √∑ (Growth % + Yield %)"
                    ] }),
                    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
                      /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Fournisseur:" }),
                      " JSLAI‚Ñ¢ - M√©trique propri√©taire ajustant le P/E par croissance et dividende."
                    ] })
                  ] }) })
                ] }),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-right", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: `font-semibold ${metric.hasInvalidData ? "text-gray-400" : metric.ratio31 >= 3 ? "text-green-600" : metric.ratio31 >= 1 ? "text-yellow-600" : "text-red-600"}`, children: metric.hasInvalidData || metric.ratio31 === null ? "N/A" : metric.ratio31.toFixed(2) }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-500", children: "Ratio 3:1" })
                ] })
              ] }),
              comparisonMode && selectedForComparison.includes(metric.profile.id) && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "ml-4 w-6 h-6 bg-purple-500 rounded-full flex items-center justify-center text-white text-xs font-bold", children: selectedForComparison.indexOf(metric.profile.id) + 1 }),
              metric.hasInvalidData ? /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$a, { className: "w-5 h-5 text-red-500 ml-2", title: "Donn√©es invalides" }) : metric.hasApprovedVersion && /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$e, { className: "w-5 h-5 text-green-500 ml-2" })
            ]
          },
          metric.profile.id
        )) }),
        matrixView === "compact" && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10 2xl:grid-cols-12 gap-1 sm:gap-1.5 md:gap-2", children: filteredMetrics.map((metric) => /* @__PURE__ */ jsxRuntimeExports.jsx(
          "div",
          {
            "data-ticker": metric.profile.id,
            onClick: (e) => {
              if (comparisonMode) {
                e.stopPropagation();
                setSelectedForComparison((prev) => {
                  if (prev.includes(metric.profile.id)) {
                    return prev.filter((t) => t !== metric.profile.id);
                  } else if (prev.length < 5) {
                    return [...prev, metric.profile.id];
                  }
                  return prev;
                });
              } else {
                onSelect(metric.profile.id);
              }
            },
            className: `p-1.5 sm:p-2 rounded cursor-pointer transition-all hover:scale-105 border ${currentId === metric.profile.id ? "border-blue-600 ring-2 ring-blue-300" : comparisonMode && selectedForComparison.includes(metric.profile.id) ? "border-purple-600 ring-2 ring-purple-300" : metric.hasInvalidData ? "border-red-300 border-dashed" : "border-gray-200"} ${metric.hasInvalidData ? "bg-red-50" : getReturnBgClass(metric.totalReturnPercent)} ${currentId === metric.profile.id ? "opacity-100" : metric.hasInvalidData ? "opacity-60" : "opacity-80"}`,
            title: `${metric.profile.id}: ${metric.hasInvalidData || metric.totalReturnPercent === null || metric.totalReturnPercent === void 0 ? "Donn√©es invalides" : `${metric.totalReturnPercent.toFixed(1)}%`}`,
            children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: `flex flex-col items-center ${metric.hasInvalidData ? "text-gray-600" : "text-white"} text-[9px] relative`, children: [
              metric.hasInvalidData && /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$a, { className: "w-3 h-3 text-red-500 absolute -top-1 -left-1" }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-0.5", children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: `font-bold ${metric.hasInvalidData ? "line-through" : ""}`, children: metric.profile.id }),
                metric.profile.isWatchlist ?? false ? /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$1, { className: "w-2.5 h-2.5 text-blue-300", title: "Watchlist" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef, { className: "w-2.5 h-2.5 text-yellow-400", title: "Portefeuille" })
              ] }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-[8px]", children: metric.hasInvalidData || metric.totalReturnPercent === null || metric.totalReturnPercent === void 0 ? "N/A" : `${metric.totalReturnPercent.toFixed(0)}%` })
            ] })
          },
          metric.profile.id
        )) })
      ] }) })
    ] }),
    currentId && profiles.find((p) => p.id === currentId) && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white p-3 sm:p-4 md:p-6 rounded-lg shadow-lg border border-blue-200 mb-6", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between mb-4", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs("h3", { className: "text-base sm:text-lg md:text-xl font-bold text-gray-800 flex items-center gap-2", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$2, { className: "w-6 h-6 text-blue-600" }),
          "Analyse D√©taill√©e : ",
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-blue-600", children: currentId }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-sm font-normal text-gray-500 ml-2", children: [
            "(",
            ((_b = (_a = profiles.find((p) => p.id === currentId)) == null ? void 0 : _a.info) == null ? void 0 : _b.name) || "Inconnu",
            ")"
          ] })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          "button",
          {
            onClick: () => toggleSection("detailedAnalysis"),
            className: "p-1.5 hover:bg-gray-100 rounded transition-colors cursor-help",
            title: sectionsVisibility.detailedAnalysis ? "R√©duire cette section" : "Agrandir cette section",
            children: sectionsVisibility.detailedAnalysis ? /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$f, { className: "w-5 h-5 text-gray-600" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$g, { className: "w-5 h-5 text-gray-600" })
          }
        )
      ] }),
      sectionsVisibility.detailedAnalysis && profiles.find((p) => p.id === currentId) && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "space-y-6", children: ((_c = profiles.find((p) => p.id === currentId)) == null ? void 0 : _c.data) && /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          AdditionalMetrics,
          {
            data: profiles.find((p) => p.id === currentId).data,
            assumptions: profiles.find((p) => p.id === currentId).assumptions,
            info: profiles.find((p) => p.id === currentId).info
          }
        ),
        /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "border-t border-gray-200 pt-6", children: /* @__PURE__ */ jsxRuntimeExports.jsx(
          EvaluationDetails,
          {
            data: profiles.find((p) => p.id === currentId).data,
            assumptions: profiles.find((p) => p.id === currentId).assumptions,
            info: profiles.find((p) => p.id === currentId).info,
            sector: profiles.find((p) => p.id === currentId).info.sector,
            onUpdateAssumption: (key, value) => {
              const profile = profiles.find((p) => p.id === currentId);
              if (profile && onUpdateProfile) {
                const updatedProfile = {
                  ...profile,
                  assumptions: {
                    ...profile.assumptions,
                    [key]: value
                  }
                };
                onUpdateProfile(profile.id, updatedProfile);
              }
            }
          }
        ) })
      ] }) })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white p-3 sm:p-4 md:p-6 rounded-lg shadow-lg border border-gray-200", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between mb-4", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2 sm:gap-3", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("h3", { className: "text-base sm:text-lg md:text-xl font-bold text-gray-800", children: "üìä Positionnement JPEGY vs Rendement Total" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx(
            "button",
            {
              onClick: () => toggleSection("scatterPlot"),
              className: "p-1.5 hover:bg-gray-100 rounded transition-colors cursor-help",
              title: sectionsVisibility.scatterPlot ? "R√©duire cette section" : "Agrandir cette section",
              children: sectionsVisibility.scatterPlot ? /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$f, { className: "w-5 h-5 text-gray-600" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$g, { className: "w-5 h-5 text-gray-600" })
            }
          )
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-xs text-gray-500", children: [
            filteredMetrics.length,
            " titre(s) affich√©(s)"
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-1 border border-gray-300 rounded-lg p-1 bg-white", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                onClick: () => {
                  setZoomJPEGY((prev) => Math.min(prev * 1.2, 5));
                  setPanJPEGY({ x: 0, y: 0 });
                },
                className: "p-1.5 hover:bg-gray-100 rounded transition-colors cursor-help",
                title: "Zoomer (x1.2)",
                children: /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$2, { className: "w-4 h-4 text-gray-600" })
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                onClick: () => {
                  setZoomJPEGY((prev) => Math.max(prev / 1.2, 0.5));
                  setPanJPEGY({ x: 0, y: 0 });
                },
                className: "p-1.5 hover:bg-gray-100 rounded transition-colors cursor-help",
                title: "D√©zoomer (√∑1.2)",
                children: /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$3, { className: "w-4 h-4 text-gray-600" })
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                onClick: () => {
                  setZoomJPEGY(1);
                  setPanJPEGY({ x: 0, y: 0 });
                },
                className: "p-1.5 hover:bg-gray-100 rounded transition-colors cursor-help",
                title: "R√©initialiser la vue",
                children: /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$4, { className: "w-4 h-4 text-gray-600" })
              }
            )
          ] })
        ] })
      ] }),
      sectionsVisibility.scatterPlot && /* @__PURE__ */ jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment, { children: filteredMetrics.length === 0 ? /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-center py-8 text-gray-500", children: "Aucun titre √† afficher sur le graphique." }) : /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "overflow-x-auto bg-gray-50 p-2 sm:p-3 md:p-4 rounded-lg", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-full", style: { minWidth: "100%" }, children: /* @__PURE__ */ jsxRuntimeExports.jsx(
          "svg",
          {
            ref: svgJPEGYRef,
            width: chartWidth,
            height: chartHeight,
            className: "border border-gray-300 rounded bg-white w-full max-w-full cursor-move",
            viewBox: `0 0 ${chartWidth} ${chartHeight}`,
            preserveAspectRatio: "xMidYMid meet",
            onMouseDown: (e) => {
              if (e.button === 0 && !e.target || e.target.tagName !== "circle") {
                setIsPanningJPEGY(true);
                setPanStartJPEGY({
                  x: e.clientX - panJPEGY.x,
                  y: e.clientY - panJPEGY.y
                });
              }
            },
            onMouseMove: (e) => {
              if (isPanningJPEGY) {
                setPanJPEGY({
                  x: e.clientX - panStartJPEGY.x,
                  y: e.clientY - panStartJPEGY.y
                });
              }
            },
            onMouseUp: () => setIsPanningJPEGY(false),
            onMouseLeave: () => setIsPanningJPEGY(false),
            children: /* @__PURE__ */ jsxRuntimeExports.jsxs("g", { transform: `translate(${panJPEGY.x}, ${panJPEGY.y}) scale(${zoomJPEGY})`, children: [
              xTicks.map((tick, i) => /* @__PURE__ */ jsxRuntimeExports.jsx(
                "line",
                {
                  x1: tick.position,
                  y1: padding,
                  x2: tick.position,
                  y2: chartHeight - padding,
                  stroke: "#e5e7eb",
                  strokeWidth: "1",
                  strokeDasharray: "2,2"
                },
                `x-grid-${i}`
              )),
              yTicks.map((tick, i) => /* @__PURE__ */ jsxRuntimeExports.jsx(
                "line",
                {
                  x1: padding,
                  y1: tick.position,
                  x2: chartWidth - padding,
                  y2: tick.position,
                  stroke: "#e5e7eb",
                  strokeWidth: "1",
                  strokeDasharray: "2,2"
                },
                `y-grid-${i}`
              )),
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "line",
                {
                  x1: padding,
                  y1: chartHeight - padding,
                  x2: chartWidth - padding,
                  y2: chartHeight - padding,
                  stroke: "#1f2937",
                  strokeWidth: "2"
                }
              ),
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "line",
                {
                  x1: padding,
                  y1: padding,
                  x2: padding,
                  y2: chartHeight - padding,
                  stroke: "#1f2937",
                  strokeWidth: "2"
                }
              ),
              xTicks.map((tick, i) => /* @__PURE__ */ jsxRuntimeExports.jsxs("g", { children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx(
                  "line",
                  {
                    x1: tick.position,
                    y1: chartHeight - padding,
                    x2: tick.position,
                    y2: chartHeight - padding + 5,
                    stroke: "#1f2937",
                    strokeWidth: "1.5"
                  }
                ),
                /* @__PURE__ */ jsxRuntimeExports.jsx(
                  "text",
                  {
                    x: tick.position,
                    y: chartHeight - padding + 20,
                    textAnchor: "middle",
                    className: "text-xs font-medium fill-gray-700",
                    children: tick.value !== null && tick.value !== void 0 ? tick.value.toFixed(1) : "N/A"
                  }
                )
              ] }, `x-tick-${i}`)),
              yTicks.map((tick, i) => /* @__PURE__ */ jsxRuntimeExports.jsxs("g", { children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx(
                  "line",
                  {
                    x1: padding,
                    y1: tick.position,
                    x2: padding - 5,
                    y2: tick.position,
                    stroke: "#1f2937",
                    strokeWidth: "1.5"
                  }
                ),
                /* @__PURE__ */ jsxRuntimeExports.jsxs(
                  "text",
                  {
                    x: padding - 10,
                    y: tick.position + 4,
                    textAnchor: "end",
                    className: "text-xs font-medium fill-gray-700",
                    children: [
                      tick.value !== null && tick.value !== void 0 ? tick.value.toFixed(0) : "N/A",
                      "%"
                    ]
                  }
                )
              ] }, `y-tick-${i}`)),
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "text",
                {
                  x: chartWidth / 2,
                  y: chartHeight - 15,
                  textAnchor: "middle",
                  className: "text-sm font-bold fill-gray-800",
                  children: "JPEGY (P/E ajust√© pour croissance et rendement)"
                }
              ),
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "text",
                {
                  x: 25,
                  y: chartHeight / 2,
                  textAnchor: "middle",
                  transform: `rotate(-90, 25, ${chartHeight / 2})`,
                  className: "text-sm font-bold fill-gray-800",
                  children: "Rendement Total Projet√© (5 ans, %) - Ratio 3:1"
                }
              ),
              /* @__PURE__ */ jsxRuntimeExports.jsx("g", { transform: `translate(${chartWidth / 2}, ${chartHeight - 5})`, children: /* @__PURE__ */ jsxRuntimeExports.jsx(
                "text",
                {
                  x: 0,
                  y: 0,
                  textAnchor: "middle",
                  className: "text-[9px] fill-gray-500",
                  children: "JPEGY = P/E √∑ (Growth % + Yield %) | Source: JSLAI‚Ñ¢ (Jean-S√©bastien)"
                }
              ) }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("g", { transform: `translate(${chartWidth - 200}, ${padding + 20})`, children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx("text", { x: 0, y: 0, className: "text-xs font-semibold fill-gray-700", children: "L√©gende JPEGY:" }),
                [
                  { label: "Excellent (‚â§0.5)", color: "#86efac" },
                  { label: "Bon (0.5-1.5)", color: "#16a34a" },
                  { label: "Moyen (1.5-1.75)", color: "#eab308" },
                  { label: "Faible (1.75-2.0)", color: "#f97316" },
                  { label: "Mauvais (>2.0)", color: "#dc2626" }
                ].map((item, idx) => /* @__PURE__ */ jsxRuntimeExports.jsxs("g", { transform: `translate(0, ${(idx + 1) * 18})`, children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("circle", { cx: 8, cy: 0, r: 6, fill: item.color }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("text", { x: 20, y: 4, className: "text-[10px] fill-gray-600", children: item.label })
                ] }, idx))
              ] }),
              filteredMetrics.filter((metric) => !metric.hasInvalidData).map((metric) => {
                if (metric.jpegy === null || metric.totalReturnPercent > 1e3 || metric.totalReturnPercent < -100 || metric.jpegy > 100 || metric.jpegy < 0 || !isFinite(metric.totalReturnPercent) || !isFinite(metric.jpegy)) {
                  return null;
                }
                const x = xScale(metric.jpegy);
                const y = yScale(metric.totalReturnPercent);
                const jpegyColor = getJpegyColor2(metric.jpegy);
                return /* @__PURE__ */ jsxRuntimeExports.jsxs("g", { children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx(
                    "circle",
                    {
                      cx: x,
                      cy: y,
                      r: currentId === metric.profile.id ? 8 : 6,
                      fill: jpegyColor || "#9ca3af",
                      stroke: currentId === metric.profile.id ? "#2563eb" : "#fff",
                      strokeWidth: currentId === metric.profile.id ? 2 : 1,
                      className: "cursor-pointer hover:r-8",
                      onClick: () => onSelect(metric.profile.id)
                    }
                  ),
                  currentId === metric.profile.id && /* @__PURE__ */ jsxRuntimeExports.jsx(
                    "text",
                    {
                      x,
                      y: y - 15,
                      textAnchor: "middle",
                      className: "text-xs font-bold fill-blue-600",
                      children: metric.profile.id
                    }
                  )
                ] }, metric.profile.id);
              }).filter(Boolean)
            ] })
          }
        ) }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "mt-3 p-3 bg-gray-50 rounded-lg border border-gray-200", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-xs text-gray-700 space-y-1", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "font-semibold mb-1", children: "üìä √Ä propos de JPEGY :" }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Source de calcul:" }),
            " P/E Actuel √∑ (Taux de croissance EPS % + Rendement dividende %)"
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Formule:" }),
            " JPEGY = Prix Actuel / BPA √∑ (Taux de croissance annuel des b√©n√©fices % + Rendement du dividende %)"
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Fournisseur:" }),
            " M√©trique propri√©taire JSLAI‚Ñ¢ d√©velopp√©e par Jean-S√©bastien. Le fournisseur √©tablit cette m√©trique en ajustant le ratio P/E traditionnel par la somme du taux de croissance des b√©n√©fices et du rendement du dividende, permettant une √©valuation plus nuanc√©e de la valorisation d'une action en tenant compte de sa capacit√© de croissance et de sa distribution de dividendes. Plus le ratio est bas, plus l'action est attractive."
          ] })
        ] }) })
      ] }) })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white p-3 sm:p-4 md:p-6 rounded-lg shadow-lg border border-gray-200", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between mb-4", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2 sm:gap-3", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("h3", { className: "text-base sm:text-lg md:text-xl font-bold text-gray-800", children: "üìä Positionnement Ratio 3:1 vs Rendement Total" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx(
            "button",
            {
              onClick: () => toggleSection("scatterPlotRatio31"),
              className: "p-1.5 hover:bg-gray-100 rounded transition-colors cursor-help",
              title: sectionsVisibility.scatterPlotRatio31 ? "R√©duire cette section" : "Agrandir cette section",
              children: sectionsVisibility.scatterPlotRatio31 ? /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$f, { className: "w-5 h-5 text-gray-600" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$g, { className: "w-5 h-5 text-gray-600" })
            }
          )
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-xs text-gray-500", children: [
            filteredMetrics.length,
            " titre(s) affich√©(s)"
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-1 border border-gray-300 rounded-lg p-1 bg-white", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                onClick: () => {
                  setZoomRatio31((prev) => Math.min(prev * 1.2, 5));
                },
                className: "p-1.5 hover:bg-gray-100 rounded transition-colors cursor-help",
                title: "Zoomer (x1.2)\\n\\nUtilisez aussi la molette de la souris pour zoomer vers le point de la souris.",
                children: /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$2, { className: "w-4 h-4 text-gray-600" })
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                onClick: () => {
                  setZoomRatio31((prev) => Math.max(prev / 1.2, 0.5));
                },
                className: "p-1.5 hover:bg-gray-100 rounded transition-colors cursor-help",
                title: "D√©zoomer (√∑1.2)\\n\\nUtilisez aussi la molette de la souris pour d√©zoomer.",
                children: /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$3, { className: "w-4 h-4 text-gray-600" })
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                onClick: () => {
                  setZoomRatio31(1);
                  setPanRatio31({ x: 0, y: 0 });
                },
                className: "p-1.5 hover:bg-gray-100 rounded transition-colors cursor-help",
                title: "R√©initialiser la vue",
                children: /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$4, { className: "w-4 h-4 text-gray-600" })
              }
            )
          ] })
        ] })
      ] }),
      sectionsVisibility.scatterPlotRatio31 && /* @__PURE__ */ jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment, { children: filteredMetrics.length === 0 ? /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-center py-8 text-gray-500", children: "Aucun titre √† afficher sur le graphique." }) : /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "overflow-x-auto bg-gray-50 p-2 sm:p-3 md:p-4 rounded-lg", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-full", style: { minWidth: "100%" }, children: (() => {
          const validMetricsForRatio31Chart = filteredMetrics.filter(
            (m) => !m.hasInvalidData && m.totalReturnPercent >= -100 && m.totalReturnPercent <= 1e3 && m.ratio31 >= 0 && m.ratio31 <= 100 && isFinite(m.totalReturnPercent) && isFinite(m.ratio31)
          );
          const maxRatio31 = validMetricsForRatio31Chart.length > 0 ? Math.max(...validMetricsForRatio31Chart.map((m) => m.ratio31).filter((r) => r !== null && r !== void 0 && isFinite(r)), 10) : 10;
          const minRatio31 = validMetricsForRatio31Chart.length > 0 ? Math.min(...validMetricsForRatio31Chart.map((m) => m.ratio31).filter((r) => r !== null && r !== void 0 && isFinite(r)), 0) : 0;
          const maxReturnRatio31 = validMetricsForRatio31Chart.length > 0 ? Math.max(...validMetricsForRatio31Chart.map((m) => m.totalReturnPercent).filter((r) => r !== null && r !== void 0 && isFinite(r)), 200) : 200;
          const minReturnRatio31 = validMetricsForRatio31Chart.length > 0 ? Math.min(...validMetricsForRatio31Chart.map((m) => m.totalReturnPercent).filter((r) => r !== null && r !== void 0 && isFinite(r)), -50) : -50;
          const xScaleRatio31 = (ratio) => {
            const range = maxRatio31 - minRatio31 || 1;
            return padding + (ratio - minRatio31) / range * (chartWidth - 2 * padding);
          };
          const yScaleRatio31 = (returnPercent) => {
            const range = maxReturnRatio31 - minReturnRatio31 || 1;
            return chartHeight - padding - (returnPercent - minReturnRatio31) / range * (chartHeight - 2 * padding);
          };
          const xTicksRatio31 = [];
          const xTickCountRatio31 = 10;
          for (let i = 0; i <= xTickCountRatio31; i++) {
            const value = minRatio31 + (maxRatio31 - minRatio31) * (i / xTickCountRatio31);
            xTicksRatio31.push({ value, position: xScaleRatio31(value) });
          }
          const yTicksRatio31 = [];
          const yTickCountRatio31 = 10;
          for (let i = 0; i <= yTickCountRatio31; i++) {
            const value = minReturnRatio31 + (maxReturnRatio31 - minReturnRatio31) * (i / yTickCountRatio31);
            yTicksRatio31.push({ value, position: yScaleRatio31(value) });
          }
          return /* @__PURE__ */ jsxRuntimeExports.jsx(
            "svg",
            {
              ref: svgRatio31Ref,
              width: chartWidth,
              height: chartHeight,
              className: "border border-gray-300 rounded bg-white w-full max-w-full cursor-move",
              viewBox: `0 0 ${chartWidth} ${chartHeight}`,
              preserveAspectRatio: "xMidYMid meet",
              onMouseDown: (e) => {
                if (e.button === 0 && !e.target || e.target.tagName !== "circle") {
                  setIsPanningRatio31(true);
                  setPanStartRatio31({
                    x: e.clientX - panRatio31.x,
                    y: e.clientY - panRatio31.y
                  });
                }
              },
              onMouseMove: (e) => {
                if (isPanningRatio31) {
                  setPanRatio31({
                    x: e.clientX - panStartRatio31.x,
                    y: e.clientY - panStartRatio31.y
                  });
                }
              },
              onMouseUp: () => setIsPanningRatio31(false),
              onMouseLeave: () => setIsPanningRatio31(false),
              children: /* @__PURE__ */ jsxRuntimeExports.jsxs("g", { transform: `translate(${panRatio31.x}, ${panRatio31.y}) scale(${zoomRatio31})`, children: [
                xTicksRatio31.map((tick, i) => /* @__PURE__ */ jsxRuntimeExports.jsx(
                  "line",
                  {
                    x1: tick.position,
                    y1: padding,
                    x2: tick.position,
                    y2: chartHeight - padding,
                    stroke: "#e5e7eb",
                    strokeWidth: "1",
                    strokeDasharray: "2,2"
                  },
                  `x-grid-ratio31-${i}`
                )),
                yTicksRatio31.map((tick, i) => /* @__PURE__ */ jsxRuntimeExports.jsx(
                  "line",
                  {
                    x1: padding,
                    y1: tick.position,
                    x2: chartWidth - padding,
                    y2: tick.position,
                    stroke: "#e5e7eb",
                    strokeWidth: "1",
                    strokeDasharray: "2,2"
                  },
                  `y-grid-ratio31-${i}`
                )),
                maxRatio31 >= 3 && minRatio31 <= 3 && /* @__PURE__ */ jsxRuntimeExports.jsx(
                  "line",
                  {
                    x1: xScaleRatio31(3),
                    y1: padding,
                    x2: xScaleRatio31(3),
                    y2: chartHeight - padding,
                    stroke: "#16a34a",
                    strokeWidth: "2",
                    strokeDasharray: "5,5",
                    opacity: "0.6"
                  }
                ),
                /* @__PURE__ */ jsxRuntimeExports.jsx(
                  "line",
                  {
                    x1: padding,
                    y1: chartHeight - padding,
                    x2: chartWidth - padding,
                    y2: chartHeight - padding,
                    stroke: "#1f2937",
                    strokeWidth: "2"
                  }
                ),
                /* @__PURE__ */ jsxRuntimeExports.jsx(
                  "line",
                  {
                    x1: padding,
                    y1: padding,
                    x2: padding,
                    y2: chartHeight - padding,
                    stroke: "#1f2937",
                    strokeWidth: "2"
                  }
                ),
                xTicksRatio31.map((tick, i) => /* @__PURE__ */ jsxRuntimeExports.jsxs("g", { children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx(
                    "line",
                    {
                      x1: tick.position,
                      y1: chartHeight - padding,
                      x2: tick.position,
                      y2: chartHeight - padding + 5,
                      stroke: "#1f2937",
                      strokeWidth: "1.5"
                    }
                  ),
                  /* @__PURE__ */ jsxRuntimeExports.jsxs(
                    "text",
                    {
                      x: tick.position,
                      y: chartHeight - padding + 20,
                      textAnchor: "middle",
                      className: "text-xs font-medium fill-gray-700",
                      children: [
                        tick.value !== null && tick.value !== void 0 ? tick.value.toFixed(1) : "N/A",
                        ":1"
                      ]
                    }
                  )
                ] }, `x-tick-ratio31-${i}`)),
                yTicksRatio31.map((tick, i) => /* @__PURE__ */ jsxRuntimeExports.jsxs("g", { children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx(
                    "line",
                    {
                      x1: padding,
                      y1: tick.position,
                      x2: padding - 5,
                      y2: tick.position,
                      stroke: "#1f2937",
                      strokeWidth: "1.5"
                    }
                  ),
                  /* @__PURE__ */ jsxRuntimeExports.jsxs(
                    "text",
                    {
                      x: padding - 10,
                      y: tick.position + 4,
                      textAnchor: "end",
                      className: "text-xs font-medium fill-gray-700",
                      children: [
                        tick.value !== null && tick.value !== void 0 ? tick.value.toFixed(0) : "N/A",
                        "%"
                      ]
                    }
                  )
                ] }, `y-tick-ratio31-${i}`)),
                /* @__PURE__ */ jsxRuntimeExports.jsx(
                  "text",
                  {
                    x: chartWidth / 2,
                    y: chartHeight - 15,
                    textAnchor: "middle",
                    className: "text-sm font-bold fill-gray-800",
                    children: "Ratio 3:1 (Potentiel de Hausse vs Risque de Baisse)"
                  }
                ),
                /* @__PURE__ */ jsxRuntimeExports.jsx(
                  "text",
                  {
                    x: 25,
                    y: chartHeight / 2,
                    textAnchor: "middle",
                    transform: `rotate(-90, 25, ${chartHeight / 2})`,
                    className: "text-sm font-bold fill-gray-800",
                    children: "Rendement Total Projet√© (5 ans, %)"
                  }
                ),
                /* @__PURE__ */ jsxRuntimeExports.jsx("g", { transform: `translate(${chartWidth / 2}, ${chartHeight - 5})`, children: /* @__PURE__ */ jsxRuntimeExports.jsx(
                  "text",
                  {
                    x: 0,
                    y: 0,
                    textAnchor: "middle",
                    className: "text-[9px] fill-gray-500",
                    children: "Ratio 3:1 = Potentiel de Hausse (%) √∑ Risque de Baisse (%) | Source: JSLAI‚Ñ¢"
                  }
                ) }),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("g", { transform: `translate(${chartWidth - 200}, ${padding + 20})`, children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("text", { x: 0, y: 0, className: "text-xs font-semibold fill-gray-700", children: "L√©gende Ratio 3:1:" }),
                  [
                    { label: "Favorable (‚â•3:1)", color: "#16a34a" },
                    { label: "Acceptable (1:1-3:1)", color: "#eab308" },
                    { label: "D√©favorable (<1:1)", color: "#dc2626" }
                  ].map((item, idx) => /* @__PURE__ */ jsxRuntimeExports.jsxs("g", { transform: `translate(0, ${(idx + 1) * 18})`, children: [
                    /* @__PURE__ */ jsxRuntimeExports.jsx("circle", { cx: 8, cy: 0, r: 6, fill: item.color }),
                    /* @__PURE__ */ jsxRuntimeExports.jsx("text", { x: 20, y: 4, className: "text-[10px] fill-gray-600", children: item.label })
                  ] }, idx))
                ] }),
                filteredMetrics.filter((metric) => !metric.hasInvalidData).map((metric) => {
                  if (metric.ratio31 < 0 || metric.ratio31 > 100 || metric.totalReturnPercent > 1e3 || metric.totalReturnPercent < -100 || !isFinite(metric.totalReturnPercent) || !isFinite(metric.ratio31)) {
                    return null;
                  }
                  const x = xScaleRatio31(metric.ratio31);
                  const y = yScaleRatio31(metric.totalReturnPercent);
                  getRatio31Color2(metric.ratio31);
                  return /* @__PURE__ */ jsxRuntimeExports.jsxs("g", { children: [
                    /* @__PURE__ */ jsxRuntimeExports.jsx(
                      "circle",
                      {
                        cx: x,
                        cy: y,
                        r: currentId === metric.profile.id ? 8 : 6,
                        className: `cursor-pointer hover:r-8 ${getRatioFillClass(metric.ratio31)}`,
                        stroke: currentId === metric.profile.id ? "#2563eb" : "#fff",
                        strokeWidth: currentId === metric.profile.id ? 2 : 1,
                        onClick: () => onSelect(metric.profile.id)
                      }
                    ),
                    currentId === metric.profile.id && /* @__PURE__ */ jsxRuntimeExports.jsx(
                      "text",
                      {
                        x,
                        y: y - 15,
                        textAnchor: "middle",
                        className: "text-xs font-bold fill-blue-600",
                        children: metric.profile.id
                      }
                    )
                  ] }, `ratio31-${metric.profile.id}`);
                }).filter(Boolean)
              ] })
            }
          );
        })() }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "mt-3 p-3 bg-gray-50 rounded-lg border border-gray-200", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-xs text-gray-700 space-y-1", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "font-semibold mb-1", children: "üìä √Ä propos du Ratio 3:1 :" }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Source de calcul:" }),
            " Potentiel de Hausse (%) √∑ Risque de Baisse (%)"
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Formule:" }),
            " Ratio 3:1 = ((Prix Projet√© - Prix Actuel) / Prix Actuel √ó 100) √∑ ((Prix Actuel - Prix Plancher) / Prix Actuel √ó 100)"
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Fournisseur:" }),
            " M√©trique propri√©taire JSLAI‚Ñ¢ d√©velopp√©e par Jean-S√©bastien. Le fournisseur √©tablit cette m√©trique en comparant le potentiel de hausse (gain potentiel si le prix atteint le prix projet√©) au risque de baisse (perte potentielle jusqu'au prix plancher historique). Un ratio ‚â• 3:1 indique que le potentiel de hausse est au moins 3 fois sup√©rieur au risque de baisse, ce qui repr√©sente un bon rapport risque/rendement."
          ] })
        ] }) })
      ] }) })
    ] }),
    filteredMetrics.length > 0 && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white p-3 sm:p-4 md:p-6 rounded-lg shadow-lg border border-gray-200", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "flex items-center justify-between mb-3 sm:mb-4", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2 sm:gap-3", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("h3", { className: "text-base sm:text-lg md:text-xl font-bold text-gray-800", children: "üìä Distribution des Rendements Totaux" }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          "button",
          {
            onClick: () => toggleSection("returnDistribution"),
            className: "p-1.5 hover:bg-gray-100 rounded transition-colors cursor-help",
            title: sectionsVisibility.returnDistribution ? "R√©duire cette section" : "Agrandir cette section",
            children: sectionsVisibility.returnDistribution ? /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$f, { className: "w-5 h-5 text-gray-600" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$g, { className: "w-5 h-5 text-gray-600" })
          }
        )
      ] }) }),
      sectionsVisibility.returnDistribution && /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "flex items-end justify-between gap-2 h-64 border-b border-l border-gray-300 pb-2 pl-2", children: (() => {
          if (filteredMetrics.length === 0) return null;
          const minReturn2 = Math.min(...filteredMetrics.map((m) => m.totalReturnPercent));
          const maxReturn2 = Math.max(...filteredMetrics.map((m) => m.totalReturnPercent));
          const binCount = 12;
          const binSize = (maxReturn2 - minReturn2) / binCount || 1;
          const bins = Array(binCount).fill(0).map((_, i) => ({
            min: minReturn2 + i * binSize,
            max: minReturn2 + (i + 1) * binSize,
            count: 0
          }));
          filteredMetrics.forEach((metric) => {
            const binIndex = Math.min(
              Math.floor((metric.totalReturnPercent - minReturn2) / binSize),
              binCount - 1
            );
            if (binIndex >= 0) bins[binIndex].count++;
          });
          const maxCount = Math.max(...bins.map((b) => b.count));
          return bins.map((bin, idx) => {
            const barHeightStyle = {
              height: `${bin.count / maxCount * 240}px`,
              minHeight: bin.count > 0 ? "4px" : "0px"
            };
            return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex-1 flex flex-col items-center group relative", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "div",
                {
                  className: "w-full bg-blue-500 hover:bg-blue-600 transition-colors rounded-t cursor-pointer",
                  style: barHeightStyle,
                  title: `${bin.min !== null && bin.min !== void 0 ? bin.min.toFixed(0) : "N/A"}% - ${bin.max !== null && bin.max !== void 0 ? bin.max.toFixed(0) : "N/A"}%: ${bin.count} titre(s)`
                }
              ),
              idx % 3 === 0 && /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-[8px] text-gray-500 mt-1", children: [
                bin.min !== null && bin.min !== void 0 ? bin.min.toFixed(0) : "N/A",
                "%"
              ] })
            ] }, idx);
          });
        })() }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "mt-2 text-xs text-gray-500 text-center", children: [
          filteredMetrics.length,
          " titre(s) | Range: ",
          filteredMetrics.length > 0 ? (() => {
            const validReturns = filteredMetrics.map((m) => m.totalReturnPercent).filter((r) => r !== null && r !== void 0);
            if (validReturns.length === 0) return "N/A";
            return `${Math.min(...validReturns).toFixed(0)}% √† ${Math.max(...validReturns).toFixed(0)}%`;
          })() : "N/A"
        ] })
      ] })
    ] }),
    filteredMetrics.length > 0 && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white p-3 sm:p-4 md:p-6 rounded-lg shadow-lg border border-gray-200", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "flex items-center justify-between mb-3 sm:mb-4", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2 sm:gap-3", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("h3", { className: "text-base sm:text-lg md:text-xl font-bold text-gray-800", children: "üìà Visualisations Avanc√©es" }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          "button",
          {
            onClick: () => toggleSection("otherVisualizations"),
            className: "p-1.5 hover:bg-gray-100 rounded transition-colors cursor-help",
            title: sectionsVisibility.otherVisualizations ? "R√©duire cette section" : "Agrandir cette section",
            children: sectionsVisibility.otherVisualizations ? /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$f, { className: "w-5 h-5 text-gray-600" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$g, { className: "w-5 h-5 text-gray-600" })
          }
        )
      ] }) }),
      sectionsVisibility.otherVisualizations && /* @__PURE__ */ jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment, { children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4 md:gap-6", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white p-3 sm:p-4 md:p-6 rounded-lg shadow-lg border border-gray-200", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("h3", { className: "text-base sm:text-lg md:text-xl font-bold text-gray-800 mb-3 sm:mb-4", children: "üî• Performance par Secteur" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-500 mb-3", children: "Rendement moyen, JPEGY moyen et nombre de titres par secteur" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "space-y-3", children: Array.from(new Set(filteredMetrics.map((m) => m.profile.info.sector))).map((sector) => {
            const sectorMetrics = filteredMetrics.filter((m) => m.profile.info.sector === sector);
            const validReturns = sectorMetrics.map((m) => m.totalReturnPercent).filter((r) => r !== null && r !== void 0 && isFinite(r));
            const avgReturn = validReturns.length > 0 ? validReturns.reduce((sum, r) => sum + r, 0) / validReturns.length : 0;
            const validJPEGY = sectorMetrics.filter((m) => m.jpegy !== null && m.jpegy !== void 0 && isFinite(m.jpegy)).map((m) => m.jpegy);
            const avgJPEGY = validJPEGY.length > 0 ? validJPEGY.reduce((sum, j) => sum + j, 0) / validJPEGY.length : null;
            const validRatios = sectorMetrics.map((m) => m.ratio31).filter((r) => r !== null && r !== void 0 && isFinite(r));
            const avgRatio31 = validRatios.length > 0 ? validRatios.reduce((sum, r) => sum + r, 0) / validRatios.length : 0;
            return { sector, avgReturn, avgJPEGY, avgRatio31, count: sectorMetrics.length };
          }).sort((a, b) => b.avgReturn - a.avgReturn).map(({ sector, avgReturn, avgJPEGY, avgRatio31, count }) => {
            const barWidthStyle = {
              width: `${Math.min(Math.max((avgReturn + 50) / 200 * 100, 0), 100)}%`
            };
            return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "p-3 bg-gradient-to-r from-gray-50 to-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between mb-2", children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-sm font-bold text-gray-800", children: sector }),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-xs text-gray-500 bg-gray-200 px-2 py-1 rounded-full", children: [
                  count,
                  " titre(s)"
                ] })
              ] }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "space-y-2", children: [
                /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-xs text-gray-600", children: "Rendement moyen:" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2", children: [
                    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-32 h-3 bg-gray-200 rounded-full overflow-hidden", children: /* @__PURE__ */ jsxRuntimeExports.jsx(
                      "div",
                      {
                        className: `h-full ${getReturnBgClass(avgReturn)}`,
                        style: barWidthStyle
                      }
                    ) }),
                    /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: `text-xs font-bold w-16 text-right ${avgReturn >= 50 ? "text-green-600" : avgReturn >= 20 ? "text-green-500" : avgReturn >= 0 ? "text-yellow-600" : "text-red-600"}`, children: [
                      avgReturn !== null && avgReturn !== void 0 && isFinite(avgReturn) ? avgReturn.toFixed(1) : "N/A",
                      "%"
                    ] })
                  ] })
                ] }),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-xs text-gray-600", children: "JPEGY moyen:" }),
                  avgJPEGY !== null ? /* @__PURE__ */ jsxRuntimeExports.jsx(
                    "span",
                    {
                      className: `text-xs font-semibold px-2 py-0.5 rounded text-white ${getJpegyBgClass(avgJPEGY)}`,
                      children: avgJPEGY.toFixed(2)
                    }
                  ) : /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-xs font-semibold px-2 py-0.5 rounded bg-gray-400 text-white flex items-center gap-1", children: [
                    "N/A ",
                    /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$a, { className: "w-3 h-3" })
                  ] })
                ] }),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-xs text-gray-600", children: "Ratio 3:1 moyen:" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: `text-xs font-semibold ${avgRatio31 != null && avgRatio31 >= 3 ? "text-green-600" : avgRatio31 != null && avgRatio31 >= 1 ? "text-yellow-600" : "text-red-600"}`, children: avgRatio31 != null && isFinite(avgRatio31) ? avgRatio31.toFixed(2) : "N/A" })
                ] })
              ] })
            ] }, sector);
          }) })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white p-3 sm:p-4 md:p-6 rounded-lg shadow-lg border border-gray-200", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("h3", { className: "text-base sm:text-lg md:text-xl font-bold text-gray-800 mb-3 sm:mb-4", children: "üèÜ Top 5 Performers" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-500 mb-3", children: "Meilleurs rendements projet√©s" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "space-y-2", children: filteredMetrics.filter((m) => !m.hasInvalidData).sort((a, b) => b.totalReturnPercent - a.totalReturnPercent).slice(0, 5).map((metric, idx) => /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between p-2 bg-gradient-to-r from-yellow-50 to-white rounded border-l-4 border-yellow-400", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-lg font-bold text-yellow-600", children: [
                "#",
                idx + 1
              ] }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "font-semibold", children: metric.profile.id })
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: `text-sm font-bold ${metric.hasInvalidData ? "text-gray-400" : "text-green-600"}`, children: metric.hasInvalidData || metric.totalReturnPercent === null || metric.totalReturnPercent === void 0 ? "N/A" : `${metric.totalReturnPercent.toFixed(1)}%` })
          ] }, metric.profile.id)) })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white p-3 sm:p-4 md:p-6 rounded-lg shadow-lg border border-gray-200", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("h3", { className: "text-base sm:text-lg md:text-xl font-bold text-gray-800 mb-3 sm:mb-4", children: "‚ö†Ô∏è Distribution des Risques de Baisse" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-500 mb-3", children: "Classification par niveau de risque avec visualisation" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "mb-4", children: /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "flex items-end justify-between gap-3 h-24 border-b border-l border-gray-300 pb-2 pl-2 bg-gray-50 p-2 rounded", children: ["Faible", "Mod√©r√©", "√âlev√©"].map((level, idx) => {
            const ranges = [[0, 20], [20, 50], [50, 100]];
            const count = filteredMetrics.filter(
              (m) => m.downsideRisk >= ranges[idx][0] && m.downsideRisk < ranges[idx][1]
            ).length;
            const maxCount = Math.max(...["Faible", "Mod√©r√©", "√âlev√©"].map((_, i) => {
              const r = [[0, 20], [20, 50], [50, 100]];
              return filteredMetrics.filter(
                (m) => m.downsideRisk >= r[i][0] && m.downsideRisk < r[i][1]
              ).length;
            }), 1);
            return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex-1 flex flex-col items-center", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                "div",
                {
                  style: {
                    height: `${count / maxCount * 100}%`,
                    minHeight: "10px"
                  },
                  className: `w-full rounded-t cursor-pointer hover:opacity-80 transition-opacity ${idx === 0 ? "bg-green-300" : idx === 1 ? "bg-yellow-500" : "bg-red-600"}`,
                  title: `${level}: ${count} titre(s)`
                }
              ),
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-[9px] text-gray-600 mt-1 text-center", children: level }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-xs font-bold text-gray-800", children: count })
            ] }, level);
          }) }) }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "space-y-2", children: ["Faible", "Mod√©r√©", "√âlev√©"].map((level, idx) => {
            const ranges = [[0, 20], [20, 50], [50, 100]];
            const count = filteredMetrics.filter(
              (m) => m.downsideRisk >= ranges[idx][0] && m.downsideRisk < ranges[idx][1]
            ).length;
            const titles = filteredMetrics.filter((m) => m.downsideRisk >= ranges[idx][0] && m.downsideRisk < ranges[idx][1]).map((m) => m.profile.id).slice(0, 5);
            return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between p-2 bg-gray-50 rounded hover:bg-gray-100 transition-colors", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2", children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-sm font-medium", children: level }),
                titles.length > 0 && /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-xs text-gray-500", children: [
                  "(",
                  titles.join(", "),
                  titles.length < count ? ` +${count - titles.length}` : "",
                  ")"
                ] })
              ] }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2", children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-32 h-4 bg-gray-200 rounded-full overflow-hidden", children: /* @__PURE__ */ jsxRuntimeExports.jsx(
                  "div",
                  {
                    className: `h-full ${idx === 0 ? "bg-green-400" : idx === 1 ? "bg-yellow-400" : "bg-red-500"}`,
                    style: { width: `${count / filteredMetrics.length * 100}%` }
                  }
                ) }),
                /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-xs font-semibold w-8 text-right", children: count })
              ] })
            ] }, level);
          }) })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white p-3 sm:p-4 md:p-6 rounded-lg shadow-lg border border-gray-200", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("h3", { className: "text-base sm:text-lg md:text-xl font-bold text-gray-800 mb-3 sm:mb-4", children: "üìä Distribution Ratio 3:1 (Potentiel vs Risque)" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-500 mb-3", children: "Ratio hausse potentielle / risque de baisse" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "space-y-2", children: ["< 1:1", "1:1 - 3:1", "> 3:1"].map((range, idx) => {
            const ranges = [[0, 1], [1, 3], [3, 100]];
            const count = filteredMetrics.filter(
              (m) => m.ratio31 >= ranges[idx][0] && m.ratio31 < ranges[idx][1]
            ).length;
            const color = idx === 2 ? "green" : idx === 1 ? "yellow" : "red";
            return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between p-2 bg-gray-50 rounded", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-sm font-medium", children: range }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2", children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-32 h-4 bg-gray-200 rounded-full overflow-hidden", children: /* @__PURE__ */ jsxRuntimeExports.jsx(
                  "div",
                  {
                    className: `h-full bg-${color}-500`,
                    style: { width: `${count / filteredMetrics.length * 100}%` }
                  }
                ) }),
                /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-xs font-semibold w-8 text-right", children: count })
              ] })
            ] }, range);
          }) })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white p-3 sm:p-4 md:p-6 rounded-lg shadow-lg border border-gray-200 md:col-span-2", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("h3", { className: "text-base sm:text-lg md:text-xl font-bold text-gray-800 mb-3 sm:mb-4", children: "üìà Timeline de Performance (Tri√©e par Rendement)" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-500 mb-3", children: "Barres horizontales class√©es par rendement d√©croissant" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "overflow-x-auto -mx-3 sm:mx-0 px-3 sm:px-0", children: /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "flex gap-1.5 sm:gap-2 min-w-max pb-2", children: filteredMetrics.sort((a, b) => b.totalReturnPercent - a.totalReturnPercent).map((metric) => {
            const timelineBarStyle = {
              height: `${Math.max(Math.min((metric.totalReturnPercent + 50) / 200 * 100, 100), 5)}px`,
              minHeight: "15px"
            };
            return /* @__PURE__ */ jsxRuntimeExports.jsxs(
              "div",
              {
                className: "flex flex-col items-center p-1.5 sm:p-2 bg-gray-50 rounded min-w-[60px] sm:min-w-[70px] md:min-w-[80px] cursor-pointer hover:bg-blue-50 transition-colors",
                onClick: () => onSelect(metric.profile.id),
                children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-[10px] sm:text-xs font-bold mb-1 truncate w-full text-center", children: metric.profile.id }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx(
                    "div",
                    {
                      className: `w-full rounded mb-1 ${getReturnBgClass(metric.totalReturnPercent)}`,
                      style: timelineBarStyle
                    }
                  ),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: `text-[9px] sm:text-xs font-semibold ${metric.hasInvalidData ? "text-gray-400" : getReturnTextClass(metric.totalReturnPercent)}`, children: metric.hasInvalidData || metric.totalReturnPercent === null || metric.totalReturnPercent === void 0 ? "N/A" : `${metric.totalReturnPercent.toFixed(0)}%` })
                ]
              },
              metric.profile.id
            );
          }) }) })
        ] })
      ] }) })
    ] }),
    filteredMetrics.length > 1 && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white p-3 sm:p-4 md:p-6 rounded-lg shadow-lg border border-gray-200", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "flex items-center justify-between mb-3 sm:mb-4", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2 sm:gap-3", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("h3", { className: "text-base sm:text-lg md:text-xl font-bold text-gray-800", children: "üîó Matrice de Corr√©lation entre M√©triques" }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          "button",
          {
            onClick: () => toggleSection("correlationMatrix"),
            className: "p-1.5 hover:bg-gray-100 rounded transition-colors cursor-help",
            title: sectionsVisibility.correlationMatrix ? "R√©duire cette section" : "Agrandir cette section",
            children: sectionsVisibility.correlationMatrix ? /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$f, { className: "w-5 h-5 text-gray-600" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$g, { className: "w-5 h-5 text-gray-600" })
          }
        )
      ] }) }),
      sectionsVisibility.correlationMatrix && /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-gray-500 mb-4", children: "Corr√©lations entre JPEGY, Rendement, Ratio 3:1, P/E, Yield et Croissance" }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "overflow-x-auto", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("table", { className: "w-full text-xs", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("thead", { children: /* @__PURE__ */ jsxRuntimeExports.jsxs("tr", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("th", { className: "p-2 text-left font-bold text-gray-700 border-b border-gray-300" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("th", { className: "p-2 text-center font-bold text-gray-700 border-b border-gray-300", children: "JPEGY" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("th", { className: "p-2 text-center font-bold text-gray-700 border-b border-gray-300", children: "Rendement" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("th", { className: "p-2 text-center font-bold text-gray-700 border-b border-gray-300", children: "Ratio 3:1" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("th", { className: "p-2 text-center font-bold text-gray-700 border-b border-gray-300", children: "P/E" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("th", { className: "p-2 text-center font-bold text-gray-700 border-b border-gray-300", children: "Yield" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("th", { className: "p-2 text-center font-bold text-gray-700 border-b border-gray-300", children: "Croissance" })
          ] }) }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("tbody", { children: (() => {
            const metrics = ["jpegy", "totalReturnPercent", "ratio31", "currentPE", "currentYield", "historicalGrowth"];
            const labels = ["JPEGY", "Rendement", "Ratio 3:1", "P/E", "Yield", "Croissance"];
            const calculateCorrelation = (x, y) => {
              if (filteredMetrics.length < 2) return 0;
              const xValues = filteredMetrics.map((m) => {
                const val = m[x];
                return typeof val === "number" && isFinite(val) ? val : 0;
              }).filter((v) => v != null && isFinite(v));
              const yValues = filteredMetrics.map((m) => {
                const val = m[y];
                return typeof val === "number" && isFinite(val) ? val : 0;
              }).filter((v) => v != null && isFinite(v));
              if (xValues.length !== yValues.length || xValues.length < 2) return 0;
              const xMean = xValues.reduce((a, b) => a + b, 0) / xValues.length;
              const yMean = yValues.reduce((a, b) => a + b, 0) / yValues.length;
              let numerator = 0;
              let xSumSq = 0;
              let ySumSq = 0;
              for (let i = 0; i < xValues.length; i++) {
                const xDiff = xValues[i] - xMean;
                const yDiff = yValues[i] - yMean;
                numerator += xDiff * yDiff;
                xSumSq += xDiff * xDiff;
                ySumSq += yDiff * yDiff;
              }
              const denominator = Math.sqrt(xSumSq * ySumSq);
              return denominator === 0 ? 0 : numerator / denominator;
            };
            return metrics.map((metric, idx) => /* @__PURE__ */ jsxRuntimeExports.jsxs("tr", { children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: "p-2 font-bold text-gray-700 border-r border-gray-300", children: labels[idx] }),
              metrics.map((otherMetric, otherIdx) => {
                if (idx === otherIdx) {
                  return /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: "p-2 text-center bg-gray-100 font-bold", children: "1.00" }, otherMetric);
                }
                const corr = calculateCorrelation(metric, otherMetric);
                const intensity = Math.abs(corr);
                const color = corr > 0 ? `rgba(34, 197, 94, ${intensity})` : `rgba(239, 68, 68, ${intensity})`;
                const cellStyle = { backgroundColor: color, color: intensity > 0.5 ? "white" : "black" };
                return /* @__PURE__ */ jsxRuntimeExports.jsx(
                  "td",
                  {
                    className: "p-2 text-center font-semibold",
                    style: cellStyle,
                    title: `Corr√©lation: ${corr.toFixed(3)}`,
                    children: corr.toFixed(2)
                  },
                  otherMetric
                );
              })
            ] }, metric));
          })() })
        ] }) }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "mt-4 flex items-center justify-center gap-4 text-xs", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-1", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-4 h-4 bg-green-500 rounded" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-gray-600", children: "Corr√©lation positive" })
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-1", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-4 h-4 bg-red-500 rounded" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-gray-600", children: "Corr√©lation n√©gative" })
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-gray-500", children: "Intensit√© = valeur absolue" })
        ] })
      ] })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white p-3 sm:p-4 md:p-6 rounded-lg shadow-lg border border-gray-200", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-4 mb-3 sm:mb-4", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2 sm:gap-3", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("h3", { className: "text-base sm:text-lg md:text-xl font-bold text-gray-800", children: "üìã Tableau de Performance D√©taill√©" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx(
            "button",
            {
              onClick: () => toggleSection("detailedTable"),
              className: "p-1.5 hover:bg-gray-100 rounded transition-colors cursor-help",
              title: sectionsVisibility.detailedTable ? "R√©duire cette section" : "Agrandir cette section",
              children: sectionsVisibility.detailedTable ? /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$f, { className: "w-5 h-5 text-gray-600" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$g, { className: "w-5 h-5 text-gray-600" })
            }
          )
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2 sm:gap-4 w-full sm:w-auto", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-xs text-gray-500", children: [
            filteredMetrics.length,
            " titre(s)"
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs(
            "button",
            {
              onClick: handleExport,
              className: "px-3 sm:px-4 py-1.5 sm:py-2 bg-blue-600 text-white text-xs sm:text-sm font-semibold rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-1 sm:gap-2 flex-1 sm:flex-none",
              title: "Exporter en CSV",
              children: [
                "üì• ",
                /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "hidden sm:inline", children: "Exporter" }),
                " CSV"
              ]
            }
          )
        ] })
      ] }),
      sectionsVisibility.detailedTable && /* @__PURE__ */ jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment, { children: filteredMetrics.length === 0 ? /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-center py-8 text-gray-500", children: "Aucun titre ne correspond aux filtres s√©lectionn√©s." }) : /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "overflow-x-auto -mx-3 sm:mx-0", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("table", { className: "w-full text-xs sm:text-sm", style: { minWidth: "100%" }, children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("thead", { className: "bg-gradient-to-r from-slate-100 to-slate-50 sticky top-0", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("tr", { children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx(
            "th",
            {
              className: "p-2 sm:p-3 text-left font-bold text-gray-700 border-b border-gray-300 cursor-pointer hover:bg-slate-200 transition-colors text-xs sm:text-sm",
              onClick: () => handleSort("ticker"),
              children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-1", children: [
                "Ticker",
                sortConfig.key === "ticker" && /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: sortConfig.direction === "asc" ? "‚Üë" : "‚Üì" })
              ] })
            }
          ),
          /* @__PURE__ */ jsxRuntimeExports.jsx(
            "th",
            {
              className: "p-2 sm:p-3 text-right font-bold text-gray-700 border-b border-gray-300 cursor-pointer hover:bg-slate-200 transition-colors text-xs sm:text-sm",
              title: "JPEGY (Jean-Sebastien's P/E Adjusted for Growth & Yield) - Source: P/E Actuel √∑ (Taux de croissance EPS % + Rendement dividende %) - Fournisseur: M√©trique propri√©taire JSLAI‚Ñ¢ d√©velopp√©e par Jean-S√©bastien. Ajuste le ratio P/E traditionnel par la somme du taux de croissance des b√©n√©fices et du rendement du dividende, permettant une √©valuation plus nuanc√©e de la valorisation d'une action.",
              onClick: () => handleSort("jpegy"),
              children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-end gap-1", children: [
                "JPEGY",
                sortConfig.key === "jpegy" && /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: sortConfig.direction === "asc" ? "‚Üë" : "‚Üì" })
              ] })
            }
          ),
          /* @__PURE__ */ jsxRuntimeExports.jsx(
            "th",
            {
              className: "p-2 sm:p-3 text-right font-bold text-gray-700 border-b border-gray-300 cursor-pointer hover:bg-slate-200 transition-colors text-xs sm:text-sm",
              title: "Rendement total projet√© sur 5 ans",
              onClick: () => handleSort("totalReturnPercent"),
              children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-end gap-1", children: [
                "Rendement",
                sortConfig.key === "totalReturnPercent" && /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: sortConfig.direction === "asc" ? "‚Üë" : "‚Üì" })
              ] })
            }
          ),
          /* @__PURE__ */ jsxRuntimeExports.jsx(
            "th",
            {
              className: "p-2 sm:p-3 text-right font-bold text-gray-700 border-b border-gray-300 cursor-pointer hover:bg-slate-200 transition-colors text-xs sm:text-sm",
              title: "Ratio potentiel de hausse vs risque de baisse",
              onClick: () => handleSort("ratio31"),
              children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-end gap-1", children: [
                "Ratio 3:1",
                sortConfig.key === "ratio31" && /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: sortConfig.direction === "asc" ? "‚Üë" : "‚Üì" })
              ] })
            }
          ),
          /* @__PURE__ */ jsxRuntimeExports.jsx("th", { className: "p-2 sm:p-3 text-right font-bold text-gray-700 border-b border-gray-300 text-xs sm:text-sm hidden md:table-cell", title: "Potentiel de hausse en %", children: "Hausse" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("th", { className: "p-2 sm:p-3 text-right font-bold text-gray-700 border-b border-gray-300 text-xs sm:text-sm hidden md:table-cell", title: "Risque de baisse en %", children: "Baisse" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("th", { className: "p-2 sm:p-3 text-right font-bold text-gray-700 border-b border-gray-300 text-xs sm:text-sm hidden lg:table-cell", title: "Ratio cours/b√©n√©fice actuel", children: "P/E" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("th", { className: "p-2 sm:p-3 text-right font-bold text-gray-700 border-b border-gray-300 text-xs sm:text-sm hidden lg:table-cell", title: "Rendement du dividende", children: "Yield" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx(
            "th",
            {
              className: "p-2 sm:p-3 text-right font-bold text-gray-700 border-b border-gray-300 cursor-pointer hover:bg-slate-200 transition-colors text-xs sm:text-sm hidden lg:table-cell",
              title: "Croissance historique des EPS",
              onClick: () => handleSort("historicalGrowth"),
              children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-end gap-1", children: [
                "Croissance",
                sortConfig.key === "historicalGrowth" && /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: sortConfig.direction === "asc" ? "‚Üë" : "‚Üì" })
              ] })
            }
          ),
          /* @__PURE__ */ jsxRuntimeExports.jsx("th", { className: "p-2 sm:p-3 text-center font-bold text-gray-700 border-b border-gray-300 text-xs sm:text-sm", children: "Approuv√©" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx(
            "th",
            {
              className: "p-2 sm:p-3 text-center font-bold text-gray-700 border-b border-gray-300 cursor-pointer hover:bg-slate-200 transition-colors text-xs sm:text-sm",
              onClick: () => handleSort("recommendation"),
              children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-center gap-1", children: [
                "Signal",
                sortConfig.key === "recommendation" && /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: sortConfig.direction === "asc" ? "‚Üë" : "‚Üì" })
              ] })
            }
          )
        ] }) }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("tbody", { className: "divide-y divide-gray-100", children: filteredMetrics.map((metric) => {
          var _a2, _b2, _c2, _d, _e, _f, _g;
          return /* @__PURE__ */ jsxRuntimeExports.jsxs(
            "tr",
            {
              onClick: () => onSelect(metric.profile.id),
              className: `cursor-pointer hover:bg-blue-50 ${currentId === metric.profile.id ? "bg-blue-100" : ""}`,
              children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: "p-2 sm:p-3 font-bold text-xs sm:text-sm", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-1.5 sm:gap-2", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "truncate", children: metric.profile.id }),
                  metric.profile.isWatchlist ?? false ? /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$1, { className: "w-3 h-3 sm:w-4 sm:h-4 text-blue-500 flex-shrink-0", title: "Watchlist" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef, { className: "w-3 h-3 sm:w-4 sm:h-4 text-yellow-500 flex-shrink-0", title: "Portefeuille" })
                ] }) }),
                /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: "p-2 sm:p-3 text-right text-xs sm:text-sm", children: metric._isLoading ? /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-end gap-1 text-gray-400", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$b, { className: "w-3 h-3 animate-spin" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-[10px]", children: "Chargement..." })
                ] }) : metric.jpegy !== null ? /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "group relative", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-end", children: [
                    /* @__PURE__ */ jsxRuntimeExports.jsx(
                      "span",
                      {
                        className: `inline-block w-4 h-4 rounded-full mr-2 ${getJpegyBgClass(metric.jpegy)}`
                      }
                    ),
                    metric.jpegy !== null && metric.jpegy !== void 0 ? metric.jpegy.toFixed(2) : "N/A"
                  ] }),
                  /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "absolute right-0 top-full mt-1 w-64 p-2 bg-gray-800 text-white text-xs rounded shadow-lg opacity-0 group-hover:opacity-100 transition-opacity z-50 pointer-events-none", children: [
                    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "font-semibold mb-1", children: [
                      "JPEGY: ",
                      metric.jpegy !== null && metric.jpegy !== void 0 ? metric.jpegy.toFixed(2) : "N/A"
                    ] }),
                    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "space-y-1 text-[10px]", children: [
                      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
                        /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Source de calcul:" }),
                        " P/E Actuel √∑ (Taux de croissance EPS % + Rendement dividende %)"
                      ] }),
                      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
                        /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Formule:" }),
                        " JPEGY = ",
                        ((_a2 = metric.currentPE) == null ? void 0 : _a2.toFixed(2)) || "P/E",
                        " √∑ (",
                        ((_b2 = metric.historicalGrowth) == null ? void 0 : _b2.toFixed(1)) || "Growth",
                        "% + ",
                        ((_c2 = metric.currentYield) == null ? void 0 : _c2.toFixed(2)) || "Yield",
                        "%)"
                      ] }),
                      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
                        /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Fournisseur:" }),
                        " M√©trique propri√©taire JSLAI‚Ñ¢ d√©velopp√©e par Jean-S√©bastien. Le fournisseur √©tablit cette m√©trique en ajustant le ratio P/E traditionnel par la somme du taux de croissance des b√©n√©fices et du rendement du dividende, permettant une √©valuation plus nuanc√©e de la valorisation d'une action en tenant compte de sa capacit√© de croissance et de sa distribution de dividendes."
                      ] })
                    ] })
                  ] })
                ] }) : /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-gray-400 flex items-center justify-end gap-1", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$a, { className: "w-4 h-4 text-orange-500", title: "JPEGY non calculable: EPS invalide ou (Growth + Yield) ‚â§ 0.01%" }),
                  "N/A"
                ] }) }),
                /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: `p-2 sm:p-3 text-right font-semibold text-xs sm:text-sm ${metric._isLoading || metric.hasInvalidData ? "text-gray-400" : getReturnTextClass(metric.totalReturnPercent)}`, children: metric._isLoading ? /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-end gap-1 text-gray-400", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$b, { className: "w-3 h-3 animate-spin" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-[10px]", children: "..." })
                ] }) : metric.hasInvalidData || metric.totalReturnPercent === null || metric.totalReturnPercent === void 0 ? "N/A" : `${metric.totalReturnPercent.toFixed(1)}%` }),
                /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: "p-2 sm:p-3 text-right text-xs sm:text-sm", children: metric._isLoading ? /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-end gap-1 text-gray-400", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$b, { className: "w-3 h-3 animate-spin" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-[10px]", children: "..." })
                ] }) : metric.ratio31 !== null && metric.ratio31 !== void 0 ? metric.ratio31.toFixed(2) : "N/A" }),
                /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: `p-2 sm:p-3 text-right text-green-600 text-xs sm:text-sm ${!displayOptions.visibleColumns.upside ? "hidden" : ""} ${displayOptions.density === "compact" ? "hidden md:table-cell" : "md:table-cell"}`, children: metric._isLoading ? /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-end gap-1 text-gray-400", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$b, { className: "w-3 h-3 animate-spin" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-[10px]", children: "..." })
                ] }) : metric.upsidePotential !== null && metric.upsidePotential !== void 0 ? `${metric.upsidePotential.toFixed(1)}%` : "N/A" }),
                /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: `p-2 sm:p-3 text-right text-red-600 text-xs sm:text-sm ${!displayOptions.visibleColumns.downside ? "hidden" : ""} ${displayOptions.density === "compact" ? "hidden md:table-cell" : "md:table-cell"}`, children: metric._isLoading ? /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-end gap-1 text-gray-400", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$b, { className: "w-3 h-3 animate-spin" }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-[10px]", children: "..." })
                ] }) : metric.downsideRisk !== null && metric.downsideRisk !== void 0 ? `${metric.downsideRisk.toFixed(1)}%` : "N/A" }),
                /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: `p-2 sm:p-3 text-center ${!displayOptions.visibleColumns.pe ? "hidden" : ""} ${displayOptions.density === "compact" ? "hidden lg:table-cell" : "lg:table-cell"}`, children: /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-xs sm:text-sm", children: [
                  ((_d = metric.currentPE) == null ? void 0 : _d.toFixed(1)) || "N/A",
                  "x"
                ] }) }),
                /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: `p-2 sm:p-3 text-center ${!displayOptions.visibleColumns.yield ? "hidden" : ""} ${displayOptions.density === "compact" ? "hidden lg:table-cell" : "lg:table-cell"}`, children: /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-xs sm:text-sm", children: [
                  ((_e = metric.currentYield) == null ? void 0 : _e.toFixed(2)) || "N/A",
                  "%"
                ] }) }),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("td", { className: `p-2 sm:p-3 text-right text-xs sm:text-sm ${!displayOptions.visibleColumns.growth ? "hidden" : ""} ${displayOptions.density === "compact" ? "hidden lg:table-cell" : "lg:table-cell"}`, children: [
                  ((_f = metric.historicalGrowth) == null ? void 0 : _f.toFixed(1)) || "N/A",
                  "%"
                ] }),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("td", { className: `p-2 sm:p-3 text-right text-xs sm:text-sm ${!displayOptions.visibleColumns.volatility ? "hidden" : ""} hidden xl:table-cell`, children: [
                  ((_g = metric.volatility) == null ? void 0 : _g.toFixed(1)) || "N/A",
                  "%"
                ] }),
                /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: `p-2 sm:p-3 text-center ${!displayOptions.visibleColumns.approved ? "hidden" : ""}`, children: metric.hasApprovedVersion ? /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$e, { className: "w-4 h-4 sm:w-5 sm:h-5 text-green-500 mx-auto" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(ForwardRef$i, { className: "w-4 h-4 sm:w-5 sm:h-5 text-gray-300 mx-auto" }) }),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("td", { className: "p-2 sm:p-3 text-center text-xs sm:text-sm", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "hidden sm:inline", children: /* @__PURE__ */ jsxRuntimeExports.jsx(
                    StatusBadge,
                    {
                      type: "recommendation",
                      value: metric.recommendation,
                      className: "font-semibold"
                    }
                  ) }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "sm:hidden", children: /* @__PURE__ */ jsxRuntimeExports.jsx(
                    StatusBadge,
                    {
                      type: "recommendation",
                      value: metric.recommendation === "ACHAT" || metric.recommendation === "BUY" ? "A" : metric.recommendation === "VENTE" || metric.recommendation === "SELL" ? "V" : "C",
                      className: "font-semibold text-xs"
                    }
                  ) })
                ] })
              ]
            },
            metric.profile.id
          );
        }) })
      ] }) }) })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      SyncSelectionDialog,
      {
        isOpen: showSyncDialog,
        profiles,
        onClose: () => setShowSyncDialog(false),
        onConfirm: (tickers) => {
          setShowSyncDialog(false);
          if (onSyncNA) {
            onSyncNA(tickers);
          }
        },
        isSyncing: isBulkSyncing
      }
    ),
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      GuideDialog,
      {
        isOpen: showGuideDialog,
        onClose: () => setShowGuideDialog(false)
      }
    )
  ] });
};
export {
  KPIDashboard
};
